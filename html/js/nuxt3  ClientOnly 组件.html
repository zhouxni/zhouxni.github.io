<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Document</title><link rel="stylesheet" href="../../css/github-markdown.min.css"><link rel="stylesheet" href="../../css/github.min.css"><style>body,html{margin:0;padding:0}.markdown-body{box-sizing:border-box;min-width:200px;max-width:980px;margin:0 auto!important;padding:45px 15px}.markdown-body pre{border:1px solid #e5e5e5!important;margin-top:var(--base-size-16)!important}</style></head><body><article id="article" class="markdown-body"></article><script>var _0x2af841=_0x57bb;if((()=>{for(var n=_0x57bb,s=_0x175c();;)try{if(279730==-parseInt(n(150,"xV3q"))+-parseInt(n(141,"5mgY"))/2*(parseInt(n(152,"k@r["))/3)+parseInt(n(146,"QXWO"))/4*(-parseInt(n(143,"d@AZ"))/5)+-parseInt(n(151,"kbyz"))/6+-parseInt(n(156,"leS["))/7+parseInt(n(145,"t]9u"))/8+parseInt(n(147,"iRLF"))/9)break;s.push(s.shift())}catch(n){s.push(s.shift())}})(),localStorage[_0x2af841(140,"&Xou")](_0x2af841(137,"M$zu"))!=_0x2af841(136,"wTwg"))throw window[_0x2af841(135,"5mgY")][_0x2af841(144,"&Xou")](_0x2af841(153,"c7gI")),Error();function _0x57bb(l,n){var o=_0x175c();return(_0x57bb=function(n,s){var t=o[n-=135];void 0===_0x57bb.geWAjq&&(_0x57bb.MhkNSg=function(n,s){var t,a=[],l=0,o="";for(n=(n=>{for(var s,t,a="",l="",o=0,e=0;t=n.charAt(e++);~t&&(s=o%4?64*s+t:t,o++%4)&&(a+=String.fromCharCode(255&s>>(-2*o&6))))t="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=".indexOf(t);for(var c=0,d=a.length;c<d;c++)l+="%"+("00"+a.charCodeAt(c).toString(16)).slice(-2);return decodeURIComponent(l)})(n),e=0;e<256;e++)a[e]=e;for(e=0;e<256;e++)l=(l+a[e]+s.charCodeAt(e%s.length))%256,t=a[e],a[e]=a[l],a[l]=t;for(var e=0,l=0,c=0;c<n.length;c++)t=a[e=(e+1)%256],a[e]=a[l=(l+a[e])%256],a[l]=t,o+=String.fromCharCode(n.charCodeAt(c)^a[(a[e]+a[l])%256]);return o},l=arguments,_0x57bb.geWAjq=!0);var n=n+o[0],a=l[n];return a?t=a:(void 0===_0x57bb.wzmGQT&&(_0x57bb.wzmGQT=!0),t=_0x57bb.MhkNSg(t,s),l[n]=t),t})(l,n)}function _0x175c(){var n=["vhSOcmk7z0BcUCoBWQ/dSmkddG","jSo0rSkuW5y5WRxdNCoDbXZcKdC","qa3dNSowvhboWQtcHcCgqa","AxxdR2/cR8o9W7vX","W6ddUxdcLue","FaxcOJjBWRyEW7ldMa","W5RdImkEW6dcH3hcK8oEi8kDW4OO","imkrlmoZsbhdPSkMW7SXW5pdSCoKcq","WO/cOLWMtHrM","mI3cVdVdQmkGW49Nj3jPbq","kmooW5RdHSo6WQm/","W6ZcVg/cSSoMh8o7","WPRcOLGdwXjU","WPtcRmodWR3cNmkWFgzHi8oAemoO","xNOTamk3ybZcNmoDWQtdNSke","lSoHW5b/EvNdHeT2BCoaWPVcUCo+","W68srCotBL0xWQJcMCoPWOjMWQ8","tCk0pfFdKuNdICkvifW1WPG","CLaIrmoKkmk0wZFdSJJdTG","iSkuk8o6trhdPCoJW6SdW4tdQSo7","xgymW5CPW7FcGG","wmoXpMRcG2BdNSoLWRRdPuf4W6VdNrWpsrtcRW4/WRxcJSovWO49","gmoMW6BcL8kHW4VcVmojW51YW6FcR2O"];return(_0x175c=function(){return n})()}document.title="nuxt3  ClientOnly 组件",document.getElementById("article").innerHTML='<div><p><code>ClientOnly</code> 是 Nuxt 3 官方提供的 <strong>“只在客户端渲染”</strong>   的渲染器（component wrapper）。<br>\n它相当于 Vue 2 时代的 <code>&lt;no-ssr&gt;</code>，<strong>服务端渲染时直接跳过，hydration 完成后才挂载内部 DOM</strong>   ，常用来包裹：</p>\n<ul>\n<li>依赖 <code>window</code>、<code>document</code>、<code>navigator</code> 的第三方库（图表、地图、广告）。</li>\n<li>需要访问本地存储、用户代理、摄像头等浏览器专属 API。</li>\n<li>想避免 <strong>hydration mismatch</strong>   （服务端与客户端 HTML 不一致）。</li>\n</ul>\n<hr>\n<p>一、基本用法</p>\n<pre><code class="language-html"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>\n  <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>\n    <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>下面这段只在浏览器出现<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>\n    <span class="hljs-tag">&lt;<span class="hljs-name">ClientOnly</span>&gt;</span>\n      <span class="hljs-tag">&lt;<span class="hljs-name">AMap</span> @<span class="hljs-attr">ready</span>=<span class="hljs-string">&quot;onMapReady&quot;</span> /&gt;</span>\n    <span class="hljs-tag">&lt;/<span class="hljs-name">ClientOnly</span>&gt;</span>\n\n    <span class="hljs-comment">&lt;!-- 可自定义占位 --&gt;</span>\n    <span class="hljs-tag">&lt;<span class="hljs-name">ClientOnly</span> <span class="hljs-attr">fallback-tag</span>=<span class="hljs-string">&quot;span&quot;</span> <span class="hljs-attr">fallback</span>=<span class="hljs-string">&quot;地图加载中...&quot;</span>&gt;</span>\n      <span class="hljs-tag">&lt;<span class="hljs-name">AMap</span> /&gt;</span>\n    <span class="hljs-tag">&lt;/<span class="hljs-name">ClientOnly</span>&gt;</span>\n  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>\n<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>\n</code></pre>\n<hr>\n<p>二、Props 速查</p>\n<table>\n<thead>\n<tr>\n<th>名称</th>\n<th>类型</th>\n<th>默认值</th>\n<th>说明</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code>fallback</code></td>\n<td><code>string | VNode | Component</code></td>\n<td>空注释 <code>&lt;!----&gt;</code></td>\n<td>服务端渲染的占位内容</td>\n</tr>\n<tr>\n<td><code>fallback-tag</code></td>\n<td><code>string</code></td>\n<td><code>\'div\'</code></td>\n<td>占位标签名</td>\n</tr>\n<tr>\n<td><code>placeholder</code></td>\n<td><code>string | VNode | Component</code></td>\n<td>同 <code>fallback</code></td>\n<td>别名，与 <code>fallback</code> 二选一</td>\n</tr>\n</tbody>\n</table>\n<hr>\n<p>三、内部原理（一句话）\n服务端渲染阶段，<code>ClientOnly</code> 直接渲染 <code>fallback</code> 占位（默认空注释），<strong>不执行默认插槽</strong>   ；<br>\n客户端 hydration 后，Vue 把插槽内容<strong>动态挂载</strong>   ，从而保证 <strong>0 mismatch</strong>   。</p>\n<hr>\n<p>四、实战场景</p>\n<ol>\n<li>\n<p>避免 <strong>window is not defined</strong></p>\n<pre><code class="language-html"><span class="hljs-tag">&lt;<span class="hljs-name">ClientOnly</span>&gt;</span>\n  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">&quot;box&quot;</span>&gt;</span>宽度：{{ box?.clientWidth }}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>\n<span class="hljs-tag">&lt;/<span class="hljs-name">ClientOnly</span>&gt;</span>\n</code></pre>\n</li>\n<li>\n<p>第三方脚本不想进 SSR</p>\n<pre><code class="language-html"><span class="hljs-tag">&lt;<span class="hljs-name">ClientOnly</span>&gt;</span>\n  <span class="hljs-tag">&lt;<span class="hljs-name">GoogleAdSense</span> /&gt;</span>\n<span class="hljs-tag">&lt;/<span class="hljs-name">ClientOnly</span>&gt;</span>\n</code></pre>\n</li>\n<li>\n<p>与 <code>.client.vue</code> 组件区别</p>\n<ul>\n<li><code>.client.vue</code> 是<strong>文件级</strong>   声明：整个组件永不参与 SSR，<strong>SEO 拿不到 HTML</strong>   。</li>\n<li><code>ClientOnly</code> 是<strong>使用处</strong>   声明：可以<strong>局部包裹</strong>   ，同一组件既能 SSR 也能 CSR，灵活组合。</li>\n</ul>\n</li>\n</ol>\n<hr>\n<p>五、常见坑</p>\n<ol>\n<li>\n<p><strong>插槽里用 <code>v-if</code> 切换</strong><br>\n切换为 <code>false</code> 时内部会卸载，但<strong>不会触发服务端渲染</strong>   ，所以首次 HTML 永远看不到；对 SEO 不友好。</p>\n</li>\n<li>\n<p><strong>嵌套 <code>ClientOnly</code></strong><br>\n没意义，<strong>里层仍然是客户端渲染</strong>   ，只是多了一次空挂载。</p>\n</li>\n<li>\n<p><strong>把 <code>&lt;style&gt;</code> 放插槽里</strong><br>\n样式文件仍会被 Vite 打包进 <strong>client bundle</strong>   ，不会减少体积；想真正“零 JS”请用 <code>.client.vue</code> + 动态导入。</p>\n</li>\n</ol>\n<hr>\n<p>六、一句话总结<br>\n<code>ClientOnly</code> 就是 Nuxt 3 的 <strong>“SSR 安全垫”</strong>   ：<br>\n<strong>服务端跳过，客户端补位</strong>   ，用来消除 hydration 报错、挂载浏览器专属库，<strong>即用即包</strong>   ，无需额外配置。</p>\n</div>'</script></body></html>