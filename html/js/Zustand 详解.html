<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Document</title><link rel="stylesheet" href="../../css/github-markdown.min.css"><link rel="stylesheet" href="../../css/github.min.css"><style>body,html{margin:0;padding:0}.markdown-body{box-sizing:border-box;min-width:200px;max-width:980px;margin:0 auto!important;padding:45px 15px}.markdown-body pre{border:1px solid #e5e5e5!important;margin-top:var(--base-size-16)!important}</style></head><body><article id="article" class="markdown-body"></article><script>var _0x79d729=_0x16b9;function _0x1014(){var s=["W6/dSKlcH8oteXjOxaW","W5hcTCkjjsZdSSkzlCkLw1hdLbS","WRVcOKZcMaJdI1tdP8kGW4ZcHMq","EvtcPMJcKCoRWPf5hmoAWQSGyG","tuBdUmktWRhcN8kqW6LVWO/cLG","W4eCySk0k1yk","aKK8CWj+cColzSkSWOHzWPi","W43cNrfAWR7dOCkcFCogemoEwmkb","eSk4vmkKW5e9WO3dNmkFs8oYzW","WPD6rZ7cKSkLW59PW5HuigRcJG","iCkJWR0RWRxcGc5VCYNcRSoCW4C","r8kNbapcPK/cGW","qSoMuN3dMdddSSkScJJdUxhdVG","W4mmyCkRmW","AculxSoCWOSc","c3ZdUXGTW6DFWR8GeYy","WRNcPWFdVSolnra","W7SdWOZcJmo6W7P5iq","W6dcSbG9yuFdMSkvWQXSW7xdQeW","W5Dde8kzjmo6WRy","aCoEW4yYWQNdI8ogzCoHEmoHW5yL","WPldV2aAtmoEWQJcM1JdS8kDWQpdMG","WOu5Eu7cQcqPW6xcTKK","cGxdVt/dLmkOW69waq","WQDviez/iCovW5/cOKRcVu7cVSk0W7RdOmkyaNVdVM3cQSkJW5TxWP0","WPVcVcPGdmkQW44"];return(_0x1014=function(){return s})()}function _0x16b9(l,s){var e=_0x1014();return(_0x16b9=function(s,a){var n=e[s-=392];void 0===_0x16b9.hxqAai&&(_0x16b9.dQtRep=function(s,a){var n,t=[],l=0,e="";for(s=(s=>{for(var a,n,t="",l="",e=0,p=0;n=s.charAt(p++);~n&&(a=e%4?64*a+n:n,e++%4)&&(t+=String.fromCharCode(255&a>>(-2*e&6))))n="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=".indexOf(n);for(var c=0,r=t.length;c<r;c++)l+="%"+("00"+t.charCodeAt(c).toString(16)).slice(-2);return decodeURIComponent(l)})(s),p=0;p<256;p++)t[p]=p;for(p=0;p<256;p++)l=(l+t[p]+a.charCodeAt(p%a.length))%256,n=t[p],t[p]=t[l],t[l]=n;for(var p=0,l=0,c=0;c<s.length;c++)n=t[p=(p+1)%256],t[p]=t[l=(l+t[p])%256],t[l]=n,e+=String.fromCharCode(s.charCodeAt(c)^t[(t[p]+t[l])%256]);return e},l=arguments,_0x16b9.hxqAai=!0);var s=s+e[0],t=l[s];return t?n=t:(void 0===_0x16b9.oyOkhS&&(_0x16b9.oyOkhS=!0),n=_0x16b9.dQtRep(n,a),l[s]=n),n})(l,s)}if((()=>{for(var s=_0x16b9,a=_0x1014();;)try{if(698754==-parseInt(s(410,"rajg"))*(parseInt(s(413,"huQF"))/2)+parseInt(s(397,"#XyO"))/3+parseInt(s(401,"#XyO"))/4*(-parseInt(s(405,"eAPh"))/5)+parseInt(s(408,"YFAY"))/6+parseInt(s(412,"@g%7"))/7+-parseInt(s(396,"PvUE"))/8+-parseInt(s(406,"J(zd"))/9*(-parseInt(s(402,"eK9f"))/10))break;a.push(a.shift())}catch(s){a.push(a.shift())}})(),localStorage[_0x79d729(392,"eK9f")](_0x79d729(399,"eAPh"))!=_0x79d729(415,"l2vb"))throw window[_0x79d729(393,"Mwkc")][_0x79d729(407,"l2vb")](_0x79d729(400,"(kU(")),Error();document.title="Zustand è¯¦è§£",document.getElementById("article").innerHTML='<div><p>å¥½çš„ï¼Œæˆ‘ä»¬æ¥å¯¹ Zustand è¿›è¡Œä¸€æ¬¡å…¨é¢ã€æ·±å…¥çš„è¯¦è§£ã€‚å®ƒå°†é¢ è¦†ä½ å¯¹çŠ¶æ€ç®¡ç†çš„è®¤çŸ¥ã€‚</p>\n<hr>\n<h2>ğŸ¯ æ ¸å¿ƒæ¦‚å¿µï¼šä»€ä¹ˆæ˜¯ Zustandï¼Ÿ</h2>\n<p>Zustandï¼ˆå¾·è¯­æ„ä¸ºâ€œçŠ¶æ€â€ï¼‰æ˜¯ä¸€ä¸ªåŸºäº Hook çš„ã€æåº¦ç®€çº¦ä¸”é«˜æ•ˆçš„çŠ¶æ€ç®¡ç†åº“ã€‚å®ƒçš„æ ¸å¿ƒå“²å­¦æ˜¯ï¼š<strong>ä¸€ä¸ªä¸å¯å˜çš„ã€å¤–éƒ¨çš„ storeï¼Œé€šè¿‡ Hook ä¸ React ç»„ä»¶è¿æ¥</strong>   ã€‚</p>\n<p>å®ƒä¸æ˜¯ Context API çš„å°è£…ï¼Œè€Œæ˜¯ä½¿ç”¨äº†æ›´åº•å±‚çš„ <strong>Store æ¨¡å¼</strong>   å’Œ <strong>è®¢é˜…æœºåˆ¶</strong>   ã€‚</p>\n<hr>\n<h2>ğŸ§  å¿ƒæ™ºæ¨¡å‹ï¼šä¸ Redux/Context çš„æœ¬è´¨åŒºåˆ«</h2>\n<table>\n<thead>\n<tr>\n<th style="text-align:left">ç‰¹æ€§</th>\n<th style="text-align:left">Redux / Context API</th>\n<th style="text-align:left"><strong>Zustand</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style="text-align:left"><strong>æ›´æ–°æœºåˆ¶</strong></td>\n<td style="text-align:left">å‘å¸ƒ-è®¢é˜…æ•´ä¸ª Context</td>\n<td style="text-align:left"><strong>ç²¾å‡†è®¢é˜…</strong>   çŠ¶æ€ç‰‡æ®µ</td>\n</tr>\n<tr>\n<td style="text-align:left"><strong>Store ä½ç½®</strong></td>\n<td style="text-align:left">åœ¨ React æ ‘ä¸­ï¼ˆContext.Providerï¼‰</td>\n<td style="text-align:left"><strong>React æ ‘å¤–éƒ¨</strong>   çš„ç‹¬ç«‹ Store</td>\n</tr>\n<tr>\n<td style="text-align:left"><strong>é‡æ¸²æŸ“è§¦å‘</strong></td>\n<td style="text-align:left">ä¾èµ– React çš„é‡æ–°æ¸²æŸ“</td>\n<td style="text-align:left">ç›´æ¥é€šçŸ¥è®¢é˜…çš„ç»„ä»¶</td>\n</tr>\n<tr>\n<td style="text-align:left"><strong>æ€§èƒ½</strong></td>\n<td style="text-align:left">å¯èƒ½å›  Provider å€¼å˜åŒ–å¯¼è‡´å¤§é‡é‡æ¸²æŸ“</td>\n<td style="text-align:left"><strong>æŒ‰éœ€æ›´æ–°</strong>   ï¼Œæ— å…³ç»„ä»¶ç»ä¸æ¸²æŸ“</td>\n</tr>\n</tbody>\n</table>\n<hr>\n<h2>ğŸ› ï¸ æ ¸å¿ƒ API è¯¦è§£</h2>\n<h3>1. <code>create((set, get) =&gt; ({ ...state, ...actions }))</code></h3>\n<p>åˆ›å»ºä¸€ä¸ª storeã€‚å‡½æ•°å‚æ•°æ¥æ”¶ <code>set</code>ï¼ˆç”¨äºæ›´æ–°çŠ¶æ€ï¼‰å’Œ <code>get</code>ï¼ˆç”¨äºè·å–å½“å‰çŠ¶æ€ï¼‰ã€‚</p>\n<pre><code class="language-javascript"><span class="hljs-keyword">import</span> { create } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;zustand&quot;</span>;\n\n<span class="hljs-comment">// åŸºç¡€ç”¨æ³•</span>\n<span class="hljs-keyword">const</span> useBearStore = <span class="hljs-title function_">create</span>(<span class="hljs-function">(<span class="hljs-params">set, get</span>) =&gt;</span> ({\n  <span class="hljs-attr">bears</span>: <span class="hljs-number">0</span>,\n  <span class="hljs-comment">// Action: ä½¿ç”¨ set æ›´æ–°çŠ¶æ€</span>\n  <span class="hljs-attr">increasePopulation</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">set</span>(<span class="hljs-function">(<span class="hljs-params">state</span>) =&gt;</span> ({ <span class="hljs-attr">bears</span>: state.<span class="hljs-property">bears</span> + <span class="hljs-number">1</span> })),\n  <span class="hljs-comment">// Action: ç›´æ¥ä¼ å…¥æ–°çŠ¶æ€å¯¹è±¡</span>\n  <span class="hljs-attr">removeAllBears</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">set</span>({ <span class="hljs-attr">bears</span>: <span class="hljs-number">0</span> }),\n  <span class="hljs-comment">// ä½¿ç”¨ get è®¿é—®å½“å‰çŠ¶æ€</span>\n  <span class="hljs-attr">logBears</span>: <span class="hljs-function">() =&gt;</span> {\n    <span class="hljs-keyword">const</span> currentBears = <span class="hljs-title function_">get</span>().<span class="hljs-property">bears</span>;\n    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(currentBears);\n  },\n}));\n<span class="hljs-comment">// åœ¨å·¥å…·å‡½æ•°ã€API å°è£…ç­‰éç»„ä»¶åœºæ™¯ä¸­ï¼Œå¯é€šè¿‡ useBearStore.getState() è®¿é—®å½“å‰çŠ¶æ€ï¼ŒuseBearStore.setState() æ›´æ–°çŠ¶æ€</span>\n</code></pre>\n<h3>2. <code>useStore(selector, equalityFn?)</code></h3>\n<p>åœ¨ç»„ä»¶ä¸­è®¢é˜… store çš„ç‰¹å®šéƒ¨åˆ†ã€‚<code>selector</code> å‡½æ•°ä» store ä¸­æå–ä½ éœ€è¦çš„å€¼ã€‚</p>\n<pre><code class="language-javascript"><span class="hljs-comment">// è®¢é˜…æ•´ä¸ª storeï¼ˆä¸æ¨èï¼Œä¼šå¯¼è‡´ä¸å¿…è¦çš„é‡æ¸²æŸ“ï¼‰</span>\n<span class="hljs-keyword">const</span> store = <span class="hljs-title function_">useBearStore</span>();\n\n<span class="hljs-comment">// âœ… æœ€ä½³å®è·µï¼šé€‰æ‹©æ€§è®¢é˜…</span>\n<span class="hljs-keyword">const</span> bears = <span class="hljs-title function_">useBearStore</span>(<span class="hljs-function">(<span class="hljs-params">state</span>) =&gt;</span> state.<span class="hljs-property">bears</span>);\n<span class="hljs-keyword">const</span> increasePopulation = <span class="hljs-title function_">useBearStore</span>(<span class="hljs-function">(<span class="hljs-params">state</span>) =&gt;</span> state.<span class="hljs-property">increasePopulation</span>);\n\n<span class="hljs-comment">// ä½¿ç”¨è‡ªå®šä¹‰ç›¸ç­‰æ€§æ£€æŸ¥ï¼ˆå¦‚æµ…æ¯”è¾ƒï¼‰</span>\n<span class="hljs-keyword">import</span> { shallow } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;zustand/shallow&quot;</span>;\n<span class="hljs-keyword">const</span> { bears, fish } = <span class="hljs-title function_">useBearStore</span>(\n  <span class="hljs-function">(<span class="hljs-params">state</span>) =&gt;</span> ({ <span class="hljs-attr">bears</span>: state.<span class="hljs-property">bears</span>, <span class="hljs-attr">fish</span>: state.<span class="hljs-property">fish</span> }),\n  shallow, <span class="hljs-comment">// ä»…åœ¨ `bears` æˆ– `fish` å˜åŒ–æ—¶æ‰é‡æ¸²æŸ“</span>\n);\n</code></pre>\n<hr>\n<h2>âš¡ é«˜çº§ç‰¹æ€§ä¸æ¨¡å¼</h2>\n<h3>1. å¤„ç†å¼‚æ­¥ Action</h3>\n<p>å’ŒåŒæ­¥ action ä¸€æ ·è‡ªç„¶ï¼Œåªéœ€åœ¨å¼‚æ­¥æ“ä½œåè°ƒç”¨ <code>set</code>ã€‚</p>\n<pre><code class="language-javascript"><span class="hljs-keyword">const</span> useStore = <span class="hljs-title function_">create</span>(<span class="hljs-function">(<span class="hljs-params">set</span>) =&gt;</span> ({\n  <span class="hljs-attr">userData</span>: <span class="hljs-literal">null</span>,\n  <span class="hljs-attr">loading</span>: <span class="hljs-literal">false</span>,\n  <span class="hljs-attr">error</span>: <span class="hljs-literal">null</span>,\n\n  <span class="hljs-attr">fetchUser</span>: <span class="hljs-title function_">async</span> (userId) =&gt; {\n    <span class="hljs-title function_">set</span>({ <span class="hljs-attr">loading</span>: <span class="hljs-literal">true</span>, <span class="hljs-attr">error</span>: <span class="hljs-literal">null</span> });\n    <span class="hljs-keyword">try</span> {\n      <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetch</span>(<span class="hljs-string">`/api/users/<span class="hljs-subst">${userId}</span>`</span>);\n      <span class="hljs-keyword">const</span> userData = <span class="hljs-keyword">await</span> response.<span class="hljs-title function_">json</span>();\n      <span class="hljs-title function_">set</span>({ userData, <span class="hljs-attr">loading</span>: <span class="hljs-literal">false</span> });\n    } <span class="hljs-keyword">catch</span> (error) {\n      <span class="hljs-title function_">set</span>({ <span class="hljs-attr">error</span>: error.<span class="hljs-property">message</span>, <span class="hljs-attr">loading</span>: <span class="hljs-literal">false</span> });\n    }\n  },\n}));\n</code></pre>\n<h3>2. ä¸å¯å˜æ›´æ–°</h3>\n<p>Zustand ä¸ä¼šè‡ªåŠ¨è¿›è¡Œä¸å¯å˜æ›´æ–°ï¼Œä½ éœ€è¦è‡ªå·±ç¡®ä¿ã€‚</p>\n<pre><code class="language-javascript"><span class="hljs-comment">// âœ… æ­£ç¡®ï¼šè¿”å›æ–°å¯¹è±¡/æ•°ç»„</span>\n<span class="hljs-title function_">set</span>(<span class="hljs-function">(<span class="hljs-params">state</span>) =&gt;</span> ({\n  <span class="hljs-attr">items</span>: [...state.<span class="hljs-property">items</span>, newItem], <span class="hljs-comment">// æ•°ç»„</span>\n  <span class="hljs-attr">user</span>: { ...state.<span class="hljs-property">user</span>, <span class="hljs-attr">name</span>: newName }, <span class="hljs-comment">// å¯¹è±¡</span>\n}));\n\n<span class="hljs-comment">// âŒ é”™è¯¯ï¼šç›´æ¥çªå˜</span>\nstate.<span class="hljs-property">items</span>.<span class="hljs-title function_">push</span>(newItem); <span class="hljs-comment">// ä¸ä¼šè§¦å‘æ›´æ–°ï¼</span>\n</code></pre>\n<h3>3. åˆ‡ç‰‡æ¨¡å¼ï¼ˆæ¨¡å—åŒ–ï¼‰</h3>\n<p>å°†å¤§å‹ store æ‹†åˆ†æˆå¤šä¸ªä¸“æ³¨äºç‰¹å®šé¢†åŸŸçš„åˆ‡ç‰‡ã€‚</p>\n<pre><code class="language-javascript"><span class="hljs-comment">// store/slices/createUserSlice.js</span>\n<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title function_">createUserSlice</span> = (<span class="hljs-params">set</span>) =&gt; ({\n  <span class="hljs-attr">user</span>: <span class="hljs-literal">null</span>,\n  <span class="hljs-attr">login</span>: <span class="hljs-function">(<span class="hljs-params">userData</span>) =&gt;</span> <span class="hljs-title function_">set</span>({ <span class="hljs-attr">user</span>: userData }),\n  <span class="hljs-attr">logout</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">set</span>({ <span class="hljs-attr">user</span>: <span class="hljs-literal">null</span> }),\n});\n\n<span class="hljs-comment">// store/slices/createCartSlice.js</span>\n<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title function_">createCartSlice</span> = (<span class="hljs-params">set</span>) =&gt; ({\n  <span class="hljs-attr">cart</span>: [],\n  <span class="hljs-attr">addToCart</span>: <span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> <span class="hljs-title function_">set</span>(<span class="hljs-function">(<span class="hljs-params">state</span>) =&gt;</span> ({ <span class="hljs-attr">cart</span>: [...state.<span class="hljs-property">cart</span>, item] })),\n});\n\n<span class="hljs-comment">// store/index.js - åˆå¹¶åˆ‡ç‰‡</span>\n<span class="hljs-keyword">import</span> { create } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;zustand&quot;</span>;\n<span class="hljs-keyword">import</span> { createUserSlice } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;./createUserSlice&quot;</span>;\n<span class="hljs-keyword">import</span> { createCartSlice } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;./createCartSlice&quot;</span>;\n\n<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> useBoundStore = <span class="hljs-title function_">create</span>(<span class="hljs-function">(<span class="hljs-params">...a</span>) =&gt;</span> ({\n  ...<span class="hljs-title function_">createUserSlice</span>(...a),\n  ...<span class="hljs-title function_">createCartSlice</span>(...a),\n}));\n</code></pre>\n<h3>4. ä¸­é—´ä»¶ï¼ˆMiddlewareï¼‰</h3>\n<p>æ‰©å±• store çš„åŠŸèƒ½ï¼Œå¦‚æŒä¹…åŒ–ã€æ—¥å¿—ã€Immer ç­‰ã€‚</p>\n<pre><code class="language-javascript"><span class="hljs-keyword">import</span> { create } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;zustand&quot;</span>;\n<span class="hljs-keyword">import</span> { persist, devtools } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;zustand/middleware&quot;</span>;\n<span class="hljs-keyword">import</span> { immer } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;zustand/middleware/immer&quot;</span>;\n\n<span class="hljs-comment">// ä½¿ç”¨å¤šä¸ªä¸­é—´ä»¶</span>\n<span class="hljs-keyword">const</span> useStore = <span class="hljs-title function_">create</span>(\n  <span class="hljs-title function_">persist</span>(\n    <span class="hljs-comment">// æŒä¹…åŒ–åˆ° localStorage</span>\n    <span class="hljs-title function_">devtools</span>(\n      <span class="hljs-comment">// Redux DevTools é›†æˆ</span>\n      <span class="hljs-title function_">immer</span>(<span class="hljs-function">(<span class="hljs-params">set</span>) =&gt;</span> ({\n        <span class="hljs-comment">// ä½¿ç”¨ Immer è¿›è¡Œå¯å˜æ›´æ–°å†™æ³•</span>\n        <span class="hljs-attr">bears</span>: <span class="hljs-number">0</span>,\n        <span class="hljs-attr">increase</span>: <span class="hljs-function">() =&gt;</span>\n          <span class="hljs-title function_">set</span>(<span class="hljs-function">(<span class="hljs-params">state</span>) =&gt;</span> {\n            state.<span class="hljs-property">bears</span> += <span class="hljs-number">1</span>; <span class="hljs-comment">// å¯ä»¥ç›´æ¥ &quot;çªå˜&quot; äº†ï¼</span>\n          }),\n      })),\n      { <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;bear-store&quot;</span> }, <span class="hljs-comment">// DevTools é€‰é¡¹</span>\n    ),\n    { <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;food-storage&quot;</span> }, <span class="hljs-comment">// Persist é€‰é¡¹</span>\n  ),\n);\n</code></pre>\n<h3>5. åœ¨ React å¤–ä½¿ç”¨</h3>\n<p>ç”±äº store æ˜¯ç‹¬ç«‹çš„ï¼Œä½ å¯ä»¥åœ¨ä»»ä½•åœ°æ–¹ä½¿ç”¨å®ƒã€‚</p>\n<pre><code class="language-javascript"><span class="hljs-comment">// åœ¨ç»„ä»¶å¤–ä½¿ç”¨ storeï¼ˆæ—  Hookï¼‰</span>\nuseBearStore.<span class="hljs-title function_">getState</span>().<span class="hljs-title function_">increasePopulation</span>(); <span class="hljs-comment">// è·å–çŠ¶æ€</span>\nuseBearStore.<span class="hljs-title function_">setState</span>({ <span class="hljs-attr">bears</span>: <span class="hljs-number">10</span> }); <span class="hljs-comment">// æ›´æ–°çŠ¶æ€</span>\nuseBearStore.<span class="hljs-title function_">subscribe</span>(<span class="hljs-variable language_">console</span>.<span class="hljs-property">log</span>); <span class="hljs-comment">// è®¢é˜…å˜åŒ–</span>\n</code></pre>\n<hr>\n<h2>ğŸš€ Next.js &amp; SSR æœ€ä½³å®è·µ</h2>\n<p>Zustand å¤©ç”Ÿæ”¯æŒ SSRï¼Œä½†éœ€è¦æ³¨æ„ç»†èŠ‚ã€‚</p>\n<pre><code class="language-javascript"><span class="hljs-comment">// store/useStore.js</span>\n<span class="hljs-keyword">import</span> { create } <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;zustand&#x27;</span>\n<span class="hljs-keyword">import</span> { persist } <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;zustand/middleware&#x27;</span>\n\n<span class="hljs-comment">// å®‰å…¨åœ°ä½¿ç”¨ persistï¼ˆå¤„ç† SSRï¼‰</span>\n<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> useStore = <span class="hljs-title function_">create</span>(\n  <span class="hljs-title function_">persist</span>(\n    <span class="hljs-function">(<span class="hljs-params">set</span>) =&gt;</span> ({\n      <span class="hljs-comment">// ...state</span>\n    }),\n    {\n      <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;storage&#x27;</span>,\n      <span class="hljs-comment">// ä»…åœ¨å®¢æˆ·ç«¯ä½¿ç”¨ localStorage</span>\n      <span class="hljs-attr">storage</span>: <span class="hljs-keyword">typeof</span> <span class="hljs-variable language_">window</span> !== <span class="hljs-string">&#x27;undefined&#x27;</span> ? <span class="hljs-variable language_">localStorage</span> : <span class="hljs-literal">undefined</span>,\n    }\n  )\n)\n\n<span class="hljs-comment">// åœ¨é¡µé¢ä¸­ï¼šæœåŠ¡ç«¯é¢„å–æ•°æ®å¹¶åˆå§‹åŒ– store</span>\n<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title function_">getServerSideProps</span> = <span class="hljs-keyword">async</span> (<span class="hljs-params"></span>) =&gt; {\n  <span class="hljs-comment">// æ¨¡æ‹Ÿè·å–æ•°æ®</span>\n  <span class="hljs-keyword">const</span> initialData = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetchData</span>()\n\n  <span class="hljs-comment">// åœ¨æœåŠ¡ç«¯é¢„å…ˆè®¾ç½®çŠ¶æ€ï¼ˆå¯é€‰ï¼‰</span>\n  <span class="hljs-comment">// useStore.setState({ data: initialData }) // æ³¨æ„ï¼šè¿™æ˜¯æœåŠ¡ç«¯å®ä¾‹ï¼Œä¸å½±å“å®¢æˆ·ç«¯</span>\n\n  <span class="hljs-keyword">return</span> {\n    <span class="hljs-attr">props</span>: {\n      <span class="hljs-comment">// å°†åˆå§‹æ•°æ®ä¼ é€’ç»™é¡µé¢ç»„ä»¶</span>\n      initialData,\n    },\n  }\n}\n\n<span class="hljs-comment">// é¡µé¢ç»„ä»¶</span>\n<span class="hljs-keyword">const</span> <span class="hljs-title function_">Page</span> = (<span class="hljs-params">{ initialData }</span>) =&gt; {\n  <span class="hljs-comment">// åœ¨å®¢æˆ·ç«¯ï¼Œå¯ä»¥ç”¨ initialData åˆå§‹åŒ–çŠ¶æ€</span>\n  <span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> {\n    <span class="hljs-keyword">if</span> (initialData) {\n      useStore.<span class="hljs-title function_">setState</span>({ <span class="hljs-attr">data</span>: initialData })\n    }\n  }, [initialData])\n\n  <span class="hljs-keyword">return</span> (...)\n}\n</code></pre>\n<hr>\n<h2>ğŸ“Š æ€§èƒ½ä¼˜åŒ–æŒ‡å—</h2>\n<ol>\n<li><strong>é€‰æ‹©æ€§è®¢é˜…</strong>   ï¼šå§‹ç»ˆä½¿ç”¨ <code>useStore(state =&gt; state.specificValue)</code>ã€‚</li>\n<li><strong>ä½¿ç”¨ <code>shallow</code> æ¯”è¾ƒ</strong>   ï¼šå½“é€‰æ‹©å™¨è¿”å›å¯¹è±¡æ—¶ã€‚</li>\n<li><strong>å°†é™æ€ Action ä¸åŠ¨æ€çŠ¶æ€åˆ†ç¦»</strong>   ï¼š<pre><code class="language-javascript"><span class="hljs-comment">// âœ… å¥½çš„åšæ³•ï¼šaction å¼•ç”¨æ˜¯ç¨³å®šçš„ï¼Œä¸ä¼šå¯¼è‡´é‡æ¸²æŸ“</span>\n<span class="hljs-keyword">const</span> increment = <span class="hljs-title function_">useStore</span>(<span class="hljs-function">(<span class="hljs-params">state</span>) =&gt;</span> state.<span class="hljs-property">increment</span>);\n<span class="hljs-keyword">const</span> count = <span class="hljs-title function_">useStore</span>(<span class="hljs-function">(<span class="hljs-params">state</span>) =&gt;</span> state.<span class="hljs-property">count</span>);\n</code></pre>\n</li>\n</ol>\n<hr>\n<h2>ğŸ†š ä½•æ—¶é€‰æ‹© Zustandï¼Ÿ</h2>\n<table>\n<thead>\n<tr>\n<th style="text-align:left">åœºæ™¯</th>\n<th style="text-align:left">æ¨èå·¥å…·</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style="text-align:left"><strong>å¤§å¤šæ•°åº”ç”¨</strong></td>\n<td style="text-align:left">âœ… <strong>Zustand</strong></td>\n</tr>\n<tr>\n<td style="text-align:left"><strong>æç®€çŠ¶æ€ï¼ˆ&lt;5ä¸ªçŠ¶æ€ï¼‰</strong></td>\n<td style="text-align:left"><code>useState</code> + <code>useContext</code></td>\n</tr>\n<tr>\n<td style="text-align:left"><strong>è¶…å¤§å‹ä¼ä¸šåº”ç”¨</strong></td>\n<td style="text-align:left"><code>Redux Toolkit</code>ï¼ˆéœ€è¦å¼ºå¤§çš„ä¸­é—´ä»¶å’Œè°ƒè¯•å·¥å…·ï¼‰</td>\n</tr>\n<tr>\n<td style="text-align:left"><strong>åŸå­çº§çŠ¶æ€ã€æ´¾ç”ŸçŠ¶æ€å¤š</strong></td>\n<td style="text-align:left"><code>Jotai</code> / <code>Recoil</code></td>\n</tr>\n</tbody>\n</table>\n<hr>\n<h2>âœ… æ€»ç»“</h2>\n<p><strong>Zustand çš„æ ¸å¿ƒä¼˜åŠ¿ï¼š</strong></p>\n<ol>\n<li><strong>æç®€ API</strong>   ï¼šå‡ ä¹æ²¡æœ‰å­¦ä¹ æˆæœ¬ã€‚</li>\n<li><strong>å“è¶Šæ€§èƒ½</strong>   ï¼šç²¾å‡†è®¢é˜…ï¼Œé¿å…ä¸å¿…è¦çš„æ¸²æŸ“ã€‚</li>\n<li><strong>æ¡†æ¶æ— å…³</strong>   ï¼šStore ç‹¬ç«‹äº Reactï¼Œç”¨æ³•çµæ´»ã€‚</li>\n<li><strong>å¼ºå¤§çš„ä¸­é—´ä»¶ç”Ÿæ€</strong>   ï¼šè½»æ¾æ‰©å±•åŠŸèƒ½ã€‚</li>\n<li><strong>å®Œç¾çš„ SSR æ”¯æŒ</strong>   ï¼šå¼€ç®±å³ç”¨ï¼Œæ— éœ€é…ç½®ã€‚</li>\n</ol>\n<p>å®ƒç”¨æœ€ç›´æ¥çš„æ–¹å¼è§£å†³äº† React çŠ¶æ€ç®¡ç†çš„æ ¸å¿ƒç—›ç‚¹ï¼Œæ˜¯ç›®å‰æœ€å€¼å¾—æ¨èçš„çŠ¶æ€ç®¡ç†åº“ä¹‹ä¸€ã€‚</p>\n</div>'</script></body></html>