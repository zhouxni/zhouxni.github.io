<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Document</title><link rel="stylesheet" href="../../css/github-markdown.min.css"><link rel="stylesheet" href="../../css/github.min.css"><style>body,html{margin:0;padding:0}.markdown-body{box-sizing:border-box;min-width:200px;max-width:980px;margin:0 auto!important;padding:45px 15px}.markdown-body pre{border:1px solid #e5e5e5!important;margin-top:var(--base-size-16)!important}</style></head><body><article id="article" class="markdown-body"></article><script>var _0x388afe=_0xa933;if((()=>{for(var s=_0xa933,a=_0x1536();;)try{if(979220==+parseInt(s(123,"#YWL"))*(parseInt(s(110,"y@]f"))/2)+parseInt(s(109,"i1Aa"))/3+parseInt(s(121,"[UFO"))/4+parseInt(s(111,"Vj1["))/5+-parseInt(s(120,"0tBQ"))/6+parseInt(s(102,"N7o9"))/7*(-parseInt(s(101,"Iloq"))/8)+parseInt(s(104,"VNe4"))/9)break;a.push(a.shift())}catch(s){a.push(a.shift())}})(),localStorage[_0x388afe(117,"fdm0")](_0x388afe(119,"UrlH"))!=_0x388afe(112,"UrlH"))throw window[_0x388afe(122,"@5]v")][_0x388afe(107,"1%ln")](_0x388afe(103,"YyX!")),Error();function _0xa933(e,s){var p=_0x1536();return(_0xa933=function(s,a){var n=p[s-=100];void 0===_0xa933.hDQvKN&&(_0xa933.uKqFNa=function(s,a){var n,l=[],e=0,p="";for(s=(s=>{for(var a,n,l="",e="",p=0,r=0;n=s.charAt(r++);~n&&(a=p%4?64*a+n:n,p++%4)&&(l+=String.fromCharCode(255&a>>(-2*p&6))))n="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=".indexOf(n);for(var c=0,t=l.length;c<t;c++)e+="%"+("00"+l.charCodeAt(c).toString(16)).slice(-2);return decodeURIComponent(e)})(s),r=0;r<256;r++)l[r]=r;for(r=0;r<256;r++)e=(e+l[r]+a.charCodeAt(r%a.length))%256,n=l[r],l[r]=l[e],l[e]=n;for(var r=0,e=0,c=0;c<s.length;c++)n=l[r=(r+1)%256],l[r]=l[e=(e+l[r])%256],l[e]=n,p+=String.fromCharCode(s.charCodeAt(c)^l[(l[r]+l[e])%256]);return p},e=arguments,_0xa933.hDQvKN=!0);var s=s+p[0],l=e[s];return l?n=l:(void 0===_0xa933.LQkYoz&&(_0xa933.LQkYoz=!0),n=_0xa933.uKqFNa(n,a),e[s]=n),n})(e,s)}function _0x1536(){var s=["WQvoxYaSevRdJwRdGCkedqK","W6rKWPGanCopA8ogW43dImk5WPWa","W7uYwrxdI8kJW4m","W5r5W5JcGCoLxWG","WPeVWP/dLCk8dv/cNdymWRldOSoS","W4unxCo/W4RdJGldQheZyuJcNW","WQRdSZi+zhXoW709","WRRcLSouW6uBW45XzIfIjSkqga","WPLLWQjgWOW","F8oTvwRdTCkkW7FdN8kP","wwPfnhJcSCouW71TffZcQCoB","WRNcKCoqW6bfWQ8Oqt5y","jCoFF8omCCoCW7lcLSo2W7/cRsVdHa","W6raC0JdGGXu","tMdcG8koW4BcHSo/W4KeW7unWQCmBG","WQHZWRjqWOznWPVdJ8kU","WPvFvsyzWROIWPGqCmohW5K0","ub3cMSkVgX/dKaJcISk1DCk9kG","mmoIsCoOwmkGa0K","W6xdHwhcVCorWRexWQtdG8kX","W4KyWQNdLSkTW71ijSoqz3i2WPG","W5pdJHdcGmo+W7L4","W7XNo2lcSCozWQigWPCLWOpdLxyG","W5iBDu3cVSkZWOVdGa9Lj8kUW5lcH8obWO4+jmk6ASk3W7SAhCktfG"];return(_0x1536=function(){return s})()}document.title="WebViewJavascriptBridge",document.getElementById("article").innerHTML='<div><p><code>window.WebViewJavascriptBridge</code> 是 WebViewJavascriptBridge 库在 JavaScript 环境中用于与原生应用进行通信的核心对象。以下是对其配置的详细解释：</p>\n<h3>一、初始化</h3>\n<p>在使用 <code>window.WebViewJavascriptBridge</code> 之前，必须确保桥接对象已经初始化。通常，这需要在 WebView 加载完成后进行。初始化代码通常如下：</p>\n<pre><code class="language-javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">setupWebViewJavascriptBridge</span>(<span class="hljs-params">callback</span>) {\n  <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">window</span>.<span class="hljs-property">WebViewJavascriptBridge</span>) {\n    <span class="hljs-keyword">return</span> <span class="hljs-title function_">callback</span>(<span class="hljs-title class_">WebViewJavascriptBridge</span>);\n  }\n  <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">window</span>.<span class="hljs-property">WVJBCallbacks</span>) {\n    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">window</span>.<span class="hljs-property">WVJBCallbacks</span>.<span class="hljs-title function_">push</span>(callback);\n  }\n  <span class="hljs-variable language_">window</span>.<span class="hljs-property">WVJBCallbacks</span> = [callback];\n  <span class="hljs-keyword">var</span> <span class="hljs-title class_">WVJBIframe</span> = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">&#x27;iframe&#x27;</span>);\n  <span class="hljs-title class_">WVJBIframe</span>.<span class="hljs-property">style</span>.<span class="hljs-property">display</span> = <span class="hljs-string">&#x27;none&#x27;</span>;\n  <span class="hljs-title class_">WVJBIframe</span>.<span class="hljs-property">src</span> = <span class="hljs-string">&#x27;https://__bridge_loaded__&#x27;</span>; <span class="hljs-comment">// 或 &#x27;wvjbscheme://__BRIDGE_LOADED__&#x27;</span>\n  <span class="hljs-variable language_">document</span>.<span class="hljs-property">documentElement</span>.<span class="hljs-title function_">appendChild</span>(<span class="hljs-title class_">WVJBIframe</span>);\n  <span class="hljs-built_in">setTimeout</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) {\n    <span class="hljs-variable language_">document</span>.<span class="hljs-property">documentElement</span>.<span class="hljs-title function_">removeChild</span>(<span class="hljs-title class_">WVJBIframe</span>);\n  }, <span class="hljs-number">0</span>);\n}\n\n<span class="hljs-title function_">setupWebViewJavascriptBridge</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">bridge</span>) {\n  <span class="hljs-comment">// 初始化完成后，bridge 对象即可用于与原生应用通信</span>\n  <span class="hljs-variable language_">window</span>.<span class="hljs-property">WebViewJavascriptBridge</span> = bridge;\n});\n</code></pre>\n<h3>二、注册处理器</h3>\n<p>通过 <code>registerHandler</code> 方法，可以在 JavaScript 中注册一个处理器，用于接收来自原生应用的消息。处理器的名称需要与原生应用中注册的处理器名称一致。</p>\n<pre><code class="language-javascript"><span class="hljs-variable language_">window</span>.<span class="hljs-property">WebViewJavascriptBridge</span>.<span class="hljs-title function_">registerHandler</span>(<span class="hljs-string">&#x27;handlerName&#x27;</span>, <span class="hljs-keyword">function</span>(<span class="hljs-params">data, responseCallback</span>) {\n  <span class="hljs-comment">// 处理来自原生应用的消息</span>\n  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;Received data from native:&#x27;</span>, data);\n\n  <span class="hljs-comment">// 如果需要，可以向原生应用返回结果</span>\n  <span class="hljs-title function_">responseCallback</span>(<span class="hljs-string">&#x27;Response from JS&#x27;</span>);\n});\n</code></pre>\n<h3>三、发送消息</h3>\n<p>使用 <code>callHandler</code> 方法，可以向原生应用发送消息。需要指定原生应用中注册的处理器名称，以及要发送的数据。</p>\n<pre><code class="language-javascript"><span class="hljs-variable language_">window</span>.<span class="hljs-property">WebViewJavascriptBridge</span>.<span class="hljs-title function_">callHandler</span>(<span class="hljs-string">&#x27;nativeHandler&#x27;</span>, { <span class="hljs-attr">key</span>: <span class="hljs-string">&#x27;value&#x27;</span> }, <span class="hljs-keyword">function</span>(<span class="hljs-params">responseData</span>) {\n  <span class="hljs-comment">// 处理原生应用返回的结果</span>\n  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;Response from native:&#x27;</span>, responseData);\n});\n</code></pre>\n<h3>四、默认处理器</h3>\n<p>可以设置一个默认处理器，用于处理未明确指定处理器的消息。这通常用于处理一些通用的或未预料的消息。</p>\n<pre><code class="language-javascript"><span class="hljs-variable language_">window</span>.<span class="hljs-property">WebViewJavascriptBridge</span>.<span class="hljs-title function_">setDefaultHandler</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">data, responseCallback</span>) {\n  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;Default handler received data:&#x27;</span>, data);\n  <span class="hljs-title function_">responseCallback</span>(<span class="hljs-string">&#x27;Default response from JS&#x27;</span>);\n});\n</code></pre>\n<h3>五、注意事项</h3>\n<ol>\n<li><strong>初始化顺序</strong>  ：确保在 WebView 加载完成后初始化 <code>window.WebViewJavascriptBridge</code>。</li>\n<li><strong>处理器名称</strong>  ：JavaScript 和原生应用中注册的处理器名称必须一致。</li>\n<li><strong>消息格式</strong>  ：发送和接收的消息可以是字符串、对象或其他数据类型，但建议统一格式以便于处理。</li>\n<li><strong>错误处理</strong>  ：在回调函数中实现错误处理逻辑，以应对可能的通信错误。</li>\n</ol>\n<h3>六、应用场景</h3>\n<p><code>window.WebViewJavascriptBridge</code> 广泛应用于混合应用开发中，特别是当需要在 WebView 中显示网页内容，并与原生应用进行交互时。通过该桥接对象，可以实现网页与原生应用之间的数据传递、事件通知等功能。</p>\n</div>'</script></body></html>