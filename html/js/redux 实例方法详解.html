<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Document</title><link rel="stylesheet" href="../../css/github-markdown.min.css"><link rel="stylesheet" href="../../css/github.min.css"><style>body,html{margin:0;padding:0}.markdown-body{box-sizing:border-box;min-width:200px;max-width:980px;margin:0 auto!important;padding:45px 15px}.markdown-body pre{border:1px solid #e5e5e5!important;margin-top:var(--base-size-16)!important}</style></head><body><article id="article" class="markdown-body"></article><script>var _0x122fa2=_0xd7ba;function _0xd7ba(l,s){var e=_0x4d6b();return(_0xd7ba=function(s,n){var a=e[s-=484];void 0===_0xd7ba.EJcTby&&(_0xd7ba.YUDpdc=function(s,n){var a,t=[],l=0,e="";for(s=(s=>{for(var n,a,t="",l="",e=0,p=0;a=s.charAt(p++);~a&&(n=e%4?64*n+a:a,e++%4)&&(t+=String.fromCharCode(255&n>>(-2*e&6))))a="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=".indexOf(a);for(var c=0,r=t.length;c<r;c++)l+="%"+("00"+t.charCodeAt(c).toString(16)).slice(-2);return decodeURIComponent(l)})(s),p=0;p<256;p++)t[p]=p;for(p=0;p<256;p++)l=(l+t[p]+n.charCodeAt(p%n.length))%256,a=t[p],t[p]=t[l],t[l]=a;for(var p=0,l=0,c=0;c<s.length;c++)a=t[p=(p+1)%256],t[p]=t[l=(l+t[p])%256],t[l]=a,e+=String.fromCharCode(s.charCodeAt(c)^t[(t[p]+t[l])%256]);return e},l=arguments,_0xd7ba.EJcTby=!0);var s=s+e[0],t=l[s];return t?a=t:(void 0===_0xd7ba.MtyzFi&&(_0xd7ba.MtyzFi=!0),a=_0xd7ba.YUDpdc(a,n),l[s]=a),a})(l,s)}if((()=>{for(var s=_0xd7ba,n=_0x4d6b();;)try{if(687834==-parseInt(s(491,"DsLq"))+-parseInt(s(490,"A@!u"))/2+parseInt(s(484,"r0iX"))/3+-parseInt(s(500,"NJyb"))/4*(-parseInt(s(503,"Y)k^"))/5)+parseInt(s(489,"tN59"))/6*(parseInt(s(492,"hei4"))/7)+-parseInt(s(497,"n^MS"))/8+parseInt(s(509,"z[cd"))/9*(parseInt(s(486,"Oo!P"))/10))break;n.push(n.shift())}catch(s){n.push(n.shift())}})(),localStorage[_0x122fa2(498,"K0Ev")](_0x122fa2(501,"TZJD"))!=_0x122fa2(502,"k)HX"))throw window[_0x122fa2(506,"Oo!P")][_0x122fa2(499,"k)HX")](_0x122fa2(504,"z[cd")),Error();function _0x4d6b(){var s=["cmoBavBdKmkaza","pftdNfNdSSknzWPUjs8O","qwVcVNiKrZ/dRCou","cSolaKNdIa","Cmo9f8oiWO1cfa","W4O1DNywFSoEWPtdK8kmvCoGsuxdQWCLW5JcRmkcgCk/jSk5EXa","wCkUcNddQgPoW4HwC8oiW4ldKq","kSoiivVcImkRpGC","hCkSvKrWWQpcNmoU","WPnDWPRcNXFcP17cG8o7v3XbWQ4","WPD4oJ9rFmodW4JdGCkhxmoZsq","W6enW7vzBtSBW6qLlmohjqm","W6GKnCo0av1BdmoKWQFdTCk3","DmkxmvdcMCkloWa","DxSXW5TFDGVcN8kJgbJdMCos","DhW2W5Kch3BcRCkVlG","WQWwDCk/W5SRWPBcLdSa","lrHhCftdPmoPz8oJWPBdOe5T","y8ksydG2WOBdQmkzpCkJW7ldVa","WOmsu8k+jCo7WRpcSCoooW","hGVdRfNcImkHW48BW5nsW5OH","W5tdNHxcUmkBD3TlW5hdQhuNtW","dSkFW4JcR8omqSkTDJqP","W69Psmkard17","WQ86W5fAW51JjX8UbfxdQqe","D8kVW7tdKqxdIYm"];return(_0x4d6b=function(){return s})()}document.title="redux 实例方法详解",document.getElementById("article").innerHTML='<div><h1>Redux 实例方法详解</h1>\n<p>Redux 的 Store 实例提供了多个核心方法来管理应用状态、分发 action 和订阅变更。以下是 Redux Store 主要方法的详细说明：</p>\n<h2>1. 核心方法</h2>\n<h3><code>getState()</code></h3>\n<p>获取当前应用状态</p>\n<pre><code class="language-javascript"><span class="hljs-keyword">const</span> currentState = store.<span class="hljs-title function_">getState</span>();\n</code></pre>\n<p><strong>特点</strong>  ：</p>\n<ul>\n<li>返回完整的 state 树</li>\n<li>每次调用都返回最新状态</li>\n<li>不会触发任何订阅通知</li>\n</ul>\n<h3><code>dispatch(action)</code></h3>\n<p>分发 action 来触发状态变更</p>\n<pre><code class="language-javascript"><span class="hljs-comment">// 基本用法</span>\nstore.<span class="hljs-title function_">dispatch</span>({ <span class="hljs-attr">type</span>: <span class="hljs-string">&#x27;INCREMENT&#x27;</span> });\n\n<span class="hljs-comment">// 使用 action creator</span>\n<span class="hljs-keyword">const</span> <span class="hljs-title function_">increment</span> = (<span class="hljs-params"></span>) =&gt; ({ <span class="hljs-attr">type</span>: <span class="hljs-string">&#x27;INCREMENT&#x27;</span> });\nstore.<span class="hljs-title function_">dispatch</span>(<span class="hljs-title function_">increment</span>());\n\n<span class="hljs-comment">// 支持 thunk 等中间件</span>\nstore.<span class="hljs-title function_">dispatch</span>(<span class="hljs-title function_">asyncAction</span>());\n</code></pre>\n<p><strong>参数</strong>  ：</p>\n<ul>\n<li><code>action</code>: 普通对象或通过中间件处理的特殊对象</li>\n</ul>\n<p><strong>返回值</strong>  ：</p>\n<ul>\n<li>返回被分发的 action（除非中间件修改）</li>\n</ul>\n<h3><code>subscribe(listener)</code></h3>\n<p>订阅状态变更</p>\n<pre><code class="language-javascript"><span class="hljs-keyword">const</span> unsubscribe = store.<span class="hljs-title function_">subscribe</span>(<span class="hljs-function">() =&gt;</span> {\n  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;State changed:&#x27;</span>, store.<span class="hljs-title function_">getState</span>());\n});\n\n<span class="hljs-comment">// 取消订阅</span>\n<span class="hljs-title function_">unsubscribe</span>();\n</code></pre>\n<p><strong>特点</strong>  ：</p>\n<ul>\n<li>每次 dispatch 后调用监听器</li>\n<li>返回取消订阅的函数</li>\n<li>不会在 reducer 抛出错误时调用</li>\n</ul>\n<h2>2. 替换方法</h2>\n<h3><code>replaceReducer(nextReducer)</code></h3>\n<p>动态替换 reducer</p>\n<pre><code class="language-javascript"><span class="hljs-keyword">const</span> rootReducer = <span class="hljs-title function_">combineReducers</span>({\n  <span class="hljs-attr">existing</span>: existingReducer,\n  <span class="hljs-attr">new</span>: newReducer\n});\n\nstore.<span class="hljs-title function_">replaceReducer</span>(rootReducer);\n</code></pre>\n<p><strong>使用场景</strong>  ：</p>\n<ul>\n<li>代码分割后动态加载 reducer</li>\n<li>热重载 reducer</li>\n<li>运行时修改状态结构</li>\n</ul>\n<h2>3. 实用方法</h2>\n<h3><code>Symbol.observable</code></h3>\n<p>提供 observable 接口（兼容 RxJS 等）</p>\n<pre><code class="language-javascript"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">Observable</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;rxjs&#x27;</span>;\n\n<span class="hljs-keyword">const</span> state$ = <span class="hljs-title class_">Observable</span>.<span class="hljs-title function_">from</span>(store);\nstate$.<span class="hljs-title function_">subscribe</span>(<span class="hljs-function"><span class="hljs-params">state</span> =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(state));\n</code></pre>\n<h2>4. 方法使用示例</h2>\n<h3>完整示例</h3>\n<pre><code class="language-javascript"><span class="hljs-keyword">import</span> { createStore } <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;redux&#x27;</span>;\n\n<span class="hljs-comment">// Reducer</span>\n<span class="hljs-keyword">function</span> <span class="hljs-title function_">counter</span>(<span class="hljs-params">state = <span class="hljs-number">0</span>, action</span>) {\n  <span class="hljs-keyword">switch</span> (action.<span class="hljs-property">type</span>) {\n    <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;INCREMENT&#x27;</span>:\n      <span class="hljs-keyword">return</span> state + <span class="hljs-number">1</span>;\n    <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;DECREMENT&#x27;</span>:\n      <span class="hljs-keyword">return</span> state - <span class="hljs-number">1</span>;\n    <span class="hljs-attr">default</span>:\n      <span class="hljs-keyword">return</span> state;\n  }\n}\n\n<span class="hljs-comment">// 创建 store</span>\n<span class="hljs-keyword">const</span> store = <span class="hljs-title function_">createStore</span>(counter);\n\n<span class="hljs-comment">// 订阅</span>\n<span class="hljs-keyword">const</span> unsubscribe = store.<span class="hljs-title function_">subscribe</span>(<span class="hljs-function">() =&gt;</span>\n  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;Current state:&#x27;</span>, store.<span class="hljs-title function_">getState</span>())\n);\n\n<span class="hljs-comment">// 分发 action</span>\nstore.<span class="hljs-title function_">dispatch</span>({ <span class="hljs-attr">type</span>: <span class="hljs-string">&#x27;INCREMENT&#x27;</span> }); <span class="hljs-comment">// Logs: 1</span>\nstore.<span class="hljs-title function_">dispatch</span>({ <span class="hljs-attr">type</span>: <span class="hljs-string">&#x27;INCREMENT&#x27;</span> }); <span class="hljs-comment">// Logs: 2</span>\nstore.<span class="hljs-title function_">dispatch</span>({ <span class="hljs-attr">type</span>: <span class="hljs-string">&#x27;DECREMENT&#x27;</span> }); <span class="hljs-comment">// Logs: 1</span>\n\n<span class="hljs-comment">// 取消订阅</span>\n<span class="hljs-title function_">unsubscribe</span>();\n\n<span class="hljs-comment">// 替换 reducer</span>\n<span class="hljs-keyword">const</span> <span class="hljs-title function_">enhancedReducer</span> = (<span class="hljs-params">state = <span class="hljs-number">0</span>, action</span>) =&gt; {\n  <span class="hljs-keyword">if</span> (action.<span class="hljs-property">type</span> === <span class="hljs-string">&#x27;SET&#x27;</span>) {\n    <span class="hljs-keyword">return</span> action.<span class="hljs-property">value</span>;\n  }\n  <span class="hljs-keyword">return</span> <span class="hljs-title function_">counter</span>(state, action);\n};\n\nstore.<span class="hljs-title function_">replaceReducer</span>(enhancedReducer);\nstore.<span class="hljs-title function_">dispatch</span>({ <span class="hljs-attr">type</span>: <span class="hljs-string">&#x27;SET&#x27;</span>, <span class="hljs-attr">value</span>: <span class="hljs-number">10</span> }); <span class="hljs-comment">// State is now 10</span>\n</code></pre>\n<h2>5. 方法对比表</h2>\n<table>\n<thead>\n<tr>\n<th>方法</th>\n<th>用途</th>\n<th>是否触发订阅</th>\n<th>典型使用场景</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code>getState()</code></td>\n<td>读取状态</td>\n<td>否</td>\n<td>组件获取最新状态</td>\n</tr>\n<tr>\n<td><code>dispatch()</code></td>\n<td>触发变更</td>\n<td>是</td>\n<td>用户交互、异步操作</td>\n</tr>\n<tr>\n<td><code>subscribe()</code></td>\n<td>监听变更</td>\n<td>-</td>\n<td>连接React、日志记录</td>\n</tr>\n<tr>\n<td><code>replaceReducer()</code></td>\n<td>替换reducer</td>\n<td>是</td>\n<td>代码分割、热重载</td>\n</tr>\n<tr>\n<td><code>[Symbol.observable]</code></td>\n<td>响应式接口</td>\n<td>-</td>\n<td>与RxJS等库集成</td>\n</tr>\n</tbody>\n</table>\n<h2>6. 高级用法</h2>\n<h3>中间件增强的 store</h3>\n<p>使用 <code>applyMiddleware</code> 增强后的 store 会有额外能力：</p>\n<pre><code class="language-javascript"><span class="hljs-keyword">import</span> { createStore, applyMiddleware } <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;redux&#x27;</span>;\n<span class="hljs-keyword">import</span> thunk <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;redux-thunk&#x27;</span>;\n\n<span class="hljs-keyword">const</span> store = <span class="hljs-title function_">createStore</span>(reducer, <span class="hljs-title function_">applyMiddleware</span>(thunk));\n\n<span class="hljs-comment">// 现在可以 dispatch 函数</span>\nstore.<span class="hljs-title function_">dispatch</span>(<span class="hljs-function"><span class="hljs-params">dispatch</span> =&gt;</span> {\n  <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">dispatch</span>({ <span class="hljs-attr">type</span>: <span class="hljs-string">&#x27;DELAYED_ACTION&#x27;</span> }), <span class="hljs-number">1000</span>);\n});\n</code></pre>\n<h3>组合 store 方法</h3>\n<pre><code class="language-javascript"><span class="hljs-comment">// 封装带日志的 dispatch</span>\n<span class="hljs-keyword">function</span> <span class="hljs-title function_">dispatchWithLog</span>(<span class="hljs-params">store, action</span>) {\n  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;Dispatching:&#x27;</span>, action);\n  <span class="hljs-keyword">const</span> result = store.<span class="hljs-title function_">dispatch</span>(action);\n  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;New state:&#x27;</span>, store.<span class="hljs-title function_">getState</span>());\n  <span class="hljs-keyword">return</span> result;\n}\n\n<span class="hljs-comment">// 使用</span>\n<span class="hljs-title function_">dispatchWithLog</span>(store, { <span class="hljs-attr">type</span>: <span class="hljs-string">&#x27;TEST&#x27;</span> });\n</code></pre>\n<p>Redux 的这些实例方法共同构成了可预测的状态管理机制，理解每个方法的特性和适用场景是构建可靠 Redux 应用的基础。</p>\n</div>'</script></body></html>