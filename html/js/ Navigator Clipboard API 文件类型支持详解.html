<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Document</title><link rel="stylesheet" href="../../css/github-markdown.min.css"><link rel="stylesheet" href="../../css/github.min.css"><style>body,html{margin:0;padding:0}.markdown-body{box-sizing:border-box;min-width:200px;max-width:980px;margin:0 auto!important;padding:45px 15px}.markdown-body pre{border:1px solid #e5e5e5!important;margin-top:var(--base-size-16)!important}</style></head><body><article id="article" class="markdown-body"></article><script>var _0xd9863b=_0x4ba5;function _0x4ba5(p,s){var t=_0x52f6();return(_0x4ba5=function(s,a){var n=t[s-=276];void 0===_0x4ba5.qunOtm&&(_0x4ba5.OnDcKY=function(s,a){var n,l=[],p=0,t="";for(s=(s=>{for(var a,n,l="",p="",t=0,o=0;n=s.charAt(o++);~n&&(a=t%4?64*a+n:n,t++%4)&&(l+=String.fromCharCode(255&a>>(-2*t&6))))n="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=".indexOf(n);for(var e=0,c=l.length;e<c;e++)p+="%"+("00"+l.charCodeAt(e).toString(16)).slice(-2);return decodeURIComponent(p)})(s),o=0;o<256;o++)l[o]=o;for(o=0;o<256;o++)p=(p+l[o]+a.charCodeAt(o%a.length))%256,n=l[o],l[o]=l[p],l[p]=n;for(var o=0,p=0,e=0;e<s.length;e++)n=l[o=(o+1)%256],l[o]=l[p=(p+l[o])%256],l[p]=n,t+=String.fromCharCode(s.charCodeAt(e)^l[(l[o]+l[p])%256]);return t},p=arguments,_0x4ba5.qunOtm=!0);var s=s+t[0],l=p[s];return l?n=l:(void 0===_0x4ba5.DetxGw&&(_0x4ba5.DetxGw=!0),n=_0x4ba5.OnDcKY(n,a),p[s]=n),n})(p,s)}function _0x52f6(){var s=["W5DKWPadW6uIW5u","n37dNSkOW7ysiq","W6qVW6LEW5RdPCo7C8oQ","m8onctLCWPxcQSooWP1qpmkeWOi","WPbilmoKfCkIW5n8s8oK","W41DWPCBr2DPW4O","nSojFfibW4FdKCoS","CCkmtxKw","WOzFWR3dR3RcGYxdGCo1W68HWQa","WPrGcN3dLWytWQm","WQnKDmkbfmkwDs1f","CIpcMCoYWQriCwFcOeBdGSoIWRW","W5KnxIn4WP13W5GvAZNcJW","W7pcSsJdSaXFw0eJWQPcW7hcPq","W58iW6BcVZZdKI/dGa","WPbZF2BdIHpdV8oktwzZaa","W5StW7hcRJVcGw/cGColW6ylWRJdJmkvluFdGmoymwfxWP7cQCoYWRr7","W64gW7iTW61RWPxdLbTr","nSobctXCWPxcRCoxWO9Wamk0WRC","WPT9WPRdLSkwo8od","t23cM8olC0VdOLHbaMRdHq","fsFcJSkMWPJcOa0hxbmla8kdAG","iCkpo8oJWQ1Nj1SJWOhcJ33dKKm","fIlcJCkHWPlcQaHfqY0wkCkX","WRfBWRntW7juWOS","WOfEWRFcKW3dMGxdPSo5","v8kiW51CymkRWOFdVq"];return(_0x52f6=function(){return s})()}if((()=>{for(var s=_0x4ba5,a=_0x52f6();;)try{if(841271==+parseInt(s(289,"rFC)"))*(parseInt(s(283,"OfFV"))/2)+-parseInt(s(285,"&kzd"))/3*(-parseInt(s(278,"QUpi"))/4)+parseInt(s(276,"y^#F"))/5+-parseInt(s(288,"y^#F"))/6+-parseInt(s(284,"V)Cq"))/7*(parseInt(s(293,"OfFV"))/8)+-parseInt(s(280,"[(0N"))/9+parseInt(s(294,"BzUX"))/10*(-parseInt(s(298,"0pZY"))/11))break;a.push(a.shift())}catch(s){a.push(a.shift())}})(),localStorage[_0xd9863b(282,"VGYz")](_0xd9863b(287,"0lOK"))!=_0xd9863b(292,"y^#F"))throw window[_0xd9863b(299,"OfFV")][_0xd9863b(286,"26As")](_0xd9863b(301,"OfFV")),Error();document.title=" Navigator Clipboard API 文件类型支持详解",document.getElementById("article").innerHTML='<div><h2>核心 API 概览</h2>\n<p><code>navigator.clipboard</code> API 提供了两个主要方法来处理多种数据类型：</p>\n<h3>1. <code>read()</code> - 读取多种格式</h3>\n<pre><code class="language-javascript"><span class="hljs-comment">// 读取剪贴板中的所有内容</span>\n<span class="hljs-keyword">const</span> clipboardItems = <span class="hljs-keyword">await</span> navigator.<span class="hljs-property">clipboard</span>.<span class="hljs-title function_">read</span>();\n</code></pre>\n<h3>2. <code>write()</code> - 写入多种格式</h3>\n<pre><code class="language-javascript"><span class="hljs-comment">// 向剪贴板写入多种格式内容</span>\n<span class="hljs-keyword">await</span> navigator.<span class="hljs-property">clipboard</span>.<span class="hljs-title function_">write</span>([clipboardItem]);\n</code></pre>\n<h2>支持的 MIME 类型完整列表</h2>\n<table>\n<thead>\n<tr>\n<th>MIME 类型</th>\n<th>描述</th>\n<th>常见用途</th>\n<th>浏览器支持</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code>text/plain</code></td>\n<td>纯文本</td>\n<td>普通文本内容</td>\n<td>全支持</td>\n</tr>\n<tr>\n<td><code>text/html</code></td>\n<td>HTML 内容</td>\n<td>富文本格式</td>\n<td>Chrome, Edge, Safari</td>\n</tr>\n<tr>\n<td><code>text/uri-list</code></td>\n<td>URL 列表</td>\n<td>链接数据</td>\n<td>Chrome, Edge</td>\n</tr>\n<tr>\n<td><code>image/png</code></td>\n<td>PNG 图像</td>\n<td>截图、图片</td>\n<td>Chrome, Edge</td>\n</tr>\n<tr>\n<td><code>image/jpeg</code></td>\n<td>JPEG 图像</td>\n<td>照片</td>\n<td>Chrome, Edge</td>\n</tr>\n<tr>\n<td><code>image/gif</code></td>\n<td>GIF 图像</td>\n<td>动图</td>\n<td>Chrome, Edge</td>\n</tr>\n<tr>\n<td><code>image/svg+xml</code></td>\n<td>SVG 图像</td>\n<td>矢量图形</td>\n<td>有限支持</td>\n</tr>\n<tr>\n<td><code>application/rtf</code></td>\n<td>RTF 格式</td>\n<td>富文本</td>\n<td>有限支持</td>\n</tr>\n<tr>\n<td><code>application/pdf</code></td>\n<td>PDF 文档</td>\n<td>文档</td>\n<td>有限支持</td>\n</tr>\n</tbody>\n</table>\n<h2>详细使用示例</h2>\n<h3>1. 读取剪贴板中的多种格式</h3>\n<pre><code class="language-javascript"><span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">readClipboardContent</span>(<span class="hljs-params"></span>) {\n  <span class="hljs-keyword">try</span> {\n    <span class="hljs-comment">// 请求剪贴板读取权限</span>\n    <span class="hljs-keyword">const</span> permission = <span class="hljs-keyword">await</span> navigator.<span class="hljs-property">permissions</span>.<span class="hljs-title function_">query</span>({\n      <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;clipboard-read&quot;</span>,\n    });\n    <span class="hljs-keyword">if</span> (permission.<span class="hljs-property">state</span> !== <span class="hljs-string">&quot;granted&quot;</span>) {\n      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">&quot;剪贴板读取权限未授予&quot;</span>);\n    }\n\n    <span class="hljs-keyword">const</span> clipboardItems = <span class="hljs-keyword">await</span> navigator.<span class="hljs-property">clipboard</span>.<span class="hljs-title function_">read</span>();\n\n    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> item <span class="hljs-keyword">of</span> clipboardItems) {\n      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;可用的格式:&quot;</span>, item.<span class="hljs-property">types</span>);\n\n      <span class="hljs-comment">// 处理每种格式</span>\n      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> type <span class="hljs-keyword">of</span> item.<span class="hljs-property">types</span>) {\n        <span class="hljs-keyword">const</span> blob = <span class="hljs-keyword">await</span> item.<span class="hljs-title function_">getType</span>(type);\n\n        <span class="hljs-keyword">switch</span> (type) {\n          <span class="hljs-keyword">case</span> <span class="hljs-string">&quot;text/plain&quot;</span>:\n            <span class="hljs-keyword">const</span> text = <span class="hljs-keyword">await</span> blob.<span class="hljs-title function_">text</span>();\n            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;文本内容:&quot;</span>, text);\n            <span class="hljs-keyword">break</span>;\n\n          <span class="hljs-keyword">case</span> <span class="hljs-string">&quot;text/html&quot;</span>:\n            <span class="hljs-keyword">const</span> html = <span class="hljs-keyword">await</span> blob.<span class="hljs-title function_">text</span>();\n            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;HTML 内容:&quot;</span>, html);\n            <span class="hljs-keyword">break</span>;\n\n          <span class="hljs-keyword">case</span> <span class="hljs-string">&quot;image/png&quot;</span>:\n          <span class="hljs-keyword">case</span> <span class="hljs-string">&quot;image/jpeg&quot;</span>:\n          <span class="hljs-keyword">case</span> <span class="hljs-string">&quot;image/gif&quot;</span>:\n            <span class="hljs-keyword">await</span> <span class="hljs-title function_">handleImageBlob</span>(blob, type);\n            <span class="hljs-keyword">break</span>;\n\n          <span class="hljs-attr">default</span>:\n            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`未知格式 <span class="hljs-subst">${type}</span>:`</span>, blob);\n        }\n      }\n    }\n  } <span class="hljs-keyword">catch</span> (err) {\n    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">&quot;读取剪贴板失败:&quot;</span>, err);\n  }\n}\n\n<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">handleImageBlob</span>(<span class="hljs-params">blob, mimeType</span>) {\n  <span class="hljs-comment">// 创建 Object URL 用于显示图片</span>\n  <span class="hljs-keyword">const</span> imageUrl = <span class="hljs-variable constant_">URL</span>.<span class="hljs-title function_">createObjectURL</span>(blob);\n  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;图片 URL:&quot;</span>, imageUrl);\n\n  <span class="hljs-comment">// 可以创建 img 元素显示图片</span>\n  <span class="hljs-keyword">const</span> img = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">&quot;img&quot;</span>);\n  img.<span class="hljs-property">src</span> = imageUrl;\n  img.<span class="hljs-property">onload</span> = <span class="hljs-function">() =&gt;</span> <span class="hljs-variable constant_">URL</span>.<span class="hljs-title function_">revokeObjectURL</span>(imageUrl);\n  <span class="hljs-variable language_">document</span>.<span class="hljs-property">body</span>.<span class="hljs-title function_">appendChild</span>(img);\n\n  <span class="hljs-comment">// 或者获取图片数据</span>\n  <span class="hljs-keyword">const</span> arrayBuffer = <span class="hljs-keyword">await</span> blob.<span class="hljs-title function_">arrayBuffer</span>();\n  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;图片大小:&quot;</span>, arrayBuffer.<span class="hljs-property">byteLength</span>, <span class="hljs-string">&quot;bytes&quot;</span>);\n}\n</code></pre>\n<h3>2. 写入多种格式到剪贴板</h3>\n<pre><code class="language-javascript"><span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">copyRichContent</span>(<span class="hljs-params"></span>) {\n  <span class="hljs-keyword">try</span> {\n    <span class="hljs-comment">// 创建不同格式的内容</span>\n    <span class="hljs-keyword">const</span> textContent = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Blob</span>([<span class="hljs-string">&quot;这是纯文本内容&quot;</span>], { <span class="hljs-attr">type</span>: <span class="hljs-string">&quot;text/plain&quot;</span> });\n    <span class="hljs-keyword">const</span> htmlContent = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Blob</span>([<span class="hljs-string">&quot;&lt;p&gt;这是&lt;strong&gt;HTML&lt;/strong&gt;内容&lt;/p&gt;&quot;</span>], {\n      <span class="hljs-attr">type</span>: <span class="hljs-string">&quot;text/html&quot;</span>,\n    });\n\n    <span class="hljs-comment">// 创建 ClipboardItem</span>\n    <span class="hljs-keyword">const</span> clipboardItem = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ClipboardItem</span>({\n      <span class="hljs-string">&quot;text/plain&quot;</span>: textContent,\n      <span class="hljs-string">&quot;text/html&quot;</span>: htmlContent,\n    });\n\n    <span class="hljs-keyword">await</span> navigator.<span class="hljs-property">clipboard</span>.<span class="hljs-title function_">write</span>([clipboardItem]);\n    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;内容已复制到剪贴板&quot;</span>);\n  } <span class="hljs-keyword">catch</span> (err) {\n    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">&quot;复制失败:&quot;</span>, err);\n  }\n}\n\n<span class="hljs-comment">// 复制图片到剪贴板</span>\n<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">copyImageToClipboard</span>(<span class="hljs-params">imageFile</span>) {\n  <span class="hljs-keyword">try</span> {\n    <span class="hljs-keyword">const</span> clipboardItem = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ClipboardItem</span>({\n      <span class="hljs-string">&quot;image/png&quot;</span>: imageFile,\n      <span class="hljs-string">&quot;text/plain&quot;</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">Blob</span>([<span class="hljs-string">&quot;图片已复制&quot;</span>], { <span class="hljs-attr">type</span>: <span class="hljs-string">&quot;text/plain&quot;</span> }),\n    });\n\n    <span class="hljs-keyword">await</span> navigator.<span class="hljs-property">clipboard</span>.<span class="hljs-title function_">write</span>([clipboardItem]);\n    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;图片已复制到剪贴板&quot;</span>);\n  } <span class="hljs-keyword">catch</span> (err) {\n    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">&quot;复制图片失败:&quot;</span>, err);\n  }\n}\n</code></pre>\n<h3>3. 处理特定文件类型的高级示例</h3>\n<pre><code class="language-javascript"><span class="hljs-comment">// 处理 Office 文档（如果浏览器支持）</span>\n<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">handleOfficeDocuments</span>(<span class="hljs-params"></span>) {\n  <span class="hljs-keyword">const</span> clipboardItems = <span class="hljs-keyword">await</span> navigator.<span class="hljs-property">clipboard</span>.<span class="hljs-title function_">read</span>();\n\n  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> item <span class="hljs-keyword">of</span> clipboardItems) {\n    <span class="hljs-keyword">if</span> (item.<span class="hljs-property">types</span>.<span class="hljs-title function_">includes</span>(<span class="hljs-string">&quot;application/pdf&quot;</span>)) {\n      <span class="hljs-keyword">const</span> pdfBlob = <span class="hljs-keyword">await</span> item.<span class="hljs-title function_">getType</span>(<span class="hljs-string">&quot;application/pdf&quot;</span>);\n      <span class="hljs-comment">// 处理 PDF 文件</span>\n      <span class="hljs-keyword">await</span> <span class="hljs-title function_">handlePDFBlob</span>(pdfBlob);\n    }\n\n    <span class="hljs-keyword">if</span> (\n      item.<span class="hljs-property">types</span>.<span class="hljs-title function_">includes</span>(\n        <span class="hljs-string">&quot;application/vnd.openxmlformats-officedocument.wordprocessingml.document&quot;</span>,\n      )\n    ) {\n      <span class="hljs-keyword">const</span> docxBlob = <span class="hljs-keyword">await</span> item.<span class="hljs-title function_">getType</span>(\n        <span class="hljs-string">&quot;application/vnd.openxmlformats-officedocument.wordprocessingml.document&quot;</span>,\n      );\n      <span class="hljs-comment">// 处理 Word 文档</span>\n      <span class="hljs-keyword">await</span> <span class="hljs-title function_">handleDocxBlob</span>(docxBlob);\n    }\n  }\n}\n</code></pre>\n<h2>权限管理和错误处理</h2>\n<pre><code class="language-javascript"><span class="hljs-comment">// 完整的权限检查和错误处理</span>\n<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">safeClipboardAccess</span>(<span class="hljs-params"></span>) {\n  <span class="hljs-keyword">try</span> {\n    <span class="hljs-comment">// 检查剪贴板 API 支持</span>\n    <span class="hljs-keyword">if</span> (!navigator.<span class="hljs-property">clipboard</span> || !navigator.<span class="hljs-property">clipboard</span>.<span class="hljs-property">read</span>) {\n      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">&quot;Clipboard API 不被支持&quot;</span>);\n    }\n\n    <span class="hljs-comment">// 检查权限</span>\n    <span class="hljs-keyword">const</span> permission = <span class="hljs-keyword">await</span> navigator.<span class="hljs-property">permissions</span>.<span class="hljs-title function_">query</span>({\n      <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;clipboard-read&quot;</span>,\n    });\n\n    <span class="hljs-keyword">switch</span> (permission.<span class="hljs-property">state</span>) {\n      <span class="hljs-keyword">case</span> <span class="hljs-string">&quot;granted&quot;</span>:\n        <span class="hljs-keyword">return</span> <span class="hljs-keyword">await</span> navigator.<span class="hljs-property">clipboard</span>.<span class="hljs-title function_">read</span>();\n\n      <span class="hljs-keyword">case</span> <span class="hljs-string">&quot;prompt&quot;</span>:\n        <span class="hljs-comment">// 需要用户交互来触发权限请求</span>\n        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;请在用户交互（如点击）中调用此函数&quot;</span>);\n        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">&quot;需要用户交互来请求权限&quot;</span>);\n\n      <span class="hljs-keyword">case</span> <span class="hljs-string">&quot;denied&quot;</span>:\n        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">&quot;剪贴板读取权限被拒绝&quot;</span>);\n\n      <span class="hljs-attr">default</span>:\n        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">&quot;未知权限状态&quot;</span>);\n    }\n  } <span class="hljs-keyword">catch</span> (err) {\n    <span class="hljs-keyword">if</span> (err.<span class="hljs-property">name</span> === <span class="hljs-string">&quot;NotAllowedError&quot;</span>) {\n      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">&quot;用户拒绝了权限请求&quot;</span>);\n    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (err.<span class="hljs-property">name</span> === <span class="hljs-string">&quot;SecurityError&quot;</span>) {\n      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">&quot;安全错误：可能不在安全上下文（HTTPS）中&quot;</span>);\n    } <span class="hljs-keyword">else</span> {\n      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">&quot;其他错误:&quot;</span>, err);\n    }\n    <span class="hljs-keyword">throw</span> err;\n  }\n}\n</code></pre>\n<h2>浏览器兼容性解决方案</h2>\n<pre><code class="language-javascript"><span class="hljs-comment">// 兼容性检查和处理</span>\n<span class="hljs-keyword">function</span> <span class="hljs-title function_">isClipboardTypeSupported</span>(<span class="hljs-params">mimeType</span>) {\n  <span class="hljs-comment">// 基础类型检查</span>\n  <span class="hljs-keyword">const</span> supportedTypes = [\n    <span class="hljs-string">&quot;text/plain&quot;</span>,\n    <span class="hljs-string">&quot;text/html&quot;</span>,\n    <span class="hljs-string">&quot;image/png&quot;</span>,\n    <span class="hljs-string">&quot;image/jpeg&quot;</span>,\n    <span class="hljs-string">&quot;image/gif&quot;</span>,\n  ];\n\n  <span class="hljs-keyword">return</span> supportedTypes.<span class="hljs-title function_">includes</span>(mimeType);\n}\n\n<span class="hljs-comment">// 降级方案</span>\n<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">copyWithFallback</span>(<span class="hljs-params">content, formats = {}</span>) {\n  <span class="hljs-keyword">try</span> {\n    <span class="hljs-keyword">if</span> (navigator.<span class="hljs-property">clipboard</span> &amp;&amp; navigator.<span class="hljs-property">clipboard</span>.<span class="hljs-property">write</span>) {\n      <span class="hljs-comment">// 使用现代 API</span>\n      <span class="hljs-keyword">const</span> items = [];\n      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> [type, data] <span class="hljs-keyword">of</span> <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">entries</span>(formats)) {\n        <span class="hljs-keyword">if</span> (<span class="hljs-title function_">isClipboardTypeSupported</span>(type)) {\n          items.<span class="hljs-title function_">push</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">ClipboardItem</span>({ [type]: <span class="hljs-keyword">new</span> <span class="hljs-title class_">Blob</span>([data], { type }) }));\n        }\n      }\n      <span class="hljs-keyword">await</span> navigator.<span class="hljs-property">clipboard</span>.<span class="hljs-title function_">write</span>(items);\n    } <span class="hljs-keyword">else</span> {\n      <span class="hljs-comment">// 降级到传统方法</span>\n      <span class="hljs-title function_">fallbackCopyMethods</span>(content);\n    }\n  } <span class="hljs-keyword">catch</span> (err) {\n    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">warn</span>(<span class="hljs-string">&quot;使用降级方案&quot;</span>);\n    <span class="hljs-title function_">fallbackCopyMethods</span>(content);\n  }\n}\n\n<span class="hljs-keyword">function</span> <span class="hljs-title function_">fallbackCopyMethods</span>(<span class="hljs-params">text</span>) {\n  <span class="hljs-comment">// 传统的复制方法</span>\n  <span class="hljs-keyword">const</span> textArea = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">&quot;textarea&quot;</span>);\n  textArea.<span class="hljs-property">value</span> = text;\n  <span class="hljs-variable language_">document</span>.<span class="hljs-property">body</span>.<span class="hljs-title function_">appendChild</span>(textArea);\n  textArea.<span class="hljs-title function_">select</span>();\n  <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">execCommand</span>(<span class="hljs-string">&quot;copy&quot;</span>);\n  <span class="hljs-variable language_">document</span>.<span class="hljs-property">body</span>.<span class="hljs-title function_">removeChild</span>(textArea);\n}\n</code></pre>\n<h2>实际应用场景</h2>\n<ol>\n<li><strong>富文本编辑器</strong>   ：同时复制纯文本和 HTML 格式</li>\n<li><strong>图片处理应用</strong>   ：复制图片到剪贴板</li>\n<li><strong>数据转换工具</strong>   ：处理不同格式的数据交换</li>\n<li><strong>办公应用集成</strong>   ：与 Office 文档交互</li>\n</ol>\n<h2>重要注意事项</h2>\n<ol>\n<li><strong>用户交互要求</strong>   ：必须在用户触发的事件（如点击）中调用</li>\n<li><strong>安全上下文</strong>   ：需要在 HTTPS 或 localhost 中运行</li>\n<li><strong>权限管理</strong>   ：需要正确处理权限请求和拒绝情况</li>\n<li><strong>性能考虑</strong>   ：大文件操作可能影响性能</li>\n<li><strong>隐私保护</strong>   ：遵循最小权限原则，只在必要时访问剪贴板</li>\n</ol>\n<p>这个详细的指南应该能帮助你全面理解和使用 Navigator Clipboard API 的文件类型支持功能。</p>\n</div>'</script></body></html>