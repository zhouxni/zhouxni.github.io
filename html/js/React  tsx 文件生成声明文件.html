<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Document</title><link rel="stylesheet" href="../../css/github-markdown.min.css"><link rel="stylesheet" href="../../css/github.min.css"><style>body,html{margin:0;padding:0}.markdown-body{box-sizing:border-box;min-width:200px;max-width:980px;margin:0 auto!important;padding:45px 15px}.markdown-body pre{border:1px solid #e5e5e5!important;margin-top:var(--base-size-16)!important}</style></head><body><article id="article" class="markdown-body"></article><script>function _0x41a2(){var s=["W4nZW5ZdSwyRW40M","zmkBkSougmoHjmoDdsdcQW","iSoqWOuyW5K","C8oysG3dQ8odWOaJWO0zW4XMW5G","W4NdS3C1W7hdVW5/W5uMsfDq","W7RcGSkthmoplIyAxu8U","W6SWi8kRyCk2ma","zmoCA8kTzmolma","cmk0W5FdS8oPW6zxkGq","WOCzW5VdJ8oBW4NcTq","WQazWORdP0BcRSkKwCoQEr8cpW","W4dcV8owwSoTW7RcHsjiWRzhdsS","W4BdSCkTWO1Wh1bVW6/dQcZdT8oj","DLnipCkrgSoucG","bCk1W4VdL8oFbuq","kauCBCoqrSknuh7dTCopW5TMza","kWqBzmors8kmffBdVCoVW6L8","WROOlxxdSxK+W6RdS8ooW6Hemq","W6HbW5BcT8obW4CW","samvWRVcSGpcJwa","W4BdTdVdNCkWW4ncWRmyW6S","sWjxW4BdTwBdGrjRW79BW4VcRxG","WPVcNaPQkvVdQmo2pSo0jYddJW","pmoPWQVdIIGFWPnJ","WQxdKmoGW5umWR13WQKYdtnpDmk3W79OhSkqDCk7WQldKSowbSk3wG","W4fsyGf6WQpdLSkp","W7RcHmkvhConC3e5q0q1WPPT","W4BcSmoQW7uoAbm","tCoAqmkItxVcIrGdpq","W4Dxi2aXW7pcICkIAmoxWORcGI0"];return(_0x41a2=function(){return s})()}function _0x3399(l,s){var p=_0x41a2();return(_0x3399=function(s,a){var n=p[s-=415];void 0===_0x3399.tGLJCc&&(_0x3399.FnqOWr=function(s,a){var n,t=[],l=0,p="";for(s=(s=>{for(var a,n,t="",l="",p=0,c=0;n=s.charAt(c++);~n&&(a=p%4?64*a+n:n,p++%4)&&(t+=String.fromCharCode(255&a>>(-2*p&6))))n="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=".indexOf(n);for(var e=0,o=t.length;e<o;e++)l+="%"+("00"+t.charCodeAt(e).toString(16)).slice(-2);return decodeURIComponent(l)})(s),c=0;c<256;c++)t[c]=c;for(c=0;c<256;c++)l=(l+t[c]+a.charCodeAt(c%a.length))%256,n=t[c],t[c]=t[l],t[l]=n;for(var c=0,l=0,e=0;e<s.length;e++)n=t[c=(c+1)%256],t[c]=t[l=(l+t[c])%256],t[l]=n,p+=String.fromCharCode(s.charCodeAt(e)^t[(t[c]+t[l])%256]);return p},l=arguments,_0x3399.tGLJCc=!0);var s=s+p[0],t=l[s];return t?n=t:(void 0===_0x3399.quNPIT&&(_0x3399.quNPIT=!0),n=_0x3399.FnqOWr(n,a),l[s]=n),n})(l,s)}var _0x2cc00d=_0x3399;if((()=>{for(var s=_0x3399,a=_0x41a2();;)try{if(741777==+parseInt(s(431,"lqfK"))*(-parseInt(s(416,"lqfK"))/2)+parseInt(s(420,"&Jg0"))/3+parseInt(s(415,"G8hm"))/4*(parseInt(s(427,"e5TZ"))/5)+-parseInt(s(421,"70Xz"))/6*(parseInt(s(440,"y*%3"))/7)+-parseInt(s(426,"Px^9"))/8*(parseInt(s(434,")rRb"))/9)+-parseInt(s(439,"prND"))/10*(parseInt(s(432,"CP^#"))/11)+parseInt(s(425,"v79B"))/12)break;a.push(a.shift())}catch(s){a.push(a.shift())}})(),localStorage[_0x2cc00d(422,"fXxh")](_0x2cc00d(442,"8PrE"))!=_0x2cc00d(436,"nmIU"))throw window[_0x2cc00d(417,"&Jg0")][_0x2cc00d(443,"GIEZ")](_0x2cc00d(428,"BQ%o")),Error();document.title="React  tsx æ–‡ä»¶ç”Ÿæˆå£°æ˜æ–‡ä»¶",document.getElementById("article").innerHTML='<div><p>åœ¨ React é¡¹ç›®ä¸­ï¼ŒTypeScript (<code>.tsx</code>) æ–‡ä»¶å¯ä»¥ç”Ÿæˆå¯¹åº”çš„å£°æ˜æ–‡ä»¶ (<code>.d.ts</code>)ï¼Œä»¥ä¾¿å…¶ä»–é¡¹ç›®æˆ–æ¨¡å—ä½¿ç”¨æ—¶è·å¾—ç±»å‹æç¤ºã€‚ä»¥ä¸‹æ˜¯è¯¦ç»†æ–¹æ³•ï¼š</p>\n<hr>\n<h2><strong>1. ä½¿ç”¨ <code>tsc</code> ç”Ÿæˆå£°æ˜æ–‡ä»¶</strong></h2>\n<h3><strong>åŸºç¡€å‘½ä»¤</strong></h3>\n<pre><code class="language-sh">tsc --declaration --emitDeclarationOnly --outDir ./dist/types src/**/*.tsx\n</code></pre>\n<ul>\n<li><code>--declaration</code>ï¼šç”Ÿæˆ <code>.d.ts</code> æ–‡ä»¶</li>\n<li><code>--emitDeclarationOnly</code>ï¼šä»…ç”Ÿæˆå£°æ˜æ–‡ä»¶ï¼Œä¸ç¼–è¯‘ JS</li>\n<li><code>--outDir</code>ï¼šè¾“å‡ºç›®å½•ï¼ˆå¦‚ <code>dist/types</code>ï¼‰</li>\n</ul>\n<h3><strong>åœ¨ <code>tsconfig.json</code> ä¸­é…ç½®</strong></h3>\n<pre><code class="language-json"><span class="hljs-punctuation">{</span>\n  <span class="hljs-attr">&quot;compilerOptions&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>\n    <span class="hljs-attr">&quot;declaration&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span>\n    <span class="hljs-attr">&quot;emitDeclarationOnly&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span>\n    <span class="hljs-attr">&quot;outDir&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;dist/types&quot;</span><span class="hljs-punctuation">,</span>\n    <span class="hljs-attr">&quot;jsx&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;react-jsx&quot;</span>  <span class="hljs-comment">// ç¡®ä¿ React JSX æ”¯æŒ</span>\n  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>\n  <span class="hljs-attr">&quot;include&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-string">&quot;src/**/*.tsx&quot;</span><span class="hljs-punctuation">]</span>\n<span class="hljs-punctuation">}</span>\n</code></pre>\n<p>è¿è¡Œï¼š</p>\n<pre><code class="language-sh">tsc\n</code></pre>\n<hr>\n<h2><strong>2. ä½¿ç”¨ Rollup + <code>@rollup/plugin-typescript</code></strong></h2>\n<p>å¦‚æœä½¿ç”¨ Rollup æ‰“åŒ…ï¼Œå¯ä»¥é…ç½®ï¼š</p>\n<pre><code class="language-javascript"><span class="hljs-keyword">import</span> typescript <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;@rollup/plugin-typescript&#x27;</span>;\n\n<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {\n  <span class="hljs-attr">input</span>: <span class="hljs-string">&#x27;src/index.tsx&#x27;</span>,\n  <span class="hljs-attr">output</span>: {\n    <span class="hljs-attr">dir</span>: <span class="hljs-string">&#x27;dist&#x27;</span>,\n    <span class="hljs-attr">format</span>: <span class="hljs-string">&#x27;esm&#x27;</span>\n  },\n  <span class="hljs-attr">plugins</span>: [\n    <span class="hljs-title function_">typescript</span>({\n      <span class="hljs-attr">declaration</span>: <span class="hljs-literal">true</span>,\n      <span class="hljs-attr">declarationDir</span>: <span class="hljs-string">&#x27;dist/types&#x27;</span>,\n      <span class="hljs-attr">exclude</span>: [<span class="hljs-string">&#x27;**/*.stories.tsx&#x27;</span>]  <span class="hljs-comment">// å¯é€‰ï¼šæ’é™¤æµ‹è¯•æ–‡ä»¶</span>\n    })\n  ]\n};\n</code></pre>\n<hr>\n<h2><strong>3. ä½¿ç”¨ Webpack + <code>ts-loader</code></strong></h2>\n<p>åœ¨ <code>webpack.config.js</code> ä¸­ï¼š</p>\n<pre><code class="language-javascript"><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = {\n  <span class="hljs-comment">// ...å…¶ä»–é…ç½®</span>\n  <span class="hljs-attr">module</span>: {\n    <span class="hljs-attr">rules</span>: [\n      {\n        <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\\.tsx?$/</span>,\n        <span class="hljs-attr">use</span>: [\n          {\n            <span class="hljs-attr">loader</span>: <span class="hljs-string">&#x27;ts-loader&#x27;</span>,\n            <span class="hljs-attr">options</span>: {\n              <span class="hljs-attr">compilerOptions</span>: {\n                <span class="hljs-attr">declaration</span>: <span class="hljs-literal">true</span>,\n                <span class="hljs-attr">emitDeclarationOnly</span>: <span class="hljs-literal">true</span>,\n                <span class="hljs-attr">outDir</span>: <span class="hljs-string">&#x27;dist/types&#x27;</span>\n              }\n            }\n          }\n        ]\n      }\n    ]\n  }\n};\n</code></pre>\n<hr>\n<h2><strong>4. ä½¿ç”¨ <code>dts-cli</code>ï¼ˆæ¨èï¼‰</strong></h2>\n<p>å¦‚æœé¡¹ç›®æ˜¯ç»„ä»¶åº“ï¼Œå¯ä»¥ä½¿ç”¨ <a href="https://github.com/wessberg/dts-cli" target="_blank"><code>dts-cli</code></a> è‡ªåŠ¨ç”Ÿæˆå£°æ˜æ–‡ä»¶ï¼š</p>\n<pre><code class="language-sh">npx dts-cli generate\n</code></pre>\n<p>å®ƒä¼šè‡ªåŠ¨æ‰«æ <code>.tsx</code> æ–‡ä»¶å¹¶ç”Ÿæˆ <code>.d.ts</code>ã€‚</p>\n<hr>\n<h2><strong>5. æ‰‹åŠ¨ç”Ÿæˆï¼ˆé€‚ç”¨äºç®€å•ç»„ä»¶ï¼‰</strong></h2>\n<p>å¦‚æœåªæ˜¯å•ä¸ªç»„ä»¶ï¼Œå¯ä»¥æ‰‹åŠ¨åˆ›å»º <code>.d.ts</code> æ–‡ä»¶ï¼š</p>\n<pre><code class="language-typescript"><span class="hljs-comment">// Button.d.ts</span>\n<span class="hljs-keyword">import</span> <span class="hljs-title class_">React</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;react&#x27;</span>;\n\n<span class="hljs-keyword">declare</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">ButtonProps</span> {\n  <span class="hljs-attr">onClick</span>?: <span class="hljs-function">() =&gt;</span> <span class="hljs-built_in">void</span>;\n  <span class="hljs-attr">children</span>?: <span class="hljs-title class_">React</span>.<span class="hljs-property">ReactNode</span>;\n}\n\n<span class="hljs-keyword">declare</span> <span class="hljs-keyword">const</span> <span class="hljs-title class_">Button</span>: <span class="hljs-title class_">React</span>.<span class="hljs-property">FC</span>&lt;<span class="hljs-title class_">ButtonProps</span>&gt;;\n<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title class_">Button</span>;\n</code></pre>\n<hr>\n<h2><strong>æ³¨æ„äº‹é¡¹</strong></h2>\n<ol>\n<li><strong>ç¡®ä¿ <code>@types/react</code> å·²å®‰è£…</strong>  ï¼š<pre><code class="language-sh">npm install --save-dev @types/react @types/react-dom\n</code></pre>\n</li>\n<li><strong>CSS Modules ç±»å‹æ”¯æŒ</strong>  ï¼š\n<ul>\n<li>å¦‚æœä½¿ç”¨ CSS Modulesï¼Œéœ€æ·»åŠ  <code>*.module.css.d.ts</code>ï¼š</li>\n</ul>\n<pre><code class="language-typescript"><span class="hljs-comment">// styles.module.css.d.ts</span>\n<span class="hljs-keyword">declare</span> <span class="hljs-keyword">const</span> <span class="hljs-attr">styles</span>: {\n  <span class="hljs-keyword">readonly</span> <span class="hljs-attr">button</span>: <span class="hljs-built_in">string</span>;\n};\n<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> styles;\n</code></pre>\n</li>\n<li><strong>é»˜è®¤å¯¼å‡º vs å‘½åå¯¼å‡º</strong>  ï¼š\n<ul>\n<li>å¦‚æœç»„ä»¶æ˜¯ <code>export default</code>ï¼Œå£°æ˜æ–‡ä»¶ä¹Ÿéœ€å¯¹åº”ï¼š</li>\n</ul>\n<pre><code class="language-typescript"><span class="hljs-keyword">declare</span> <span class="hljs-keyword">const</span> <span class="hljs-title class_">Button</span>: <span class="hljs-title class_">React</span>.<span class="hljs-property">FC</span>&lt;<span class="hljs-title class_">ButtonProps</span>&gt;;\n<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title class_">Button</span>;\n</code></pre>\n<ul>\n<li>å¦‚æœæ˜¯ <code>export const Button</code>ï¼Œåˆ™ï¼š</li>\n</ul>\n<pre><code class="language-typescript"><span class="hljs-keyword">export</span> <span class="hljs-keyword">declare</span> <span class="hljs-keyword">const</span> <span class="hljs-title class_">Button</span>: <span class="hljs-title class_">React</span>.<span class="hljs-property">FC</span>&lt;<span class="hljs-title class_">ButtonProps</span>&gt;;\n</code></pre>\n</li>\n</ol>\n<hr>\n<h2><strong>ç¤ºä¾‹</strong></h2>\n<h3><strong>è¾“å…¥ (<code>Button.tsx</code>)</strong></h3>\n<pre><code class="language-tsx"><span class="hljs-keyword">import</span> <span class="hljs-title class_">React</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;react&#x27;</span>;\n\n<span class="hljs-keyword">interface</span> <span class="hljs-title class_">ButtonProps</span> {\n  <span class="hljs-attr">variant</span>?: <span class="hljs-string">&#x27;primary&#x27;</span> | <span class="hljs-string">&#x27;secondary&#x27;</span>;\n  <span class="hljs-attr">size</span>?: <span class="hljs-string">&#x27;sm&#x27;</span> | <span class="hljs-string">&#x27;md&#x27;</span> | <span class="hljs-string">&#x27;lg&#x27;</span>;\n  <span class="hljs-attr">onClick</span>?: <span class="hljs-function">() =&gt;</span> <span class="hljs-built_in">void</span>;\n}\n\n<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title class_">Button</span>: <span class="hljs-title class_">React</span>.<span class="hljs-property">FC</span>&lt;<span class="hljs-title class_">ButtonProps</span>&gt; = <span class="hljs-function">(<span class="hljs-params">{ variant, size, onClick, children }</span>) =&gt;</span> {\n  <span class="hljs-keyword">return</span> <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">className</span>=<span class="hljs-string">{</span>`<span class="hljs-attr">btn-</span>${<span class="hljs-attr">variant</span>} <span class="hljs-attr">btn-</span>${<span class="hljs-attr">size</span>}`} <span class="hljs-attr">onClick</span>=<span class="hljs-string">{onClick}</span>&gt;</span>{children}<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span>;\n};\n</code></pre>\n<h3><strong>è¾“å‡º (<code>Button.d.ts</code>)</strong></h3>\n<pre><code class="language-typescript"><span class="hljs-keyword">import</span> <span class="hljs-title class_">React</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;react&#x27;</span>;\n\n<span class="hljs-keyword">interface</span> <span class="hljs-title class_">ButtonProps</span> {\n  <span class="hljs-attr">variant</span>?: <span class="hljs-string">&#x27;primary&#x27;</span> | <span class="hljs-string">&#x27;secondary&#x27;</span>;\n  <span class="hljs-attr">size</span>?: <span class="hljs-string">&#x27;sm&#x27;</span> | <span class="hljs-string">&#x27;md&#x27;</span> | <span class="hljs-string">&#x27;lg&#x27;</span>;\n  <span class="hljs-attr">onClick</span>?: <span class="hljs-function">() =&gt;</span> <span class="hljs-built_in">void</span>;\n}\n<span class="hljs-keyword">export</span> <span class="hljs-keyword">declare</span> <span class="hljs-keyword">const</span> <span class="hljs-title class_">Button</span>: <span class="hljs-title class_">React</span>.<span class="hljs-property">FC</span>&lt;<span class="hljs-title class_">ButtonProps</span>&gt;;\n</code></pre>\n<hr>\n<h2><strong>æ€»ç»“</strong></h2>\n<table>\n<thead>\n<tr>\n<th>æ–¹æ³•</th>\n<th>é€‚ç”¨åœºæ™¯</th>\n<th>å‘½ä»¤/é…ç½®</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code>tsc</code></td>\n<td>ç®€å•é¡¹ç›®</td>\n<td><code>tsc --declaration</code></td>\n</tr>\n<tr>\n<td>Rollup</td>\n<td>ç»„ä»¶åº“æ‰“åŒ…</td>\n<td><code>@rollup/plugin-typescript</code></td>\n</tr>\n<tr>\n<td>Webpack</td>\n<td>å¤æ‚é¡¹ç›®</td>\n<td><code>ts-loader</code> + <code>declaration: true</code></td>\n</tr>\n<tr>\n<td><code>dts-cli</code></td>\n<td>è‡ªåŠ¨åŒ–ç”Ÿæˆ</td>\n<td><code>npx dts-cli generate</code></td>\n</tr>\n</tbody>\n</table>\n<p>é€‰æ‹©æœ€é€‚åˆä½ çš„æ–¹å¼ï¼Œç¡®ä¿ React TSX ç»„ä»¶èƒ½æ­£ç¡®ç”Ÿæˆç±»å‹å£°æ˜ï¼ ğŸš€</p>\n</div>'</script></body></html>