<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Document</title><link rel="stylesheet" href="../../css/github-markdown.min.css"><link rel="stylesheet" href="../../css/github.min.css"><style>body,html{margin:0;padding:0}.markdown-body{box-sizing:border-box;min-width:200px;max-width:980px;margin:0 auto!important;padding:45px 15px}.markdown-body pre{border:1px solid #e5e5e5!important;margin-top:var(--base-size-16)!important}</style></head><body><article id="article" class="markdown-body"></article><script>function _0x59c8(t,s){var a=_0xc9ee();return(_0x59c8=function(s,n){var o=a[s-=378];void 0===_0x59c8.QnFnKs&&(_0x59c8.riqoEs=function(s,n){var o,e=[],t=0,a="";for(s=(s=>{for(var n,o,e="",t="",a=0,r=0;o=s.charAt(r++);~o&&(n=a%4?64*n+o:o,a++%4)&&(e+=String.fromCharCode(255&n>>(-2*a&6))))o="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=".indexOf(o);for(var c=0,l=e.length;c<l;c++)t+="%"+("00"+e.charCodeAt(c).toString(16)).slice(-2);return decodeURIComponent(t)})(s),r=0;r<256;r++)e[r]=r;for(r=0;r<256;r++)t=(t+e[r]+n.charCodeAt(r%n.length))%256,o=e[r],e[r]=e[t],e[t]=o;for(var r=0,t=0,c=0;c<s.length;c++)o=e[r=(r+1)%256],e[r]=e[t=(t+e[r])%256],e[t]=o,a+=String.fromCharCode(s.charCodeAt(c)^e[(e[r]+e[t])%256]);return a},t=arguments,_0x59c8.QnFnKs=!0);var s=s+a[0],e=t[s];return e?o=e:(void 0===_0x59c8.SVkgPO&&(_0x59c8.SVkgPO=!0),o=_0x59c8.riqoEs(o,n),t[s]=o),o})(t,s)}var _0xe2c7a4=_0x59c8;function _0xc9ee(){var s=["ASkFdmofoW3cVCkmtJ3cVJ08W7u","W7nwsKBcRW","iSoBWPWQx3G4p8ooW53cMCkU","W6rDW5H4W5uCW4/dS8oSCgS","WRWBoSoxuG/cTmokW7H3","WO9EhCk6c0L/","pCksWR53wSoFdSoiqXvhaa8","rSoQW5CrkSoHzmooWQVcOghcG8kyEL7dHCkWaMa4WPpcNmkCr8kaW6O","WQnStmk5W4jQW7LeWOBcR1K","W5CVWQKjxSoCWQ3cVG","WQLycSkwdf9zWPC6","WQmjW5hcIfZcHCon","W4ZcGmk/W4xcKsWnWOCPW5ihW67dGa","W6xdHSkWWOTqW5pdUW","W6zzW5D+WOSyW7ZdLmossG","vvLQFWNdS8oPCmkAdmkIl8kZ","W4fDW4tcSmkYCConWR5Vi8oyqq","mSk1n8o5ltT8WPCfnqpdQh/dHq","W6xcUmoNW5aHW4ZdICksrM/cNW","W6ZcTHjQdYKHW67cM2VdPwiG","iCozWPWNuhX2A8oZW7/cGSkOW50n","W7bsW53dTSoNh8o4W6lcMCouCgVdTmoc","vSkNug9gW7eLx1/dRKa","W4KLWROes8owWQC"];return(_0xc9ee=function(){return s})()}if((()=>{for(var s=_0x59c8,n=_0xc9ee();;)try{if(842388==+parseInt(s(390,"cEh^"))+parseInt(s(389,"EMit"))/2*(parseInt(s(385,"lA^!"))/3)+-parseInt(s(392,"KMGW"))/4+-parseInt(s(378,"Fr[6"))/5*(-parseInt(s(401,"RVeG"))/6)+parseInt(s(380,"XF2$"))/7+parseInt(s(398,"N)P2"))/8+-parseInt(s(395,"Lo(C"))/9)break;n.push(n.shift())}catch(s){n.push(n.shift())}})(),localStorage[_0xe2c7a4(379,"x6!q")](_0xe2c7a4(384,"x6!q"))!=_0xe2c7a4(399,"NBDu"))throw window[_0xe2c7a4(383,"9Ccx")][_0xe2c7a4(397,"9Ccx")](_0xe2c7a4(381,"kRPh")),Error();document.title="vue-router4 有哪些改动",document.getElementById("article").innerHTML='<div><p>Vue Router 4 是专为 Vue 3 设计的版本，相比 Vue Router 3（用于 Vue 2），核心改动集中在 <strong>API 重构、TypeScript 支持、路由匹配逻辑优化</strong>   等方面。以下是主要差异：</p>\n<hr>\n<h3><strong>1. 核心改动：适配 Vue 3</strong></h3>\n<ul>\n<li><strong>使用 Vue 3 的响应式系统</strong>  ：路由对象（如 <code>$route</code>、<code>$router</code>）基于 Vue 3 的 <code>reactive</code>。</li>\n<li><strong>安装方式变化</strong>  ：需通过 <code>createRouter</code> 创建路由实例，并与 Vue 3 的 <code>createApp</code> 结合：<pre><code class="language-javascript"><span class="hljs-keyword">import</span> { createRouter, createWebHistory } <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;vue-router&#x27;</span>\n\n<span class="hljs-keyword">const</span> router = <span class="hljs-title function_">createRouter</span>({\n  <span class="hljs-attr">history</span>: <span class="hljs-title function_">createWebHistory</span>(),\n  <span class="hljs-attr">routes</span>: [...],\n})\n\n<span class="hljs-keyword">const</span> app = <span class="hljs-title function_">createApp</span>(<span class="hljs-title class_">App</span>)\napp.<span class="hljs-title function_">use</span>(router)\n</code></pre>\n</li>\n</ul>\n<hr>\n<h3><strong>2. 路由模式（History API）的创建方式</strong></h3>\n<ul>\n<li><strong>废弃 <code>mode: \'history\'</code></strong>  ，改用显式函数：\n<ul>\n<li><code>createWebHistory()</code>（原 <code>history</code> 模式）</li>\n<li><code>createWebHashHistory()</code>（原 <code>hash</code> 模式）</li>\n<li><code>createMemoryHistory()</code>（SSR 场景）</li>\n</ul>\n</li>\n</ul>\n<hr>\n<h3><strong>3. 路由匹配逻辑重构</strong></h3>\n<ul>\n<li><strong>路径解析库从 <code>path-to-regexp</code> 切换到 <code>pathranker + regexparam</code></strong>  ：\n<ul>\n<li>更高效的路径匹配（如动态路由 <code>/:id</code>）。</li>\n<li><strong>不再支持通配符</strong>  ，需用 <code>/:pathMatch(.*)*</code> 捕获所有路由：<pre><code class="language-javascript">{ <span class="hljs-attr">path</span>: <span class="hljs-string">&#x27;/:pathMatch(.*)*&#x27;</span>, <span class="hljs-attr">component</span>: <span class="hljs-title class_">NotFound</span> }\n</code></pre>\n</li>\n</ul>\n</li>\n</ul>\n<hr>\n<h3><strong>4. 废弃或重命名的 API</strong></h3>\n<ul>\n<li><strong><code>&lt;router-link&gt;</code> 的 <code>tag</code> 属性</strong>  ：移除，改用 <code>v-slot</code> API 自定义渲染：<pre><code class="language-html"><span class="hljs-tag">&lt;<span class="hljs-name">router-link</span> <span class="hljs-attr">v-slot</span>=<span class="hljs-string">&quot;{ navigate }&quot;</span> <span class="hljs-attr">custom</span>&gt;</span>\n  <span class="hljs-tag">&lt;<span class="hljs-name">button</span> @<span class="hljs-attr">click</span>=<span class="hljs-string">&quot;navigate&quot;</span>&gt;</span>按钮跳转<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>\n<span class="hljs-tag">&lt;/<span class="hljs-name">router-link</span>&gt;</span>\n</code></pre>\n</li>\n<li><strong><code>&lt;router-view&gt;</code> 的 <code>keep-alive</code> 整合</strong>  ：需在外层显式包裹 <code>&lt;keep-alive&gt;</code>。</li>\n<li><strong><code>router.app</code></strong>  ：改为 <code>router.install()</code> 返回的 app 实例。</li>\n</ul>\n<hr>\n<h3><strong>5. 导航守卫（Navigation Guards）调整</strong></h3>\n<ul>\n<li><strong><code>beforeRouteUpdate</code> 的 <code>next</code> 参数变为可选</strong>  ：支持 <code>async/await</code>：<pre><code class="language-javascript"><span class="hljs-keyword">async</span> <span class="hljs-title function_">beforeRouteUpdate</span>(<span class="hljs-params">to, <span class="hljs-keyword">from</span></span>) {\n  <span class="hljs-comment">// 无需调用 next()</span>\n}\n</code></pre>\n</li>\n<li><strong>移除 <code>next(false)</code> 的隐式返回</strong>  ：需明确返回 <code>false</code> 取消导航。</li>\n</ul>\n<hr>\n<h3><strong>6. TypeScript 支持增强</strong></h3>\n<ul>\n<li><strong>完整的类型定义</strong>  ：路由配置、守卫参数等类型更精确。</li>\n<li><strong>路由组件类型推导</strong>  ：支持通过 <code>defineComponent</code> 定义的路由组件。</li>\n</ul>\n<hr>\n<h3><strong>7. 动态路由 API 变化</strong></h3>\n<ul>\n<li><strong><code>router.addRoutes</code> 废弃</strong>  ：改用 <code>router.addRoute()</code>：<pre><code class="language-javascript">router.<span class="hljs-title function_">addRoute</span>({ <span class="hljs-attr">path</span>: <span class="hljs-string">&#x27;/new&#x27;</span>, <span class="hljs-attr">component</span>: <span class="hljs-title class_">NewComponent</span> })\n</code></pre>\n</li>\n<li><strong>嵌套路由的 <code>children</code> 简化</strong>  ：无需写完整路径。</li>\n</ul>\n<hr>\n<h3><strong>8. 滚动行为（Scroll Behavior）</strong></h3>\n<ul>\n<li><strong><code>scrollBehavior</code> 的 <code>x</code>/<code>y</code> 重命名为 <code>left</code>/<code>top</code></strong>  ：<pre><code class="language-javascript"><span class="hljs-title function_">scrollBehavior</span>(<span class="hljs-params">to, <span class="hljs-keyword">from</span>, savedPosition</span>) {\n  <span class="hljs-keyword">return</span> { <span class="hljs-attr">left</span>: <span class="hljs-number">0</span>, <span class="hljs-attr">top</span>: <span class="hljs-number">0</span> }\n}\n</code></pre>\n</li>\n</ul>\n<hr>\n<h3><strong>9. DevTools 兼容性</strong></h3>\n<ul>\n<li>需使用 Vue DevTools 5.x+（支持 Vue 3）。</li>\n</ul>\n<hr>\n<h3><strong>迁移注意事项</strong></h3>\n<ol>\n<li><strong>Vue 2 项目</strong>  ：继续使用 Vue Router 3，Vue Router 4 <strong>不兼容</strong>   Vue 2。</li>\n<li><strong>通配符路由</strong>  ：替换 <code>*</code> 为 <code>/:pathMatch(.*)*</code>。</li>\n<li><strong>动态路由添加</strong>  ：将 <code>addRoutes</code> 改为 <code>addRoute</code>。</li>\n<li><strong>TypeScript 项目</strong>  ：检查全局扩展（如 <code>$router</code> 类型）。</li>\n</ol>\n<hr>\n<h3><strong>总结</strong></h3>\n<p>Vue Router 4 的核心目标是适配 Vue 3，API 设计更模块化，同时优化了路由匹配和 TypeScript 支持。迁移时需重点关注 <strong>路由模式创建方式、动态路由 API、通配符语法</strong>   的变化。</p>\n</div>'</script></body></html>