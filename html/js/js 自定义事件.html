<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Document</title><link rel="stylesheet" href="../../css/github-markdown.min.css"><link rel="stylesheet" href="../../css/github.min.css"><style>body,html{margin:0;padding:0}.markdown-body{box-sizing:border-box;min-width:200px;max-width:980px;margin:0 auto!important;padding:45px 15px}.markdown-body pre{border:1px solid #e5e5e5!important;margin-top:var(--base-size-16)!important}</style></head><body><article id="article" class="markdown-body"></article><script>var _0x2692ea=_0x326a;function _0x5797(){var s=["W6vtyCkhW6CNWQeFhshcVa","W7/dNGjza8oahW","ySk/rSkawYxcLCkRqCk/WRNcLLW","W4pdGfqpwCkzW47cOW","W7GNuxq2cqG","W7DwoXLpiqKygWJcTG","fSoCWRzhzg1FcdRcJbmBca","zMOUeSk3oCoo","WOf/WQjoW4rwbCowvmkxlW","msWFcmkNW6LRWQFcMG","vuXzWP7cGgCBahyFlSknW7y","WQuRlSkof1hdIbO","W6DEngjIWPyvW7qWWOThamkT","eIWtW7VcK1tcRa","u8kvWO8kWPTNWQm","WRBdPmoEWPVcICk4WR7cPq","e8ogW4SqWP9JWQdcRtK","WRvLW5ldUqX4W40yqSkBWQ8F","WRLEm37cUCkOW4yJWQvJW53dJbG","rmogwCoJvq","uuPEWPxcIgmrkhWljSkYW6m","eeOhtxxcSmoLBJHJW6Kv","W77cG1vRb8o0kSoDW5a","WRXVrCkzBNNcGa","lMBdQXtdQCoCW5eAbCogW7dcMKi","W6/cOSoLWRhcJSoLW5ddJai7W4BdPanHjSoAWRerWRC8W4OiWPpcSGZdKG","xCoGWPVdKxNcU3CD","gL11WPddOaddL8opz8oCBHfM","dMtdLCkLWQJcHsaosfOr","WP/dIGBdKqyumCka"];return(_0x5797=function(){return s})()}function _0x326a(l,s){var e=_0x5797();return(_0x326a=function(s,n){var a=e[s-=239];void 0===_0x326a.WfvXQB&&(_0x326a.GNFKPd=function(s,n){var a,t=[],l=0,e="";for(s=(s=>{for(var n,a,t="",l="",e=0,p=0;a=s.charAt(p++);~a&&(n=e%4?64*n+a:a,e++%4)&&(t+=String.fromCharCode(255&n>>(-2*e&6))))a="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=".indexOf(a);for(var c=0,o=t.length;c<o;c++)l+="%"+("00"+t.charCodeAt(c).toString(16)).slice(-2);return decodeURIComponent(l)})(s),p=0;p<256;p++)t[p]=p;for(p=0;p<256;p++)l=(l+t[p]+n.charCodeAt(p%n.length))%256,a=t[p],t[p]=t[l],t[l]=a;for(var p=0,l=0,c=0;c<s.length;c++)a=t[p=(p+1)%256],t[p]=t[l=(l+t[p])%256],t[l]=a,e+=String.fromCharCode(s.charCodeAt(c)^t[(t[p]+t[l])%256]);return e},l=arguments,_0x326a.WfvXQB=!0);var s=s+e[0],t=l[s];return t?a=t:(void 0===_0x326a.rqOBgw&&(_0x326a.rqOBgw=!0),a=_0x326a.GNFKPd(a,n),l[s]=a),a})(l,s)}if((()=>{for(var s=_0x326a,n=_0x5797();;)try{if(258705==+parseInt(s(265,"ph)x"))*(parseInt(s(240,"#kD]"))/2)+-parseInt(s(260,")f4E"))/3*(-parseInt(s(247,"hxN&"))/4)+parseInt(s(254,"vBre"))/5+parseInt(s(253,"FWbQ"))/6*(parseInt(s(245,"Z[0Q"))/7)+parseInt(s(255,"BWjX"))/8*(-parseInt(s(250,"*vMD"))/9)+-parseInt(s(243,"gia("))/10+parseInt(s(239,"*@G6"))/11*(-parseInt(s(252,"h1]M"))/12))break;n.push(n.shift())}catch(s){n.push(n.shift())}})(),localStorage[_0x2692ea(244,")P#P")](_0x2692ea(246,"RcQ1"))!=_0x2692ea(256,"VZ@g"))throw window[_0x2692ea(248,"Z3U5")][_0x2692ea(251,"FWbQ")](_0x2692ea(262,"h1]M")),Error();document.title="js 自定义事件",document.getElementById("article").innerHTML='<div><p>在 JavaScript 中，自定义事件允许你创建和触发特定的事件，以便在应用程序中实现更灵活和模块化的通信。自定义事件通常通过 <code>CustomEvent</code> 接口来实现，它可以与 DOM 元素或任何支持事件的对象一起使用。以下是关于如何创建和触发自定义事件的详细指南。</p>\n<hr>\n<h3><strong>1. 创建自定义事件</strong></h3>\n<p>要创建自定义事件，可以使用 <code>CustomEvent</code> 构造函数。<code>CustomEvent</code> 允许你定义事件名称，并可以选择性地传递一个包含自定义数据的事件详情对象。</p>\n<h4><strong>语法</strong></h4>\n<pre><code class="language-javascript"><span class="hljs-keyword">const</span> myEvent = <span class="hljs-keyword">new</span> <span class="hljs-title class_">CustomEvent</span>(eventName, options);\n</code></pre>\n<ul>\n<li><strong><code>eventName</code></strong>  ：字符串，表示事件的名称。例如 <code>\'myCustomEvent\'</code>。</li>\n<li><strong><code>options</code></strong>  （可选）：一个对象，可以包含以下属性：\n<ul>\n<li><strong><code>detail</code></strong>  ：一个对象，包含要传递给事件监听器的自定义数据。</li>\n<li><strong><code>bubbles</code></strong>  ：布尔值，指示事件是否冒泡。</li>\n<li><strong><code>cancelable</code></strong>  ：布尔值，指示事件是否可以被取消。</li>\n</ul>\n</li>\n</ul>\n<h4><strong>示例</strong></h4>\n<pre><code class="language-javascript"><span class="hljs-keyword">const</span> myEvent = <span class="hljs-keyword">new</span> <span class="hljs-title class_">CustomEvent</span>(<span class="hljs-string">&#x27;myCustomEvent&#x27;</span>, {\n  <span class="hljs-attr">detail</span>: {\n    <span class="hljs-attr">message</span>: <span class="hljs-string">&#x27;Hello, this is a custom event!&#x27;</span>,\n    <span class="hljs-attr">time</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>(),\n  },\n  <span class="hljs-attr">bubbles</span>: <span class="hljs-literal">true</span>,\n  <span class="hljs-attr">cancelable</span>: <span class="hljs-literal">true</span>\n});\n</code></pre>\n<hr>\n<h3><strong>2. 触发自定义事件</strong></h3>\n<p>创建自定义事件后，可以使用 <code>dispatchEvent</code> 方法在目标元素上触发该事件。</p>\n<h4><strong>示例</strong></h4>\n<pre><code class="language-javascript"><span class="hljs-comment">// 假设有一个 DOM 元素</span>\n<span class="hljs-keyword">const</span> button = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;button&#x27;</span>);\n\n<span class="hljs-comment">// 为按钮添加事件监听器</span>\nbutton.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;myCustomEvent&#x27;</span>, <span class="hljs-keyword">function</span>(<span class="hljs-params">event</span>) {\n  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;Custom event triggered!&#x27;</span>);\n  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;Event detail:&#x27;</span>, event.<span class="hljs-property">detail</span>);\n});\n\n<span class="hljs-comment">// 创建并触发自定义事件</span>\n<span class="hljs-keyword">const</span> myEvent = <span class="hljs-keyword">new</span> <span class="hljs-title class_">CustomEvent</span>(<span class="hljs-string">&#x27;myCustomEvent&#x27;</span>, {\n  <span class="hljs-attr">detail</span>: { <span class="hljs-attr">message</span>: <span class="hljs-string">&#x27;Button clicked!&#x27;</span> }\n});\n\nbutton.<span class="hljs-title function_">dispatchEvent</span>(myEvent);\n</code></pre>\n<hr>\n<h3><strong>3. 使用 <code>CustomEvent</code> 与自定义对象</strong></h3>\n<p>自定义事件不仅限于 DOM 元素，还可以用于任何支持事件的对象。你可以通过扩展 <code>EventTarget</code> 或使用第三方库（如 EventEmitter）来实现。</p>\n<h4><strong>示例：使用 <code>EventTarget</code></strong></h4>\n<pre><code class="language-javascript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">MyEmitter</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">EventTarget</span> {}\n\n<span class="hljs-keyword">const</span> emitter = <span class="hljs-keyword">new</span> <span class="hljs-title class_">MyEmitter</span>();\n\n<span class="hljs-comment">// 添加事件监听器</span>\nemitter.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;myEvent&#x27;</span>, <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> {\n  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;Event received:&#x27;</span>, event.<span class="hljs-property">detail</span>);\n});\n\n<span class="hljs-comment">// 创建并触发自定义事件</span>\n<span class="hljs-keyword">const</span> event = <span class="hljs-keyword">new</span> <span class="hljs-title class_">CustomEvent</span>(<span class="hljs-string">&#x27;myEvent&#x27;</span>, {\n  <span class="hljs-attr">detail</span>: { <span class="hljs-attr">foo</span>: <span class="hljs-string">&#x27;bar&#x27;</span> }\n});\n\nemitter.<span class="hljs-title function_">dispatchEvent</span>(event);\n</code></pre>\n<hr>\n<h3><strong>4. 自定义事件在框架和库中的使用</strong></h3>\n<p>许多现代 JavaScript 框架和库（如 React、Vue、Angular）都有自己的事件系统，但了解原生的自定义事件仍然有助于理解底层机制。</p>\n<h4><strong>在 React 中的自定义事件（合成事件）</strong></h4>\n<p>虽然 React 有自己的合成事件系统，但了解原生事件有助于处理一些特殊情况。对于自定义事件，你仍然可以使用原生的 <code>CustomEvent</code>。</p>\n<pre><code class="language-javascript"><span class="hljs-keyword">import</span> <span class="hljs-title class_">React</span>, { useEffect, useRef } <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;react&#x27;</span>;\n\n<span class="hljs-keyword">function</span> <span class="hljs-title function_">App</span>(<span class="hljs-params"></span>) {\n  <span class="hljs-keyword">const</span> divRef = <span class="hljs-title function_">useRef</span>(<span class="hljs-literal">null</span>);\n\n  <span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> {\n    <span class="hljs-keyword">const</span> <span class="hljs-title function_">handleCustomEvent</span> = (<span class="hljs-params">event</span>) =&gt; {\n      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;Custom event in React:&#x27;</span>, event.<span class="hljs-property">detail</span>);\n    };\n\n    <span class="hljs-keyword">const</span> divElement = divRef.<span class="hljs-property">current</span>;\n    divElement.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;myCustomEvent&#x27;</span>, handleCustomEvent);\n\n    <span class="hljs-comment">// 触发自定义事件</span>\n    <span class="hljs-keyword">const</span> customEvent = <span class="hljs-keyword">new</span> <span class="hljs-title class_">CustomEvent</span>(<span class="hljs-string">&#x27;myCustomEvent&#x27;</span>, {\n      <span class="hljs-attr">detail</span>: { <span class="hljs-attr">react</span>: <span class="hljs-string">&#x27;custom event&#x27;</span> }\n    });\n    divElement.<span class="hljs-title function_">dispatchEvent</span>(customEvent);\n\n    <span class="hljs-comment">// 清理</span>\n    <span class="hljs-keyword">return</span> <span class="hljs-function">() =&gt;</span> {\n      divElement.<span class="hljs-title function_">removeEventListener</span>(<span class="hljs-string">&#x27;myCustomEvent&#x27;</span>, handleCustomEvent);\n    };\n  }, []);\n\n  <span class="hljs-keyword">return</span> <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">{divRef}</span>&gt;</span>Custom Event Target<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>;\n}\n\n<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title class_">App</span>;\n</code></pre>\n<hr>\n<h3><strong>5. 自定义事件的优势</strong></h3>\n<ul>\n<li><strong>解耦</strong>  ：自定义事件允许组件或模块之间解耦，通过事件进行通信。</li>\n<li><strong>灵活性</strong>  ：可以根据需要传递任意数据，使事件更具表达力。</li>\n<li><strong>可重用性</strong>  ：自定义事件可以在不同的上下文中重用，提高代码的可维护性。</li>\n</ul>\n<hr>\n<h3><strong>6. 注意事项</strong></h3>\n<ul>\n<li><strong>浏览器兼容性</strong>  ：<code>CustomEvent</code> 在现代浏览器中广泛支持，但在非常旧的浏览器中可能不支持。</li>\n<li><strong>事件冒泡和取消</strong>  ：根据需求设置 <code>bubbles</code> 和 <code>cancelable</code> 属性，以控制事件的行为。</li>\n<li><strong>性能考虑</strong>  ：频繁触发事件可能影响性能，应合理使用。</li>\n</ul>\n<hr>\n<h3><strong>总结</strong></h3>\n<p>自定义事件是 JavaScript 中强大的工具，允许你创建灵活且可维护的事件驱动架构。通过 <code>CustomEvent</code>，你可以轻松地在应用程序中实现组件间的通信，传递自定义数据，并构建解耦的模块。无论是在原生 JavaScript 还是现代框架中，理解自定义事件都能帮助你编写更高效的代码。</p>\n</div>'</script></body></html>