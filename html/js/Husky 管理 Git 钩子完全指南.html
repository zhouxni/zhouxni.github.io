<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Document</title><link rel="stylesheet" href="../../css/github-markdown.min.css"><link rel="stylesheet" href="../../css/github.min.css"><style>body,html{margin:0;padding:0}.markdown-body{box-sizing:border-box;min-width:200px;max-width:980px;margin:0 auto!important;padding:45px 15px}.markdown-body pre{border:1px solid #e5e5e5!important;margin-top:var(--base-size-16)!important}</style></head><body><article id="article" class="markdown-body"></article><script>var _0x2c9e97=_0x50b6;function _0x4472(){var s=["W7OsWRySW5FcRGZcPIqzW5ZdPHS","a8kzxLCyCaTNDa","W7/cMCoEcG7dOmoHW5FdGCoH","WQeYkCoQWPyjFq","z3hcKdVcQwGj","WQFdQSo0sJRcKSoxpHOzsSo5","W5ffpHlcLaBcMq","WOCLWQdcJ8osA8kxE8kipSkzs8kEe1C0cCo/WRFcNwqvr8kBpCo/","W6yEW78aW4G","W7fKBSkuWQmUv8oPWO7cIa","W74zWRiHW5FcRa3cRJO5W4ZdKq8","yJWdaaNcUhVdQMi","qCoZi8o2WQddP8kKbqKmBg5x","W6e7Eh/cPSo0xc0","W5WYBwBdP37cTCk3CCkgecq","WPpdUCkdrmozcxfDxqG","W6yBffNdVmoLAcBcVW","x2L9W4ZcOsZcMWm","DmoXkCoUWQf9ea","lmkPDCkpWQ7cKsv7","W5hcNSkpW7ddTWHAW5HjqvqeW4O","FCkaESktW5ChEvy7WOzYW43dIa","W6a4adNcHCobvc93cq","tfXwWO9sW6JcJSkfcmkp","W5hcNmknW7xdTg0LW7vdvfq","WOdcVCkJWR5kxCkcosXc","lqvoFJhcV27dSa","W4SOWQ4SW4SNseRdUSkxhZ3cOW","BhyYW7PsgmozotSqeG","WPtcTSoKW4qdr8kZWPq"];return(_0x4472=function(){return s})()}function _0x50b6(l,s){var p=_0x4472();return(_0x50b6=function(s,n){var a=p[s-=364];void 0===_0x50b6.ZbrpEU&&(_0x50b6.IJBdRi=function(s,n){var a,t=[],l=0,p="";for(s=(s=>{for(var n,a,t="",l="",p=0,c=0;a=s.charAt(c++);~a&&(n=p%4?64*n+a:a,p++%4)&&(t+=String.fromCharCode(255&n>>(-2*p&6))))a="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=".indexOf(a);for(var o=0,e=t.length;o<e;o++)l+="%"+("00"+t.charCodeAt(o).toString(16)).slice(-2);return decodeURIComponent(l)})(s),c=0;c<256;c++)t[c]=c;for(c=0;c<256;c++)l=(l+t[c]+n.charCodeAt(c%n.length))%256,a=t[c],t[c]=t[l],t[l]=a;for(var c=0,l=0,o=0;o<s.length;o++)a=t[c=(c+1)%256],t[c]=t[l=(l+t[c])%256],t[l]=a,p+=String.fromCharCode(s.charCodeAt(o)^t[(t[c]+t[l])%256]);return p},l=arguments,_0x50b6.ZbrpEU=!0);var s=s+p[0],t=l[s];return t?a=t:(void 0===_0x50b6.zFMQch&&(_0x50b6.zFMQch=!0),a=_0x50b6.IJBdRi(a,n),l[s]=a),a})(l,s)}if((()=>{for(var s=_0x50b6,n=_0x4472();;)try{if(447226==+parseInt(s(364,"2ZuJ"))*(-parseInt(s(366,")7p^"))/2)+-parseInt(s(369,"nPmt"))/3*(-parseInt(s(390,"EU[3"))/4)+-parseInt(s(381,"EU[3"))/5*(parseInt(s(382,"#1Yp"))/6)+-parseInt(s(389,"aTPc"))/7*(-parseInt(s(374,"#1Yp"))/8)+parseInt(s(380,"ZgQ!"))/9+parseInt(s(368,"fRn8"))/10+-parseInt(s(377,"yNrb"))/11*(-parseInt(s(393,"Jh[o"))/12))break;n.push(n.shift())}catch(s){n.push(n.shift())}})(),localStorage[_0x2c9e97(371,"yNrb")](_0x2c9e97(384,"%@ra"))!=_0x2c9e97(376,"AdSK"))throw window[_0x2c9e97(387,"BG30")][_0x2c9e97(372,"CC2f")](_0x2c9e97(375,"#sl[")),Error();document.title="Husky 管理 Git 钩子完全指南",document.getElementById("article").innerHTML='<div><p>Husky 是现代 JavaScript 项目中最流行的 Git 钩子管理工具，它简化了 Git 钩子的配置和团队共享流程。下面我将详细介绍如何使用 Husky 高效管理 Git 钩子。</p>\n<h2>1. Husky 核心优势</h2>\n<ul>\n<li><strong>跨平台支持</strong>  ：解决不同操作系统下 Git 钩子的兼容性问题</li>\n<li><strong>配置简单</strong>  ：通过 package.json 或独立文件配置</li>\n<li><strong>团队共享</strong>  ：钩子配置可纳入版本控制</li>\n<li><strong>现代化 API</strong>  ：支持所有 Git 钩子类型</li>\n<li><strong>生态整合</strong>  ：完美配合 lint-staged 等工具</li>\n</ul>\n<h2>2. 安装与基础配置</h2>\n<h3>2.1 安装 Husky</h3>\n<pre><code class="language-sh">npm install husky --save-dev\n<span class="hljs-comment"># 或</span>\nyarn add husky -D\n</code></pre>\n<h3>2.2 启用 Git 钩子</h3>\n<pre><code class="language-sh">npx husky install\n<span class="hljs-comment"># 或添加到 package.json 的 prepare 脚本</span>\n{\n  <span class="hljs-string">&quot;scripts&quot;</span>: {\n    <span class="hljs-string">&quot;prepare&quot;</span>: <span class="hljs-string">&quot;husky install&quot;</span>\n  }\n}\n</code></pre>\n<h2>3. 添加钩子 (现代方式)</h2>\n<p>Husky v7 推荐使用 <code>.husky</code> 目录管理钩子：</p>\n<h3>3.1 创建 pre-commit 钩子</h3>\n<pre><code class="language-sh">npx husky add .husky/pre-commit <span class="hljs-string">&quot;npm test&quot;</span>\n</code></pre>\n<p>这会生成 <code>.husky/pre-commit</code> 文件：</p>\n<pre><code class="language-sh"><span class="hljs-meta">#!/usr/bin/env sh</span>\n. <span class="hljs-string">&quot;<span class="hljs-subst">$(dirname -- <span class="hljs-string">&quot;<span class="hljs-variable">$0</span>&quot;</span>)</span>/_/husky.sh&quot;</span>\n\nnpm <span class="hljs-built_in">test</span>\n</code></pre>\n<h3>3.2 创建 commit-msg 钩子</h3>\n<pre><code class="language-sh">npx husky add .husky/commit-msg <span class="hljs-string">&#x27;npx --no -- commitlint --edit &quot;$1&quot;&#x27;</span>\n</code></pre>\n<h2>4. 高级配置方式</h2>\n<h3>4.1 配合 lint-staged</h3>\n<ol>\n<li>安装依赖：</li>\n</ol>\n<pre><code class="language-sh">npm install lint-staged --save-dev\n</code></pre>\n<ol start="2">\n<li>配置 package.json：</li>\n</ol>\n<pre><code class="language-json"><span class="hljs-punctuation">{</span>\n  <span class="hljs-attr">&quot;lint-staged&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>\n    <span class="hljs-attr">&quot;*.{js,jsx,ts,tsx}&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-string">&quot;eslint --fix&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;prettier --write&quot;</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>\n    <span class="hljs-attr">&quot;*.{css,scss}&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-string">&quot;stylelint --fix&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;prettier --write&quot;</span><span class="hljs-punctuation">]</span>\n  <span class="hljs-punctuation">}</span>\n<span class="hljs-punctuation">}</span>\n</code></pre>\n<ol start="3">\n<li>修改 pre-commit 钩子：</li>\n</ol>\n<pre><code class="language-sh"><span class="hljs-meta">#!/usr/bin/env sh</span>\n. <span class="hljs-string">&quot;<span class="hljs-subst">$(dirname -- <span class="hljs-string">&quot;<span class="hljs-variable">$0</span>&quot;</span>)</span>/_/husky.sh&quot;</span>\n\nnpx lint-staged\n</code></pre>\n<h3>4.2 多命令组合</h3>\n<pre><code class="language-sh"><span class="hljs-meta">#!/usr/bin/env sh</span>\n. <span class="hljs-string">&quot;<span class="hljs-subst">$(dirname -- <span class="hljs-string">&quot;<span class="hljs-variable">$0</span>&quot;</span>)</span>/_/husky.sh&quot;</span>\n\n<span class="hljs-comment"># 并行运行检查和测试</span>\nnpm run lint &amp; npm run <span class="hljs-built_in">test</span>:unit\n<span class="hljs-built_in">wait</span>\n</code></pre>\n<h2>5. 支持的 Git 钩子类型</h2>\n<p>Husky 支持所有标准 Git 钩子，常用钩子示例：</p>\n<table>\n<thead>\n<tr>\n<th>钩子类型</th>\n<th>典型用途</th>\n<th>示例命令</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>pre-commit</td>\n<td>代码检查</td>\n<td><code>npm run lint</code></td>\n</tr>\n<tr>\n<td>commit-msg</td>\n<td>提交信息校验</td>\n<td><code>commitlint --edit $1</code></td>\n</tr>\n<tr>\n<td>pre-push</td>\n<td>推送前检查</td>\n<td><code>npm run test</code></td>\n</tr>\n<tr>\n<td>post-merge</td>\n<td>合并后操作</td>\n<td><code>npm install</code></td>\n</tr>\n</tbody>\n</table>\n<h2>6. 团队共享配置</h2>\n<h3>6.1 纳入版本控制</h3>\n<p>将 <code>.husky</code> 目录加入 Git：</p>\n<pre><code class="language-sh">git add .husky/\n</code></pre>\n<h3>6.2 跨项目统一配置</h3>\n<p>创建共享配置模板：</p>\n<pre><code>.husky/\n├── _/\n│   └── husky.sh    # 共享的初始化脚本\n├── pre-commit      # 通用预提交钩子\n└── commit-msg      # 通用提交信息钩子\n</code></pre>\n<h2>7. 调试技巧</h2>\n<h3>7.1 查看钩子执行日志</h3>\n<pre><code class="language-sh"><span class="hljs-comment"># 查看详细执行过程</span>\nHUSKY_DEBUG=1 git commit -m <span class="hljs-string">&quot;test&quot;</span>\n</code></pre>\n<h3>7.2 临时跳过钩子</h3>\n<pre><code class="language-sh">git commit --no-verify -m <span class="hljs-string">&quot;紧急提交&quot;</span>\ngit push --no-verify\n</code></pre>\n<h2>8. 性能优化建议</h2>\n<ol>\n<li><strong>最小化钩子任务</strong>  ：只包含必要的检查</li>\n<li><strong>并行执行</strong>  ：使用 <code>&amp;</code> 并行运行独立任务</li>\n<li><strong>增量检查</strong>  ：配合 lint-staged 只检查暂存文件</li>\n<li><strong>缓存机制</strong>  ：对耗时任务实现结果缓存</li>\n</ol>\n<h2>9. 常见问题解决</h2>\n<h3>9.1 钩子不生效</h3>\n<ul>\n<li>确认 <code>husky install</code> 已执行</li>\n<li>检查钩子文件是否有可执行权限</li>\n<li>验证脚本路径是否正确</li>\n</ul>\n<h3>9.2 Windows 兼容性问题</h3>\n<ul>\n<li>确保使用 Git Bash 或 WSL</li>\n<li>脚本使用跨平台兼容语法</li>\n<li>避免路径硬编码</li>\n</ul>\n<h2>10. 与 CI/CD 集成</h2>\n<p>在持续集成环境中自动安装钩子：</p>\n<pre><code class="language-yaml"><span class="hljs-comment"># .gitlab-ci.yml 示例</span>\n<span class="hljs-attr">before_script:</span>\n  <span class="hljs-bullet">-</span> <span class="hljs-string">npm</span> <span class="hljs-string">install</span>\n  <span class="hljs-bullet">-</span> <span class="hljs-string">npx</span> <span class="hljs-string">husky</span> <span class="hljs-string">install</span>\n</code></pre>\n<p>Husky 的这种设计使得 Git 钩子管理变得简单可靠，特别适合现代 JavaScript 项目的开发工作流。通过合理配置，可以确保团队所有成员执行统一的代码质量控制流程。</p>\n</div>'</script></body></html>