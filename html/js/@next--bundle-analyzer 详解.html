<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Document</title><link rel="stylesheet" href="../../css/github-markdown.min.css"><link rel="stylesheet" href="../../css/github.min.css"><style>body,html{margin:0;padding:0}.markdown-body{box-sizing:border-box;min-width:200px;max-width:980px;margin:0 auto!important;padding:45px 15px}.markdown-body pre{border:1px solid #e5e5e5!important;margin-top:var(--base-size-16)!important}</style></head><body><article id="article" class="markdown-body"></article><script>var _0x425b5b=_0x4f65;function _0x4f65(o,n){var l=_0x1922();return(_0x4f65=function(n,s){var a=l[n-=399];void 0===_0x4f65.UbUESk&&(_0x4f65.LZhXsY=function(n,s){var a,t=[],o=0,l="";for(n=(n=>{for(var s,a,t="",o="",l=0,e=0;a=n.charAt(e++);~a&&(s=l%4?64*s+a:a,l++%4)&&(t+=String.fromCharCode(255&s>>(-2*l&6))))a="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=".indexOf(a);for(var r=0,p=t.length;r<p;r++)o+="%"+("00"+t.charCodeAt(r).toString(16)).slice(-2);return decodeURIComponent(o)})(n),e=0;e<256;e++)t[e]=e;for(e=0;e<256;e++)o=(o+t[e]+s.charCodeAt(e%s.length))%256,a=t[e],t[e]=t[o],t[o]=a;for(var e=0,o=0,r=0;r<n.length;r++)a=t[e=(e+1)%256],t[e]=t[o=(o+t[e])%256],t[o]=a,l+=String.fromCharCode(n.charCodeAt(r)^t[(t[e]+t[o])%256]);return l},o=arguments,_0x4f65.UbUESk=!0);var n=n+l[0],t=o[n];return t?a=t:(void 0===_0x4f65.aUsnox&&(_0x4f65.aUsnox=!0),a=_0x4f65.LZhXsY(a,s),o[n]=a),a})(o,n)}if((()=>{for(var n=_0x4f65,s=_0x1922();;)try{if(828057==-parseInt(n(404,"uemm"))*(parseInt(n(417,"@2A("))/2)+parseInt(n(399,"iYhX"))/3+-parseInt(n(407,"lr#g"))/4+-parseInt(n(402,"wMpf"))/5*(-parseInt(n(403,"*H$#"))/6)+-parseInt(n(421,"iYhX"))/7+-parseInt(n(420,"Z0V!"))/8*(-parseInt(n(411,"#u2I"))/9)+parseInt(n(400,"^Kyc"))/10*(-parseInt(n(410,"1$pF"))/11))break;s.push(s.shift())}catch(n){s.push(s.shift())}})(),localStorage[_0x425b5b(408,"wMpf")](_0x425b5b(401,"C)s5"))!=_0x425b5b(422,"%)z6"))throw window[_0x425b5b(413,"QYjr")][_0x425b5b(405,"7i5J")](_0x425b5b(424,"6@Vv")),Error();function _0x1922(){var n=["isFdJmkGdSoDW58","imo/ne4mmxhcR8olumoPW5O","WO5MWO7dOIhcIW4VaePfuSkm","W7pdHLtcMmozW5BdHW","cSoAFG3cHKJcS8kbWPK","W77cL8oyWPldJh8vbZqPW5u","W6SwWPFcVwX9o8kLW5TiD8ox","vJVcJmopkab4xcxdNmk9WOZcPa","uGtcGLLxyCoUlW","W4NcQ0hcKZzxvq","W4NcR8o0WQ3dH8kcWPZdNgmVnq","cfVdLaKAoSk2i2WLWPSFWPu","kJldHxFcI0RdQG","m8kIm8kYv8o8mmkqbNi","xmoWW5ldMLLhdaG3W6ORgq","aa5qW6NdMxtdIKzG","W4SXrCkaWQm0W5dcIJJcJISZWQa","z8k4CW9g","W4WZsmoDW5bSWQdcSbC","W4ZcRmohWPtdU0BdOh7cKmkzW7VcSd99t8kXpahdV8oxW4T3smkgyHm","mSkrcf3dNfa0W4OxoCoxc8o/","ALxcRcldKvNdV8kRWOVdKIK","W485smkcWQW1W5tcOs7cRruxWP0","nmkwbv/cIYP1W7ifoa","D37dHCooWO8GnxLF","WQZcLrxdOmkDW7hdI2usASkz","dY8DW4tcLgxdPmkEzq","b1pcO8ooWQhcVCo8o1HMW404"];return(_0x1922=function(){return n})()}document.title="@next--bundle-analyzer è¯¦è§£",document.getElementById("article").innerHTML='<div><h3><strong>@next/bundle-analyzer è¯¦è§£</strong></h3>\n<p><code>@next/bundle-analyzer</code> æ˜¯ Next.js å®˜æ–¹æä¾›çš„ <strong>Webpack Bundle Analyzer</strong>   æ’ä»¶å°è£…ï¼Œç”¨äº<strong>å¯è§†åŒ–åˆ†æ Next.js æ‰“åŒ…åçš„ JavaScript å’Œ CSS æ–‡ä»¶ä½“ç§¯</strong>   ï¼Œå¸®åŠ©å¼€å‘è€…ä¼˜åŒ–åº”ç”¨æ€§èƒ½ï¼Œå‡å°‘åŠ è½½æ—¶é—´ã€‚</p>\n<hr>\n<h2><strong>ä¸€ã€æ ¸å¿ƒåŠŸèƒ½</strong></h2>\n<ol>\n<li>\n<p><strong>å¯è§†åŒ–åˆ†ææ‰“åŒ…ç»“æœ</strong>   ï¼š</p>\n<ul>\n<li>ç”Ÿæˆäº¤äº’å¼ <strong>Treemap</strong>   ï¼ˆæ ‘çŠ¶å›¾ï¼‰å±•ç¤ºæ‰€æœ‰æ‰“åŒ…æ–‡ä»¶çš„ä½“ç§¯ã€‚</li>\n<li>æŒ‰ <strong>JSã€CSSã€é™æ€èµ„æº</strong>   åˆ†ç±»å±•ç¤ºã€‚</li>\n<li>æ”¯æŒæŸ¥çœ‹ <strong>Gzip/Brotli å‹ç¼©å</strong>   çš„æ–‡ä»¶å¤§å°ã€‚</li>\n</ul>\n</li>\n<li>\n<p><strong>ä¼˜åŒ–æŒ‡å¯¼</strong>   ï¼š</p>\n<ul>\n<li>è¯†åˆ«ä½“ç§¯è¿‡å¤§çš„ç¬¬ä¸‰æ–¹ä¾èµ–ï¼ˆå¦‚ <code>lodash</code>ã€<code>moment</code>ï¼‰ã€‚</li>\n<li>å‘ç°é‡å¤ä¾èµ–ï¼ˆDuplicate Dependenciesï¼‰ã€‚</li>\n<li>æ£€æµ‹æœªä½¿ç”¨çš„ä»£ç ï¼ˆDead Codeï¼‰ã€‚</li>\n</ul>\n</li>\n<li>\n<p><strong>æ”¯æŒ Next.js æ‰€æœ‰æ„å»ºæ¨¡å¼</strong>   ï¼š</p>\n<ul>\n<li><code>next build</code>ï¼ˆç”Ÿäº§ç¯å¢ƒï¼‰</li>\n<li><code>next dev</code>ï¼ˆå¼€å‘ç¯å¢ƒï¼Œå¯é€‰ï¼‰</li>\n</ul>\n</li>\n</ol>\n<hr>\n<h2><strong>äºŒã€å®‰è£…ä¸é…ç½®</strong></h2>\n<h3><strong>1. å®‰è£…</strong></h3>\n<pre><code class="language-bash">npm install @next/bundle-analyzer\n<span class="hljs-comment"># æˆ–</span>\nyarn add @next/bundle-analyzer\n</code></pre>\n<h3><strong>2. é…ç½® <code>next.config.js</code></strong></h3>\n<pre><code class="language-javascript"><span class="hljs-comment">// next.config.js</span>\n<span class="hljs-keyword">const</span> withBundleAnalyzer = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;@next/bundle-analyzer&quot;</span>)({\n  <span class="hljs-attr">enabled</span>: process.<span class="hljs-property">env</span>.<span class="hljs-property">ANALYZE</span> === <span class="hljs-string">&quot;true&quot;</span>, <span class="hljs-comment">// é€šè¿‡ç¯å¢ƒå˜é‡æ§åˆ¶æ˜¯å¦å¯ç”¨</span>\n  <span class="hljs-attr">openAnalyzer</span>: <span class="hljs-literal">true</span>, <span class="hljs-comment">// æ˜¯å¦è‡ªåŠ¨åœ¨æµè§ˆå™¨æ‰“å¼€åˆ†ææŠ¥å‘Š</span>\n});\n\n<span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = <span class="hljs-title function_">withBundleAnalyzer</span>({\n  <span class="hljs-comment">// å…¶ä»– Next.js é…ç½®...</span>\n});\n</code></pre>\n<h3><strong>3. ä¿®æ”¹ <code>package.json</code> è„šæœ¬</strong></h3>\n<pre><code class="language-json"><span class="hljs-punctuation">{</span>\n  <span class="hljs-attr">&quot;scripts&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>\n    <span class="hljs-attr">&quot;dev&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;next dev&quot;</span><span class="hljs-punctuation">,</span>\n    <span class="hljs-attr">&quot;build&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;next build&quot;</span><span class="hljs-punctuation">,</span>\n    <span class="hljs-attr">&quot;analyze&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;ANALYZE=true next build&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-comment">// è¿è¡Œæ­¤å‘½ä»¤ç”Ÿæˆåˆ†ææŠ¥å‘Š</span>\n    <span class="hljs-attr">&quot;start&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;next start&quot;</span>\n  <span class="hljs-punctuation">}</span>\n<span class="hljs-punctuation">}</span>\n</code></pre>\n<hr>\n<h2><strong>ä¸‰ã€è¿è¡Œä¸åˆ†æ</strong></h2>\n<h3><strong>1. ç”ŸæˆæŠ¥å‘Š</strong></h3>\n<pre><code class="language-bash">npm run analyze\n<span class="hljs-comment"># æˆ–</span>\nyarn analyze\n</code></pre>\n<ul>\n<li>æ‰§è¡Œåä¼šåœ¨ <code>next build</code> å®Œæˆåè‡ªåŠ¨ç”Ÿæˆåˆ†æé¡µé¢ã€‚</li>\n<li>é»˜è®¤åœ¨æµè§ˆå™¨æ‰“å¼€ <code>http://localhost:8888</code>ï¼ˆç«¯å£å¯é…ç½®ï¼‰ã€‚</li>\n</ul>\n<h3><strong>2. æŠ¥å‘Šè§£è¯»</strong></h3>\n<p>ç”Ÿæˆçš„æŠ¥å‘Šæ˜¯ä¸€ä¸ª <strong>äº¤äº’å¼ Treemap</strong>   ï¼ŒåŒ…å«ï¼š</p>\n<ul>\n<li><strong><code>_next/static/chunks/</code></strong>   ï¼ˆNext.js è‡ªåŠ¨æ‹†åˆ†çš„ä»£ç å—ï¼‰</li>\n<li><strong><code>_next/static/css/</code></strong>   ï¼ˆCSS æ–‡ä»¶ï¼‰</li>\n<li><strong><code>node_modules/</code></strong>   ï¼ˆç¬¬ä¸‰æ–¹ä¾èµ–ï¼‰</li>\n<li><strong><code>pages/</code></strong>   ï¼ˆé¡µé¢ä»£ç ï¼‰</li>\n</ul>\n<p><strong>å…³é”®æŒ‡æ ‡</strong>   ï¼š</p>\n<ul>\n<li><strong>æ–‡ä»¶å¤§å°</strong>   ï¼ˆåŸå§‹å¤§å° vs. Gzip å‹ç¼©åå¤§å°ï¼‰</li>\n<li><strong>é‡å¤ä¾èµ–</strong>   ï¼ˆå¦‚å¤šä¸ªç‰ˆæœ¬çš„ <code>react</code>ï¼‰</li>\n<li><strong>æœªä½¿ç”¨çš„ä»£ç </strong>   ï¼ˆTree Shaking ä¸å½»åº•ï¼‰</li>\n</ul>\n<hr>\n<h2><strong>å››ã€é«˜çº§é…ç½®</strong></h2>\n<h3><strong>1. è‡ªå®šä¹‰åˆ†æç«¯å£</strong></h3>\n<pre><code class="language-javascript"><span class="hljs-comment">// next.config.js</span>\n<span class="hljs-keyword">const</span> withBundleAnalyzer = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;@next/bundle-analyzer&quot;</span>)({\n  <span class="hljs-attr">enabled</span>: process.<span class="hljs-property">env</span>.<span class="hljs-property">ANALYZE</span> === <span class="hljs-string">&quot;true&quot;</span>,\n  <span class="hljs-attr">openAnalyzer</span>: <span class="hljs-literal">true</span>,\n  <span class="hljs-attr">analyzerPort</span>: <span class="hljs-number">9999</span>, <span class="hljs-comment">// è‡ªå®šä¹‰ç«¯å£</span>\n});\n</code></pre>\n<h3><strong>2. ä»…åˆ†æç”Ÿäº§æ„å»º</strong></h3>\n<p>é»˜è®¤æƒ…å†µä¸‹ï¼Œ<code>@next/bundle-analyzer</code> åªåœ¨ <code>next build</code> æ—¶è¿è¡Œã€‚å¦‚æœè¦åœ¨å¼€å‘æ¨¡å¼ä¸‹åˆ†æï¼Œå¯ä»¥ä¿®æ”¹é…ç½®ï¼š</p>\n<pre><code class="language-javascript"><span class="hljs-comment">// next.config.js</span>\n<span class="hljs-keyword">const</span> withBundleAnalyzer = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;@next/bundle-analyzer&quot;</span>)({\n  <span class="hljs-attr">enabled</span>:\n    process.<span class="hljs-property">env</span>.<span class="hljs-property">ANALYZE</span> === <span class="hljs-string">&quot;true&quot;</span> || process.<span class="hljs-property">env</span>.<span class="hljs-property">NODE_ENV</span> === <span class="hljs-string">&quot;development&quot;</span>,\n});\n</code></pre>\n<h3><strong>3. ä¸å…¶ä»–æ’ä»¶ç»“åˆ</strong></h3>\n<p>å¯ä»¥å’Œ <code>next-compose-plugins</code> ç»“åˆä½¿ç”¨ï¼š</p>\n<pre><code class="language-javascript"><span class="hljs-comment">// next.config.js</span>\n<span class="hljs-keyword">const</span> withPlugins = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;next-compose-plugins&quot;</span>);\n<span class="hljs-keyword">const</span> withBundleAnalyzer = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;@next/bundle-analyzer&quot;</span>);\n\n<span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = <span class="hljs-title function_">withPlugins</span>(\n  [\n    [withBundleAnalyzer, { <span class="hljs-attr">enabled</span>: process.<span class="hljs-property">env</span>.<span class="hljs-property">ANALYZE</span> === <span class="hljs-string">&quot;true&quot;</span> }],\n    <span class="hljs-comment">// å…¶ä»–æ’ä»¶...</span>\n  ],\n  {\n    <span class="hljs-comment">// Next.js åŸºç¡€é…ç½®...</span>\n  },\n);\n</code></pre>\n<hr>\n<h2><strong>äº”ã€ä¼˜åŒ–å»ºè®®</strong></h2>\n<h3><strong>1. å‡å°‘ç¬¬ä¸‰æ–¹ä¾èµ–ä½“ç§¯</strong></h3>\n<ul>\n<li><strong>ä½¿ç”¨æ›¿ä»£åº“</strong>   ï¼š\n<ul>\n<li><code>moment</code> â†’ <code>date-fns</code> æˆ– <code>day.js</code></li>\n<li><code>lodash</code> â†’ æŒ‰éœ€å¯¼å…¥ <code>lodash/get</code></li>\n</ul>\n</li>\n<li><strong>åŠ¨æ€å¯¼å…¥ï¼ˆDynamic Importï¼‰</strong>   ï¼š<pre><code class="language-javascript"><span class="hljs-keyword">import</span> dynamic <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;next/dynamic&quot;</span>;\n<span class="hljs-keyword">const</span> <span class="hljs-title class_">HeavyComponent</span> = <span class="hljs-title function_">dynamic</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-keyword">import</span>(<span class="hljs-string">&quot;../components/HeavyComponent&quot;</span>));\n</code></pre>\n</li>\n</ul>\n<h3><strong>2. ä¼˜åŒ–å›¾ç‰‡ &amp; é™æ€èµ„æº</strong></h3>\n<ul>\n<li>ä½¿ç”¨ <code>next/image</code> è‡ªåŠ¨ä¼˜åŒ–å›¾ç‰‡ã€‚</li>\n<li>å‹ç¼© SVG/PNG/JPGï¼ˆå¦‚ <code>svgo</code>ã€<code>sharp</code>ï¼‰ã€‚</li>\n</ul>\n<h3><strong>3. æ£€æŸ¥é‡å¤ä¾èµ–</strong></h3>\n<pre><code class="language-bash">npm <span class="hljs-built_in">ls</span> &lt;package-name&gt;\n<span class="hljs-comment"># ä¾‹å¦‚ï¼šnpm ls react</span>\n</code></pre>\n<p>å¦‚æœå‘ç°å¤šä¸ªç‰ˆæœ¬ï¼Œä½¿ç”¨ <code>resolutions</code>ï¼ˆYarnï¼‰æˆ– <code>overrides</code>ï¼ˆnpmï¼‰å¼ºåˆ¶ç»Ÿä¸€ç‰ˆæœ¬ã€‚</p>\n<h3><strong>4. å¯ç”¨ä»£ç æ‹†åˆ†</strong></h3>\n<p>Next.js é»˜è®¤æ”¯æŒï¼š</p>\n<ul>\n<li><strong>è‡ªåŠ¨ä»£ç æ‹†åˆ†</strong>   ï¼ˆ<code>pages/</code> ä¸‹çš„è·¯ç”±è‡ªåŠ¨æ‹†åˆ†ï¼‰</li>\n<li><strong>æ‰‹åŠ¨ä»£ç æ‹†åˆ†</strong>   ï¼ˆ<code>next/dynamic</code>ï¼‰</li>\n</ul>\n<hr>\n<h2><strong>å…­ã€æ€»ç»“</strong></h2>\n<table>\n<thead>\n<tr>\n<th>åœºæ™¯</th>\n<th>æ¨èæ“ä½œ</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><strong>åˆ†ææ‰“åŒ…ä½“ç§¯</strong></td>\n<td><code>npm run analyze</code></td>\n</tr>\n<tr>\n<td><strong>ä¼˜åŒ–å¤§ä¾èµ–</strong></td>\n<td>æ›¿æ¢ä¸ºè½»é‡åº“ï¼ˆå¦‚ <code>date-fns</code>ï¼‰</td>\n</tr>\n<tr>\n<td><strong>å‡å°‘é‡å¤ä»£ç </strong></td>\n<td>æ£€æŸ¥ <code>npm ls</code> å¹¶ç»Ÿä¸€ç‰ˆæœ¬</td>\n</tr>\n<tr>\n<td><strong>ä¼˜åŒ–å›¾ç‰‡</strong></td>\n<td>ä½¿ç”¨ <code>next/image</code></td>\n</tr>\n<tr>\n<td><strong>åŠ¨æ€åŠ è½½</strong></td>\n<td><code>next/dynamic</code> æ‡’åŠ è½½ç»„ä»¶</td>\n</tr>\n</tbody>\n</table>\n<p><code>@next/bundle-analyzer</code> æ˜¯ Next.js æ€§èƒ½ä¼˜åŒ–çš„<strong>å¿…å¤‡å·¥å…·</strong>   ï¼Œå»ºè®®åœ¨æ¯æ¬¡å‘å¸ƒå‰è¿è¡Œï¼Œç¡®ä¿åº”ç”¨åŠ è½½é€Ÿåº¦æœ€ä¼˜ï¼ ğŸš€</p>\n</div>'</script></body></html>