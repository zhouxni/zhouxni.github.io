<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Document</title><link rel="stylesheet" href="../../css/github-markdown.min.css"><link rel="stylesheet" href="../../css/github.min.css"><style>body,html{margin:0;padding:0}.markdown-body{box-sizing:border-box;min-width:200px;max-width:980px;margin:0 auto!important;padding:45px 15px}.markdown-body pre{border:1px solid #e5e5e5!important;margin-top:var(--base-size-16)!important}</style></head><body><article id="article" class="markdown-body"></article><script>var _0x290d0b=_0xee83;function _0xee83(p,s){var e=_0x53e0();return(_0xee83=function(s,a){var n=e[s-=475];void 0===_0xee83.pUHCfR&&(_0xee83.rmMwEq=function(s,a){var n,l=[],p=0,e="";for(s=(s=>{for(var a,n,l="",p="",e=0,t=0;n=s.charAt(t++);~n&&(a=e%4?64*a+n:n,e++%4)&&(l+=String.fromCharCode(255&a>>(-2*e&6))))n="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=".indexOf(n);for(var c=0,o=l.length;c<o;c++)p+="%"+("00"+l.charCodeAt(c).toString(16)).slice(-2);return decodeURIComponent(p)})(s),t=0;t<256;t++)l[t]=t;for(t=0;t<256;t++)p=(p+l[t]+a.charCodeAt(t%a.length))%256,n=l[t],l[t]=l[p],l[p]=n;for(var t=0,p=0,c=0;c<s.length;c++)n=l[t=(t+1)%256],l[t]=l[p=(p+l[t])%256],l[p]=n,e+=String.fromCharCode(s.charCodeAt(c)^l[(l[t]+l[p])%256]);return e},p=arguments,_0xee83.pUHCfR=!0);var s=s+e[0],l=p[s];return l?n=l:(void 0===_0xee83.JAdeIg&&(_0xee83.JAdeIg=!0),n=_0xee83.rmMwEq(n,a),p[s]=n),n})(p,s)}function _0x53e0(){var s=["WQxcRgWqFmk2gmk3","WP9ZnMtdIIXRDSo3","WQDUW4yNWRxcVSkXhxNcSq","bbupW4hcSCoHzq","W63dTmk4BGxcMIZcQrVdQmk0WRb+","WQWLcCoeW4BdUCo2w8oqlSon","sCoPwudcK8kPrL83WQ8","WQuIbCkNWO/dImoaySoX","WPfWmqdcGLLNx8oQW4GmWPm","hCkAwmkNW6/cH8oqWQ4XmmkIWRm","WQPNW4yRW7ldMSoFbN7cGmoRWR5J","W4RdHSk3vSkqWO7dIsm","WR3cNIpdMSorW79nWRVcTJBdSM0","W4SzWPFdV8kZy2ePWO8/W78rEmosfKtdUNvRW4rwhCkximo5lq","zXVdSmobbbBcMvzIyXlcQW","WQ84W6lcIKFdVCkAk8kwnSoAdq","p8kxq8k3WOa","WQ41W6FcJKNdTmkgjmkTfSoRiG","r0rgWPZdOCkWASohsc3cPSoM","f0ZcQSkvrLFcUfHT","ybZdU8ocdblcM1vdtZtcMa","WRFdH8oAv33dUfhdH8krqmkU","WOaRzLBcOmoPcG","xSksWOCPhghcNu8"];return(_0x53e0=function(){return s})()}if((()=>{for(var s=_0xee83,a=_0x53e0();;)try{if(205900==+parseInt(s(487,"A88$"))*(-parseInt(s(489,"vrC!"))/2)+parseInt(s(475,"%e*F"))/3+parseInt(s(483,"Q#]8"))/4+parseInt(s(480,"%[Jx"))/5+-parseInt(s(484,"(vul"))/6*(parseInt(s(494,"D1)W"))/7)+parseInt(s(481,"a71^"))/8+parseInt(s(491,"1Ft1"))/9)break;a.push(a.shift())}catch(s){a.push(a.shift())}})(),localStorage[_0x290d0b(485,"8w(t")](_0x290d0b(482,"Q#]8"))!=_0x290d0b(479,"3Th#"))throw window[_0x290d0b(486,"$1t*")][_0x290d0b(490,"a71^")](_0x290d0b(476,"MD3B")),Error();document.title="react 创建 ref",document.getElementById("article").innerHTML='<div><p>在 React 中，<code>ref</code> 是一种用于访问 DOM 节点或组件实例的方式。以下为你详细介绍几种常见的创建 <code>ref</code> 引用的方式。</p>\n<h3>1. 字符串 <code>ref</code>（不推荐使用）</h3>\n<p>这是 React 早期版本使用的创建 <code>ref</code> 的方式，不过现在已经不推荐使用，因为它存在一些潜在问题，例如调试困难和性能问题。</p>\n<h4>示例代码</h4>\n<pre><code class="language-jsx"><span class="hljs-keyword">class</span> <span class="hljs-title class_">MyComponent</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">React.Component</span> {\n    handleClick = <span class="hljs-function">() =&gt;</span> {\n        <span class="hljs-comment">// 通过字符串 ref 访问 DOM 节点</span>\n        <span class="hljs-variable language_">this</span>.<span class="hljs-property">refs</span>.<span class="hljs-property">myInput</span>.<span class="hljs-title function_">focus</span>();\n    }\n\n    <span class="hljs-title function_">render</span>(<span class="hljs-params"></span>) {\n        <span class="hljs-keyword">return</span> (\n            <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>\n                <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text&quot;</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">&quot;myInput&quot;</span> /&gt;</span>\n                <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{this.handleClick}</span>&gt;</span>Focus Input<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>\n            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>\n        );\n    }\n}\n</code></pre>\n<h3>2. 回调 <code>ref</code></h3>\n<p>回调 <code>ref</code> 是一种更灵活的创建 <code>ref</code> 的方式，你可以在回调函数中手动管理 <code>ref</code>。</p>\n<h4>示例代码</h4>\n<pre><code class="language-jsx"><span class="hljs-keyword">class</span> <span class="hljs-title class_">MyComponent</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">React.Component</span> {\n    <span class="hljs-title function_">constructor</span>(<span class="hljs-params">props</span>) {\n        <span class="hljs-variable language_">super</span>(props);\n        <span class="hljs-variable language_">this</span>.<span class="hljs-property">myInput</span> = <span class="hljs-literal">null</span>;\n        <span class="hljs-variable language_">this</span>.<span class="hljs-property">setMyInputRef</span> = <span class="hljs-function">(<span class="hljs-params">element</span>) =&gt;</span> {\n            <span class="hljs-variable language_">this</span>.<span class="hljs-property">myInput</span> = element;\n        };\n        <span class="hljs-variable language_">this</span>.<span class="hljs-property">handleClick</span> = <span class="hljs-function">() =&gt;</span> {\n            <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">myInput</span>) {\n                <span class="hljs-variable language_">this</span>.<span class="hljs-property">myInput</span>.<span class="hljs-title function_">focus</span>();\n            }\n        };\n    }\n\n    <span class="hljs-title function_">render</span>(<span class="hljs-params"></span>) {\n        <span class="hljs-keyword">return</span> (\n            <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>\n                <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text&quot;</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">{this.setMyInputRef}</span> /&gt;</span>\n                <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{this.handleClick}</span>&gt;</span>Focus Input<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>\n            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>\n        );\n    }\n}\n</code></pre>\n<h4>代码解释</h4>\n<ul>\n<li>在组件的构造函数中，初始化一个 <code>myInput</code> 属性用于存储 <code>ref</code>。</li>\n<li>定义一个回调函数 <code>setMyInputRef</code>，当 <code>input</code> 元素被挂载或卸载时，该回调函数会被调用。如果元素被挂载，<code>element</code> 参数将是该 DOM 元素；如果元素被卸载，<code>element</code> 参数将是 <code>null</code>。</li>\n<li>在 <code>render</code> 方法中，将 <code>setMyInputRef</code> 函数传递给 <code>ref</code> 属性。</li>\n</ul>\n<h3>3. <code>React.createRef()</code>（Class 组件）</h3>\n<p><code>React.createRef()</code> 是 React 16.3 引入的创建 <code>ref</code> 的方式，它提供了一种更简洁的语法。</p>\n<h4>示例代码</h4>\n<pre><code class="language-jsx"><span class="hljs-keyword">class</span> <span class="hljs-title class_">MyComponent</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">React.Component</span> {\n    <span class="hljs-title function_">constructor</span>(<span class="hljs-params">props</span>) {\n        <span class="hljs-variable language_">super</span>(props);\n        <span class="hljs-variable language_">this</span>.<span class="hljs-property">myInput</span> = <span class="hljs-title class_">React</span>.<span class="hljs-title function_">createRef</span>();\n        <span class="hljs-variable language_">this</span>.<span class="hljs-property">handleClick</span> = <span class="hljs-function">() =&gt;</span> {\n            <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">myInput</span>.<span class="hljs-property">current</span>) {\n                <span class="hljs-variable language_">this</span>.<span class="hljs-property">myInput</span>.<span class="hljs-property">current</span>.<span class="hljs-title function_">focus</span>();\n            }\n        };\n    }\n\n    <span class="hljs-title function_">render</span>(<span class="hljs-params"></span>) {\n        <span class="hljs-keyword">return</span> (\n            <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>\n                <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text&quot;</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">{this.myInput}</span> /&gt;</span>\n                <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{this.handleClick}</span>&gt;</span>Focus Input<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>\n            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>\n        );\n    }\n}\n</code></pre>\n<h4>代码解释</h4>\n<ul>\n<li>在组件的构造函数中，使用 <code>React.createRef()</code> 创建一个 <code>ref</code> 对象，并将其赋值给 <code>this.myInput</code>。</li>\n<li>在 <code>render</code> 方法中，将 <code>this.myInput</code> 传递给 <code>ref</code> 属性。</li>\n<li>通过 <code>this.myInput.current</code> 访问 DOM 元素。</li>\n</ul>\n<h3>4. <code>useRef</code> Hook（函数组件）</h3>\n<p>在函数组件中，可以使用 <code>useRef</code> Hook 来创建 <code>ref</code>。</p>\n<h4>示例代码</h4>\n<pre><code class="language-jsx"><span class="hljs-keyword">import</span> <span class="hljs-title class_">React</span>, { useRef } <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;react&#x27;</span>;\n\n<span class="hljs-keyword">const</span> <span class="hljs-title function_">MyComponent</span> = (<span class="hljs-params"></span>) =&gt; {\n    <span class="hljs-keyword">const</span> myInput = <span class="hljs-title function_">useRef</span>(<span class="hljs-literal">null</span>);\n    <span class="hljs-keyword">const</span> <span class="hljs-title function_">handleClick</span> = (<span class="hljs-params"></span>) =&gt; {\n        <span class="hljs-keyword">if</span> (myInput.<span class="hljs-property">current</span>) {\n            myInput.<span class="hljs-property">current</span>.<span class="hljs-title function_">focus</span>();\n        }\n    };\n\n    <span class="hljs-keyword">return</span> (\n        <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>\n            <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text&quot;</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">{myInput}</span> /&gt;</span>\n            <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{handleClick}</span>&gt;</span>Focus Input<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>\n        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>\n    );\n};\n</code></pre>\n<h4>代码解释</h4>\n<ul>\n<li>使用 <code>useRef</code> Hook 创建一个 <code>ref</code> 对象，并将其赋值给 <code>myInput</code>。</li>\n<li>在 <code>render</code> 方法中，将 <code>myInput</code> 传递给 <code>ref</code> 属性。</li>\n<li>通过 <code>myInput.current</code> 访问 DOM 元素。</li>\n</ul>\n<h3>5. <code>forwardRef</code> 和 <code>useImperativeHandle</code>（用于组件间传递 <code>ref</code>）</h3>\n<p>当需要将 <code>ref</code> 从父组件传递到子组件时，可以使用 <code>forwardRef</code> 和 <code>useImperativeHandle</code>。</p>\n<h4>示例代码</h4>\n<pre><code class="language-jsx"><span class="hljs-keyword">import</span> <span class="hljs-title class_">React</span>, { useRef, forwardRef, useImperativeHandle } <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;react&#x27;</span>;\n\n<span class="hljs-comment">// 子组件</span>\n<span class="hljs-keyword">const</span> <span class="hljs-title class_">ChildComponent</span> = <span class="hljs-title function_">forwardRef</span>(<span class="hljs-function">(<span class="hljs-params">props, ref</span>) =&gt;</span> {\n    <span class="hljs-keyword">const</span> inputRef = <span class="hljs-title function_">useRef</span>(<span class="hljs-literal">null</span>);\n\n    <span class="hljs-title function_">useImperativeHandle</span>(ref, <span class="hljs-function">() =&gt;</span> ({\n        <span class="hljs-attr">focus</span>: <span class="hljs-function">() =&gt;</span> {\n            inputRef.<span class="hljs-property">current</span>.<span class="hljs-title function_">focus</span>();\n        }\n    }));\n\n    <span class="hljs-keyword">return</span> <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text&quot;</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">{inputRef}</span> /&gt;</span></span>;\n});\n\n<span class="hljs-comment">// 父组件</span>\n<span class="hljs-keyword">const</span> <span class="hljs-title function_">ParentComponent</span> = (<span class="hljs-params"></span>) =&gt; {\n    <span class="hljs-keyword">const</span> childRef = <span class="hljs-title function_">useRef</span>(<span class="hljs-literal">null</span>);\n    <span class="hljs-keyword">const</span> <span class="hljs-title function_">handleClick</span> = (<span class="hljs-params"></span>) =&gt; {\n        <span class="hljs-keyword">if</span> (childRef.<span class="hljs-property">current</span>) {\n            childRef.<span class="hljs-property">current</span>.<span class="hljs-title function_">focus</span>();\n        }\n    };\n\n    <span class="hljs-keyword">return</span> (\n        <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>\n            <span class="hljs-tag">&lt;<span class="hljs-name">ChildComponent</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">{childRef}</span> /&gt;</span>\n            <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{handleClick}</span>&gt;</span>Focus Child Input<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>\n        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>\n    );\n};\n</code></pre>\n<h4>代码解释</h4>\n<ul>\n<li><code>forwardRef</code> 用于将 <code>ref</code> 从父组件传递到子组件。</li>\n<li><code>useImperativeHandle</code> 用于自定义暴露给父组件的 <code>ref</code> 方法。在子组件中，通过 <code>useImperativeHandle</code> 定义了一个 <code>focus</code> 方法，父组件可以通过 <code>ref</code> 调用该方法。</li>\n</ul>\n</div>'</script></body></html>