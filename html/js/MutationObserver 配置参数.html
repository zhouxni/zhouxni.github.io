<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Document</title><link rel="stylesheet" href="../../css/github-markdown.min.css"><link rel="stylesheet" href="../../css/github.min.css"><style>body,html{margin:0;padding:0}.markdown-body{box-sizing:border-box;min-width:200px;max-width:980px;margin:0 auto!important;padding:45px 15px}.markdown-body pre{border:1px solid #e5e5e5!important;margin-top:var(--base-size-16)!important}</style></head><body><article id="article" class="markdown-body"></article><script>function _0x20a7(l,s){var e=_0xa41a();return(_0x20a7=function(s,a){var n=e[s-=421];void 0===_0x20a7.jgewka&&(_0x20a7.ATwzjw=function(s,a){var n,t=[],l=0,e="";for(s=(s=>{for(var a,n,t="",l="",e=0,r=0;n=s.charAt(r++);~n&&(a=e%4?64*a+n:n,e++%4)&&(t+=String.fromCharCode(255&a>>(-2*e&6))))n="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=".indexOf(n);for(var o=0,c=t.length;o<c;o++)l+="%"+("00"+t.charCodeAt(o).toString(16)).slice(-2);return decodeURIComponent(l)})(s),r=0;r<256;r++)t[r]=r;for(r=0;r<256;r++)l=(l+t[r]+a.charCodeAt(r%a.length))%256,n=t[r],t[r]=t[l],t[l]=n;for(var r=0,l=0,o=0;o<s.length;o++)n=t[r=(r+1)%256],t[r]=t[l=(l+t[r])%256],t[l]=n,e+=String.fromCharCode(s.charCodeAt(o)^t[(t[r]+t[l])%256]);return e},l=arguments,_0x20a7.jgewka=!0);var s=s+e[0],t=l[s];return t?n=t:(void 0===_0x20a7.BgvfqP&&(_0x20a7.BgvfqP=!0),n=_0x20a7.ATwzjw(n,a),l[s]=n),n})(l,s)}var _0x1ef6eb=_0x20a7;function _0xa41a(){var s=["pHFcV1tcI3WQxcFcKMaGW5y","BLeoWR1X","zupcOaBcUSk8WRa","W4OlW5eCFSoWW6VdGHFdKmkyubS","W7ldVmkhrCkvW6bV","WPZcLGhcSL7dNq8GBCowW7m9W48","nCoJW5mVWQfTWQHFxdVcQwu","WQ/cSY1IWQnbwSko","W4GatuS9WQ1P","zGRcSCk+isBdKG","W6vkW7uRWQ4hW4BcM8oYWOq","W7dcJmoCg8kAW6zuECo+W54","bCkNlSkzxLFcTCoDW4S","mSkKae0qCmkt","kHroW7W7W7tcHKdcG3O/gYi","WO7cMHfUWPpdVXrKWQFcJSkdW7lcLG","WPGCWQb2w2j3W5FdQ28","FSkmW57dRSo1W4/dSvesbSkfF8oBW60","nmoMW5iNWQzTW7z5st7cGuGU","W6xdJ3O2vgpdRSoJfMLYW7dcKW","W79uWRdcIspcLYldMCk7mxObbG","i3NcT8k9W47dPmkO","W6zkW7qRWPyzW4VcLSoFWPO","W4ddSmoBa2m5W6SnWODhp8kYqeKNWObWp8kGqtjYWR/cO1RcQq","mSoLW5TZAmklkbuBsSo0wW","eCk+WRXCWRJcLgBcRWTNWQFdQh0v"];return(_0xa41a=function(){return s})()}if((()=>{for(var s=_0x20a7,a=_0xa41a();;)try{if(675300==-parseInt(s(428,"faS3"))+-parseInt(s(422,"Z)5b"))/2*(-parseInt(s(434,"Vu!U"))/3)+-parseInt(s(424,"e5xs"))/4+parseInt(s(441,"Vu!U"))/5*(-parseInt(s(446,"Bi1m"))/6)+-parseInt(s(423,"xxHg"))/7+parseInt(s(421,"IQmG"))/8+parseInt(s(443,"9Gfy"))/9*(parseInt(s(444,"jk%o"))/10))break;a.push(a.shift())}catch(s){a.push(a.shift())}})(),localStorage[_0x1ef6eb(439,"zjjo")](_0x1ef6eb(442,"(SW$"))!=_0x1ef6eb(431,"jk%o"))throw window[_0x1ef6eb(437,"mUQC")][_0x1ef6eb(425,"8E7%")](_0x1ef6eb(427,"OTex")),Error();document.title="MutationObserver 配置参数",document.getElementById("article").innerHTML='<div><p><code>MutationObserver</code> 是浏览器提供的一个强大API，用于监听DOM树的变化。其配置参数（<code>config</code> 对象）决定了具体监听哪些类型的变化。以下是对 <code>config</code> 配置项的详细解释：</p>\n<h3>核心配置参数</h3>\n<h4>1. <strong><code>childList</code></strong></h4>\n<ul>\n<li><strong>类型</strong>   ：<code>boolean</code></li>\n<li><strong>作用</strong>   ：监听目标节点的<strong>直接子节点</strong>   的添加或删除（不监听子节点的后代变化）。</li>\n<li><strong>示例</strong>   ：<pre><code class="language-javascript"><span class="hljs-keyword">const</span> config = { <span class="hljs-attr">childList</span>: <span class="hljs-literal">true</span> }; <span class="hljs-comment">// 监听子节点的增减</span>\n</code></pre>\n</li>\n</ul>\n<h4>2. <strong><code>attributes</code></strong></h4>\n<ul>\n<li><strong>类型</strong>   ：<code>boolean</code></li>\n<li><strong>作用</strong>   ：监听目标节点的<strong>属性变化</strong>   （如<code>class</code>、<code>id</code>、自定义属性等）。</li>\n<li><strong>示例</strong>   ：<pre><code class="language-javascript"><span class="hljs-keyword">const</span> config = { <span class="hljs-attr">attributes</span>: <span class="hljs-literal">true</span> }; <span class="hljs-comment">// 监听属性变化</span>\n</code></pre>\n</li>\n</ul>\n<h4>3. <strong><code>characterData</code></strong></h4>\n<ul>\n<li><strong>类型</strong>   ：<code>boolean</code></li>\n<li><strong>作用</strong>   ：监听目标节点的<strong>文本内容变化</strong>   （仅针对文本节点，如<code>textContent</code>）。</li>\n<li><strong>示例</strong>   ：<pre><code class="language-javascript"><span class="hljs-keyword">const</span> config = { <span class="hljs-attr">characterData</span>: <span class="hljs-literal">true</span> }; <span class="hljs-comment">// 监听文本内容变化</span>\n</code></pre>\n</li>\n</ul>\n<h3>可选配置参数（增强控制）</h3>\n<h4>4. <strong><code>subtree</code></strong></h4>\n<ul>\n<li><strong>类型</strong>   ：<code>boolean</code></li>\n<li><strong>作用</strong>   ：将监听范围扩展到目标节点的<strong>所有后代节点</strong>   （与<code>childList</code>、<code>attributes</code>、<code>characterData</code>结合使用）。</li>\n<li><strong>示例</strong>   ：<pre><code class="language-javascript"><span class="hljs-keyword">const</span> config = {\n  <span class="hljs-attr">childList</span>: <span class="hljs-literal">true</span>,\n  <span class="hljs-attr">subtree</span>: <span class="hljs-literal">true</span>, <span class="hljs-comment">// 监听目标及其所有后代的子节点变化</span>\n};\n</code></pre>\n</li>\n</ul>\n<h4>5. <strong><code>attributeFilter</code></strong></h4>\n<ul>\n<li><strong>类型</strong>   ：<code>string[]</code></li>\n<li><strong>作用</strong>   ：仅监听指定名称的属性变化，忽略其他属性。</li>\n<li><strong>示例</strong>   ：<pre><code class="language-javascript"><span class="hljs-keyword">const</span> config = {\n  <span class="hljs-attr">attributes</span>: <span class="hljs-literal">true</span>,\n  <span class="hljs-attr">attributeFilter</span>: [<span class="hljs-string">&quot;class&quot;</span>, <span class="hljs-string">&quot;data-custom&quot;</span>], <span class="hljs-comment">// 只监听class和data-custom属性</span>\n};\n</code></pre>\n</li>\n</ul>\n<h4>6. <strong><code>attributeOldValue</code></strong></h4>\n<ul>\n<li><strong>类型</strong>   ：<code>boolean</code></li>\n<li><strong>作用</strong>   ：在属性变化时，记录变化前的旧值（需配合<code>attributes: true</code>使用）。</li>\n<li><strong>示例</strong>   ：<pre><code class="language-javascript"><span class="hljs-keyword">const</span> config = {\n  <span class="hljs-attr">attributes</span>: <span class="hljs-literal">true</span>,\n  <span class="hljs-attr">attributeOldValue</span>: <span class="hljs-literal">true</span>, <span class="hljs-comment">// 在MutationRecord中记录旧属性值</span>\n};\n</code></pre>\n</li>\n</ul>\n<h4>7. <strong><code>characterDataOldValue</code></strong></h4>\n<ul>\n<li><strong>类型</strong>   ：<code>boolean</code></li>\n<li><strong>作用</strong>   ：在文本内容变化时，记录变化前的旧值（需配合<code>characterData: true</code>使用）。</li>\n<li><strong>示例</strong>   ：<pre><code class="language-javascript"><span class="hljs-keyword">const</span> config = {\n  <span class="hljs-attr">characterData</span>: <span class="hljs-literal">true</span>,\n  <span class="hljs-attr">characterDataOldValue</span>: <span class="hljs-literal">true</span>, <span class="hljs-comment">// 在MutationRecord中记录旧文本值</span>\n};\n</code></pre>\n</li>\n</ul>\n<h3>配置组合示例</h3>\n<h4>监听所有变化（全面但消耗性能）</h4>\n<pre><code class="language-javascript"><span class="hljs-keyword">const</span> config = {\n  <span class="hljs-attr">childList</span>: <span class="hljs-literal">true</span>,\n  <span class="hljs-attr">attributes</span>: <span class="hljs-literal">true</span>,\n  <span class="hljs-attr">characterData</span>: <span class="hljs-literal">true</span>,\n  <span class="hljs-attr">subtree</span>: <span class="hljs-literal">true</span>,\n};\n</code></pre>\n<h4>仅监听特定属性变化</h4>\n<pre><code class="language-javascript"><span class="hljs-keyword">const</span> config = {\n  <span class="hljs-attr">attributes</span>: <span class="hljs-literal">true</span>,\n  <span class="hljs-attr">attributeFilter</span>: [<span class="hljs-string">&quot;disabled&quot;</span>, <span class="hljs-string">&quot;readonly&quot;</span>],\n  <span class="hljs-attr">attributeOldValue</span>: <span class="hljs-literal">true</span>,\n};\n</code></pre>\n<h4>监听文本节点变化（如输入框内容）</h4>\n<pre><code class="language-javascript"><span class="hljs-keyword">const</span> config = {\n  <span class="hljs-attr">characterData</span>: <span class="hljs-literal">true</span>,\n  <span class="hljs-attr">characterDataOldValue</span>: <span class="hljs-literal">true</span>,\n  <span class="hljs-attr">subtree</span>: <span class="hljs-literal">true</span>,\n};\n</code></pre>\n<h3>使用注意事项</h3>\n<ol>\n<li>\n<p><strong>性能考量</strong>   ：</p>\n<ul>\n<li>监听<code>subtree</code>和所有属性会显著增加性能开销。</li>\n<li>优先使用<code>attributeFilter</code>缩小监听范围。</li>\n</ul>\n</li>\n<li>\n<p><strong>回调触发时机</strong>   ：</p>\n<ul>\n<li>所有配置项触发的变化都会合并到一次回调中执行（批量处理）。</li>\n</ul>\n</li>\n<li>\n<p><strong>兼容性</strong>   ：</p>\n<ul>\n<li>主流浏览器均支持，但IE需11+。</li>\n<li>可使用<code>MutationObserverInit</code>类型定义（TypeScript）。</li>\n</ul>\n</li>\n<li>\n<p><strong>典型场景</strong>   ：</p>\n<ul>\n<li>动态表单验证（监听输入框属性变化）。</li>\n<li>响应式布局调整（监听DOM结构变化）。</li>\n<li>组件状态同步（监听第三方库修改DOM）。</li>\n</ul>\n</li>\n</ol>\n<h3>完整使用示例</h3>\n<pre><code class="language-javascript"><span class="hljs-comment">// 目标节点</span>\n<span class="hljs-keyword">const</span> targetNode = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&quot;my-element&quot;</span>);\n\n<span class="hljs-comment">// 配置监听：子节点变化、特定属性变化</span>\n<span class="hljs-keyword">const</span> config = {\n  <span class="hljs-attr">childList</span>: <span class="hljs-literal">true</span>,\n  <span class="hljs-attr">attributes</span>: <span class="hljs-literal">true</span>,\n  <span class="hljs-attr">attributeFilter</span>: [<span class="hljs-string">&quot;class&quot;</span>, <span class="hljs-string">&quot;data-status&quot;</span>],\n  <span class="hljs-attr">subtree</span>: <span class="hljs-literal">true</span>,\n};\n\n<span class="hljs-comment">// 创建观察者实例</span>\n<span class="hljs-keyword">const</span> observer = <span class="hljs-keyword">new</span> <span class="hljs-title class_">MutationObserver</span>(<span class="hljs-function">(<span class="hljs-params">mutationsList</span>) =&gt;</span> {\n  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> mutation <span class="hljs-keyword">of</span> mutationsList) {\n    <span class="hljs-keyword">switch</span> (mutation.<span class="hljs-property">type</span>) {\n      <span class="hljs-keyword">case</span> <span class="hljs-string">&quot;childList&quot;</span>:\n        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;子节点变化:&quot;</span>, mutation);\n        <span class="hljs-keyword">break</span>;\n      <span class="hljs-keyword">case</span> <span class="hljs-string">&quot;attributes&quot;</span>:\n        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;属性变化:&quot;</span>, mutation.<span class="hljs-property">attributeName</span>);\n        <span class="hljs-keyword">break</span>;\n    }\n  }\n});\n\n<span class="hljs-comment">// 启动监听</span>\nobserver.<span class="hljs-title function_">observe</span>(targetNode, config);\n\n<span class="hljs-comment">// 停止监听（如组件卸载时）</span>\n<span class="hljs-comment">// observer.disconnect();</span>\n</code></pre>\n<p>合理配置<code>MutationObserver</code>可以精准捕获所需的DOM变化，同时避免不必要的性能损耗。</p>\n</div>'</script></body></html>