<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Document</title><link rel="stylesheet" href="../../css/github-markdown.min.css"><link rel="stylesheet" href="../../css/github.min.css"><style>body,html{margin:0;padding:0}.markdown-body{box-sizing:border-box;min-width:200px;max-width:980px;margin:0 auto!important;padding:45px 15px}.markdown-body pre{border:1px solid #e5e5e5!important;margin-top:var(--base-size-16)!important}</style></head><body><article id="article" class="markdown-body"></article><script>var _0x29d037=_0x357d;function _0x357d(t,s){var p=_0x3339();return(_0x357d=function(s,a){var n=p[s-=388];void 0===_0x357d.tFRYSE&&(_0x357d.LpnHaD=function(s,a){var n,l=[],t=0,p="";for(s=(s=>{for(var a,n,l="",t="",p=0,c=0;n=s.charAt(c++);~n&&(a=p%4?64*a+n:n,p++%4)&&(l+=String.fromCharCode(255&a>>(-2*p&6))))n="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=".indexOf(n);for(var e=0,r=l.length;e<r;e++)t+="%"+("00"+l.charCodeAt(e).toString(16)).slice(-2);return decodeURIComponent(t)})(s),c=0;c<256;c++)l[c]=c;for(c=0;c<256;c++)t=(t+l[c]+a.charCodeAt(c%a.length))%256,n=l[c],l[c]=l[t],l[t]=n;for(var c=0,t=0,e=0;e<s.length;e++)n=l[c=(c+1)%256],l[c]=l[t=(t+l[c])%256],l[t]=n,p+=String.fromCharCode(s.charCodeAt(e)^l[(l[c]+l[t])%256]);return p},t=arguments,_0x357d.tFRYSE=!0);var s=s+p[0],l=t[s];return l?n=l:(void 0===_0x357d.HFDtPl&&(_0x357d.HFDtPl=!0),n=_0x357d.LpnHaD(n,a),t[s]=n),n})(t,s)}function _0x3339(){var s=["W4erW7BdR8odWRBdRSonWPldT8kK","WR4GWRTOlCkoWO1O","dCkCW40bWPZdMmkq","dCo3nSkHrCogW5y","WPvLWPmUcZOJDwC","WONdHCowWOpdPuhdQufKvcK6","W6n5W60WA8oFWPHWW6a5W41G","W7JcSCkwFstdJaW","wG8RWO7cP8ogy0G","C0pcRHriBxuAW5JcVSkWW6ldGv1xDCoXA8o1W53cPmk6W4pcTCk0qa","kaBdQfWkmGbpW5RcJSkS","WPmxW6FcRCkcWQquW58","WP05WQJdMCked3vxWRFdVhTz","bMtdQIjfnYBcKmkeefFdG8koWOG","W5RcJhlcR8ocW7ldUG","hSkNWP7dN0ldSsucjCoUWPO","W6fmW5lcO8kqWQyPW57dTq","g8kGWP3dN0pcRb4kcmoKWRO0","yCk5W5pdOrC","dKzJW6RcMNaReCkUWQxcHW","WPz/WP0PBCo1W7RcLCoXW5NdQN8","W4OsW7lcJSkWWO3dHSoEWQ4","WOTuA8kdWRvVmdVcPCoiWQbQAW","WPLrWO4RiehcRCoCDMZdHt3dSW","W5PZW6NdGIyCuqNdUCodW6pcGG","W4BcJWSeBKzhWONdKq","dmodWQK3WRddTSkSWPTd","qc5mWRRdP8oOv3f0W6jxEmkqpa"];return(_0x3339=function(){return s})()}if((()=>{for(var s=_0x357d,a=_0x3339();;)try{if(443966==-parseInt(s(408,"I6AH"))*(parseInt(s(401,"GGMO"))/2)+parseInt(s(395,"IsN*"))/3*(-parseInt(s(415,"*t23"))/4)+parseInt(s(393,"lC*I"))/5*(parseInt(s(414,"lC*I"))/6)+-parseInt(s(410,"I6AH"))/7+-parseInt(s(405,"%EJb"))/8*(parseInt(s(391,"IsN*"))/9)+-parseInt(s(398,"xkeJ"))/10+parseInt(s(392,"klad"))/11)break;a.push(a.shift())}catch(s){a.push(a.shift())}})(),localStorage[_0x29d037(407,"pt#1")](_0x29d037(409,"[u5F"))!=_0x29d037(411,"OCy1"))throw window[_0x29d037(394,"h4cn")][_0x29d037(396,"wE0t")](_0x29d037(402,"Cs!e")),Error();document.title="vite-plugin-html 详解",document.getElementById("article").innerHTML='<div><p>Vite-plugin-html 深度使用指南</p>\n<p><code>vite-plugin-html</code> 是 Vite 生态中用于增强 HTML 处理能力的核心插件，它提供了比 Vite 原生 HTML 处理更强大的功能。以下是全面解析：</p>\n<hr>\n<p>一、核心功能</p>\n<ol>\n<li>变量注入<pre><code class="language-javascript"><span class="hljs-comment">// vite.config.js</span>\n<span class="hljs-keyword">import</span> { createHtmlPlugin } <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;vite-plugin-html&#x27;</span>\n\n<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {\n  <span class="hljs-attr">plugins</span>: [\n    <span class="hljs-title function_">createHtmlPlugin</span>({\n      <span class="hljs-attr">inject</span>: {\n        <span class="hljs-attr">data</span>: {\n          <span class="hljs-attr">title</span>: <span class="hljs-string">&#x27;动态标题&#x27;</span>,\n          <span class="hljs-attr">injectScript</span>: <span class="hljs-string">&#x27;&lt;script&gt;console.log(&quot;注入脚本&quot;)&lt;/script&gt;&#x27;</span>\n        }\n      }\n    })\n  ]\n}\n</code></pre>\n<pre><code class="language-html"><span class="hljs-comment">&lt;!-- index.html --&gt;</span>\n<span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>&lt;%= title %&gt;<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>\n&lt;%= injectScript %&gt;\n</code></pre>\n</li>\n<li>多模板支持<pre><code class="language-javascript"><span class="hljs-title function_">createHtmlPlugin</span>({\n  <span class="hljs-attr">template</span>: <span class="hljs-string">&#x27;src/custom.html&#x27;</span>, <span class="hljs-comment">// 自定义模板路径</span>\n  <span class="hljs-attr">multiple</span>: {\n    <span class="hljs-attr">index</span>: <span class="hljs-string">&#x27;src/index.html&#x27;</span>,\n    <span class="hljs-attr">about</span>: <span class="hljs-string">&#x27;src/about.html&#x27;</span>\n  }\n})\n</code></pre>\n</li>\n<li>压缩优化<pre><code class="language-javascript"><span class="hljs-title function_">createHtmlPlugin</span>({\n  <span class="hljs-attr">minify</span>: {\n    <span class="hljs-attr">collapseWhitespace</span>: <span class="hljs-literal">true</span>,\n    <span class="hljs-attr">keepClosingSlash</span>: <span class="hljs-literal">true</span>,\n    <span class="hljs-attr">removeComments</span>: <span class="hljs-literal">true</span>,\n    <span class="hljs-attr">removeRedundantAttributes</span>: <span class="hljs-literal">true</span>\n  }\n})\n</code></pre>\n</li>\n</ol>\n<hr>\n<p>二、高级应用场景</p>\n<ol>\n<li>环境变量集成</li>\n</ol>\n<pre><code class="language-javascript"><span class="hljs-comment">// vite.config.js</span>\n<span class="hljs-keyword">import</span> { loadEnv } <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;vite&#x27;</span>\n\n<span class="hljs-keyword">export</span> <span class="hljs-title function_">default</span> ({ mode }) =&gt; {\n  <span class="hljs-keyword">const</span> env = <span class="hljs-title function_">loadEnv</span>(mode, process.<span class="hljs-title function_">cwd</span>())\n\n  <span class="hljs-keyword">return</span> {\n    <span class="hljs-attr">plugins</span>: [\n      <span class="hljs-title function_">createHtmlPlugin</span>({\n        <span class="hljs-attr">inject</span>: {\n          <span class="hljs-attr">data</span>: {\n            <span class="hljs-attr">apiBaseUrl</span>: env.<span class="hljs-property">VITE_API_URL</span>\n          }\n        }\n      })\n    ]\n  }\n}\n</code></pre>\n<pre><code class="language-html"><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript">\n  <span class="hljs-variable language_">window</span>.<span class="hljs-property">config</span> = { <span class="hljs-attr">API_URL</span>: <span class="hljs-string">&#x27;&lt;%= apiBaseUrl %&gt;&#x27;</span> }\n</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>\n</code></pre>\n<ol start="2">\n<li>多入口自动匹配</li>\n</ol>\n<pre><code class="language-javascript"><span class="hljs-title function_">createHtmlPlugin</span>({\n  <span class="hljs-attr">pages</span>: [\n    {\n      <span class="hljs-attr">entry</span>: <span class="hljs-string">&#x27;src/main.js&#x27;</span>,\n      <span class="hljs-attr">template</span>: <span class="hljs-string">&#x27;index.html&#x27;</span>,\n      <span class="hljs-attr">filename</span>: <span class="hljs-string">&#x27;index.html&#x27;</span>\n    },\n    {\n      <span class="hljs-attr">entry</span>: <span class="hljs-string">&#x27;src/about.js&#x27;</span>,\n      <span class="hljs-attr">template</span>: <span class="hljs-string">&#x27;about.html&#x27;</span>,\n      <span class="hljs-attr">filename</span>: <span class="hljs-string">&#x27;about.html&#x27;</span>\n    }\n  ]\n})\n</code></pre>\n<ol start="3">\n<li>自定义资源注入</li>\n</ol>\n<pre><code class="language-javascript"><span class="hljs-title function_">createHtmlPlugin</span>({\n  <span class="hljs-attr">inject</span>: {\n    <span class="hljs-attr">tags</span>: [\n      {\n        <span class="hljs-attr">tag</span>: <span class="hljs-string">&#x27;script&#x27;</span>,\n        <span class="hljs-attr">attrs</span>: { <span class="hljs-attr">src</span>: <span class="hljs-string">&#x27;/lib/analytics.js&#x27;</span>, <span class="hljs-attr">async</span>: <span class="hljs-literal">true</span> },\n        <span class="hljs-attr">injectTo</span>: <span class="hljs-string">&#x27;head&#x27;</span>\n      },\n      {\n        <span class="hljs-attr">tag</span>: <span class="hljs-string">&#x27;link&#x27;</span>,\n        <span class="hljs-attr">attrs</span>: { <span class="hljs-attr">rel</span>: <span class="hljs-string">&#x27;preload&#x27;</span>, <span class="hljs-attr">href</span>: <span class="hljs-string">&#x27;/fonts/iconfont.woff2&#x27;</span> }\n      }\n    ]\n  }\n})\n</code></pre>\n<hr>\n<p>三、性能优化技巧</p>\n<ol>\n<li>预加载关键资源<pre><code class="language-javascript"><span class="hljs-title function_">createHtmlPlugin</span>({\n  <span class="hljs-attr">inject</span>: {\n    <span class="hljs-attr">tags</span>: [\n      {\n        <span class="hljs-attr">tag</span>: <span class="hljs-string">&#x27;link&#x27;</span>,\n        <span class="hljs-attr">attrs</span>: {\n          <span class="hljs-attr">rel</span>: <span class="hljs-string">&#x27;modulepreload&#x27;</span>,\n          <span class="hljs-attr">href</span>: <span class="hljs-string">&#x27;/src/components/CriticalComponent.vue&#x27;</span>\n        }\n      }\n    ]\n  }\n})\n</code></pre>\n</li>\n<li>条件编译<pre><code class="language-javascript"><span class="hljs-title function_">createHtmlPlugin</span>({\n  <span class="hljs-attr">inject</span>: {\n    <span class="hljs-attr">data</span>: {\n      <span class="hljs-attr">isProd</span>: process.<span class="hljs-property">env</span>.<span class="hljs-property">NODE_ENV</span> === <span class="hljs-string">&#x27;production&#x27;</span>\n    }\n  }\n})\n</code></pre>\n<pre><code class="language-html">&lt;% if (isProd) { %&gt;\n<span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;https://cdn.example.com/vue.min.js&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>\n&lt;% } else { %&gt;\n<span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;/vue.js&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>\n&lt;% } %&gt;\n</code></pre>\n</li>\n<li>SSR 支持<pre><code class="language-javascript"><span class="hljs-title function_">createHtmlPlugin</span>({\n  <span class="hljs-attr">ssr</span>: <span class="hljs-literal">true</span>,\n  <span class="hljs-attr">template</span>: <span class="hljs-string">&#x27;src/ssr-template.html&#x27;</span>\n})\n</code></pre>\n</li>\n</ol>\n<hr>\n<p>四、与其他插件组合</p>\n<ol>\n<li>配合 <code>unplugin-auto-import</code></li>\n</ol>\n<pre><code class="language-javascript"><span class="hljs-keyword">import</span> <span class="hljs-title class_">AutoImport</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;unplugin-auto-import/vite&#x27;</span>\n\n<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {\n  <span class="hljs-attr">plugins</span>: [\n    <span class="hljs-title class_">AutoImport</span>({\n      <span class="hljs-attr">imports</span>: [<span class="hljs-string">&#x27;vue&#x27;</span>],\n      <span class="hljs-attr">dts</span>: <span class="hljs-string">&#x27;src/auto-imports.d.ts&#x27;</span>\n    }),\n    <span class="hljs-title function_">createHtmlPlugin</span>({\n      <span class="hljs-attr">inject</span>: {\n        <span class="hljs-attr">data</span>: {\n          <span class="hljs-attr">autoImport</span>: <span class="hljs-string">&#x27;&lt;script src=&quot;/src/auto-imports.js&quot;&gt;&lt;/script&gt;&#x27;</span>\n        }\n      }\n    })\n  ]\n}\n</code></pre>\n<ol start="2">\n<li>与 <code>vite-plugin-pwa</code> 集成</li>\n</ol>\n<pre><code class="language-javascript"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">VitePWA</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;vite-plugin-pwa&#x27;</span>\n\n<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {\n  <span class="hljs-attr">plugins</span>: [\n    <span class="hljs-title class_">VitePWA</span>(),\n    <span class="hljs-title function_">createHtmlPlugin</span>({\n      <span class="hljs-attr">inject</span>: {\n        <span class="hljs-attr">tags</span>: [\n          {\n            <span class="hljs-attr">tag</span>: <span class="hljs-string">&#x27;link&#x27;</span>,\n            <span class="hljs-attr">attrs</span>: { <span class="hljs-attr">rel</span>: <span class="hljs-string">&#x27;manifest&#x27;</span>, <span class="hljs-attr">href</span>: <span class="hljs-string">&#x27;/manifest.webmanifest&#x27;</span> }\n          }\n        ]\n      }\n    })\n  ]\n}\n</code></pre>\n<hr>\n<p>五、调试技巧</p>\n<ol>\n<li>查看最终生成的 HTML<pre><code class="language-javascript"><span class="hljs-title function_">createHtmlPlugin</span>({\n  <span class="hljs-attr">debug</span>: {\n    <span class="hljs-attr">logPath</span>: <span class="hljs-literal">true</span>,  <span class="hljs-comment">// 输出文件路径</span>\n    <span class="hljs-attr">showCompiled</span>: <span class="hljs-literal">true</span>  <span class="hljs-comment">// 显示编译后的模板</span>\n  }\n})\n</code></pre>\n</li>\n<li>自定义日志输出<pre><code class="language-javascript"><span class="hljs-title function_">createHtmlPlugin</span>({\n  <span class="hljs-title function_">onLog</span>(<span class="hljs-params">level, msg</span>) {\n    <span class="hljs-keyword">if</span> (level === <span class="hljs-string">&#x27;warn&#x27;</span>) {\n      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">warn</span>(<span class="hljs-string">&#x27;[HTML Plugin]&#x27;</span>, msg)\n    }\n  }\n})\n</code></pre>\n</li>\n</ol>\n<hr>\n<p>六、最佳实践建议</p>\n<ol>\n<li>项目结构组织<pre><code>src/\n├── html-templates/\n│   ├── base.html\n│   ├── home.html\n│   └── admin.html\n└── vite-plugins/\n    └── html-config.js\n</code></pre>\n</li>\n<li>配置分离<pre><code class="language-javascript"><span class="hljs-comment">// vite-plugins/html-config.js</span>\n<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title function_">htmlPlugin</span> = (<span class="hljs-params">mode</span>) =&gt; <span class="hljs-title function_">createHtmlPlugin</span>({\n  <span class="hljs-attr">minify</span>: mode === <span class="hljs-string">&#x27;production&#x27;</span>,\n  <span class="hljs-attr">inject</span>: <span class="hljs-title function_">loadEnv</span>(mode, process.<span class="hljs-title function_">cwd</span>())\n})\n\n<span class="hljs-comment">// vite.config.js</span>\n<span class="hljs-keyword">import</span> { htmlPlugin } <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./src/vite-plugins/html-config&#x27;</span>\n</code></pre>\n</li>\n<li>版本控制策略<pre><code class="language-javascript"><span class="hljs-title function_">createHtmlPlugin</span>({\n  <span class="hljs-attr">inject</span>: {\n    <span class="hljs-attr">data</span>: {\n      <span class="hljs-attr">buildVersion</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>().<span class="hljs-title function_">toISOString</span>()\n    }\n  }\n})\n</code></pre>\n<pre><code class="language-html"><span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;version&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;&lt;%= buildVersion %&gt;&quot;</span>&gt;</span>\n</code></pre>\n</li>\n</ol>\n<hr>\n<p>常见问题解决方案</p>\n<p>Q1: 变量未正确替换？</p>\n<ul>\n<li>\n<p>确保模板中使用 <code>&lt;%= %&gt;</code> 语法</p>\n</li>\n<li>\n<p>检查数据注入路径是否正确</p>\n</li>\n</ul>\n<p>Q2: 多页面路由冲突？</p>\n<pre><code class="language-javascript"><span class="hljs-title function_">createHtmlPlugin</span>({\n  <span class="hljs-attr">pages</span>: [\n    {\n      <span class="hljs-attr">filename</span>: <span class="hljs-string">&#x27;admin/index.html&#x27;</span>,\n      <span class="hljs-attr">template</span>: <span class="hljs-string">&#x27;admin.html&#x27;</span>\n    }\n  ]\n})\n</code></pre>\n<p>Q3: 如何保留原始注释？</p>\n<pre><code class="language-javascript"><span class="hljs-title function_">createHtmlPlugin</span>({\n  <span class="hljs-attr">minify</span>: {\n    <span class="hljs-attr">removeComments</span>: <span class="hljs-literal">false</span>\n  }\n})\n</code></pre>\n<p>通过合理配置 <code>vite-plugin-html</code>，可以实现从简单的变量替换到复杂的多页面应用架构，是 Vite 项目不可或缺的高级工具。</p>\n</div>'</script></body></html>