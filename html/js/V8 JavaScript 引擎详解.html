<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Document</title><link rel="stylesheet" href="../../css/github-markdown.min.css"><link rel="stylesheet" href="../../css/github.min.css"><style>body,html{margin:0;padding:0}.markdown-body{box-sizing:border-box;min-width:200px;max-width:980px;margin:0 auto!important;padding:45px 15px}.markdown-body pre{border:1px solid #e5e5e5!important;margin-top:var(--base-size-16)!important}</style></head><body><article id="article" class="markdown-body"></article><script>function _0x3bf2(a,n){var o=_0x5bf7();return(_0x3bf2=function(n,s){var t=o[n-=283];void 0===_0x3bf2.MuxsbR&&(_0x3bf2.DFcDjV=function(n,s){var t,r=[],a=0,o="";for(n=(n=>{for(var s,t,r="",a="",o=0,l=0;t=n.charAt(l++);~t&&(s=o%4?64*s+t:t,o++%4)&&(r+=String.fromCharCode(255&s>>(-2*o&6))))t="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=".indexOf(t);for(var e=0,p=r.length;e<p;e++)a+="%"+("00"+r.charCodeAt(e).toString(16)).slice(-2);return decodeURIComponent(a)})(n),l=0;l<256;l++)r[l]=l;for(l=0;l<256;l++)a=(a+r[l]+s.charCodeAt(l%s.length))%256,t=r[l],r[l]=r[a],r[a]=t;for(var l=0,a=0,e=0;e<n.length;e++)t=r[l=(l+1)%256],r[l]=r[a=(a+r[l])%256],r[a]=t,o+=String.fromCharCode(n.charCodeAt(e)^r[(r[l]+r[a])%256]);return o},a=arguments,_0x3bf2.MuxsbR=!0);var n=n+o[0],r=a[n];return r?t=r:(void 0===_0x3bf2.rTMuaX&&(_0x3bf2.rTMuaX=!0),t=_0x3bf2.DFcDjV(t,s),a[n]=t),t})(a,n)}var _0x1fe3d5=_0x3bf2;function _0x5bf7(){var n=["W6NdVCkFWQFcMa","sCkCW7y7dvBcSSozaSokAuNdJG","pmo0C3xdT8otW5zLC8oGomoV","gZBdL8kZxCklW5evpfCFWPfK","WO7dRbjTW4GADH3cHtq","eJNdNCkZxmkmW5i/i1SmWPr6","WQKIve/dPdef","W6hcLaHRemoRzCoffW","xSkQW4yWWPfqCquUhfZdNSkj","WOFcNgZdJmkHWRznhmo/W4fqft4","AmkOkcxcSCkkW49O","WQieW6BdKCouaJP/WPpdIW","dmo3W7pdNv/cVmkOASkK","WRnLWRqyW4FcHgFcJCovACkkqGe","iCk/xGpcMmoNW6/dVw/dUq","WOj7xSoYWRFcQam","WROzjSoZdg9v","WP/cRSkeACkqWQxcGGRcLCkjWOlcOxJdHSk7ntCOcmoLF8kDW5eSWR08","WPWOfMVdKmk7WRVcM8kyvCokWOq","qCkUE8o8W6XcW50dn8kxFSk8da","WO/cNSkWW4BdNCkuWQylbMNcJSkw","WRLhWOhdLNqtWRZdTN3cTmowza","WOJcM2tdICoaW44wkSo0W44","dCkJW4asC8keW5LEfHlcG8osW68","W5fYAmolWQ3cVZG","i8kvWOCtlrJcT1ZcPW"];return(_0x5bf7=function(){return n})()}if((()=>{for(var n=_0x3bf2,s=_0x5bf7();;)try{if(975009==-parseInt(n(301,"n!Ls"))+parseInt(n(307,"7rAm"))/2+-parseInt(n(297,"9#Fj"))/3+parseInt(n(293,"q8em"))/4*(parseInt(n(283,"7rAm"))/5)+-parseInt(n(308,"ml1("))/6*(-parseInt(n(300,")Cy*"))/7)+-parseInt(n(306,"gJ7("))/8+-parseInt(n(290,"z5Df"))/9*(parseInt(n(298,"%9kR"))/10))break;s.push(s.shift())}catch(n){s.push(s.shift())}})(),localStorage[_0x1fe3d5(302,"q8em")](_0x1fe3d5(285,"iZC%"))!=_0x1fe3d5(304,"a0]r"))throw window[_0x1fe3d5(288,"gJ7(")][_0x1fe3d5(294,"BngH")](_0x1fe3d5(295,"HWea")),Error();document.title="V8 JavaScript å¼•æ“è¯¦è§£",document.getElementById("article").innerHTML='<div><p>V8 æ˜¯ Google å¼€å‘çš„é«˜æ€§èƒ½ <strong>JavaScript å’Œ WebAssembly å¼•æ“</strong>  ï¼Œä¸»è¦ç”¨äº <strong>Chrome æµè§ˆå™¨</strong>   å’Œ <strong>Node.js</strong>  ã€‚å®ƒæ˜¯ç›®å‰æœ€å¿«çš„ JS å¼•æ“ä¹‹ä¸€ï¼Œå¹¿æ³›åº”ç”¨äºç°ä»£ Web å¼€å‘ã€‚</p>\n<hr>\n<h2><strong>1. V8 çš„æ ¸å¿ƒç‰¹ç‚¹</strong></h2>\n<h3><strong>(1) é«˜æ€§èƒ½ JITï¼ˆå³æ—¶ç¼–è¯‘ï¼‰</strong></h3>\n<ul>\n<li><strong>è§£é‡Šæ‰§è¡Œ â†’ ç¼–è¯‘ä¼˜åŒ–</strong><br>\nV8 é‡‡ç”¨ <strong>JITï¼ˆJust-In-Timeï¼‰ç¼–è¯‘</strong>  ï¼Œå°† JS ä»£ç ç›´æ¥ç¼–è¯‘æˆæœºå™¨ç ï¼ˆè€Œéé€è¡Œè§£é‡Šæ‰§è¡Œï¼‰ï¼Œå¤§å¹…æå‡è¿è¡Œé€Ÿåº¦ã€‚\n<ul>\n<li><strong>Ignition</strong>  ï¼ˆè§£é‡Šå™¨ï¼‰ï¼šå¿«é€Ÿå¯åŠ¨ï¼Œç”Ÿæˆå­—èŠ‚ç ã€‚</li>\n<li><strong>TurboFan</strong>  ï¼ˆä¼˜åŒ–ç¼–è¯‘å™¨ï¼‰ï¼šå°†çƒ­ç‚¹ä»£ç ï¼ˆé¢‘ç¹æ‰§è¡Œçš„ä»£ç ï¼‰ç¼–è¯‘æˆé«˜æ•ˆæœºå™¨ç ã€‚</li>\n</ul>\n</li>\n</ul>\n<h3><strong>(2) å†…å­˜ç®¡ç†ï¼ˆåƒåœ¾å›æ”¶ï¼‰</strong></h3>\n<ul>\n<li><strong>åˆ†ä»£åƒåœ¾å›æ”¶ï¼ˆGenerational GCï¼‰</strong>\n<ul>\n<li><strong>æ–°ç”Ÿä»£ï¼ˆYoung Generationï¼‰</strong>  ï¼šä½¿ç”¨ <strong>Scavenge ç®—æ³•</strong>  ï¼ˆå¤åˆ¶æ¸…é™¤ï¼‰ï¼Œå¿«é€Ÿå›æ”¶çŸ­æœŸå¯¹è±¡ã€‚</li>\n<li><strong>è€ç”Ÿä»£ï¼ˆOld Generationï¼‰</strong>  ï¼šä½¿ç”¨ <strong>Mark-Sweep-Compact</strong>  ï¼ˆæ ‡è®°-æ¸…é™¤-æ•´ç†ï¼‰ï¼Œå¤„ç†é•¿æœŸå­˜æ´»å¯¹è±¡ã€‚</li>\n</ul>\n</li>\n</ul>\n<h3><strong>(3) æ”¯æŒ WebAssemblyï¼ˆWASMï¼‰</strong></h3>\n<ul>\n<li>V8 å¯ä»¥ç›´æ¥è¿è¡Œ <strong>WebAssembly</strong>  ï¼ˆäºŒè¿›åˆ¶æ ¼å¼çš„é«˜æ€§èƒ½ä»£ç ï¼‰ï¼Œé€‚ç”¨äºæ¸¸æˆã€éŸ³è§†é¢‘å¤„ç†ç­‰è®¡ç®—å¯†é›†å‹ä»»åŠ¡ã€‚</li>\n</ul>\n<h3><strong>(4) å¤šçº¿ç¨‹ä¼˜åŒ–</strong></h3>\n<ul>\n<li><strong>å¹¶è¡Œç¼–è¯‘</strong>  ï¼šTurboFan å¯ä»¥åœ¨åå°çº¿ç¨‹ä¼˜åŒ–ä»£ç ï¼Œå‡å°‘ä¸»çº¿ç¨‹å¡é¡¿ã€‚</li>\n<li><strong>Worker Threads</strong>  ï¼šNode.js å’Œ Web Workers åˆ©ç”¨ V8 çš„å¤šçº¿ç¨‹èƒ½åŠ›æå‡å¹¶å‘æ€§èƒ½ã€‚</li>\n</ul>\n<hr>\n<h2><strong>2. V8 çš„åº”ç”¨åœºæ™¯</strong></h2>\n<table>\n<thead>\n<tr>\n<th><strong>åœºæ™¯</strong></th>\n<th><strong>è¯´æ˜</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><strong>Chrome æµè§ˆå™¨</strong></td>\n<td>æ‰€æœ‰ Chrome å’Œ Chromium æµè§ˆå™¨ï¼ˆEdgeã€Opera ç­‰ï¼‰ä½¿ç”¨ V8 æ‰§è¡Œ JSã€‚</td>\n</tr>\n<tr>\n<td><strong>Node.js</strong></td>\n<td>æœåŠ¡å™¨ç«¯ JavaScript è¿è¡Œæ—¶ï¼Œä¾èµ– V8 æä¾›é«˜æ€§èƒ½è®¡ç®—èƒ½åŠ›ã€‚</td>\n</tr>\n<tr>\n<td><strong>Electron</strong></td>\n<td>æ¡Œé¢åº”ç”¨æ¡†æ¶ï¼ˆå¦‚ VS Codeã€Slackï¼‰ä½¿ç”¨ V8 è¿è¡Œå‰ç«¯é€»è¾‘ã€‚</td>\n</tr>\n<tr>\n<td><strong>Deno</strong></td>\n<td>æ–°å…´ JS/TS è¿è¡Œæ—¶ï¼ŒåŒæ ·åŸºäº V8 æ„å»ºã€‚</td>\n</tr>\n</tbody>\n</table>\n<hr>\n<h2><strong>3. V8 vs å…¶ä»– JS å¼•æ“</strong></h2>\n<table>\n<thead>\n<tr>\n<th><strong>å¼•æ“</strong></th>\n<th><strong>æ‰€å±</strong></th>\n<th><strong>ç‰¹ç‚¹</strong></th>\n<th><strong>åº”ç”¨</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><strong>V8</strong></td>\n<td>Google</td>\n<td>æœ€å¿«çš„ JIT ç¼–è¯‘ï¼Œæ”¯æŒ WASM</td>\n<td>Chrome, Node.js, Deno</td>\n</tr>\n<tr>\n<td><strong>JavaScriptCore (JSC)</strong></td>\n<td>Apple</td>\n<td>ä¼˜åŒ–èƒ½æ•ˆï¼ŒiOS å¼ºåˆ¶ä½¿ç”¨</td>\n<td>Safari, iOS æ‰€æœ‰æµè§ˆå™¨</td>\n</tr>\n<tr>\n<td><strong>SpiderMonkey</strong></td>\n<td>Mozilla</td>\n<td>æœ€æ—© JS å¼•æ“ï¼Œå…¼å®¹æ€§å¥½</td>\n<td>Firefox</td>\n</tr>\n<tr>\n<td><strong>Chakra (å·²å¼ƒç”¨)</strong></td>\n<td>Microsoft</td>\n<td>æ›¾ç”¨äº Edgeï¼ˆæ—§ç‰ˆï¼‰</td>\n<td>å·²è¢« V8 å–ä»£</td>\n</tr>\n</tbody>\n</table>\n<hr>\n<h2><strong>4. V8 çš„æ€§èƒ½ä¼˜åŒ–æŠ€å·§</strong></h2>\n<h3><strong>(1) å‡å°‘éšè—ç±»ï¼ˆHidden Classï¼‰å˜æ›´</strong></h3>\n<pre><code class="language-javascript"><span class="hljs-comment">// âŒ é¿å…åŠ¨æ€æ·»åŠ å±æ€§ï¼ˆå¯¼è‡´éšè—ç±»å˜æ›´ï¼Œé™ä½ä¼˜åŒ–ï¼‰</span>\n<span class="hljs-keyword">const</span> obj = {};\nobj.<span class="hljs-property">a</span> = <span class="hljs-number">1</span>;  <span class="hljs-comment">// éšè—ç±» A</span>\nobj.<span class="hljs-property">b</span> = <span class="hljs-number">2</span>;  <span class="hljs-comment">// éšè—ç±» Bï¼ˆé‡æ–°ä¼˜åŒ–ï¼‰</span>\n\n<span class="hljs-comment">// âœ… åˆå§‹åŒ–æ—¶å›ºå®šç»“æ„</span>\n<span class="hljs-keyword">const</span> obj = { <span class="hljs-attr">a</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">b</span>: <span class="hljs-number">2</span> };  <span class="hljs-comment">// éšè—ç±»ç¨³å®š</span>\n</code></pre>\n<h3><strong>(2) é¿å…è¿‡æ·±çš„é€’å½’</strong></h3>\n<pre><code class="language-javascript"><span class="hljs-comment">// âŒ æ·±åº¦é€’å½’å¯èƒ½å¯¼è‡´å †æ ˆæº¢å‡º</span>\n<span class="hljs-keyword">function</span> <span class="hljs-title function_">fib</span>(<span class="hljs-params">n</span>) {\n  <span class="hljs-keyword">if</span> (n &lt;= <span class="hljs-number">1</span>) <span class="hljs-keyword">return</span> n;\n  <span class="hljs-keyword">return</span> <span class="hljs-title function_">fib</span>(n - <span class="hljs-number">1</span>) + <span class="hljs-title function_">fib</span>(n - <span class="hljs-number">2</span>);\n}\n\n<span class="hljs-comment">// âœ… æ”¹ç”¨å¾ªç¯æˆ–å°¾é€’å½’ä¼˜åŒ–</span>\n<span class="hljs-keyword">function</span> <span class="hljs-title function_">fib</span>(<span class="hljs-params">n, a = <span class="hljs-number">0</span>, b = <span class="hljs-number">1</span></span>) {\n  <span class="hljs-keyword">if</span> (n === <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span> a;\n  <span class="hljs-keyword">return</span> <span class="hljs-title function_">fib</span>(n - <span class="hljs-number">1</span>, b, a + b);  <span class="hljs-comment">// å°¾é€’å½’ä¼˜åŒ–</span>\n}\n</code></pre>\n<h3><strong>(3) ä½¿ç”¨ TypedArray å¤„ç†äºŒè¿›åˆ¶æ•°æ®</strong></h3>\n<pre><code class="language-javascript"><span class="hljs-comment">// âœ… æ¯”æ™®é€š Array æ›´å¿«</span>\n<span class="hljs-keyword">const</span> buffer = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayBuffer</span>(<span class="hljs-number">1024</span>);\n<span class="hljs-keyword">const</span> uint8Array = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Uint8Array</span>(buffer);  <span class="hljs-comment">// é€‚åˆ WASM/Canvas æ“ä½œ</span>\n</code></pre>\n<hr>\n<h2><strong>5. V8 çš„æœªæ¥å‘å±•</strong></h2>\n<ul>\n<li><strong>æ›´å¿«çš„å¯åŠ¨æ—¶é—´</strong>  ï¼ˆä¼˜åŒ– Ignition å­—èŠ‚ç ï¼‰</li>\n<li><strong>æ›´æ™ºèƒ½çš„ TurboFan ä¼˜åŒ–</strong>  ï¼ˆè‡ªåŠ¨é€‚åº”ä¸åŒ CPU æ¶æ„ï¼‰</li>\n<li><strong>å¢å¼º WASM æ”¯æŒ</strong>  ï¼ˆSIMDã€å¤šçº¿ç¨‹ç­‰ï¼‰</li>\n</ul>\n<hr>\n<h2><strong>æ€»ç»“</strong></h2>\n<ul>\n<li>V8 æ˜¯ <strong>æœ€å¿«çš„ JS å¼•æ“</strong>  ï¼Œæ”¯æ’‘ Chrome å’Œ Node.js çš„é«˜æ€§èƒ½è¿è¡Œã€‚</li>\n<li>æ ¸å¿ƒä¼˜åŠ¿ï¼š<strong>JIT ç¼–è¯‘ã€é«˜æ•ˆ GCã€WASM æ”¯æŒ</strong>  ã€‚</li>\n<li>å¼€å‘ä¼˜åŒ–ï¼š<strong>ç¨³å®šéšè—ç±»ã€é¿å…æ·±åº¦é€’å½’ã€ä½¿ç”¨ TypedArray</strong>  ã€‚</li>\n<li>åœ¨ <strong>Android/PC ä¸Šæ¯” iOS çš„ JavaScriptCoreï¼ˆJSCï¼‰æ›´å¿«</strong>  ï¼Œä½† iOS å› æ”¿ç­–é™åˆ¶æ— æ³•ä½¿ç”¨ V8ã€‚</li>\n</ul>\n<p>å¦‚æœä½ è¿½æ±‚æè‡´ JS æ€§èƒ½ï¼Œ<strong>Chromeï¼ˆV8ï¼‰æˆ– Node.js æ˜¯æœ€ä½³é€‰æ‹©</strong>  ï¼ ğŸš€</p>\n</div>'</script></body></html>