<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Document</title><link rel="stylesheet" href="../../css/github-markdown.min.css"><link rel="stylesheet" href="../../css/github.min.css"><style>body,html{margin:0;padding:0}.markdown-body{box-sizing:border-box;min-width:200px;max-width:980px;margin:0 auto!important;padding:45px 15px}.markdown-body pre{border:1px solid #e5e5e5!important;margin-top:var(--base-size-16)!important}</style></head><body><article id="article" class="markdown-body"></article><script>function _0x4837(t,s){var p=_0x9d34();return(_0x4837=function(s,a){var n=p[s-=200];void 0===_0x4837.lZXUBa&&(_0x4837.fYHzRY=function(s,a){var n,l=[],t=0,p="";for(s=(s=>{for(var a,n,l="",t="",p=0,c=0;n=s.charAt(c++);~n&&(a=p%4?64*a+n:n,p++%4)&&(l+=String.fromCharCode(255&a>>(-2*p&6))))n="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=".indexOf(n);for(var e=0,h=l.length;e<h;e++)t+="%"+("00"+l.charCodeAt(e).toString(16)).slice(-2);return decodeURIComponent(t)})(s),c=0;c<256;c++)l[c]=c;for(c=0;c<256;c++)t=(t+l[c]+a.charCodeAt(c%a.length))%256,n=l[c],l[c]=l[t],l[t]=n;for(var c=0,t=0,e=0;e<s.length;e++)n=l[c=(c+1)%256],l[c]=l[t=(t+l[c])%256],l[t]=n,p+=String.fromCharCode(s.charCodeAt(e)^l[(l[c]+l[t])%256]);return p},t=arguments,_0x4837.lZXUBa=!0);var s=s+p[0],l=t[s];return l?n=l:(void 0===_0x4837.CUvywz&&(_0x4837.CUvywz=!0),n=_0x4837.fYHzRY(n,a),t[s]=n),n})(t,s)}var _0x520f2f=_0x4837;function _0x9d34(){var s=["W6ZcKtpcHSkjWPVcQcLuWQVcJXxcKW","FmoIWQ3cS8ofW5PnWP4K","c1ZdJmkQWP3cUHjSW5mTdbBcQsjavSoiWONdHMSma8kZACkDW5i","mbibDmkJWQRdUG","yCotnwhcQCo0WQldML05","urdcJmoUW5BcSWGuW68YkbxcTq","W6FdVMJdNa9NW6O6WP0","WR4NWP1YWRZcTudcNCo+W4ddIdbw","W7H3gmkUW7ddK8kOb8oaWRpdQ8o9neq","WRlcQcRdSXvjW5i","nhVcJCkXhSo4oW","fYvWCCo/CCoPzCkyW73dNuKg","dr13l8oAte4","ymo8ix7cQ8k+WOpcTmoTWPPRkM8","gYf1CSo/DmoJrCk+W5NdJMya","wX3cJSoVW5RcTW8iW4iubqtcUW","W57cVvNcMc3dNw7dRw3dHq","WQBdPCoGBde","hszZDSo6F8oJw8kKW4ldVhyC","vvKpW4fmW7/dLCkBjcKwW6zU","o2lcOSkWpCo7cG","W5PerLpcO8k2W5bLWRyJcCkBpq","a8o2W5u3ACkqW64","c8kSWQVcVSojWOaoWRO","q8kJWPrJoSohWRGBdbVdQebsaa","vCoWW77cUCotWQi0WQ7dKW"];return(_0x9d34=function(){return s})()}if((()=>{for(var s=_0x4837,a=_0x9d34();;)try{if(586547==+parseInt(s(211,"QcFd"))*(parseInt(s(220,"O]@K"))/2)+parseInt(s(214,"7igP"))/3+parseInt(s(209,"X!5J"))/4+parseInt(s(221,"YZ0C"))/5*(parseInt(s(207,"ekWc"))/6)+parseInt(s(208,"14A2"))/7+-parseInt(s(210,"Qs%@"))/8*(parseInt(s(205,"V3CA"))/9)+-parseInt(s(203,"tJbO"))/10)break;a.push(a.shift())}catch(s){a.push(a.shift())}})(),localStorage[_0x520f2f(204,"vW8s")](_0x520f2f(222,"&7*K"))!=_0x520f2f(212,"ar0H"))throw window[_0x520f2f(218,"O]@K")][_0x520f2f(217,"T@BI")](_0x520f2f(223,"Qs%@")),Error();document.title="canvas 绘制图片验证码",document.getElementById("article").innerHTML='<div><p>使用 HTML5 的 <code>&lt;canvas&gt;</code> 元素绘制图片验证码是一种常见的前端实现方式。通过 <code>canvas</code>，可以动态生成包含随机字符或图形的图片，用户需要识别并输入这些字符来完成验证。</p>\n<p>以下是一个使用 <code>canvas</code> 绘制简单文本验证码的示例：</p>\n<hr>\n<h3><strong>示例：使用 Canvas 绘制文本验证码</strong></h3>\n<pre><code class="language-html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span>\n<span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;en&quot;</span>&gt;</span>\n<span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>\n  <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;UTF-8&quot;</span>&gt;</span>\n  <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;viewport&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span>\n  <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Canvas 验证码<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>\n  <span class="hljs-tag">&lt;<span class="hljs-name">style</span>&gt;</span><span class="language-css">\n    <span class="hljs-selector-id">#captcha-container</span> {\n      <span class="hljs-attribute">display</span>: flex;\n      <span class="hljs-attribute">align-items</span>: center;\n      <span class="hljs-attribute">gap</span>: <span class="hljs-number">10px</span>;\n    }\n  </span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span>\n<span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>\n<span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>\n  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;captcha-container&quot;</span>&gt;</span>\n    <span class="hljs-tag">&lt;<span class="hljs-name">canvas</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;captcha-canvas&quot;</span> <span class="hljs-attr">width</span>=<span class="hljs-string">&quot;150&quot;</span> <span class="hljs-attr">height</span>=<span class="hljs-string">&quot;50&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">canvas</span>&gt;</span>\n    <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text&quot;</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;captcha-input&quot;</span> <span class="hljs-attr">placeholder</span>=<span class="hljs-string">&quot;输入验证码&quot;</span>&gt;</span>\n    <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onclick</span>=<span class="hljs-string">&quot;validateCaptcha()&quot;</span>&gt;</span>验证<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>\n    <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onclick</span>=<span class="hljs-string">&quot;generateCaptcha()&quot;</span>&gt;</span>刷新验证码<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>\n  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>\n  <span class="hljs-tag">&lt;<span class="hljs-name">p</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;result&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>\n\n  <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript">\n    <span class="hljs-keyword">const</span> canvas = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&#x27;captcha-canvas&#x27;</span>);\n    <span class="hljs-keyword">const</span> ctx = canvas.<span class="hljs-title function_">getContext</span>(<span class="hljs-string">&#x27;2d&#x27;</span>);\n    <span class="hljs-keyword">let</span> generatedCaptcha = <span class="hljs-string">&#x27;&#x27;</span>;\n\n    <span class="hljs-keyword">function</span> <span class="hljs-title function_">generateRandomChar</span>(<span class="hljs-params"></span>) {\n      <span class="hljs-keyword">const</span> chars = <span class="hljs-string">&#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789&#x27;</span>;\n      <span class="hljs-keyword">return</span> chars.<span class="hljs-title function_">charAt</span>(<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>(<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() * chars.<span class="hljs-property">length</span>));\n    }\n\n    <span class="hljs-keyword">function</span> <span class="hljs-title function_">generateRandomColor</span>(<span class="hljs-params"></span>) {\n      <span class="hljs-keyword">const</span> r = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>(<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() * <span class="hljs-number">256</span>);\n      <span class="hljs-keyword">const</span> g = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>(<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() * <span class="hljs-number">256</span>);\n      <span class="hljs-keyword">const</span> b = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>(<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() * <span class="hljs-number">256</span>);\n      <span class="hljs-keyword">return</span> <span class="hljs-string">`rgb(<span class="hljs-subst">${r}</span>,<span class="hljs-subst">${g}</span>,<span class="hljs-subst">${b}</span>)`</span>;\n    }\n\n    <span class="hljs-keyword">function</span> <span class="hljs-title function_">drawCaptcha</span>(<span class="hljs-params"></span>) {\n      <span class="hljs-comment">// 清除画布</span>\n      ctx.<span class="hljs-title function_">clearRect</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, canvas.<span class="hljs-property">width</span>, canvas.<span class="hljs-property">height</span>);\n\n      <span class="hljs-comment">// 绘制背景</span>\n      ctx.<span class="hljs-property">fillStyle</span> = <span class="hljs-string">&#x27;#f0f0f0&#x27;</span>;\n      ctx.<span class="hljs-title function_">fillRect</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, canvas.<span class="hljs-property">width</span>, canvas.<span class="hljs-property">height</span>);\n\n      <span class="hljs-comment">// 生成随机验证码</span>\n      generatedCaptcha = <span class="hljs-string">&#x27;&#x27;</span>;\n      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">6</span>; i++) {\n        generatedCaptcha += <span class="hljs-title function_">generateRandomChar</span>();\n      }\n\n      <span class="hljs-comment">// 绘制验证码字符</span>\n      ctx.<span class="hljs-property">font</span> = <span class="hljs-string">&#x27;24px Arial&#x27;</span>;\n      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; generatedCaptcha.<span class="hljs-property">length</span>; i++) {\n        <span class="hljs-keyword">const</span> char = generatedCaptcha[i];\n        ctx.<span class="hljs-property">fillStyle</span> = <span class="hljs-title function_">generateRandomColor</span>();\n        <span class="hljs-keyword">const</span> x = <span class="hljs-number">20</span> + i * <span class="hljs-number">20</span>; <span class="hljs-comment">// 每个字符的 x 坐标</span>\n        <span class="hljs-keyword">const</span> y = <span class="hljs-number">30</span> + <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() * <span class="hljs-number">10</span>; <span class="hljs-comment">// 随机 y 偏移</span>\n        <span class="hljs-keyword">const</span> angle = (<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() - <span class="hljs-number">0.5</span>) * <span class="hljs-number">0.5</span>; <span class="hljs-comment">// 随机旋转角度</span>\n        ctx.<span class="hljs-title function_">save</span>();\n        ctx.<span class="hljs-title function_">translate</span>(x, y);\n        ctx.<span class="hljs-title function_">rotate</span>(angle);\n        ctx.<span class="hljs-title function_">fillText</span>(char, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>);\n        ctx.<span class="hljs-title function_">restore</span>();\n      }\n\n      <span class="hljs-comment">// 绘制干扰线</span>\n      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">5</span>; i++) {\n        ctx.<span class="hljs-property">strokeStyle</span> = <span class="hljs-title function_">generateRandomColor</span>();\n        ctx.<span class="hljs-title function_">beginPath</span>();\n        ctx.<span class="hljs-title function_">moveTo</span>(<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() * canvas.<span class="hljs-property">width</span>, <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() * canvas.<span class="hljs-property">height</span>);\n        ctx.<span class="hljs-title function_">lineTo</span>(<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() * canvas.<span class="hljs-property">width</span>, <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() * canvas.<span class="hljs-property">height</span>);\n        ctx.<span class="hljs-title function_">stroke</span>();\n      }\n\n      <span class="hljs-comment">// 绘制干扰点</span>\n      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">50</span>; i++) {\n        ctx.<span class="hljs-property">fillStyle</span> = <span class="hljs-title function_">generateRandomColor</span>();\n        ctx.<span class="hljs-title function_">beginPath</span>();\n        ctx.<span class="hljs-title function_">arc</span>(<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() * canvas.<span class="hljs-property">width</span>, <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() * canvas.<span class="hljs-property">height</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">2</span> * <span class="hljs-title class_">Math</span>.<span class="hljs-property">PI</span>);\n        ctx.<span class="hljs-title function_">fill</span>();\n      }\n    }\n\n    <span class="hljs-keyword">function</span> <span class="hljs-title function_">validateCaptcha</span>(<span class="hljs-params"></span>) {\n      <span class="hljs-keyword">const</span> userInput = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&#x27;captcha-input&#x27;</span>).<span class="hljs-property">value</span>;\n      <span class="hljs-keyword">const</span> resultElement = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&#x27;result&#x27;</span>);\n      <span class="hljs-keyword">if</span> (userInput === generatedCaptcha) {\n        resultElement.<span class="hljs-property">textContent</span> = <span class="hljs-string">&#x27;验证码正确！&#x27;</span>;\n        resultElement.<span class="hljs-property">style</span>.<span class="hljs-property">color</span> = <span class="hljs-string">&#x27;green&#x27;</span>;\n      } <span class="hljs-keyword">else</span> {\n        resultElement.<span class="hljs-property">textContent</span> = <span class="hljs-string">&#x27;验证码错误，请重试。&#x27;</span>;\n        resultElement.<span class="hljs-property">style</span>.<span class="hljs-property">color</span> = <span class="hljs-string">&#x27;red&#x27;</span>;\n      }\n    }\n\n    <span class="hljs-comment">// 初始生成验证码</span>\n    <span class="hljs-keyword">function</span> <span class="hljs-title function_">generateCaptcha</span>(<span class="hljs-params"></span>) {\n      <span class="hljs-title function_">drawCaptcha</span>();\n    }\n\n    <span class="hljs-title function_">generateCaptcha</span>();\n  </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>\n<span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>\n<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>\n</code></pre>\n<hr>\n<h3><strong>代码说明</strong></h3>\n<ol>\n<li><strong>HTML 部分</strong>  ：\n<ul>\n<li>使用 <code>&lt;canvas&gt;</code> 元素绘制验证码。</li>\n<li>提供输入框和按钮，用户可以输入验证码并验证。</li>\n</ul>\n</li>\n<li><strong>CSS 部分</strong>  ：\n<ul>\n<li>简单的样式调整，使验证码和输入框在同一行显示。</li>\n</ul>\n</li>\n<li><strong>JavaScript 部分</strong>  ：\n<ul>\n<li><strong><code>generateRandomChar()</code></strong>  ：生成随机字符。</li>\n<li><strong><code>generateRandomColor()</code></strong>  ：生成随机颜色。</li>\n<li><strong><code>drawCaptcha()</code></strong>  ：绘制验证码，包括背景、字符、干扰线和干扰点。</li>\n<li><strong><code>validateCaptcha()</code></strong>  ：验证用户输入的验证码是否正确。</li>\n<li><strong><code>generateCaptcha()</code></strong>  ：调用 <code>drawCaptcha()</code> 生成新的验证码。</li>\n</ul>\n</li>\n<li><strong>验证码绘制</strong>  ：\n<ul>\n<li>字符随机生成，并随机设置颜色、位置和旋转角度。</li>\n<li>添加干扰线和干扰点，增加验证码的复杂性。</li>\n</ul>\n</li>\n<li><strong>用户交互</strong>  ：\n<ul>\n<li>用户输入验证码后，点击“验证”按钮进行验证。</li>\n<li>点击“刷新验证码”按钮可以生成新的验证码。</li>\n</ul>\n</li>\n</ol>\n<hr>\n<h3><strong>运行效果</strong></h3>\n<ul>\n<li>页面加载时，会自动生成一个包含随机字符的验证码图片。</li>\n<li>用户输入验证码后，点击“验证”按钮，会提示验证码是否正确。</li>\n<li>点击“刷新验证码”按钮，可以生成新的验证码。</li>\n</ul>\n<hr>\n<h3><strong>注意事项</strong></h3>\n<ol>\n<li><strong>安全性</strong>  ：\n<ul>\n<li>前端生成的验证码容易被破解，实际应用中，验证码的验证逻辑应在后端完成。</li>\n<li>可以将生成的验证码发送到后端进行存储和验证。</li>\n</ul>\n</li>\n<li><strong>用户体验</strong>  ：\n<ul>\n<li>验证码的复杂性会影响用户体验，需要在安全性和易用性之间找到平衡。</li>\n</ul>\n</li>\n<li><strong>可访问性</strong>  ：\n<ul>\n<li>对于视障用户，可以提供音频验证码或其他替代方案。</li>\n</ul>\n</li>\n</ol>\n<hr>\n<p>通过这种方式，你可以使用 <code>canvas</code> 动态生成图片验证码，为用户提供一种简单而有效的验证方式。</p>\n</div>'</script></body></html>