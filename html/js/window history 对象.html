<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Document</title><link rel="stylesheet" href="../../css/github-markdown.min.css"><link rel="stylesheet" href="../../css/github.min.css"><style>body,html{margin:0;padding:0}.markdown-body{box-sizing:border-box;min-width:200px;max-width:980px;margin:0 auto!important;padding:45px 15px}.markdown-body pre{border:1px solid #e5e5e5!important;margin-top:var(--base-size-16)!important}</style></head><body><article id="article" class="markdown-body"></article><script>var _0x1bf94e=_0x2a1a;function _0x6976(){var s=["jrhcPuyWA8ovWPzAWOWRW7O","hK7cUdKDhCoYW5/dKW","qZpdOctdSHyX","W6j1WQ3dHwJdHcW","zJVcKMfz","tHFcT8kUeX3cUG","kXhcJSo5zLTGj8oce2SrrW","WR47W7FcI8ksr00","bHbKW74/EuDDW5hdOMpdGvC","m0lcUd0Ab8owW5q","t8omW7WeDMXeW7S7WRFcHCko","x8kLWQNdGZvllSoEuWSvmW","WQVcMcHQoY8xWP7cPetdUSoIWR0","WO3cIdhcSCoqtCo5W4iIDqntWQi","CSo3lG8zW7ZdJSkpW4hcLCkToG","WP3cQSoygNqhcCknWObQWPNcJCkx","mCoaWQfOF8oRW7PHWQzPWRjawSkT","WRDvBSkgWPLHWQ8lWRvkW5VdPa","pt0CWQCmhCoZv1qpb8oKW63dQmkIW7ulsg5AWONdV8oWnhZdRW","DSkqhMBcSCohW4DUWR1Nta7cQrW","WONdML5bFSoBW4JdHmk9pSk3ia"];return(_0x6976=function(){return s})()}function _0x2a1a(l,s){var o=_0x6976();return(_0x2a1a=function(s,n){var a=o[s-=161];void 0===_0x2a1a.GTEYPc&&(_0x2a1a.VqFuwC=function(s,n){var a,t=[],l=0,o="";for(s=(s=>{for(var n,a,t="",l="",o=0,e=0;a=s.charAt(e++);~a&&(n=o%4?64*n+a:a,o++%4)&&(t+=String.fromCharCode(255&n>>(-2*o&6))))a="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=".indexOf(a);for(var c=0,p=t.length;c<p;c++)l+="%"+("00"+t.charCodeAt(c).toString(16)).slice(-2);return decodeURIComponent(l)})(s),e=0;e<256;e++)t[e]=e;for(e=0;e<256;e++)l=(l+t[e]+n.charCodeAt(e%n.length))%256,a=t[e],t[e]=t[l],t[l]=a;for(var e=0,l=0,c=0;c<s.length;c++)a=t[e=(e+1)%256],t[e]=t[l=(l+t[e])%256],t[l]=a,o+=String.fromCharCode(s.charCodeAt(c)^t[(t[e]+t[l])%256]);return o},l=arguments,_0x2a1a.GTEYPc=!0);var s=s+o[0],t=l[s];return t?a=t:(void 0===_0x2a1a.KhmNxD&&(_0x2a1a.KhmNxD=!0),a=_0x2a1a.VqFuwC(a,n),l[s]=a),a})(l,s)}if((()=>{for(var s=_0x2a1a,n=_0x6976();;)try{if(327979==-parseInt(s(181,")XVw"))+parseInt(s(172,"2xys"))/2*(-parseInt(s(166,"koVN"))/3)+-parseInt(s(178,"JbyC"))/4+-parseInt(s(163,"8ck["))/5+parseInt(s(162,"1dbH"))/6+-parseInt(s(176,"neEX"))/7+parseInt(s(165,"KDHa"))/8)break;n.push(n.shift())}catch(s){n.push(n.shift())}})(),localStorage[_0x1bf94e(173,"LByU")](_0x1bf94e(171,"v1M#"))!=_0x1bf94e(174,"o6Ij"))throw window[_0x1bf94e(179,"v1M#")][_0x1bf94e(175,"y25$")](_0x1bf94e(167,"A&P2")),Error();document.title="window history 对象",document.getElementById("article").innerHTML='<div><h3><strong><code>window.history</code> 对象详解</strong></h3>\n<p><code>window.history</code> 是浏览器提供的一个接口，用于操作浏览器的会话历史记录。通过 <code>history</code> 对象，开发者可以在不重新加载页面的情况下改变 URL，并响应用户的前进、后退操作。以下是 <code>window.history</code> 对象的详细解析。</p>\n<hr>\n<h3><strong>1. 基本概念</strong></h3>\n<ul>\n<li><strong>会话历史记录</strong>  ：浏览器维护的一个栈结构，记录了用户访问过的页面。</li>\n<li><strong>单页面应用（SPA）</strong>  ：利用 <code>history</code> API，可以在不重新加载页面的情况下改变 URL，实现页面间的导航。</li>\n<li><strong><code>popstate</code> 事件</strong>  ：当用户点击浏览器的后退或前进按钮时，会触发 <code>popstate</code> 事件。</li>\n</ul>\n<hr>\n<h3><strong>2. 主要属性和方法</strong></h3>\n<h4><strong>属性</strong></h4>\n<ul>\n<li><strong><code>history.length</code></strong>\n<ul>\n<li><strong>描述</strong>  ：返回历史记录中 URL 的数量。</li>\n<li><strong>示例</strong>  ：<pre><code class="language-javascript"><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(history.<span class="hljs-property">length</span>); <span class="hljs-comment">// 输出历史记录的长度</span>\n</code></pre>\n</li>\n</ul>\n</li>\n</ul>\n<h4><strong>方法</strong></h4>\n<ul>\n<li><strong><code>history.back()</code></strong>\n<ul>\n<li><strong>描述</strong>  ：加载历史记录中的前一个 URL，相当于点击浏览器的后退按钮。</li>\n<li><strong>示例</strong>  ：<pre><code class="language-javascript">history.<span class="hljs-title function_">back</span>();\n</code></pre>\n</li>\n</ul>\n</li>\n<li><strong><code>history.forward()</code></strong>\n<ul>\n<li><strong>描述</strong>  ：加载历史记录中的下一个 URL，相当于点击浏览器的前进按钮。</li>\n<li><strong>示例</strong>  ：<pre><code class="language-javascript">history.<span class="hljs-title function_">forward</span>();\n</code></pre>\n</li>\n</ul>\n</li>\n<li><strong><code>history.go(n)</code></strong>\n<ul>\n<li><strong>描述</strong>  ：加载历史记录中相对当前页面的第 <code>n</code> 个 URL。<code>n</code> 可以为正数（前进）或负数（后退）。</li>\n<li><strong>示例</strong>  ：<pre><code class="language-javascript">history.<span class="hljs-title function_">go</span>(-<span class="hljs-number">1</span>); <span class="hljs-comment">// 后退一个页面</span>\nhistory.<span class="hljs-title function_">go</span>(<span class="hljs-number">2</span>);  <span class="hljs-comment">// 前进两个页面</span>\n</code></pre>\n</li>\n</ul>\n</li>\n<li><strong><code>history.pushState(state, title, url)</code></strong>\n<ul>\n<li><strong>描述</strong>  ：向历史记录中添加一个新的状态。不会重新加载页面。</li>\n<li><strong>参数</strong>  ：\n<ul>\n<li><code>state</code>：一个与历史记录条目关联的状态对象，可用于在 <code>popstate</code> 事件中恢复状态。</li>\n<li><code>title</code>：目前大多数浏览器会忽略这个参数，但可以传入一个空字符串。</li>\n<li><code>url</code>：新的 URL，可以是相对路径或绝对路径。</li>\n</ul>\n</li>\n<li><strong>示例</strong>  ：<pre><code class="language-javascript">history.<span class="hljs-title function_">pushState</span>({ <span class="hljs-attr">page</span>: <span class="hljs-number">1</span> }, <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-string">&#x27;/page1&#x27;</span>);\n</code></pre>\n</li>\n</ul>\n</li>\n<li><strong><code>history.replaceState(state, title, url)</code></strong>\n<ul>\n<li><strong>描述</strong>  ：用新的状态替换当前历史记录条目。不会重新加载页面。</li>\n<li><strong>参数</strong>  ：与 <code>pushState</code> 相同。</li>\n<li><strong>示例</strong>  ：<pre><code class="language-javascript">history.<span class="hljs-title function_">replaceState</span>({ <span class="hljs-attr">page</span>: <span class="hljs-number">2</span> }, <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-string">&#x27;/page2&#x27;</span>);\n</code></pre>\n</li>\n</ul>\n</li>\n</ul>\n<hr>\n<h3><strong>3. <code>popstate</code> 事件</strong></h3>\n<ul>\n<li><strong>描述</strong>  ：当活动历史记录条目发生变化时（例如用户点击后退或前进按钮，或调用 <code>history.back()</code>、<code>history.forward()</code>、<code>history.go()</code> 方法），会触发 <code>popstate</code> 事件。</li>\n<li><strong>使用场景</strong>  ：在单页面应用中，监听 <code>popstate</code> 事件以响应用户的导航操作。</li>\n<li><strong>示例</strong>  ：<pre><code class="language-javascript"><span class="hljs-variable language_">window</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;popstate&#x27;</span>, <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> {\n  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;URL changed:&#x27;</span>, <span class="hljs-variable language_">window</span>.<span class="hljs-property">location</span>.<span class="hljs-property">pathname</span>);\n  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;State:&#x27;</span>, event.<span class="hljs-property">state</span>); <span class="hljs-comment">// 获取与历史记录条目关联的状态对象</span>\n});\n</code></pre>\n</li>\n</ul>\n<hr>\n<h3><strong>4. 使用场景</strong></h3>\n<h4><strong>单页面应用（SPA）导航</strong></h4>\n<p>在单页面应用中，可以使用 <code>history.pushState</code> 和 <code>history.replaceState</code> 方法来改变 URL，而不触发页面重新加载。结合 <code>popstate</code> 事件，可以实现无刷新的页面导航。</p>\n<p><strong>示例</strong>  ：</p>\n<pre><code class="language-javascript"><span class="hljs-comment">// 导航函数</span>\n<span class="hljs-keyword">function</span> <span class="hljs-title function_">navigate</span>(<span class="hljs-params">path, state = <span class="hljs-literal">null</span></span>) {\n  history.<span class="hljs-title function_">pushState</span>(state, <span class="hljs-string">&#x27;&#x27;</span>, path);\n  <span class="hljs-comment">// 根据 path 更新页面内容</span>\n  <span class="hljs-title function_">updatePageContent</span>(path);\n}\n\n<span class="hljs-comment">// 监听 popstate 事件</span>\n<span class="hljs-variable language_">window</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;popstate&#x27;</span>, <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> {\n  <span class="hljs-keyword">const</span> path = <span class="hljs-variable language_">window</span>.<span class="hljs-property">location</span>.<span class="hljs-property">pathname</span>;\n  <span class="hljs-comment">// 根据 path 更新页面内容</span>\n  <span class="hljs-title function_">updatePageContent</span>(path);\n});\n\n<span class="hljs-comment">// 更新页面内容的函数（示例）</span>\n<span class="hljs-keyword">function</span> <span class="hljs-title function_">updatePageContent</span>(<span class="hljs-params">path</span>) {\n  <span class="hljs-keyword">const</span> contentElement = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&#x27;content&#x27;</span>);\n  <span class="hljs-keyword">switch</span> (path) {\n    <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;/home&#x27;</span>:\n      contentElement.<span class="hljs-property">textContent</span> = <span class="hljs-string">&#x27;Home Page&#x27;</span>;\n      <span class="hljs-keyword">break</span>;\n    <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;/about&#x27;</span>:\n      contentElement.<span class="hljs-property">textContent</span> = <span class="hljs-string">&#x27;About Page&#x27;</span>;\n      <span class="hljs-keyword">break</span>;\n    <span class="hljs-attr">default</span>:\n      contentElement.<span class="hljs-property">textContent</span> = <span class="hljs-string">&#x27;404 Not Found&#x27;</span>;\n  }\n}\n\n<span class="hljs-comment">// 示例导航</span>\n<span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&#x27;homeButton&#x27;</span>).<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;click&#x27;</span>, <span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">navigate</span>(<span class="hljs-string">&#x27;/home&#x27;</span>));\n<span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&#x27;aboutButton&#x27;</span>).<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;click&#x27;</span>, <span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">navigate</span>(<span class="hljs-string">&#x27;/about&#x27;</span>));\n</code></pre>\n<hr>\n<h3><strong>5. 注意事项</strong></h3>\n<ul>\n<li><strong>浏览器兼容性</strong>  ：<code>history</code> API 在现代浏览器中广泛支持，但在一些旧版浏览器中可能不可用。</li>\n<li><strong>SEO 考虑</strong>  ：使用 <code>history</code> API 的单页面应用在 SEO 方面可能受到影响，因为搜索引擎爬虫可能无法正确索引动态加载的内容。可以考虑使用服务器端渲染（SSR）或预渲染（Prerendering）来改善 SEO。</li>\n<li><strong>安全性</strong>  ：避免在 <code>state</code> 对象中存储敏感信息，因为用户可以通过浏览器开发工具查看和修改 <code>state</code> 对象。</li>\n<li><strong>URL 有效性</strong>  ：确保使用 <code>pushState</code> 或 <code>replaceState</code> 方法设置的 URL 是有效的，并且服务器能够正确处理这些 URL。否则，直接刷新页面时可能会导致 404 错误。</li>\n</ul>\n<hr>\n<h3><strong>6. 与传统导航的区别</strong></h3>\n<table>\n<thead>\n<tr>\n<th>特性</th>\n<th>传统导航</th>\n<th><code>history</code> API 导航</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>页面重新加载</td>\n<td>是</td>\n<td>否</td>\n</tr>\n<tr>\n<td>URL 变化</td>\n<td>是</td>\n<td>是</td>\n</tr>\n<tr>\n<td>历史记录</td>\n<td>添加新条目</td>\n<td>可以添加、替换或修改条目</td>\n</tr>\n<tr>\n<td>用户体验</td>\n<td>较慢，因为页面需要重新加载</td>\n<td>较快，因为页面不需要重新加载</td>\n</tr>\n<tr>\n<td>实现复杂度</td>\n<td>低</td>\n<td>较高，需要手动管理状态和内容更新</td>\n</tr>\n</tbody>\n</table>\n<hr>\n<h3><strong>7. 总结</strong></h3>\n<p><code>window.history</code> 对象提供了强大的 API，用于操作浏览器的会话历史记录。通过 <code>pushState</code> 和 <code>replaceState</code> 方法，可以在不重新加载页面的情况下改变 URL，结合 <code>popstate</code> 事件，可以实现无刷新的页面导航。这对于构建单页面应用（SPA）非常有用。然而，在使用 <code>history</code> API 时，需要注意浏览器兼容性、SEO 和安全性等问题。</p>\n</div>'</script></body></html>