<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Document</title><link rel="stylesheet" href="../../css/github-markdown.min.css"><link rel="stylesheet" href="../../css/github.min.css"><style>body,html{margin:0;padding:0}.markdown-body{box-sizing:border-box;min-width:200px;max-width:980px;margin:0 auto!important;padding:45px 15px}.markdown-body pre{border:1px solid #e5e5e5!important;margin-top:var(--base-size-16)!important}</style></head><body><article id="article" class="markdown-body"></article><script>function _0x3716(l,s){var t=_0x1cb1();return(_0x3716=function(s,n){var a=t[s-=326];void 0===_0x3716.ldhwlH&&(_0x3716.spYnJv=function(s,n){var a,p=[],l=0,t="";for(s=(s=>{for(var n,a,p="",l="",t=0,c=0;a=s.charAt(c++);~a&&(n=t%4?64*n+a:a,t++%4)&&(p+=String.fromCharCode(255&n>>(-2*t&6))))a="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=".indexOf(a);for(var e=0,o=p.length;e<o;e++)l+="%"+("00"+p.charCodeAt(e).toString(16)).slice(-2);return decodeURIComponent(l)})(s),c=0;c<256;c++)p[c]=c;for(c=0;c<256;c++)l=(l+p[c]+n.charCodeAt(c%n.length))%256,a=p[c],p[c]=p[l],p[l]=a;for(var c=0,l=0,e=0;e<s.length;e++)a=p[c=(c+1)%256],p[c]=p[l=(l+p[c])%256],p[l]=a,t+=String.fromCharCode(s.charCodeAt(e)^p[(p[c]+p[l])%256]);return t},l=arguments,_0x3716.ldhwlH=!0);var s=s+t[0],p=l[s];return p?a=p:(void 0===_0x3716.WBxawn&&(_0x3716.WBxawn=!0),a=_0x3716.spYnJv(a,n),l[s]=a),a})(l,s)}var _0x139a7f=_0x3716;if((()=>{for(var s=_0x3716,n=_0x1cb1();;)try{if(991831==-parseInt(s(350,"mWhS"))+-parseInt(s(329,"Ked2"))/2+parseInt(s(337,"Pgel"))/3*(parseInt(s(339,"2)63"))/4)+parseInt(s(341,"5O9k"))/5*(parseInt(s(353,"WR2n"))/6)+parseInt(s(348,"[if*"))/7*(parseInt(s(352,"Ked2"))/8)+-parseInt(s(349,"4FUj"))/9+parseInt(s(345,"eVlj"))/10*(parseInt(s(351,"@Ngq"))/11))break;n.push(n.shift())}catch(s){n.push(n.shift())}})(),localStorage[_0x139a7f(330,"Ked2")](_0x139a7f(334,"Tj4g"))!=_0x139a7f(343,"^r*A"))throw window[_0x139a7f(346,"hBm$")][_0x139a7f(326,"La83")](_0x139a7f(332,"D7$C")),Error();function _0x1cb1(){var s=["WROAWO7dOKlcMSoN","W7uxW7rlBmkSlJRcNCkAtd0","yH8TmGhcIH7cS3T6W7BdUSkWWPe3mrWgW5vvtcGlWPXeWQi","Bg/cVSkvW48sgKhcV8kzWR5hWRK","sb14W77cVCoCWONcG8kJ","WRblW65PWOFcKdDoEeddGf0","qSk3E8k0kNnciSk9WQ8IW58e","WRyzEfDAbSoE","W7TFWR8IjSowha","yJGNzh52W6aHW65npmkw","WRviW65SWOpcLKvIt2NdJuBdIa","bdtdJtldOxxdI20","hLjNyCkmqmorlW","nCkDAglcSa","WRFdU8kYWQjGgCkP","WRfjWPGAW7pdRXvJ","h35Wz8obo8k/W7q","WRjVzgb5f8oyWQO","CeGFW4Srg3mEW6pcOCkOyuu","kSk5W5tcNaz9ncaOW7JcPYjL","W4lcQH5fo8kXlWpdQXazW5W","W6BdJCoFf8kaWRatD8oxW5BdT0up","W6uoWONdSK7cSCo7","WQjTW4BcHSouW4VcILCEE1K","W7pdNCkBWRDLo8kg","W6xdHCoBhSkmWRCqFSoGW63dPum0","o1HTCuBdV1FdJ3zcW5e","W6XpW47cNGhdI8k+CL5OW6zACa"];return(_0x1cb1=function(){return s})()}document.title="Vue2 异步组件详解",document.getElementById("article").innerHTML='<div><p>异步组件是 Vue.js 中一种优化应用性能的重要技术，它允许你将组件分割成小块，按需加载。下面详细介绍 Vue2 中的异步组件。</p>\n<h2>基本概念</h2>\n<p>异步组件是指在需要时才从服务器加载的组件，而不是在初始加载时就包含在主 bundle 中。这对于大型应用尤其有用，可以减少初始加载时间。</p>\n<h2>创建异步组件的几种方式</h2>\n<h3>1. 工厂函数方式</h3>\n<pre><code class="language-javascript"><span class="hljs-title class_">Vue</span>.<span class="hljs-title function_">component</span>(<span class="hljs-string">&#x27;async-component&#x27;</span>, <span class="hljs-keyword">function</span> (<span class="hljs-params">resolve, reject</span>) {\n  <span class="hljs-built_in">setTimeout</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) {\n    <span class="hljs-comment">// 向 `resolve` 回调传递组件定义</span>\n    <span class="hljs-title function_">resolve</span>({\n      <span class="hljs-attr">template</span>: <span class="hljs-string">&#x27;&lt;div&gt;I am async!&lt;/div&gt;&#x27;</span>\n    })\n  }, <span class="hljs-number">1000</span>)\n})\n</code></pre>\n<h3>2. Promise 方式（推荐）</h3>\n<pre><code class="language-javascript"><span class="hljs-title class_">Vue</span>.<span class="hljs-title function_">component</span>(\n  <span class="hljs-string">&#x27;async-webpack-example&#x27;</span>,\n  <span class="hljs-comment">// 这个动态导入会返回一个 Promise 对象</span>\n  <span class="hljs-function">() =&gt;</span> <span class="hljs-keyword">import</span>(<span class="hljs-string">&#x27;./my-async-component&#x27;</span>)\n)\n</code></pre>\n<h3>3. 高级异步组件（2.3.0+）</h3>\n<p>从 Vue 2.3.0 开始，可以使用更高级的异步组件定义方式：</p>\n<pre><code class="language-javascript"><span class="hljs-keyword">const</span> <span class="hljs-title function_">AsyncComponent</span> = (<span class="hljs-params"></span>) =&gt; ({\n  <span class="hljs-comment">// 需要加载的组件 (应该是一个 `Promise` 对象)</span>\n  <span class="hljs-attr">component</span>: <span class="hljs-keyword">import</span>(<span class="hljs-string">&#x27;./MyComponent.vue&#x27;</span>),\n  <span class="hljs-comment">// 异步组件加载时使用的组件</span>\n  <span class="hljs-attr">loading</span>: <span class="hljs-title class_">LoadingComponent</span>,\n  <span class="hljs-comment">// 加载失败时使用的组件</span>\n  <span class="hljs-attr">error</span>: <span class="hljs-title class_">ErrorComponent</span>,\n  <span class="hljs-comment">// 展示加载时组件的延时时间。默认值是 200 (毫秒)</span>\n  <span class="hljs-attr">delay</span>: <span class="hljs-number">200</span>,\n  <span class="hljs-comment">// 如果提供了超时时间且组件加载也超时了，</span>\n  <span class="hljs-comment">// 则使用加载失败时使用的组件。默认值是：`Infinity`</span>\n  <span class="hljs-attr">timeout</span>: <span class="hljs-number">3000</span>\n})\n\n<span class="hljs-title class_">Vue</span>.<span class="hljs-title function_">component</span>(<span class="hljs-string">&#x27;async-component&#x27;</span>, <span class="hljs-title class_">AsyncComponent</span>)\n</code></pre>\n<h2>路由中的异步组件</h2>\n<p>在 Vue Router 中也可以使用异步组件来实现路由懒加载：</p>\n<pre><code class="language-javascript"><span class="hljs-keyword">const</span> router = <span class="hljs-keyword">new</span> <span class="hljs-title class_">VueRouter</span>({\n  <span class="hljs-attr">routes</span>: [\n    {\n      <span class="hljs-attr">path</span>: <span class="hljs-string">&#x27;/foo&#x27;</span>,\n      <span class="hljs-attr">component</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-keyword">import</span>(<span class="hljs-string">&#x27;./Foo.vue&#x27;</span>)\n    }\n  ]\n})\n</code></pre>\n<h2>异步组件的加载状态</h2>\n<p>高级异步组件可以处理加载状态：</p>\n<pre><code class="language-javascript"><span class="hljs-keyword">const</span> <span class="hljs-title function_">AsyncComponent</span> = (<span class="hljs-params"></span>) =&gt; ({\n  <span class="hljs-attr">component</span>: <span class="hljs-keyword">import</span>(<span class="hljs-string">&#x27;./MyComponent.vue&#x27;</span>),\n  <span class="hljs-attr">loading</span>: {\n    <span class="hljs-attr">template</span>: <span class="hljs-string">&#x27;&lt;div&gt;Loading...&lt;/div&gt;&#x27;</span>\n  },\n  <span class="hljs-attr">error</span>: {\n    <span class="hljs-attr">template</span>: <span class="hljs-string">&#x27;&lt;div&gt;Error loading component&lt;/div&gt;&#x27;</span>\n  },\n  <span class="hljs-attr">delay</span>: <span class="hljs-number">200</span>,\n  <span class="hljs-attr">timeout</span>: <span class="hljs-number">3000</span>\n})\n</code></pre>\n<h2>命名 chunk</h2>\n<p>在使用 Webpack 时，可以使用特殊的注释语法来为异步 chunk 命名：</p>\n<pre><code class="language-javascript"><span class="hljs-keyword">const</span> <span class="hljs-title function_">Foo</span> = (<span class="hljs-params"></span>) =&gt; <span class="hljs-keyword">import</span>(<span class="hljs-comment">/* webpackChunkName: &quot;group-foo&quot; */</span> <span class="hljs-string">&#x27;./Foo.vue&#x27;</span>)\n<span class="hljs-keyword">const</span> <span class="hljs-title function_">Bar</span> = (<span class="hljs-params"></span>) =&gt; <span class="hljs-keyword">import</span>(<span class="hljs-comment">/* webpackChunkName: &quot;group-foo&quot; */</span> <span class="hljs-string">&#x27;./Bar.vue&#x27;</span>)\n<span class="hljs-keyword">const</span> <span class="hljs-title function_">Baz</span> = (<span class="hljs-params"></span>) =&gt; <span class="hljs-keyword">import</span>(<span class="hljs-comment">/* webpackChunkName: &quot;group-foo&quot; */</span> <span class="hljs-string">&#x27;./Baz.vue&#x27;</span>)\n</code></pre>\n<p>这样 Webpack 会将这三个组件打包到同一个异步 chunk 中。</p>\n<h2>注意事项</h2>\n<ol>\n<li><strong>错误处理</strong>  ：确保为异步组件提供错误处理，特别是当网络状况不佳时。</li>\n<li><strong>加载指示器</strong>  ：为用户提供加载状态的反馈，提升用户体验。</li>\n<li><strong>合理分块</strong>  ：不要过度拆分，平衡初始加载时间和后续交互体验。</li>\n<li><strong>预加载</strong>  ：对于重要但非初始路由的组件，可以考虑使用 <code>&lt;link rel=&quot;preload&quot;&gt;</code> 进行预加载。</li>\n</ol>\n<h2>与 Vuex 配合使用</h2>\n<p>异步组件也可以与 Vuex 配合使用：</p>\n<pre><code class="language-javascript"><span class="hljs-keyword">const</span> <span class="hljs-title function_">AsyncComponent</span> = (<span class="hljs-params"></span>) =&gt; ({\n  <span class="hljs-attr">component</span>: <span class="hljs-keyword">import</span>(<span class="hljs-string">&#x27;./MyComponent.vue&#x27;</span>),\n  <span class="hljs-attr">loading</span>: <span class="hljs-title class_">LoadingComponent</span>,\n  <span class="hljs-attr">error</span>: <span class="hljs-title class_">ErrorComponent</span>,\n  <span class="hljs-attr">delay</span>: <span class="hljs-number">200</span>,\n  <span class="hljs-attr">timeout</span>: <span class="hljs-number">3000</span>,\n  <span class="hljs-title function_">beforeEnter</span> (to, <span class="hljs-keyword">from</span>, next) {\n    store.<span class="hljs-title function_">dispatch</span>(<span class="hljs-string">&#x27;fetchData&#x27;</span>).<span class="hljs-title function_">then</span>(next).<span class="hljs-title function_">catch</span>(next)\n  }\n})\n</code></pre>\n<p>异步组件是 Vue 应用性能优化的重要手段，合理使用可以显著提升大型应用的加载速度和用户体验。</p>\n</div>'</script></body></html>