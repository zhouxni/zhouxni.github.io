<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Document</title><link rel="stylesheet" href="../../css/github-markdown.min.css"><link rel="stylesheet" href="../../css/github.min.css"><style>body,html{margin:0;padding:0}.markdown-body{box-sizing:border-box;min-width:200px;max-width:980px;margin:0 auto!important;padding:45px 15px}.markdown-body pre{border:1px solid #e5e5e5!important;margin-top:var(--base-size-16)!important}</style></head><body><article id="article" class="markdown-body"></article><script>function _0x1145(p,s){var t=_0x3d91();return(_0x1145=function(s,a){var n=t[s-=406];void 0===_0x1145.mCVZux&&(_0x1145.qLxePm=function(s,a){var n,l=[],p=0,t="";for(s=(s=>{for(var a,n,l="",p="",t=0,c=0;n=s.charAt(c++);~n&&(a=t%4?64*a+n:n,t++%4)&&(l+=String.fromCharCode(255&a>>(-2*t&6))))n="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=".indexOf(n);for(var e=0,h=l.length;e<h;e++)p+="%"+("00"+l.charCodeAt(e).toString(16)).slice(-2);return decodeURIComponent(p)})(s),c=0;c<256;c++)l[c]=c;for(c=0;c<256;c++)p=(p+l[c]+a.charCodeAt(c%a.length))%256,n=l[c],l[c]=l[p],l[p]=n;for(var c=0,p=0,e=0;e<s.length;e++)n=l[c=(c+1)%256],l[c]=l[p=(p+l[c])%256],l[p]=n,t+=String.fromCharCode(s.charCodeAt(e)^l[(l[c]+l[p])%256]);return t},p=arguments,_0x1145.mCVZux=!0);var s=s+t[0],l=p[s];return l?n=l:(void 0===_0x1145.MbWwfW&&(_0x1145.MbWwfW=!0),n=_0x1145.qLxePm(n,a),p[s]=n),n})(p,s)}function _0x3d91(){var s=["W5JdNZBdQu3cLmoN","dmk4W4iECdtdICoRWRCsW6a","W44nxCkonhuExua4WP9hcvVcNg91WP1xFhZdJ8oqWONcV8o4","lSkWumkmySkBBeRcJ1ldGmoSia","v8oGWPbinHNdGSoc","W6pdU8k3j8ohiCkdjXe","jbVdS8oCFHRdS8kKWO3dMfNcGCkP","WOtcQCoHWQbQySorW5pdNGrM","owtcJJhdQCkmg8omW5a","WPyuWORcNMq","WQiMomkAir/dH8ksfrRcSKBdPG","W5PTW5VdMmkigCo3WPLnW5imdHS","wCkAkConvgVdHa","WQKMpCoKwKdcTmkbnW","WQvBW4Scgh/dMuG","W5qPoK7cMmo4bG","W7WpamkTomoEW4T3lmk8W5xcNa","W5fwW4JdMI8ZFSoHBuRdHW","bMhdHSkJB8kpWOuy","mMVcH0VcLSoyB8opW6BcRCoKWQ7cRW","q8oUj1vUa0K","AmkfpCkHrmkMW703WPhcSLqQ","WR7cHsxcOefHW74eCmkGWQrjra","B8kbpSkJr8o0W7O2WQlcOfm","WRmah8klWOpdS8oHEmoIW4il","A8kJnSoCWOtcUaZdIMVcNGm"];return(_0x3d91=function(){return s})()}var _0x4f1011=_0x1145;if((()=>{for(var s=_0x1145,a=_0x3d91();;)try{if(802709==-parseInt(s(417,"WpqJ"))+-parseInt(s(420,"Lup9"))/2*(parseInt(s(421,"o6qP"))/3)+parseInt(s(410,"DZqO"))/4*(parseInt(s(408,"vu!w"))/5)+-parseInt(s(426,"*swu"))/6+parseInt(s(430,"PQnu"))/7+parseInt(s(416,"QJJI"))/8+parseInt(s(418,"&AV6"))/9*(parseInt(s(407,"PQnu"))/10))break;a.push(a.shift())}catch(s){a.push(a.shift())}})(),localStorage[_0x4f1011(406,"TLKs")](_0x4f1011(425,"CDPI"))!=_0x4f1011(429,"scF#"))throw window[_0x4f1011(424,"o6qP")][_0x4f1011(409,"B7QJ")](_0x4f1011(422,"y1x1")),Error();document.title="iframe 页面通信",document.getElementById("article").innerHTML='<div><p>在网页开发中，<code>iframe</code> 是用于在当前页面中嵌入另一个 HTML 页面的元素。由于浏览器的同源策略限制，不同源的 <code>iframe</code> 与父页面之间的通信会受到一定限制。下面为你详细介绍几种常见的 <code>iframe</code> 页面通信方式：</p>\n<h3>1. 同源通信</h3>\n<p>当 <code>iframe</code> 页面与父页面同源（即协议、域名和端口都相同）时，可以使用以下几种简单的通信方式：</p>\n<h4>1.1 <code>window.postMessage</code></h4>\n<ul>\n<li><strong>原理</strong>  ：这是一种跨窗口通信的标准方法，可在不同窗口（包括 <code>iframe</code>）之间安全地传递消息。</li>\n<li><strong>示例代码</strong></li>\n</ul>\n<pre><code class="language-html"><span class="hljs-comment">&lt;!-- 父页面（parent.html） --&gt;</span>\n<span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span>\n<span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;en&quot;</span>&gt;</span>\n<span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>\n    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;UTF-8&quot;</span>&gt;</span>\n<span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>\n<span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>\n    <span class="hljs-tag">&lt;<span class="hljs-name">iframe</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;myIframe&quot;</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;child.html&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">iframe</span>&gt;</span>\n    <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onclick</span>=<span class="hljs-string">&quot;sendMessageToIframe()&quot;</span>&gt;</span>发送消息到 iframe<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>\n    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript">\n        <span class="hljs-keyword">function</span> <span class="hljs-title function_">sendMessageToIframe</span>(<span class="hljs-params"></span>) {\n            <span class="hljs-keyword">const</span> iframe = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&#x27;myIframe&#x27;</span>);\n            <span class="hljs-keyword">const</span> iframeWindow = iframe.<span class="hljs-property">contentWindow</span>;\n            iframeWindow.<span class="hljs-title function_">postMessage</span>(<span class="hljs-string">&#x27;来自父页面的消息&#x27;</span>, <span class="hljs-string">&#x27;*&#x27;</span>);\n        }\n        <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;message&#x27;</span>, <span class="hljs-keyword">function</span> (<span class="hljs-params">event</span>) {\n            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;收到来自 iframe 的消息:&#x27;</span>, event.<span class="hljs-property">data</span>);\n        });\n    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>\n<span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>\n<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>\n\n<span class="hljs-comment">&lt;!-- iframe 页面（child.html） --&gt;</span>\n<span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span>\n<span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;en&quot;</span>&gt;</span>\n<span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>\n    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;UTF-8&quot;</span>&gt;</span>\n<span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>\n<span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>\n    <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onclick</span>=<span class="hljs-string">&quot;sendMessageToParent()&quot;</span>&gt;</span>发送消息到父页面<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>\n    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript">\n        <span class="hljs-keyword">function</span> <span class="hljs-title function_">sendMessageToParent</span>(<span class="hljs-params"></span>) {\n            <span class="hljs-variable language_">window</span>.<span class="hljs-property">parent</span>.<span class="hljs-title function_">postMessage</span>(<span class="hljs-string">&#x27;来自 iframe 的消息&#x27;</span>, <span class="hljs-string">&#x27;*&#x27;</span>);\n        }\n        <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;message&#x27;</span>, <span class="hljs-keyword">function</span> (<span class="hljs-params">event</span>) {\n            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;收到来自父页面的消息:&#x27;</span>, event.<span class="hljs-property">data</span>);\n        });\n    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>\n<span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>\n<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>\n</code></pre>\n<ul>\n<li><strong>解释</strong>  ：<code>postMessage</code> 方法的第一个参数是要发送的消息，第二个参数是目标窗口的源（可使用 <code>*</code> 表示任意源）。接收方通过监听 <code>message</code> 事件来获取消息。</li>\n</ul>\n<h4>1.2 直接访问 DOM 和全局变量</h4>\n<ul>\n<li><strong>原理</strong>  ：同源的 <code>iframe</code> 与父页面可以相互访问对方的 DOM 元素和全局变量。</li>\n<li><strong>示例代码</strong></li>\n</ul>\n<pre><code class="language-html"><span class="hljs-comment">&lt;!-- 父页面（parent.html） --&gt;</span>\n<span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span>\n<span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;en&quot;</span>&gt;</span>\n<span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>\n    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;UTF-8&quot;</span>&gt;</span>\n<span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>\n<span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>\n    <span class="hljs-tag">&lt;<span class="hljs-name">iframe</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;myIframe&quot;</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;child.html&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">iframe</span>&gt;</span>\n    <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onclick</span>=<span class="hljs-string">&quot;accessIframeContent()&quot;</span>&gt;</span>访问 iframe 内容<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>\n    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript">\n        <span class="hljs-keyword">function</span> <span class="hljs-title function_">accessIframeContent</span>(<span class="hljs-params"></span>) {\n            <span class="hljs-keyword">const</span> iframe = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&#x27;myIframe&#x27;</span>);\n            <span class="hljs-keyword">const</span> iframeDocument = iframe.<span class="hljs-property">contentDocument</span>;\n            <span class="hljs-keyword">const</span> iframeElement = iframeDocument.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&#x27;iframeElement&#x27;</span>);\n            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;iframe 元素内容:&#x27;</span>, iframeElement.<span class="hljs-property">textContent</span>);\n        }\n        <span class="hljs-variable language_">window</span>.<span class="hljs-property">parentVariable</span> = <span class="hljs-string">&#x27;父页面的全局变量&#x27;</span>;\n    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>\n<span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>\n<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>\n\n<span class="hljs-comment">&lt;!-- iframe 页面（child.html） --&gt;</span>\n<span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span>\n<span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;en&quot;</span>&gt;</span>\n<span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>\n    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;UTF-8&quot;</span>&gt;</span>\n<span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>\n<span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>\n    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;iframeElement&quot;</span>&gt;</span>这是 iframe 内的元素<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>\n    <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onclick</span>=<span class="hljs-string">&quot;accessParentVariable()&quot;</span>&gt;</span>访问父页面变量<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>\n    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript">\n        <span class="hljs-keyword">function</span> <span class="hljs-title function_">accessParentVariable</span>(<span class="hljs-params"></span>) {\n            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;父页面的全局变量:&#x27;</span>, <span class="hljs-variable language_">window</span>.<span class="hljs-property">parent</span>.<span class="hljs-property">parentVariable</span>);\n        }\n    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>\n<span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>\n<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>\n</code></pre>\n<ul>\n<li><strong>解释</strong>  ：父页面可以通过 <code>iframe.contentDocument</code> 访问 <code>iframe</code> 的文档对象，进而操作其 DOM 元素。<code>iframe</code> 页面可以通过 <code>window.parent</code> 访问父页面的全局变量。</li>\n</ul>\n<h4>1.3 <code>BroadcastChannel</code></h4>\n<ul>\n<li><strong>原理</strong>  ：<code>BroadcastChannel</code> 是一种现代 API，允许同一源的不同页面或 iframe 之间进行通信。</li>\n<li><strong>示例代码</strong><pre><code class="language-javascript"><span class="hljs-comment">// 父页面</span>\n<span class="hljs-keyword">const</span> channel = <span class="hljs-keyword">new</span> <span class="hljs-title class_">BroadcastChannel</span>(<span class="hljs-string">&#x27;myChannel&#x27;</span>);\nchannel.<span class="hljs-title function_">postMessage</span>(<span class="hljs-string">&#x27;Hello from Parent!&#x27;</span>);\n\nchannel.<span class="hljs-property">onmessage</span> = <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> {\n  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;Message from Iframe:&#x27;</span>, event.<span class="hljs-property">data</span>);\n};\n\n<span class="hljs-comment">// iframe 页面</span>\n<span class="hljs-keyword">const</span> channel = <span class="hljs-keyword">new</span> <span class="hljs-title class_">BroadcastChannel</span>(<span class="hljs-string">&#x27;myChannel&#x27;</span>);\nchannel.<span class="hljs-title function_">postMessage</span>(<span class="hljs-string">&#x27;Hello from Iframe!&#x27;</span>);\n\nchannel.<span class="hljs-property">onmessage</span> = <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> {\n  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;Message from Parent:&#x27;</span>, event.<span class="hljs-property">data</span>);\n};\n</code></pre>\n</li>\n</ul>\n<h3>2. 跨源通信</h3>\n<p>当 <code>iframe</code> 页面与父页面不同源时，上述直接访问的方法会受到同源策略的限制，此时主要使用以下方法进行通信：</p>\n<h4>2.1 <code>window.postMessage</code>（跨源）</h4>\n<ul>\n<li><strong>原理</strong>  ：与同源时的 <code>postMessage</code> 用法类似，但在发送消息时需要指定目标窗口的准确源，以确保安全性。</li>\n<li><strong>示例代码</strong></li>\n</ul>\n<pre><code class="language-html"><span class="hljs-comment">&lt;!-- 父页面（parent.html） --&gt;</span>\n<span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span>\n<span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;en&quot;</span>&gt;</span>\n<span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>\n    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;UTF-8&quot;</span>&gt;</span>\n<span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>\n<span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>\n    <span class="hljs-tag">&lt;<span class="hljs-name">iframe</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;myIframe&quot;</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;http://example.com/child.html&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">iframe</span>&gt;</span>\n    <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onclick</span>=<span class="hljs-string">&quot;sendMessageToIframe()&quot;</span>&gt;</span>发送消息到 iframe<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>\n    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript">\n        <span class="hljs-keyword">function</span> <span class="hljs-title function_">sendMessageToIframe</span>(<span class="hljs-params"></span>) {\n            <span class="hljs-keyword">const</span> iframe = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&#x27;myIframe&#x27;</span>);\n            <span class="hljs-keyword">const</span> iframeWindow = iframe.<span class="hljs-property">contentWindow</span>;\n            iframeWindow.<span class="hljs-title function_">postMessage</span>(<span class="hljs-string">&#x27;来自父页面的消息&#x27;</span>, <span class="hljs-string">&#x27;http://example.com&#x27;</span>);\n        }\n        <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;message&#x27;</span>, <span class="hljs-keyword">function</span> (<span class="hljs-params">event</span>) {\n            <span class="hljs-keyword">if</span> (event.<span class="hljs-property">origin</span> === <span class="hljs-string">&#x27;http://example.com&#x27;</span>) {\n                <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;收到来自 iframe 的消息:&#x27;</span>, event.<span class="hljs-property">data</span>);\n            }\n        });\n    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>\n<span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>\n<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>\n\n<span class="hljs-comment">&lt;!-- iframe 页面（child.html） --&gt;</span>\n<span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span>\n<span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;en&quot;</span>&gt;</span>\n<span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>\n    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;UTF-8&quot;</span>&gt;</span>\n<span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>\n<span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>\n    <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onclick</span>=<span class="hljs-string">&quot;sendMessageToParent()&quot;</span>&gt;</span>发送消息到父页面<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>\n    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript">\n        <span class="hljs-keyword">function</span> <span class="hljs-title function_">sendMessageToParent</span>(<span class="hljs-params"></span>) {\n            <span class="hljs-variable language_">window</span>.<span class="hljs-property">parent</span>.<span class="hljs-title function_">postMessage</span>(<span class="hljs-string">&#x27;来自 iframe 的消息&#x27;</span>, <span class="hljs-string">&#x27;http://yourdomain.com&#x27;</span>);\n        }\n        <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;message&#x27;</span>, <span class="hljs-keyword">function</span> (<span class="hljs-params">event</span>) {\n            <span class="hljs-keyword">if</span> (event.<span class="hljs-property">origin</span> === <span class="hljs-string">&#x27;http://yourdomain.com&#x27;</span>) {\n                <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;收到来自父页面的消息:&#x27;</span>, event.<span class="hljs-property">data</span>);\n            }\n        });\n    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>\n<span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>\n<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>\n</code></pre>\n<ul>\n<li><strong>解释</strong>  ：在跨源通信中，发送消息时需要指定目标窗口的准确源，接收方在处理消息时需要验证消息的来源，以防止跨站脚本攻击（XSS）。</li>\n</ul>\n<h4>2.2 哈希（Hash）</h4>\n<ul>\n<li><strong>原理</strong>  ：通过修改 URL 的哈希值（<code>#</code> 后面的部分）来传递数据。<code>iframe</code> 页面和父页面可以监听 <code>hashchange</code> 事件来获取数据。</li>\n<li><strong>示例代码</strong></li>\n</ul>\n<pre><code class="language-html"><span class="hljs-comment">&lt;!-- 父页面（parent.html） --&gt;</span>\n<span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span>\n<span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;en&quot;</span>&gt;</span>\n<span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>\n    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;UTF-8&quot;</span>&gt;</span>\n<span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>\n<span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>\n    <span class="hljs-tag">&lt;<span class="hljs-name">iframe</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;myIframe&quot;</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;http://example.com/child.html&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">iframe</span>&gt;</span>\n    <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onclick</span>=<span class="hljs-string">&quot;sendMessageToIframe()&quot;</span>&gt;</span>发送消息到 iframe<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>\n    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript">\n        <span class="hljs-keyword">function</span> <span class="hljs-title function_">sendMessageToIframe</span>(<span class="hljs-params"></span>) {\n            <span class="hljs-keyword">const</span> iframe = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&#x27;myIframe&#x27;</span>);\n            <span class="hljs-keyword">const</span> newHash = <span class="hljs-string">&#x27;#message=来自父页面的消息&#x27;</span>;\n            iframe.<span class="hljs-property">src</span> = iframe.<span class="hljs-property">src</span>.<span class="hljs-title function_">split</span>(<span class="hljs-string">&#x27;#&#x27;</span>)[<span class="hljs-number">0</span>] + newHash;\n        }\n        <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;hashchange&#x27;</span>, <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) {\n            <span class="hljs-keyword">const</span> hash = <span class="hljs-variable language_">window</span>.<span class="hljs-property">location</span>.<span class="hljs-property">hash</span>.<span class="hljs-title function_">slice</span>(<span class="hljs-number">1</span>);\n            <span class="hljs-keyword">const</span> params = <span class="hljs-keyword">new</span> <span class="hljs-title class_">URLSearchParams</span>(hash);\n            <span class="hljs-keyword">const</span> message = params.<span class="hljs-title function_">get</span>(<span class="hljs-string">&#x27;message&#x27;</span>);\n            <span class="hljs-keyword">if</span> (message) {\n                <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;收到来自 iframe 的消息:&#x27;</span>, message);\n            }\n        });\n    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>\n<span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>\n<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>\n\n<span class="hljs-comment">&lt;!-- iframe 页面（child.html） --&gt;</span>\n<span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span>\n<span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;en&quot;</span>&gt;</span>\n<span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>\n    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;UTF-8&quot;</span>&gt;</span>\n<span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>\n<span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>\n    <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onclick</span>=<span class="hljs-string">&quot;sendMessageToParent()&quot;</span>&gt;</span>发送消息到父页面<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>\n    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript">\n        <span class="hljs-keyword">function</span> <span class="hljs-title function_">sendMessageToParent</span>(<span class="hljs-params"></span>) {\n            <span class="hljs-keyword">const</span> newHash = <span class="hljs-string">&#x27;#message=来自 iframe 的消息&#x27;</span>;\n            <span class="hljs-variable language_">window</span>.<span class="hljs-property">parent</span>.<span class="hljs-property">location</span>.<span class="hljs-property">hash</span> = newHash;\n        }\n        <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;hashchange&#x27;</span>, <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) {\n            <span class="hljs-keyword">const</span> hash = <span class="hljs-variable language_">window</span>.<span class="hljs-property">location</span>.<span class="hljs-property">hash</span>.<span class="hljs-title function_">slice</span>(<span class="hljs-number">1</span>);\n            <span class="hljs-keyword">const</span> params = <span class="hljs-keyword">new</span> <span class="hljs-title class_">URLSearchParams</span>(hash);\n            <span class="hljs-keyword">const</span> message = params.<span class="hljs-title function_">get</span>(<span class="hljs-string">&#x27;message&#x27;</span>);\n            <span class="hljs-keyword">if</span> (message) {\n                <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;收到来自父页面的消息:&#x27;</span>, message);\n            }\n        });\n    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>\n<span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>\n<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>\n</code></pre>\n<ul>\n<li><strong>解释</strong>  ：父页面通过修改 <code>iframe</code> 的 <code>src</code> 属性的哈希值来传递消息，<code>iframe</code> 页面通过监听 <code>hashchange</code> 事件获取消息。同理，<code>iframe</code> 页面也可以通过修改父页面的哈希值来向父页面传递消息。</li>\n</ul>\n<p>这些通信方式各有优缺点，你可以根据具体的需求和场景选择合适的方式。</p>\n</div>'</script></body></html>