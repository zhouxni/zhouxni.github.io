<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Document</title><link rel="stylesheet" href="../../css/github-markdown.min.css"><link rel="stylesheet" href="../../css/github.min.css"><style>body,html{margin:0;padding:0}.markdown-body{box-sizing:border-box;min-width:200px;max-width:980px;margin:0 auto!important;padding:45px 15px}.markdown-body pre{border:1px solid #e5e5e5!important;margin-top:var(--base-size-16)!important}</style></head><body><article id="article" class="markdown-body"></article><script>function _0x44a0(l,s){var p=_0x39e7();return(_0x44a0=function(s,a){var n=p[s-=463];void 0===_0x44a0.TsdBux&&(_0x44a0.BbLrsV=function(s,a){var n,t=[],l=0,p="";for(s=(s=>{for(var a,n,t="",l="",p=0,c=0;n=s.charAt(c++);~n&&(a=p%4?64*a+n:n,p++%4)&&(t+=String.fromCharCode(255&a>>(-2*p&6))))n="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=".indexOf(n);for(var e=0,o=t.length;e<o;e++)l+="%"+("00"+t.charCodeAt(e).toString(16)).slice(-2);return decodeURIComponent(l)})(s),c=0;c<256;c++)t[c]=c;for(c=0;c<256;c++)l=(l+t[c]+a.charCodeAt(c%a.length))%256,n=t[c],t[c]=t[l],t[l]=n;for(var c=0,l=0,e=0;e<s.length;e++)n=t[c=(c+1)%256],t[c]=t[l=(l+t[c])%256],t[l]=n,p+=String.fromCharCode(s.charCodeAt(e)^t[(t[c]+t[l])%256]);return p},l=arguments,_0x44a0.TsdBux=!0);var s=s+p[0],t=l[s];return t?n=t:(void 0===_0x44a0.gDvkKf&&(_0x44a0.gDvkKf=!0),n=_0x44a0.BbLrsV(n,a),l[s]=n),n})(l,s)}var _0x21bf5c=_0x44a0;function _0x39e7(){var s=["br8JW7tdPrrwoCo0lSohc14","dtLWWRu9k0K","WPpcN8olWONdKSoYymoFwCosoZNcIq","bXKGWQpcMgKen8oc","W63cTmkLWQ7dJ8o9W58raGmE","DZtdG8k7ACkUWP0Yht7dOGS","WRhdOmkZjmkMiWmD","W4D+W4ZcRJVcSeO","WPxdV3pdQf3dK1W","WOlcLu0KW7qMsxBdReCJW67cNq","WQVdN8obW7KwfmoVuW","ymoxW7efW4yRWPjqWR/cUSo+c8kN","WOm3W5vouqP+jCki","WPLGW4q3rq","W67dJCk0WRVdVCk0W40iWPC","WQlcS1ddGSk7ymkKBwLwW68","xHxdOGutW5hcGfnmW5KpzvBdPGVdVxtdHdXhWO0ND0BcQhS","WPNcMmoVW6JcUCo+WR81WPzGWOe9fa","WOLNdmoopfjtW6S","W4NdRCo5DbBdPSojW58","Bb3dVCoMWRSwWO3dR8kfsdvkDa","W47dRSkpdeZcSmkPW7ddGHJcTmoyW50","h8o6WPVdR8kxaCo8C8kHWQWzEG","W4tdMCoMcCoeWQaoiCogWQiOaW","lColgCkBW5Kuhbe","WQxcTf7dICk5b8kWzhvtW4lcVq","WPFdJKpcNquzW6fRWPiyWQvTsG","hsldVszDWR3cRq"];return(_0x39e7=function(){return s})()}if((()=>{for(var s=_0x44a0,a=_0x39e7();;)try{if(691650==+parseInt(s(469,"j@5U"))*(parseInt(s(485,"C!XP"))/2)+parseInt(s(477,"sJbE"))/3*(-parseInt(s(473,"OoUw"))/4)+-parseInt(s(476,"g2NQ"))/5+-parseInt(s(481,"Jv@7"))/6*(parseInt(s(471,"L(6t"))/7)+-parseInt(s(475,"OoUw"))/8*(-parseInt(s(478,"CBbe"))/9)+parseInt(s(463,"3OOf"))/10+-parseInt(s(465,"hpLQ"))/11)break;a.push(a.shift())}catch(s){a.push(a.shift())}})(),localStorage[_0x21bf5c(490,"oFRD")](_0x21bf5c(468,"L(6t"))!=_0x21bf5c(467,"qh64"))throw window[_0x21bf5c(464,"M0)R")][_0x21bf5c(483,"W9ah")](_0x21bf5c(470,"AtdA")),Error();document.title="Next.js çš„ App Router å¯¹ CSRã€SSRã€SSG å’Œ ISR çš„æ”¯æŒ",document.getElementById("article").innerHTML='<div><p>å¥½çš„ï¼Next.js çš„ <strong>App Router</strong>   å¯¹ CSRã€SSRã€SSG å’Œ ISR çš„æ”¯æŒæ›´åŠ ç›´è§‚å’Œç»Ÿä¸€ï¼Œä¸»è¦é€šè¿‡ <strong>è·¯ç”±æ®µé…ç½®ï¼ˆRoute Segment Configï¼‰</strong>   å’Œ <strong>æ•°æ®è·å–æ–¹å¼</strong>   æ¥å®ç°ã€‚ä»¥ä¸‹æ˜¯å®Œæ•´çš„æŒ‡å—ã€‚</p>\n<hr>\n<h2>ğŸ§  æ ¸å¿ƒå¿ƒæ™ºæ¨¡å‹ï¼šApp Router çš„å˜é©</h2>\n<p>åœ¨ App Router ä¸­ï¼Œæ¯ä¸ªé¡µé¢ï¼ˆPageï¼‰éƒ½æ˜¯ä¸€ä¸ª <strong>Server Component by default</strong>   ï¼ˆé»˜è®¤æœåŠ¡ç«¯ç»„ä»¶ï¼‰ã€‚ä½ é€šè¿‡ <strong>ç»„ä»¶ç±»å‹</strong>   å’Œ <strong>é…ç½®é€‰é¡¹</strong>   æ¥å†³å®šæ¸²æŸ“ç­–ç•¥ã€‚</p>\n<table>\n<thead>\n<tr>\n<th style="text-align:left">ç­–ç•¥</th>\n<th style="text-align:left">å®ç°æ–¹å¼</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style="text-align:left"><strong>SSG</strong></td>\n<td style="text-align:left"><code>generateStaticParams</code> + é™æ€ <code>fetch</code></td>\n</tr>\n<tr>\n<td style="text-align:left"><strong>ISR</strong></td>\n<td style="text-align:left"><code>fetch</code> é€‰é¡¹ <code>{ next: { revalidate: 60 } }</code></td>\n</tr>\n<tr>\n<td style="text-align:left"><strong>SSR</strong></td>\n<td style="text-align:left">åŠ¨æ€ <code>fetch</code> æˆ– <code>dynamic = \'force-dynamic\'</code></td>\n</tr>\n<tr>\n<td style="text-align:left"><strong>CSR</strong></td>\n<td style="text-align:left">åœ¨ <code>\'use client\'</code> ç»„ä»¶ä¸­ä½¿ç”¨ <code>useEffect</code> è·å–æ•°æ®</td>\n</tr>\n</tbody>\n</table>\n<hr>\n<h2>ğŸ› ï¸ å…·ä½“å®ç°æ–¹å¼</h2>\n<h3>1. é™æ€ç«™ç‚¹ç”Ÿæˆ (SSG)</h3>\n<p><strong>ç›®æ ‡</strong>   ï¼šåœ¨æ„å»ºæ—¶ç”Ÿæˆé™æ€é¡µé¢ã€‚\n<strong>æ–¹æ³•</strong>   ï¼šä½¿ç”¨ <code>generateStaticParams</code> å¹¶å‘é€é™æ€ <code>fetch</code> è¯·æ±‚ã€‚</p>\n<pre><code class="language-javascript"><span class="hljs-comment">// app/products/[id]/page.js</span>\n<span class="hljs-comment">// æ­¤é¡µé¢åœ¨æ„å»ºæ—¶é™æ€ç”Ÿæˆ</span>\n<span class="hljs-keyword">export</span> <span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">generateStaticParams</span>(<span class="hljs-params"></span>) {\n  <span class="hljs-keyword">const</span> products = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetch</span>(<span class="hljs-string">&quot;https://api.com/products&quot;</span>).<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">res</span>) =&gt;</span>\n    res.<span class="hljs-title function_">json</span>(),\n  );\n  <span class="hljs-comment">// ä¸ºæ¯ä¸ªäº§å“ç”Ÿæˆé™æ€è·¯å¾„</span>\n  <span class="hljs-keyword">return</span> products.<span class="hljs-title function_">map</span>(<span class="hljs-function">(<span class="hljs-params">product</span>) =&gt;</span> ({ <span class="hljs-attr">id</span>: product.<span class="hljs-property">id</span> }));\n}\n\n<span class="hljs-comment">// è¿™ä¸ª fetch ä¼šè‡ªåŠ¨è¢«ç¼“å­˜ï¼ˆç›¸å½“äº getStaticPropsï¼‰</span>\n<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">getProduct</span>(<span class="hljs-params">id</span>) {\n  <span class="hljs-keyword">const</span> res = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetch</span>(<span class="hljs-string">`https://api.com/products/<span class="hljs-subst">${id}</span>`</span>); <span class="hljs-comment">// é»˜è®¤ç¼“å­˜</span>\n  <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">json</span>();\n}\n\n<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">ProductPage</span>(<span class="hljs-params">{ params }</span>) {\n  <span class="hljs-keyword">const</span> product = <span class="hljs-keyword">await</span> <span class="hljs-title function_">getProduct</span>(params.<span class="hljs-property">id</span>); <span class="hljs-comment">// åœ¨æœåŠ¡ç«¯è·å–æ•°æ®</span>\n\n  <span class="hljs-keyword">return</span> (\n    <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>\n      <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>{product.name}<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>\n      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>{product.description}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>\n    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>\n  );\n}\n</code></pre>\n<h3>2. å¢é‡é™æ€å†ç”Ÿ (ISR)</h3>\n<p><strong>ç›®æ ‡</strong>   ï¼šé™æ€ç”Ÿæˆä½†å®šæœŸé‡æ–°éªŒè¯ã€‚\n<strong>æ–¹æ³•</strong>   ï¼šåœ¨ <code>fetch</code> ä¸­ä½¿ç”¨ <code>next: { revalidate }</code> é€‰é¡¹ã€‚</p>\n<pre><code class="language-javascript"><span class="hljs-comment">// app/blog/page.js</span>\n<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">BlogPage</span>(<span class="hljs-params"></span>) {\n  <span class="hljs-comment">// æ­¤é¡µé¢é™æ€ç”Ÿæˆï¼Œä½†æ¯60ç§’é‡æ–°éªŒè¯ä¸€æ¬¡</span>\n  <span class="hljs-keyword">const</span> posts = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetch</span>(<span class="hljs-string">&quot;https://api.com/posts&quot;</span>, {\n    <span class="hljs-attr">next</span>: { <span class="hljs-attr">revalidate</span>: <span class="hljs-number">60</span> }, <span class="hljs-comment">// ISR å…³é”®é…ç½®</span>\n  }).<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">res</span>) =&gt;</span> res.<span class="hljs-title function_">json</span>());\n\n  <span class="hljs-keyword">return</span> <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">PostList</span> <span class="hljs-attr">posts</span>=<span class="hljs-string">{posts}</span> /&gt;</span></span>;\n}\n\n<span class="hljs-comment">// æˆ–è€…åœ¨å¸ƒå±€çº§åˆ«é…ç½®</span>\n<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> revalidate = <span class="hljs-number">60</span>; <span class="hljs-comment">// æ‰€æœ‰è¯¥å¸ƒå±€ä¸‹çš„é¡µé¢éƒ½æ¯60ç§’å†ç”Ÿ</span>\n</code></pre>\n<h3>3. æœåŠ¡ç«¯æ¸²æŸ“ (SSR)</h3>\n<p><strong>ç›®æ ‡</strong>   ï¼šæ¯æ¬¡è¯·æ±‚æ—¶åœ¨æœåŠ¡ç«¯æ¸²æŸ“ã€‚\n<strong>æ–¹æ³•</strong>   ï¼šä½¿ç”¨åŠ¨æ€ <code>fetch</code> æˆ–è®¾ç½® <code>dynamic = \'force-dynamic\'</code>ã€‚</p>\n<p><strong>æ–¹å¼ä¸€ï¼šä½¿ç”¨åŠ¨æ€å‡½æ•°ï¼ˆcookies, headers, searchParamsï¼‰</strong></p>\n<pre><code class="language-javascript"><span class="hljs-comment">// app/dashboard/page.js</span>\n<span class="hljs-keyword">import</span> { cookies } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;next/headers&quot;</span>;\n\n<span class="hljs-comment">// æ­¤é¡µé¢ä¼šåœ¨æ¯æ¬¡è¯·æ±‚æ—¶åŠ¨æ€æ¸²æŸ“</span>\n<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">DashboardPage</span>(<span class="hljs-params"></span>) {\n  <span class="hljs-comment">// ä½¿ç”¨åŠ¨æ€å‡½æ•°ï¼ˆå¦‚ cookiesï¼‰ä¼šè‡ªåŠ¨é€‰æ‹©åŠ¨æ€æ¸²æŸ“</span>\n  <span class="hljs-keyword">const</span> cookieStore = <span class="hljs-title function_">cookies</span>();\n  <span class="hljs-keyword">const</span> session = cookieStore.<span class="hljs-title function_">get</span>(<span class="hljs-string">&quot;session&quot;</span>);\n\n  <span class="hljs-keyword">const</span> userData = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetch</span>(<span class="hljs-string">&quot;https://api.com/user&quot;</span>, {\n    <span class="hljs-attr">headers</span>: { <span class="hljs-title class_">Authorization</span>: <span class="hljs-string">`Bearer <span class="hljs-subst">${session?.value}</span>`</span> },\n    <span class="hljs-attr">cache</span>: <span class="hljs-string">&quot;no-store&quot;</span>, <span class="hljs-comment">// ä¸ç¼“å­˜ï¼Œæ¯æ¬¡è¯·æ±‚éƒ½é‡æ–°è·å–</span>\n  }).<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">res</span>) =&gt;</span> res.<span class="hljs-title function_">json</span>());\n\n  <span class="hljs-keyword">return</span> <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">Dashboard</span> <span class="hljs-attr">data</span>=<span class="hljs-string">{userData}</span> /&gt;</span></span>;\n}\n</code></pre>\n<p><strong>æ–¹å¼äºŒï¼šå¼ºåˆ¶åŠ¨æ€æ¸²æŸ“</strong></p>\n<pre><code class="language-javascript"><span class="hljs-comment">// app/orders/page.js</span>\n<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> dynamic = <span class="hljs-string">&quot;force-dynamic&quot;</span>; <span class="hljs-comment">// å¼ºåˆ¶åŠ¨æ€æ¸²æŸ“</span>\n\n<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">OrdersPage</span>(<span class="hljs-params"></span>) {\n  <span class="hljs-keyword">const</span> orders = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetch</span>(<span class="hljs-string">&quot;https://api.com/orders&quot;</span>, {\n    <span class="hljs-attr">cache</span>: <span class="hljs-string">&quot;no-store&quot;</span>, <span class="hljs-comment">// ä¸ç¼“å­˜</span>\n  }).<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">res</span>) =&gt;</span> res.<span class="hljs-title function_">json</span>());\n\n  <span class="hljs-keyword">return</span> <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">OrderList</span> <span class="hljs-attr">orders</span>=<span class="hljs-string">{orders}</span> /&gt;</span></span>;\n}\n</code></pre>\n<h3>4. å®¢æˆ·ç«¯æ¸²æŸ“ (CSR)</h3>\n<p><strong>ç›®æ ‡</strong>   ï¼šåœ¨å®¢æˆ·ç«¯æµè§ˆå™¨ä¸­æ¸²æŸ“å’Œè·å–æ•°æ®ã€‚\n<strong>æ–¹æ³•</strong>   ï¼šåˆ›å»º <code>\'use client\'</code> ç»„ä»¶å¹¶ä½¿ç”¨ <code>useEffect</code>ã€‚</p>\n<pre><code class="language-javascript"><span class="hljs-comment">// app/admin/page.js</span>\n<span class="hljs-string">&quot;use client&quot;</span>; <span class="hljs-comment">// æ ‡è®°ä¸ºå®¢æˆ·ç«¯ç»„ä»¶</span>\n\n<span class="hljs-keyword">import</span> { useState, useEffect } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;react&quot;</span>;\n\n<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">AdminPage</span>(<span class="hljs-params"></span>) {\n  <span class="hljs-keyword">const</span> [data, setData] = <span class="hljs-title function_">useState</span>(<span class="hljs-literal">null</span>);\n  <span class="hljs-keyword">const</span> [loading, setLoading] = <span class="hljs-title function_">useState</span>(<span class="hljs-literal">true</span>);\n\n  <span class="hljs-comment">// åœ¨å®¢æˆ·ç«¯è·å–æ•°æ®</span>\n  <span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> {\n    <span class="hljs-title function_">fetch</span>(<span class="hljs-string">&quot;/api/admin&quot;</span>)\n      .<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">res</span>) =&gt;</span> res.<span class="hljs-title function_">json</span>())\n      .<span class="hljs-title function_">then</span>(setData)\n      .<span class="hljs-title function_">finally</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">setLoading</span>(<span class="hljs-literal">false</span>));\n  }, []);\n\n  <span class="hljs-keyword">if</span> (loading) <span class="hljs-keyword">return</span> <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>Loading...<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>;\n\n  <span class="hljs-keyword">return</span> <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">AdminDashboard</span> <span class="hljs-attr">data</span>=<span class="hljs-string">{data}</span> /&gt;</span></span>;\n}\n</code></pre>\n<hr>\n<h2>ğŸ”„ é«˜çº§æ··åˆæ¨¡å¼ï¼šåŒä¸€é¡µé¢å†…çš„æ··åˆæ¸²æŸ“</h2>\n<p>App Router çš„å¼ºå¤§ä¹‹å¤„åœ¨äºå¯ä»¥è½»æ¾æ··åˆä¸åŒç­–ç•¥ã€‚</p>\n<h3>ç¤ºä¾‹ï¼šäº§å“é¡µé¢ï¼ˆSSG + CSRï¼‰</h3>\n<pre><code class="language-javascript"><span class="hljs-comment">// app/products/[id]/page.js</span>\n<span class="hljs-comment">// ä¸»è¦éƒ¨åˆ†é™æ€ç”Ÿæˆï¼Œå®æ—¶æ•°æ®åœ¨å®¢æˆ·ç«¯è·å–</span>\n\n<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">getProduct</span>(<span class="hljs-params">id</span>) {\n  <span class="hljs-keyword">const</span> res = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetch</span>(<span class="hljs-string">`https://api.com/products/<span class="hljs-subst">${id}</span>`</span>);\n  <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">json</span>();\n}\n\n<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">ProductPage</span>(<span class="hljs-params">{ params }</span>) {\n  <span class="hljs-comment">// é™æ€éƒ¨åˆ†ï¼šäº§å“åŸºæœ¬ä¿¡æ¯ï¼ˆSSGï¼‰</span>\n  <span class="hljs-keyword">const</span> product = <span class="hljs-keyword">await</span> <span class="hljs-title function_">getProduct</span>(params.<span class="hljs-property">id</span>);\n\n  <span class="hljs-keyword">return</span> (\n    <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>\n      {/* é™æ€å†…å®¹ */}\n      <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>{product.name}<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>\n      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>{product.description}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>\n\n      {/* åŠ¨æ€å®¢æˆ·ç«¯ç»„ä»¶ */}\n      <span class="hljs-tag">&lt;<span class="hljs-name">ClientProductInfo</span> <span class="hljs-attr">productId</span>=<span class="hljs-string">{params.id}</span> /&gt;</span>\n    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>\n  );\n}\n</code></pre>\n<pre><code class="language-javascript"><span class="hljs-comment">// app/components/client-product-info.js</span>\n<span class="hljs-string">&quot;use client&quot;</span>;\n\n<span class="hljs-keyword">import</span> { useState, useEffect } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;react&quot;</span>;\n\n<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">ClientProductInfo</span>(<span class="hljs-params">{ productId }</span>) {\n  <span class="hljs-keyword">const</span> [price, setPrice] = <span class="hljs-title function_">useState</span>(<span class="hljs-literal">null</span>);\n  <span class="hljs-keyword">const</span> [stock, setStock] = <span class="hljs-title function_">useState</span>(<span class="hljs-literal">null</span>);\n\n  <span class="hljs-comment">// å®¢æˆ·ç«¯è·å–å®æ—¶æ•°æ®ï¼ˆCSRï¼‰</span>\n  <span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> {\n    <span class="hljs-title function_">fetch</span>(<span class="hljs-string">`/api/products/<span class="hljs-subst">${productId}</span>/real-time`</span>)\n      .<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">res</span>) =&gt;</span> res.<span class="hljs-title function_">json</span>())\n      .<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">data</span>) =&gt;</span> {\n        <span class="hljs-title function_">setPrice</span>(data.<span class="hljs-property">price</span>);\n        <span class="hljs-title function_">setStock</span>(data.<span class="hljs-property">stock</span>);\n      });\n  }, [productId]);\n\n  <span class="hljs-keyword">return</span> (\n    <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>\n      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>å®æ—¶ä»·æ ¼: {price || &quot;åŠ è½½ä¸­...&quot;}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>\n      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>åº“å­˜: {stock || &quot;åŠ è½½ä¸­...&quot;}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>\n    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>\n  );\n}\n</code></pre>\n<hr>\n<h2>âš™ï¸ è·¯ç”±æ®µé…ç½®ï¼ˆRoute Segment Configï¼‰</h2>\n<p>ä½ å¯ä»¥åœ¨ <code>page.js</code> æˆ– <code>layout.js</code> ä¸­å¯¼å‡ºé…ç½®å˜é‡æ¥æ§åˆ¶è¡Œä¸ºï¼š</p>\n<pre><code class="language-javascript"><span class="hljs-comment">// å¼ºåˆ¶åŠ¨æ€æ¸²æŸ“ï¼ˆSSRï¼‰</span>\n<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> dynamic = <span class="hljs-string">&quot;force-dynamic&quot;</span>;\n\n<span class="hljs-comment">// å¼ºåˆ¶é™æ€æ¸²æŸ“ï¼ˆSSGï¼‰</span>\n<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> dynamic = <span class="hljs-string">&quot;force-static&quot;</span>;\n\n<span class="hljs-comment">// ISRï¼šé‡æ–°éªŒè¯æ—¶é—´</span>\n<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> revalidate = <span class="hljs-number">60</span>;\n\n<span class="hljs-comment">// æˆ–è€…å®Œå…¨ç¦ç”¨ç¼“å­˜ï¼ˆç­‰æ•ˆäº SSRï¼‰</span>\n<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> revalidate = <span class="hljs-number">0</span>;\n</code></pre>\n<hr>\n<h2>ğŸ“Š å†³ç­–æµç¨‹å›¾ï¼ˆApp Router ç‰ˆï¼‰</h2>\n<pre><code class="language-mermaid">flowchart TD\n    A[ä¸ºé¡µé¢é€‰æ‹©æ¸²æŸ“ç­–ç•¥] --&gt; B{æ•°æ®æ˜¯å¦ç”¨æˆ·ä¸ªæ€§åŒ–&lt;br&gt;æˆ–ä¾èµ–cookies/headers?}\n    B -- æ˜¯ --&gt; C[ä½¿ç”¨ SSR&lt;br&gt;è®¾ç½® dynamic=\'force-dynamic\']\n    B -- å¦ --&gt; D{æ•°æ®å˜åŒ–é¢‘ç¹å—?}\n    D -- æ˜¯ --&gt; E[ä½¿ç”¨ ISR&lt;br&gt;fetchä¸­é…ç½® revalidate]\n    D -- å¦ --&gt; F[ä½¿ç”¨ SSG&lt;br&gt;é»˜è®¤è¡Œä¸ºæˆ–generateStaticParams]\n\n    G[éœ€è¦å®¢æˆ·ç«¯äº¤äº’?] --&gt; H[ä½¿ç”¨ CSR&lt;br&gt;åˆ›å»º \'use client\' ç»„ä»¶]\n</code></pre>\n<hr>\n<h2>âœ… æ€»ç»“ï¼šApp Router çš„ä¼˜åŠ¿</h2>\n<ol>\n<li><strong>æ›´ç®€å•</strong>   ï¼šä¸éœ€è¦è®°å¿† <code>getStaticProps</code>/<code>getServerSideProps</code>ï¼Œåªéœ€å…³æ³¨ <code>fetch</code> é€‰é¡¹å’Œç»„ä»¶ç±»å‹ã€‚</li>\n<li><strong>æ›´çµæ´»</strong>   ï¼šå¤©ç„¶æ”¯æŒåŒä¸€é¡µé¢å†…çš„æ··åˆæ¸²æŸ“ç­–ç•¥ã€‚</li>\n<li><strong>æ€§èƒ½æ›´å¥½</strong>   ï¼šæ”¯æŒ<strong>æµå¼æ¸²æŸ“ï¼ˆStreamingï¼‰</strong>   å’Œ <strong>React Suspense</strong>   ã€‚</li>\n<li><strong>é»˜è®¤å®‰å…¨</strong>   ï¼šé»˜è®¤æ˜¯æœåŠ¡ç«¯ç»„ä»¶ï¼Œé€»è¾‘ä¸ä¼šæ³„éœ²åˆ°å®¢æˆ·ç«¯ã€‚</li>\n</ol>\n<p><strong>æ¨èåšæ³•</strong>   ï¼š</p>\n<ul>\n<li>ä¼˜å…ˆä½¿ç”¨ <strong>é»˜è®¤çš„é™æ€æ¸²æŸ“ï¼ˆSSGï¼‰</strong></li>\n<li>éœ€è¦æ›´æ–°æ•°æ®æ—¶ä½¿ç”¨ <strong>ISR</strong>   ï¼ˆ<code>revalidate</code>ï¼‰</li>\n<li>ä¸ªæ€§åŒ–æ•°æ®ä½¿ç”¨ <strong>SSR</strong>   ï¼ˆ<code>dynamic = \'force-dynamic\'</code> æˆ–åŠ¨æ€å‡½æ•°ï¼‰</li>\n<li>äº¤äº’æ€§å†…å®¹ä½¿ç”¨ <strong>CSR</strong>   ï¼ˆ<code>\'use client\'</code> ç»„ä»¶ï¼‰</li>\n</ul>\n<p>App Router é€šè¿‡è¿™ç§ç»Ÿä¸€çš„æ–¹å¼ï¼Œè®©æ··åˆæ¸²æŸ“ç­–ç•¥å˜å¾—æ›´åŠ ç›´è§‚å’Œæ˜“äºç®¡ç†ã€‚</p>\n</div>'</script></body></html>