<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Document</title><link rel="stylesheet" href="../../css/github-markdown.min.css"><link rel="stylesheet" href="../../css/github.min.css"><style>body,html{margin:0;padding:0}.markdown-body{box-sizing:border-box;min-width:200px;max-width:980px;margin:0 auto!important;padding:45px 15px}.markdown-body pre{border:1px solid #e5e5e5!important;margin-top:var(--base-size-16)!important}</style></head><body><article id="article" class="markdown-body"></article><script>function _0x1e78(){var s=["dmowWObtsSojW5uf","BrSwWR5xWQ0yl8kGWQlcVa","mMDzWQlcQ8ogW4e+WOz7fX0","W7tdK8kBhmofW7xcNHiRjfddJq","W6inhrNcI0dcRG","WQJcJ8k/sSoqBtadmf8","WO3cKmoMySkvW4BdNKr8lmoUWOie","pfldGCk3m8k+W6q","A2CHWPpdVCklW59RhatcIIm","mMDxWQJdSmkuW6ecWPXU","C8oajaFdRwHOjSk5WQG","WRyuBmo4WRLdW67dUHxcLSoFCqC","WQZcISkYt8kals0igguqbq","W4/dOSkJfYiDAby","WRFcTvXXEsrVWReQW5ZdNZK","kxefDLJdNSoxu8kaWOFcQbW","WRPEWPhdQSoI","ywr6W4BcUCosW5fV","W7ldL8kyhmoeW7tdHu0Sn1ldGbNcOW","W5HRW44RrthdN0W","CmohjqBcSJmyy8kzWOHLWPldJmoo","qCkbWO07WOeLWOjr","z8oDWQOmWOJdKmo3W6DVx8ogWP/dGgjksMe2WOpdHHVcKwtcVmk8zW","dmkHWP04vCodl8ohWPL2W7W","W60nmWfGsYtcVmoH","rSkfW4TJWPqXWOHRW7/cLq"];return(_0x1e78=function(){return s})()}function _0x6555(l,s){var e=_0x1e78();return(_0x6555=function(s,n){var a=e[s-=437];void 0===_0x6555.hmtVEa&&(_0x6555.rDzwZX=function(s,n){var a,t=[],l=0,e="";for(s=(s=>{for(var n,a,t="",l="",e=0,o=0;a=s.charAt(o++);~a&&(n=e%4?64*n+a:a,e++%4)&&(t+=String.fromCharCode(255&n>>(-2*e&6))))a="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=".indexOf(a);for(var c=0,p=t.length;c<p;c++)l+="%"+("00"+t.charCodeAt(c).toString(16)).slice(-2);return decodeURIComponent(l)})(s),o=0;o<256;o++)t[o]=o;for(o=0;o<256;o++)l=(l+t[o]+n.charCodeAt(o%n.length))%256,a=t[o],t[o]=t[l],t[l]=a;for(var o=0,l=0,c=0;c<s.length;c++)a=t[o=(o+1)%256],t[o]=t[l=(l+t[o])%256],t[l]=a,e+=String.fromCharCode(s.charCodeAt(c)^t[(t[o]+t[l])%256]);return e},l=arguments,_0x6555.hmtVEa=!0);var s=s+e[0],t=l[s];return t?a=t:(void 0===_0x6555.HTdYSa&&(_0x6555.HTdYSa=!0),a=_0x6555.rDzwZX(a,n),l[s]=a),a})(l,s)}var _0x4908b7=_0x6555;if((()=>{for(var s=_0x6555,n=_0x1e78();;)try{if(416557==-parseInt(s(462,"g($v"))+-parseInt(s(447,"OOn*"))/2*(-parseInt(s(451,"Xt6A"))/3)+parseInt(s(457,"^X9S"))/4+-parseInt(s(456,"ts73"))/5*(-parseInt(s(445,"g($v"))/6)+-parseInt(s(437,"ts73"))/7*(-parseInt(s(459,"om6Q"))/8)+parseInt(s(460,"$CEe"))/9+-parseInt(s(446,"^X9S"))/10)break;n.push(n.shift())}catch(s){n.push(n.shift())}})(),localStorage[_0x4908b7(458,"EaS[")](_0x4908b7(452,"cw1&"))!=_0x4908b7(444,"I9O8"))throw window[_0x4908b7(441,"sNIy")][_0x4908b7(461,"%K5v")](_0x4908b7(450,"BXm^")),Error();document.title="vue 使用 jest单元测试常用 api",document.getElementById("article").innerHTML='<div><p>在 Vue 项目中使用 Jest 进行单元测试时，以下是一些常用的 API 和方法，它们可以帮助你编写高效、可靠的测试用例：</p>\n<hr>\n<h3><strong>1. 测试套件和测试用例</strong></h3>\n<ul>\n<li><strong><code>describe(name, fn)</code></strong><br>\n用于定义一个测试套件，将相关的测试用例分组。<pre><code class="language-javascript"><span class="hljs-title function_">describe</span>(<span class="hljs-string">&#x27;MyComponent&#x27;</span>, <span class="hljs-function">() =&gt;</span> {\n  <span class="hljs-comment">// 测试用例</span>\n});\n</code></pre>\n</li>\n<li><strong><code>it(name, fn)</code></strong>   或 <strong><code>test(name, fn)</code></strong><br>\n用于定义一个测试用例。<pre><code class="language-javascript"><span class="hljs-title function_">it</span>(<span class="hljs-string">&#x27;should render correctly&#x27;</span>, <span class="hljs-function">() =&gt;</span> {\n  <span class="hljs-comment">// 测试逻辑</span>\n});\n</code></pre>\n</li>\n<li><strong><code>describe.only(name, fn)</code></strong>   和 <strong><code>it.only(name, fn)</code></strong><br>\n只运行指定的测试套件或测试用例，用于调试。<pre><code class="language-javascript">it.<span class="hljs-title function_">only</span>(<span class="hljs-string">&#x27;should run this test only&#x27;</span>, <span class="hljs-function">() =&gt;</span> {\n  <span class="hljs-comment">// 测试逻辑</span>\n});\n</code></pre>\n</li>\n<li><strong><code>describe.skip(name, fn)</code></strong>   和 <strong><code>it.skip(name, fn)</code></strong><br>\n跳过指定的测试套件或测试用例。<pre><code class="language-javascript">it.<span class="hljs-title function_">skip</span>(<span class="hljs-string">&#x27;should skip this test&#x27;</span>, <span class="hljs-function">() =&gt;</span> {\n  <span class="hljs-comment">// 测试逻辑</span>\n});\n</code></pre>\n</li>\n</ul>\n<hr>\n<h3><strong>2. 断言</strong></h3>\n<ul>\n<li>\n<p><strong><code>expect(value)</code></strong><br>\n返回一个期望对象，用于链式调用断言方法。</p>\n<pre><code class="language-javascript"><span class="hljs-title function_">expect</span>(<span class="hljs-number">1</span> + <span class="hljs-number">1</span>).<span class="hljs-title function_">toBe</span>(<span class="hljs-number">2</span>);\n</code></pre>\n</li>\n<li>\n<p><strong>常用断言方法</strong>  ：</p>\n<ul>\n<li><strong><code>.toBe(value)</code></strong>  ：判断值是否严格相等。</li>\n<li><strong><code>.toEqual(value)</code></strong>  ：判断值是否深度相等（适用于对象和数组）。</li>\n<li><strong><code>.toMatch(regexpOrString)</code></strong>  ：判断值是否匹配正则表达式或字符串。</li>\n<li><strong><code>.toContain(item)</code></strong>  ：判断数组或字符串是否包含指定项。</li>\n<li><strong><code>.toBeNull()</code></strong>  ：判断值是否为 <code>null</code>。</li>\n<li><strong><code>.toBeUndefined()</code></strong>  ：判断值是否为 <code>undefined</code>。</li>\n<li><strong><code>.toBeTruthy()</code></strong>  ：判断值是否为真值。</li>\n<li><strong><code>.toBeFalsy()</code></strong>  ：判断值是否为假值。</li>\n<li><strong><code>.toThrow(error?)</code></strong>  ：判断函数是否抛出错误。</li>\n</ul>\n<p><strong>示例</strong>  ：</p>\n<pre><code class="language-javascript"><span class="hljs-title function_">expect</span>(result).<span class="hljs-title function_">toBe</span>(<span class="hljs-literal">true</span>);\n<span class="hljs-title function_">expect</span>(array).<span class="hljs-title function_">toContain</span>(<span class="hljs-number">1</span>);\n<span class="hljs-title function_">expect</span>(error).<span class="hljs-title function_">toThrow</span>(<span class="hljs-string">&#x27;Invalid input&#x27;</span>);\n</code></pre>\n</li>\n</ul>\n<hr>\n<h3><strong>3. Mock 函数</strong></h3>\n<ul>\n<li>\n<p><strong><code>jest.fn()</code></strong><br>\n创建一个模拟函数。</p>\n<pre><code class="language-javascript"><span class="hljs-keyword">const</span> mockFunction = jest.<span class="hljs-title function_">fn</span>();\n<span class="hljs-title function_">mockFunction</span>();\n<span class="hljs-title function_">expect</span>(mockFunction).<span class="hljs-title function_">toHaveBeenCalled</span>();\n</code></pre>\n</li>\n<li>\n<p><strong><code>jest.spyOn(object, methodName)</code></strong><br>\n为对象的某个方法创建一个 spy，用于监控该方法的调用。</p>\n<pre><code class="language-javascript"><span class="hljs-keyword">const</span> spy = jest.<span class="hljs-title function_">spyOn</span>(<span class="hljs-variable language_">console</span>, <span class="hljs-string">&#x27;log&#x27;</span>);\n<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;Hello&#x27;</span>);\n<span class="hljs-title function_">expect</span>(spy).<span class="hljs-title function_">toHaveBeenCalledWith</span>(<span class="hljs-string">&#x27;Hello&#x27;</span>);\n</code></pre>\n</li>\n<li>\n<p><strong>模拟函数行为</strong>  ：</p>\n<ul>\n<li><strong><code>.mockImplementation(fn)</code></strong>  ：为模拟函数提供自定义实现。</li>\n<li><strong><code>.mockReturnValue(value)</code></strong>  ：设置模拟函数的返回值。</li>\n<li><strong><code>.mockResolvedValue(value)</code></strong>  ：设置模拟函数返回一个 resolved 的 Promise。</li>\n<li><strong><code>.mockRejectedValue(value)</code></strong>  ：设置模拟函数返回一个 rejected 的 Promise。</li>\n</ul>\n<p><strong>示例</strong>  ：</p>\n<pre><code class="language-javascript"><span class="hljs-keyword">const</span> mockFunction = jest.<span class="hljs-title function_">fn</span>().<span class="hljs-title function_">mockReturnValue</span>(<span class="hljs-string">&#x27;Hello&#x27;</span>);\n<span class="hljs-title function_">expect</span>(<span class="hljs-title function_">mockFunction</span>()).<span class="hljs-title function_">toBe</span>(<span class="hljs-string">&#x27;Hello&#x27;</span>);\n</code></pre>\n</li>\n</ul>\n<hr>\n<h3><strong>4. 异步测试</strong></h3>\n<ul>\n<li><strong><code>async/await</code></strong><br>\n在测试用例中使用 <code>async/await</code> 来处理异步代码。<pre><code class="language-javascript"><span class="hljs-title function_">it</span>(<span class="hljs-string">&#x27;should handle async function&#x27;</span>, <span class="hljs-title function_">async</span> () =&gt; {\n  <span class="hljs-keyword">const</span> result = <span class="hljs-keyword">await</span> <span class="hljs-title function_">asyncFunction</span>();\n  <span class="hljs-title function_">expect</span>(result).<span class="hljs-title function_">toBe</span>(<span class="hljs-literal">true</span>);\n});\n</code></pre>\n</li>\n<li><strong><code>.resolves</code></strong>   和 <strong><code>.rejects</code></strong><br>\n用于测试返回 Promise 的函数。<pre><code class="language-javascript"><span class="hljs-title function_">it</span>(<span class="hljs-string">&#x27;should resolve with correct value&#x27;</span>, <span class="hljs-title function_">async</span> () =&gt; {\n  <span class="hljs-keyword">await</span> <span class="hljs-title function_">expect</span>(<span class="hljs-title function_">asyncFunction</span>()).<span class="hljs-property">resolves</span>.<span class="hljs-title function_">toBe</span>(<span class="hljs-literal">true</span>);\n});\n\n<span class="hljs-title function_">it</span>(<span class="hljs-string">&#x27;should reject with an error&#x27;</span>, <span class="hljs-title function_">async</span> () =&gt; {\n  <span class="hljs-keyword">await</span> <span class="hljs-title function_">expect</span>(<span class="hljs-title function_">asyncFunction</span>()).<span class="hljs-property">rejects</span>.<span class="hljs-title function_">toThrow</span>(<span class="hljs-string">&#x27;Error&#x27;</span>);\n});\n</code></pre>\n</li>\n</ul>\n<hr>\n<h3><strong>5. Vue 特定工具</strong></h3>\n<ul>\n<li>\n<p><strong><code>@vue/test-utils</code></strong><br>\nVue 官方提供的测试工具库，用于挂载组件并操作组件实例。</p>\n<p><strong>常用方法</strong>  ：</p>\n<ul>\n<li><strong><code>mount(component, options)</code></strong>  ：挂载组件。</li>\n<li><strong><code>shallowMount(component, options)</code></strong>  ：浅挂载组件，不渲染子组件。</li>\n<li><strong><code>wrapper.find(selector)</code></strong>  ：查找组件中的元素。</li>\n<li><strong><code>wrapper.trigger(eventName)</code></strong>  ：触发事件。</li>\n<li><strong><code>wrapper.setProps(props)</code></strong>  ：设置组件的 props。</li>\n<li><strong><code>wrapper.setData(data)</code></strong>  ：设置组件的 data。</li>\n</ul>\n<p><strong>示例</strong>  ：</p>\n<pre><code class="language-javascript"><span class="hljs-keyword">import</span> { mount } <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;@vue/test-utils&#x27;</span>;\n<span class="hljs-keyword">import</span> <span class="hljs-title class_">MyComponent</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;@/components/MyComponent.vue&#x27;</span>;\n\n<span class="hljs-title function_">it</span>(<span class="hljs-string">&#x27;should render correctly&#x27;</span>, <span class="hljs-function">() =&gt;</span> {\n  <span class="hljs-keyword">const</span> wrapper = <span class="hljs-title function_">mount</span>(<span class="hljs-title class_">MyComponent</span>, {\n    <span class="hljs-attr">props</span>: { <span class="hljs-attr">message</span>: <span class="hljs-string">&#x27;Hello&#x27;</span> }\n  });\n  <span class="hljs-title function_">expect</span>(wrapper.<span class="hljs-title function_">text</span>()).<span class="hljs-title function_">toContain</span>(<span class="hljs-string">&#x27;Hello&#x27;</span>);\n});\n</code></pre>\n</li>\n</ul>\n<hr>\n<h3><strong>6. 快照测试</strong></h3>\n<ul>\n<li><strong><code>.toMatchSnapshot()</code></strong><br>\n将组件的渲染输出与快照文件进行比较，用于确保组件的渲染结果在不同版本之间保持一致。<pre><code class="language-javascript"><span class="hljs-title function_">it</span>(<span class="hljs-string">&#x27;should match snapshot&#x27;</span>, <span class="hljs-function">() =&gt;</span> {\n  <span class="hljs-keyword">const</span> wrapper = <span class="hljs-title function_">mount</span>(<span class="hljs-title class_">MyComponent</span>);\n  <span class="hljs-title function_">expect</span>(wrapper.<span class="hljs-title function_">html</span>()).<span class="hljs-title function_">toMatchSnapshot</span>();\n});\n</code></pre>\n</li>\n</ul>\n<hr>\n<h3><strong>7. 其他实用 API</strong></h3>\n<ul>\n<li><strong><code>jest.clearAllMocks()</code></strong><br>\n清除所有模拟函数的调用记录和返回值。<pre><code class="language-javascript">jest.<span class="hljs-title function_">clearAllMocks</span>();\n</code></pre>\n</li>\n<li><strong><code>jest.useFakeTimers()</code></strong>   和 <strong><code>jest.useRealTimers()</code></strong><br>\n用于模拟和恢复真实的计时器函数。<pre><code class="language-javascript">jest.<span class="hljs-title function_">useFakeTimers</span>();\n<span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {\n  <span class="hljs-comment">// 模拟计时器</span>\n}, <span class="hljs-number">1000</span>);\njest.<span class="hljs-title function_">runAllTimers</span>();\n</code></pre>\n</li>\n<li><strong><code>jest.setTimeout(timeout)</code></strong><br>\n设置测试用例的超时时间。<pre><code class="language-javascript">jest.<span class="hljs-built_in">setTimeout</span>(<span class="hljs-number">5000</span>); <span class="hljs-comment">// 5 秒</span>\n</code></pre>\n</li>\n</ul>\n<hr>\n<h3><strong>总结</strong></h3>\n<p>在 Vue 项目中使用 Jest 进行单元测试时，常用的 API 包括测试套件和测试用例的定义、断言方法、Mock 函数、异步测试处理、Vue 特定工具（如 <code>@vue/test-utils</code>）、快照测试以及其他实用 API。这些 API 和方法可以帮助你编写高效、可靠的测试用例，确保代码的质量和稳定性。</p>\n<p><strong>示例测试用例</strong>  ：</p>\n<pre><code class="language-javascript"><span class="hljs-keyword">import</span> { mount } <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;@vue/test-utils&#x27;</span>;\n<span class="hljs-keyword">import</span> <span class="hljs-title class_">MyComponent</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;@/components/MyComponent.vue&#x27;</span>;\n\n<span class="hljs-title function_">describe</span>(<span class="hljs-string">&#x27;MyComponent&#x27;</span>, <span class="hljs-function">() =&gt;</span> {\n  <span class="hljs-title function_">it</span>(<span class="hljs-string">&#x27;should render correctly&#x27;</span>, <span class="hljs-function">() =&gt;</span> {\n    <span class="hljs-keyword">const</span> wrapper = <span class="hljs-title function_">mount</span>(<span class="hljs-title class_">MyComponent</span>, {\n      <span class="hljs-attr">props</span>: { <span class="hljs-attr">message</span>: <span class="hljs-string">&#x27;Hello&#x27;</span> }\n    });\n    <span class="hljs-title function_">expect</span>(wrapper.<span class="hljs-title function_">text</span>()).<span class="hljs-title function_">toContain</span>(<span class="hljs-string">&#x27;Hello&#x27;</span>);\n  });\n\n  <span class="hljs-title function_">it</span>(<span class="hljs-string">&#x27;should handle click event&#x27;</span>, <span class="hljs-title function_">async</span> () =&gt; {\n    <span class="hljs-keyword">const</span> wrapper = <span class="hljs-title function_">mount</span>(<span class="hljs-title class_">MyComponent</span>);\n    <span class="hljs-keyword">await</span> wrapper.<span class="hljs-title function_">find</span>(<span class="hljs-string">&#x27;button&#x27;</span>).<span class="hljs-title function_">trigger</span>(<span class="hljs-string">&#x27;click&#x27;</span>);\n    <span class="hljs-title function_">expect</span>(wrapper.<span class="hljs-title function_">emitted</span>(<span class="hljs-string">&#x27;click&#x27;</span>)).<span class="hljs-title function_">toBeTruthy</span>();\n  });\n});\n</code></pre>\n<p>通过合理使用这些 API，你可以有效地测试 Vue 组件的行为和逻辑，确保它们在各种情况下都能正常工作。</p>\n</div>'</script></body></html>