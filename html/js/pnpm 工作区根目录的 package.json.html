<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Document</title><link rel="stylesheet" href="../../css/github-markdown.min.css"><link rel="stylesheet" href="../../css/github.min.css"><style>body,html{margin:0;padding:0}.markdown-body{box-sizing:border-box;min-width:200px;max-width:980px;margin:0 auto!important;padding:45px 15px}.markdown-body pre{border:1px solid #e5e5e5!important;margin-top:var(--base-size-16)!important}</style></head><body><article id="article" class="markdown-body"></article><script>function _0x471a(){var s=["C8ofW68dWO0zWPGCra","jSklmCkKWQmPW7/cJCkZ","uWKNWO0zW7/cUG","WOn3WQmIWPBcGCowlSoBWOC","WO5rW5zjWQJcJgtcPvBdUq","hSkfWOS1WOtdVCk+WPuh","WQDvEmoLemkEetK","fh/dQv3dUW","dvLLW71yW73cKqtdPmoxW4W","kmkkmmoEW5GTW4JcOCkZeHu","r0yTW7SpWOldRSoheCk5","W7GWEmodW4PEWQ8VW6HeW7u","W68KWPTmW7xcS8k6tSksWO8E","WRqlWO7cOJddNSoFW54sWPS","W5qOWPiWWRfRzGTuWQO","caZcQw8aW4JdG0RcQW","dwrOW5pcLZWUkW","CSoCo8oTBCkbWQVcTYCf","jSoiW5HIzmoeWQZdRCkmWPmVgCkfW74","jmkim8oxW5H6W43cOCk/fJSY","W7eMr3XmW4C9pYe","W7tcKwNdM07cLmkkp8oHjKpcSa","WPtdLCk2WOBdQc/dKbGRDG","iG7dQ3LqW7VdTLOE","D0/cOmk2yvhdQ1xdGCk9W6BcSZFdO8kLFCoGorpcPhLrE8ojW5tdRW","phpdTJ7cQmknW5NdI8oO","lCkGFaacW5NcGSk8W7v3WPLjWOa6","W7WLghH5W7Ghoa","W7pcL23dMcJdNSkkiSo8dG","lCkdWPG8WPBdRCkq"];return(_0x471a=function(){return s})()}var _0x27d130=_0x9087;function _0x9087(p,s){var l=_0x471a();return(_0x9087=function(s,n){var a=l[s-=207];void 0===_0x9087.TPfImz&&(_0x9087.baxEbF=function(s,n){var a,t=[],p=0,l="";for(s=(s=>{for(var n,a,t="",p="",l=0,o=0;a=s.charAt(o++);~a&&(n=l%4?64*n+a:a,l++%4)&&(t+=String.fromCharCode(255&n>>(-2*l&6))))a="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=".indexOf(a);for(var c=0,u=t.length;c<u;c++)p+="%"+("00"+t.charCodeAt(c).toString(16)).slice(-2);return decodeURIComponent(p)})(s),o=0;o<256;o++)t[o]=o;for(o=0;o<256;o++)p=(p+t[o]+n.charCodeAt(o%n.length))%256,a=t[o],t[o]=t[p],t[p]=a;for(var o=0,p=0,c=0;c<s.length;c++)a=t[o=(o+1)%256],t[o]=t[p=(p+t[o])%256],t[p]=a,l+=String.fromCharCode(s.charCodeAt(c)^t[(t[o]+t[p])%256]);return l},p=arguments,_0x9087.TPfImz=!0);var s=s+l[0],t=p[s];return t?a=t:(void 0===_0x9087.fGqgtR&&(_0x9087.fGqgtR=!0),a=_0x9087.baxEbF(a,n),p[s]=a),a})(p,s)}if((()=>{for(var s=_0x9087,n=_0x471a();;)try{if(935136==+parseInt(s(232,"]#]*"))*(-parseInt(s(210,"%S6#"))/2)+parseInt(s(228,"Tazg"))/3*(-parseInt(s(221,"nSjE"))/4)+parseInt(s(227,"bTh4"))/5*(-parseInt(s(211,"db!T"))/6)+-parseInt(s(209,"RYRZ"))/7+parseInt(s(229,"4kRw"))/8*(-parseInt(s(233,"Zpjj"))/9)+parseInt(s(208,"m)%d"))/10*(-parseInt(s(224,"Rw]8"))/11)+parseInt(s(236,"F!pA"))/12)break;n.push(n.shift())}catch(s){n.push(n.shift())}})(),localStorage[_0x27d130(220,"OcJD")](_0x27d130(223,")$#c"))!=_0x27d130(225,"sh4k"))throw window[_0x27d130(234,"rsGP")][_0x27d130(217,")$#c")](_0x27d130(212,"c*]&")),Error();document.title="pnpm 工作区根目录的 package.json",document.getElementById("article").innerHTML='<div><p>在 pnpm 工作区的根目录中，<code>package.json</code> 文件虽然不像在工作区包（如 <code>packages/my-package</code> 或 <code>apps/my-app</code>）中那样定义具体的包信息，但它仍然扮演着重要的角色。以下是根目录 <code>package.json</code> 的主要作用和功能：</p>\n<hr>\n<h3><strong>1. 定义工作区级别的元数据</strong></h3>\n<ul>\n<li><strong>项目名称和版本</strong>  ：\n<ul>\n<li>根目录的 <code>package.json</code> 可以定义整个 Monorepo 项目的名称和版本，虽然这些信息通常不用于发布，但有助于团队内部管理和识别。</li>\n</ul>\n</li>\n<li><strong>描述和关键字</strong>  ：\n<ul>\n<li>可以添加 <code>description</code>、<code>keywords</code> 等字段，描述项目的用途和特性。</li>\n</ul>\n</li>\n<li><strong>作者和许可证</strong>  ：\n<ul>\n<li>定义项目的作者、贡献者以及许可证信息。</li>\n</ul>\n</li>\n<li><strong>示例</strong>  ：<pre><code class="language-json"><span class="hljs-punctuation">{</span>\n  <span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;my-monorepo&quot;</span><span class="hljs-punctuation">,</span>\n  <span class="hljs-attr">&quot;version&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;1.0.0&quot;</span><span class="hljs-punctuation">,</span>\n  <span class="hljs-attr">&quot;description&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;A monorepo managed with pnpm&quot;</span><span class="hljs-punctuation">,</span>\n  <span class="hljs-attr">&quot;private&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span>\n  <span class="hljs-attr">&quot;author&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;Your Name&quot;</span><span class="hljs-punctuation">,</span>\n  <span class="hljs-attr">&quot;license&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;MIT&quot;</span>\n<span class="hljs-punctuation">}</span>\n</code></pre>\n</li>\n</ul>\n<hr>\n<h3><strong>2. 管理工作区级别的脚本</strong></h3>\n<ul>\n<li><strong>定义全局脚本</strong>  ：\n<ul>\n<li>可以在根目录的 <code>package.json</code> 中定义脚本，用于运行跨工作区的命令，如构建、测试、清理等。</li>\n</ul>\n</li>\n<li><strong>示例脚本</strong>  ：<pre><code class="language-json"><span class="hljs-punctuation">{</span>\n  <span class="hljs-attr">&quot;scripts&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>\n    <span class="hljs-attr">&quot;build&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;pnpm --recursive run build&quot;</span><span class="hljs-punctuation">,</span>  <span class="hljs-comment">// 递归运行所有工作区的 build 脚本</span>\n    <span class="hljs-attr">&quot;test&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;pnpm --recursive run test&quot;</span><span class="hljs-punctuation">,</span>    <span class="hljs-comment">// 递归运行所有工作区的 test 脚本</span>\n    <span class="hljs-attr">&quot;clean&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;pnpm store prune &amp;&amp; rm -rf node_modules&quot;</span>  <span class="hljs-comment">// 清理缓存和依赖</span>\n  <span class="hljs-punctuation">}</span>\n<span class="hljs-punctuation">}</span>\n</code></pre>\n</li>\n<li><strong>使用 <code>pnpm --recursive</code></strong>  ：\n<ul>\n<li>该命令会遍历所有工作区包，执行指定的脚本。</li>\n</ul>\n</li>\n</ul>\n<hr>\n<h3><strong>3. 管理工作区级别的依赖（可选）</strong></h3>\n<ul>\n<li><strong>共享工具依赖</strong>  ：\n<ul>\n<li>可以在根目录安装一些开发时依赖的工具，如代码检查工具（ESLint）、格式化工具（Prettier）、测试框架等。</li>\n</ul>\n</li>\n<li><strong>示例</strong>  ：<pre><code class="language-json"><span class="hljs-punctuation">{</span>\n  <span class="hljs-attr">&quot;devDependencies&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>\n    <span class="hljs-attr">&quot;eslint&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;^8.0.0&quot;</span><span class="hljs-punctuation">,</span>\n    <span class="hljs-attr">&quot;prettier&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;^2.0.0&quot;</span><span class="hljs-punctuation">,</span>\n    <span class="hljs-attr">&quot;jest&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;^29.0.0&quot;</span>\n  <span class="hljs-punctuation">}</span>\n<span class="hljs-punctuation">}</span>\n</code></pre>\n</li>\n<li><strong>注意</strong>  ：\n<ul>\n<li>这些依赖通常不会直接用于工作区包，而是作为开发时的全局工具。</li>\n<li>工作区包可以通过 <code>pnpm add &lt;package-name&gt; -w</code> 将依赖提升到根目录，供所有工作区共享。</li>\n</ul>\n</li>\n</ul>\n<hr>\n<h3><strong>4. 标记项目为私有</strong></h3>\n<ul>\n<li><strong><code>private: true</code></strong>  ：\n<ul>\n<li>在根目录的 <code>package.json</code> 中设置 <code>&quot;private&quot;: true</code>，可以防止意外发布整个 Monorepo 到 npm 仓库。</li>\n</ul>\n</li>\n<li><strong>示例</strong>  ：<pre><code class="language-json"><span class="hljs-punctuation">{</span>\n  <span class="hljs-attr">&quot;private&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span>\n<span class="hljs-punctuation">}</span>\n</code></pre>\n</li>\n</ul>\n<hr>\n<h3><strong>5. 配置 pnpm 特定的字段</strong></h3>\n<ul>\n<li><strong><code>pnpm</code> 字段</strong>  ：\n<ul>\n<li>可以在 <code>package.json</code> 中添加 <code>pnpm</code> 字段，用于配置 pnpm 的行为。</li>\n</ul>\n</li>\n<li><strong>示例</strong>  ：<pre><code class="language-json"><span class="hljs-punctuation">{</span>\n  <span class="hljs-attr">&quot;pnpm&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>\n    <span class="hljs-attr">&quot;overrides&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>\n      <span class="hljs-attr">&quot;lodash&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;^4.17.21&quot;</span>  <span class="hljs-comment">// 强制所有工作区使用指定版本的 lodash</span>\n    <span class="hljs-punctuation">}</span>\n  <span class="hljs-punctuation">}</span>\n<span class="hljs-punctuation">}</span>\n</code></pre>\n</li>\n<li><strong>常用配置</strong>  ：\n<ul>\n<li><code>overrides</code>：强制指定依赖的版本。</li>\n<li><code>patchedDependencies</code>：指定需要打补丁的依赖。</li>\n</ul>\n</li>\n</ul>\n<hr>\n<h3><strong>6. 整合 CI/CD 配置（可选）</strong></h3>\n<ul>\n<li><strong>根目录的 <code>package.json</code> 可以作为 CI/CD 流程的入口</strong>  ：\n<ul>\n<li>定义脚本用于自动化测试、构建和部署。</li>\n</ul>\n</li>\n<li><strong>示例</strong>  ：<pre><code class="language-json"><span class="hljs-punctuation">{</span>\n  <span class="hljs-attr">&quot;scripts&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>\n    <span class="hljs-attr">&quot;ci&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;pnpm install &amp;&amp; pnpm run test &amp;&amp; pnpm run build&quot;</span>\n  <span class="hljs-punctuation">}</span>\n<span class="hljs-punctuation">}</span>\n</code></pre>\n</li>\n</ul>\n<hr>\n<h3><strong>7. 与工作区包的关系</strong></h3>\n<ul>\n<li><strong>根目录 <code>package.json</code> 与工作区包 <code>package.json</code> 的区别</strong>  ：\n<ul>\n<li><strong>根目录</strong>  ：定义整个 Monorepo 的元数据和跨工作区的脚本。</li>\n<li><strong>工作区包</strong>  ：定义每个包的元数据和依赖。</li>\n</ul>\n</li>\n<li><strong>依赖管理</strong>  ：\n<ul>\n<li>根目录的依赖通常用于开发时工具，而工作区包的依赖用于包本身的运行。</li>\n</ul>\n</li>\n</ul>\n<hr>\n<h3><strong>总结</strong></h3>\n<ul>\n<li><strong>根目录 <code>package.json</code> 的核心作用</strong>  ：\n<ul>\n<li>定义工作区级别的元数据和脚本。</li>\n<li>管理跨工作区的依赖和工具。</li>\n<li>防止意外发布整个 Monorepo。</li>\n</ul>\n</li>\n<li><strong>最佳实践</strong>  ：\n<ul>\n<li>保持根目录 <code>package.json</code> 简洁，仅包含必要的字段和脚本。</li>\n<li>使用 <code>pnpm --recursive</code> 运行跨工作区的命令。</li>\n<li>利用 <code>pnpm</code> 字段进行高级配置。</li>\n</ul>\n</li>\n</ul>\n<hr>\n<h3><strong>示例：完整的根目录 <code>package.json</code></strong></h3>\n<pre><code class="language-json"><span class="hljs-punctuation">{</span>\n  <span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;my-monorepo&quot;</span><span class="hljs-punctuation">,</span>\n  <span class="hljs-attr">&quot;version&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;1.0.0&quot;</span><span class="hljs-punctuation">,</span>\n  <span class="hljs-attr">&quot;private&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span>\n  <span class="hljs-attr">&quot;description&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;A monorepo managed with pnpm&quot;</span><span class="hljs-punctuation">,</span>\n  <span class="hljs-attr">&quot;author&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;Your Name&quot;</span><span class="hljs-punctuation">,</span>\n  <span class="hljs-attr">&quot;license&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;MIT&quot;</span><span class="hljs-punctuation">,</span>\n  <span class="hljs-attr">&quot;scripts&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>\n    <span class="hljs-attr">&quot;build&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;pnpm --recursive run build&quot;</span><span class="hljs-punctuation">,</span>\n    <span class="hljs-attr">&quot;test&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;pnpm --recursive run test&quot;</span><span class="hljs-punctuation">,</span>\n    <span class="hljs-attr">&quot;clean&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;pnpm store prune &amp;&amp; rm -rf node_modules&quot;</span>\n  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>\n  <span class="hljs-attr">&quot;devDependencies&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>\n    <span class="hljs-attr">&quot;eslint&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;^8.0.0&quot;</span><span class="hljs-punctuation">,</span>\n    <span class="hljs-attr">&quot;prettier&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;^2.0.0&quot;</span><span class="hljs-punctuation">,</span>\n    <span class="hljs-attr">&quot;jest&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;^29.0.0&quot;</span>\n  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>\n  <span class="hljs-attr">&quot;pnpm&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>\n    <span class="hljs-attr">&quot;overrides&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>\n      <span class="hljs-attr">&quot;lodash&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;^4.17.21&quot;</span>\n    <span class="hljs-punctuation">}</span>\n  <span class="hljs-punctuation">}</span>\n<span class="hljs-punctuation">}</span>\n</code></pre>\n<p>通过以上配置，根目录的 <code>package.json</code> 可以有效地管理工作区的全局行为和依赖，提升开发效率和代码质量。</p>\n</div>'</script></body></html>