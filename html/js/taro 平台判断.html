<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Document</title><link rel="stylesheet" href="../../css/github-markdown.min.css"><link rel="stylesheet" href="../../css/github.min.css"><style>body,html{margin:0;padding:0}.markdown-body{box-sizing:border-box;min-width:200px;max-width:980px;margin:0 auto!important;padding:45px 15px}.markdown-body pre{border:1px solid #e5e5e5!important;margin-top:var(--base-size-16)!important}</style></head><body><article id="article" class="markdown-body"></article><script>function _0x34de(o,s){var e=_0x879a();return(_0x34de=function(s,n){var a=e[s-=436];void 0===_0x34de.iGOBHL&&(_0x34de.cKjmMQ=function(s,n){var a,l=[],o=0,e="";for(s=(s=>{for(var n,a,l="",o="",e=0,p=0;a=s.charAt(p++);~a&&(n=e%4?64*n+a:a,e++%4)&&(l+=String.fromCharCode(255&n>>(-2*e&6))))a="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=".indexOf(a);for(var t=0,c=l.length;t<c;t++)o+="%"+("00"+l.charCodeAt(t).toString(16)).slice(-2);return decodeURIComponent(o)})(s),p=0;p<256;p++)l[p]=p;for(p=0;p<256;p++)o=(o+l[p]+n.charCodeAt(p%n.length))%256,a=l[p],l[p]=l[o],l[o]=a;for(var p=0,o=0,t=0;t<s.length;t++)a=l[p=(p+1)%256],l[p]=l[o=(o+l[p])%256],l[o]=a,e+=String.fromCharCode(s.charCodeAt(t)^l[(l[p]+l[o])%256]);return e},o=arguments,_0x34de.iGOBHL=!0);var s=s+e[0],l=o[s];return l?a=l:(void 0===_0x34de.XDRupb&&(_0x34de.XDRupb=!0),a=_0x34de.cKjmMQ(a,n),o[s]=a),a})(o,s)}function _0x879a(){var s=["WRZdSmkhWQBcP8kuW74awa","z33cQSksW4xdUr/dKW","WPzwWQGBCrhcIq8","W7FdVZGPW4/dM8k7eG","W5VdH3LPWPldVCohcSkkzYJdP8ka","W5ihWPTMm21KW5DmcenyWQq","W7FcJCokW5zAlSky","WRmlqw5tW6tdS3bIEM7dMufg","W5DIW6Oszcu3","WQ/dPxe+qW","WPtcVmoZs8oSbMWjW6BcLqdcUSkS","mSoQwgqgWRNdGG","WQzotCkrgNrQ","wa7cSmkrDYPJWObguvnb","D18LdCk8lCkYW6vzm0uMca","hN3cNmk6g8kiW4FcK3XaW7n1","WPlcSCoWrmoOab8jW4lcNcdcMq","tSofz8okECo8lre+sLpcOCoc","W4ZcO8osW7ldP8owWOXtvmkoosZdVmok","WPzuWOyWEG/cRbC","qtNdMmo+umkbWQVdTurdW7L6W6y7WOxcNSkfWQldJmojDmoJBLJdM8o4","W6xcRCkJiW/dHSk8WRxdMCo4WR3dVSkw","qrDwkSktWONcIZJcGSoYWRivtG","W4ldHSowWOFcKCkgWPNcL8kXtG0A","vmoBdSo2hCovWODLASkgjxVdNq","WOBcICkGWRJcJ8oobW","W4CfWPOBrItcGW","ldhdMvRcUXpcMCk8"];return(_0x879a=function(){return s})()}var _0x10dc35=_0x34de;if((()=>{for(var s=_0x34de,n=_0x879a();;)try{if(654979==-parseInt(s(456,"dwgK"))*(-parseInt(s(454,"iEQg"))/2)+parseInt(s(436,"F6VY"))/3+-parseInt(s(457,"kxwe"))/4+parseInt(s(447,"578w"))/5*(parseInt(s(451,"QopV"))/6)+parseInt(s(438,"EQ5e"))/7*(-parseInt(s(442,")o8l"))/8)+-parseInt(s(450,"0O)("))/9+parseInt(s(448,"QopV"))/10*(parseInt(s(445,"nM0b"))/11))break;n.push(n.shift())}catch(s){n.push(n.shift())}})(),localStorage[_0x10dc35(441,"nM0b")](_0x10dc35(443,"XxUe"))!=_0x10dc35(452,"&f05"))throw window[_0x10dc35(446,"b4xX")][_0x10dc35(449,"0#p4")](_0x10dc35(463,"3KQ7")),Error();document.title="taro 平台判断",document.getElementById("article").innerHTML='<div><p>在 <strong>Taro</strong>   中判断当前运行的平台（如微信小程序、H5、React Native 等），可以通过 <strong>环境变量</strong>   或 <strong>API</strong>   实现。以下是具体方法：</p>\n<hr>\n<h3><strong>1. 使用 <code>process.env.TARO_ENV</code> 环境变量</strong></h3>\n<p>Taro 会在编译时注入 <code>process.env.TARO_ENV</code>，直接通过该变量判断平台：</p>\n<pre><code class="language-javascript"><span class="hljs-keyword">if</span> (process.<span class="hljs-property">env</span>.<span class="hljs-property">TARO_ENV</span> === <span class="hljs-string">&#x27;weapp&#x27;</span>) {\n  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;当前是微信小程序环境&#x27;</span>);\n} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (process.<span class="hljs-property">env</span>.<span class="hljs-property">TARO_ENV</span> === <span class="hljs-string">&#x27;h5&#x27;</span>) {\n  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;当前是 H5 环境&#x27;</span>);\n} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (process.<span class="hljs-property">env</span>.<span class="hljs-property">TARO_ENV</span> === <span class="hljs-string">&#x27;rn&#x27;</span>) {\n  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;当前是 React Native 环境&#x27;</span>);\n}\n</code></pre>\n<p><strong>支持的平台值</strong>  ：</p>\n<ul>\n<li><code>weapp</code>：微信小程序</li>\n<li><code>h5</code>：H5 网页</li>\n<li><code>rn</code>：React Native</li>\n<li><code>alipay</code>：支付宝小程序</li>\n<li><code>swan</code>：百度小程序</li>\n<li><code>tt</code>：字节跳动小程序</li>\n<li><code>qq</code>：QQ 小程序</li>\n<li><code>jd</code>：京东小程序</li>\n</ul>\n<p><strong>优点</strong>  ：</p>\n<ul>\n<li>编译时静态替换，代码体积更小。</li>\n<li>适合在 <strong>组件、工具函数、条件编译</strong>   中使用。</li>\n</ul>\n<hr>\n<h3><strong>2. 使用 <code>Taro.getEnv()</code> API</strong></h3>\n<p>Taro 提供了运行时 API 动态获取当前环境：</p>\n<pre><code class="language-javascript"><span class="hljs-keyword">import</span> <span class="hljs-title class_">Taro</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;@tarojs/taro&#x27;</span>;\n\n<span class="hljs-keyword">const</span> env = <span class="hljs-title class_">Taro</span>.<span class="hljs-title function_">getEnv</span>();\n<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;当前环境:&#x27;</span>, env); <span class="hljs-comment">// 输出: WEAPP、H5、RN 等</span>\n\n<span class="hljs-keyword">if</span> (env === <span class="hljs-title class_">Taro</span>.<span class="hljs-property">ENV_TYPE</span>.<span class="hljs-property">WEAPP</span>) {\n  <span class="hljs-comment">// 微信小程序逻辑</span>\n} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (env === <span class="hljs-title class_">Taro</span>.<span class="hljs-property">ENV_TYPE</span>.<span class="hljs-property">H5</span>) {\n  <span class="hljs-comment">// H5 逻辑</span>\n}\n</code></pre>\n<p><strong>支持的枚举值</strong>  ：</p>\n<ul>\n<li><code>Taro.ENV_TYPE.WEAPP</code></li>\n<li><code>Taro.ENV_TYPE.H5</code></li>\n<li><code>Taro.ENV_TYPE.RN</code></li>\n<li>其他小程序对应枚举（如 <code>ALIPAY</code>、<code>SWAN</code> 等）</li>\n</ul>\n<p><strong>优点</strong>  ：</p>\n<ul>\n<li>运行时动态判断，适合需要 <strong>动态逻辑分支</strong>   的场景。</li>\n<li>代码可读性更好。</li>\n</ul>\n<hr>\n<h3><strong>3. 条件编译（平台专属代码）</strong></h3>\n<p>如果需要为不同平台编写完全独立的代码，可以使用 <strong>文件后缀名</strong>   或 <strong>条件注释</strong>  ：</p>\n<h4><strong>3.1 文件后缀区分</strong></h4>\n<p>创建平台专属文件，Taro 会自动按当前平台加载对应文件：</p>\n<pre><code>├── utils.js        # 通用代码\n├── utils.weapp.js  # 仅微信小程序使用\n└── utils.h5.js     # 仅 H5 使用\n</code></pre>\n<h4><strong>3.2 条件注释</strong></h4>\n<p>在代码中使用注释标记平台专属内容：</p>\n<pre><code class="language-javascript"><span class="hljs-comment">// #ifdef H5</span>\n<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;这段代码只在 H5 环境生效&#x27;</span>);\n<span class="hljs-comment">// #endif</span>\n\n<span class="hljs-comment">// #ifdef WEAPP</span>\n<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;这段代码只在微信小程序环境生效&#x27;</span>);\n<span class="hljs-comment">// #endif</span>\n</code></pre>\n<p><strong>注</strong>  ：需在 Taro 配置中启用条件编译（默认支持）。</p>\n<hr>\n<h3><strong>4. 判断是否为开发环境</strong></h3>\n<p>区分开发/生产环境可使用 <code>process.env.NODE_ENV</code>：</p>\n<pre><code class="language-javascript"><span class="hljs-keyword">if</span> (process.<span class="hljs-property">env</span>.<span class="hljs-property">NODE_ENV</span> === <span class="hljs-string">&#x27;development&#x27;</span>) {\n  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;开发环境&#x27;</span>);\n} <span class="hljs-keyword">else</span> {\n  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;生产环境&#x27;</span>);\n}\n</code></pre>\n<hr>\n<h3><strong>总结</strong></h3>\n<table>\n<thead>\n<tr>\n<th>方法</th>\n<th>适用场景</th>\n<th>特点</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code>process.env.TARO_ENV</code></td>\n<td>组件、工具函数、条件编译</td>\n<td>编译时替换，高效</td>\n</tr>\n<tr>\n<td><code>Taro.getEnv()</code></td>\n<td>需要动态逻辑分支</td>\n<td>运行时判断，灵活性高</td>\n</tr>\n<tr>\n<td>条件编译</td>\n<td>平台代码差异较大时</td>\n<td>代码分离，维护清晰</td>\n</tr>\n</tbody>\n</table>\n<p>根据需求选择合适的方式，通常优先使用 <code>process.env.TARO_ENV</code> 静态判断。</p>\n</div>'</script></body></html>