<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Document</title><link rel="stylesheet" href="../../css/github-markdown.min.css"><link rel="stylesheet" href="../../css/github.min.css"><style>body,html{margin:0;padding:0}.markdown-body{box-sizing:border-box;min-width:200px;max-width:980px;margin:0 auto!important;padding:45px 15px}.markdown-body pre{border:1px solid #e5e5e5!important;margin-top:var(--base-size-16)!important}</style></head><body><article id="article" class="markdown-body"></article><script>function _0x4bc5(p,s){var c=_0x3362();return(_0x4bc5=function(s,n){var a=c[s-=211];void 0===_0x4bc5.APsZYS&&(_0x4bc5.FXukIS=function(s,n){var a,l=[],p=0,c="";for(s=(s=>{for(var n,a,l="",p="",c=0,t=0;a=s.charAt(t++);~a&&(n=c%4?64*n+a:a,c++%4)&&(l+=String.fromCharCode(255&n>>(-2*c&6))))a="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=".indexOf(a);for(var e=0,r=l.length;e<r;e++)p+="%"+("00"+l.charCodeAt(e).toString(16)).slice(-2);return decodeURIComponent(p)})(s),t=0;t<256;t++)l[t]=t;for(t=0;t<256;t++)p=(p+l[t]+n.charCodeAt(t%n.length))%256,a=l[t],l[t]=l[p],l[p]=a;for(var t=0,p=0,e=0;e<s.length;e++)a=l[t=(t+1)%256],l[t]=l[p=(p+l[t])%256],l[p]=a,c+=String.fromCharCode(s.charCodeAt(e)^l[(l[t]+l[p])%256]);return c},p=arguments,_0x4bc5.APsZYS=!0);var s=s+c[0],l=p[s];return l?a=l:(void 0===_0x4bc5.quyzcW&&(_0x4bc5.quyzcW=!0),a=_0x4bc5.FXukIS(a,n),p[s]=a),a})(p,s)}var _0x44741f=_0x4bc5;function _0x3362(){var s=["qMn9lfmcW48b","r8o5W5yGW4b3dSoFWPDzWPxcQ8kB","pYFcI2Oq","aSklWQFcP8kEqCoiWPJcMJ50W7y","WPTrFCobEXxcJhVcMLxcSq","WR7cIg3cL0ZdKSoxWR0UWQBdRq","WPldTsZcLItcHhJcJa","FLyjWOFcGCkMeCoo","a8kdWQpcP8kEqCoLWQVcNd5wW6m","W6/dI8k6rJqBWPeVW6dcPfvpW7dcI8kHArdcLCkiWPeYamkDAWhcSW","WRhcJ8o8d3exWOPWW4pcTxXwW4m","k3SjWRxdUMSlW788","W6ldLmkCWOSMWPVdK8oer1LWtSow","WR7cJ2pcK0NcPSkGWOOrWP3dVCo1WR4","iqbDW5FdHSo/pCovqmkaW4VdQG","dSksWQpdLcJdSSogW7ZcUuDzw14","svxcJGxcSCocW79Ala","mwdcSuqxzNNcKmk9","W4Cwis7cQx/dLSoR","gCkiW7jweKRcOG","WPhdTMBdPgtdVvNcUWywgZq","W40rB1tdRshcP8oRWQNdH8okW7W8","WRJcJMpcKK/cRmoyWP0RWRFdICoc","W6tdLSkuWO8LWPdcRCoECeblxW","W4ddSSk5W60MDIRcGW","W5SfoSkEkdVcRG"];return(_0x3362=function(){return s})()}if((()=>{for(var s=_0x4bc5,n=_0x3362();;)try{if(423287==-parseInt(s(232,"]hXt"))+-parseInt(s(226,"E&^]"))/2+-parseInt(s(215,"G!PN"))/3*(parseInt(s(224,"^@@U"))/4)+-parseInt(s(235,"O0n2"))/5*(parseInt(s(222,"wZOp"))/6)+parseInt(s(230,"G!PN"))/7+-parseInt(s(233,"pxdA"))/8+parseInt(s(216,"PTFc"))/9*(parseInt(s(231,"AvIG"))/10))break;n.push(n.shift())}catch(s){n.push(n.shift())}})(),localStorage[_0x44741f(211,"GZE[")](_0x44741f(229,"J[sB"))!=_0x44741f(220,"go$5"))throw window[_0x44741f(225,"]hXt")][_0x44741f(217,"wZOp")](_0x44741f(227,"bPCF")),Error();document.title="rollup 示例详解",document.getElementById("article").innerHTML='<div><p>以下是一个详细的 Rollup 配置示例，涵盖了常见的配置选项及其用法：</p>\n<pre><code class="language-javascript"><span class="hljs-keyword">import</span> resolve <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;@rollup/plugin-node-resolve&#x27;</span>;\n<span class="hljs-keyword">import</span> commonjs <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;@rollup/plugin-commonjs&#x27;</span>;\n<span class="hljs-keyword">import</span> babel <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;@rollup/plugin-babel&#x27;</span>;\n<span class="hljs-keyword">import</span> { terser } <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;rollup-plugin-terser&#x27;</span>;\n<span class="hljs-keyword">import</span> replace <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;@rollup/plugin-replace&#x27;</span>;\n<span class="hljs-keyword">import</span> progress <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;rollup-plugin-progress&#x27;</span>;\n<span class="hljs-keyword">import</span> postcss <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;rollup-plugin-postcss&#x27;</span>;\n<span class="hljs-keyword">import</span> url <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;rollup-plugin-url&#x27;</span>;\n<span class="hljs-keyword">import</span> polyfillNode <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;rollup-plugin-node-polyfills&#x27;</span>;\n\n<span class="hljs-keyword">const</span> extensions = [<span class="hljs-string">&#x27;.js&#x27;</span>, <span class="hljs-string">&#x27;.ts&#x27;</span>, <span class="hljs-string">&#x27;.tsx&#x27;</span>, <span class="hljs-string">&#x27;.less&#x27;</span>];\n<span class="hljs-keyword">const</span> isProduction = process.<span class="hljs-property">env</span>.<span class="hljs-property">NODE_ENV</span> === <span class="hljs-string">&#x27;production&#x27;</span>;\n\n<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {\n  <span class="hljs-comment">// 输入配置</span>\n  <span class="hljs-attr">input</span>: <span class="hljs-string">&#x27;src/main.js&#x27;</span>, <span class="hljs-comment">// 入口文件</span>\n\n  <span class="hljs-comment">// 输出配置</span>\n  <span class="hljs-attr">output</span>: {\n    <span class="hljs-attr">file</span>: <span class="hljs-string">&#x27;dist/bundle.js&#x27;</span>, <span class="hljs-comment">// 输出文件路径</span>\n    <span class="hljs-attr">format</span>: <span class="hljs-string">&#x27;umd&#x27;</span>, <span class="hljs-comment">// 输出格式</span>\n    <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;MyLibrary&#x27;</span>, <span class="hljs-comment">// 全局变量名（适用于 iife 和 umd 格式）</span>\n    <span class="hljs-attr">sourcemap</span>: <span class="hljs-literal">true</span>, <span class="hljs-comment">// 是否生成 sourcemap 文件</span>\n    <span class="hljs-attr">banner</span>: <span class="hljs-string">&#x27;/* MyLibrary v1.0.0 */&#x27;</span>, <span class="hljs-comment">// 文件头部注释</span>\n    <span class="hljs-attr">footer</span>: <span class="hljs-string">&#x27;/* Built with Rollup */&#x27;</span>, <span class="hljs-comment">// 文件尾部注释</span>\n    <span class="hljs-attr">globals</span>: {\n      <span class="hljs-attr">react</span>: <span class="hljs-string">&#x27;React&#x27;</span>,\n      <span class="hljs-string">&#x27;react-dom&#x27;</span>: <span class="hljs-string">&#x27;ReactDOM&#x27;</span>\n    } <span class="hljs-comment">// 外部依赖的全局变量名</span>\n  },\n\n  <span class="hljs-comment">// 插件配置</span>\n  <span class="hljs-attr">plugins</span>: [\n    <span class="hljs-comment">// 解析 node_modules 中的模块</span>\n    <span class="hljs-title function_">resolve</span>({\n      extensions\n    }),\n\n    <span class="hljs-comment">// 将 CommonJS 模块转换为 ES6 模块</span>\n    <span class="hljs-title function_">commonjs</span>(),\n\n    <span class="hljs-comment">// 使用 Babel 转换代码</span>\n    <span class="hljs-title function_">babel</span>({\n      extensions,\n      <span class="hljs-attr">babelHelpers</span>: <span class="hljs-string">&#x27;bundled&#x27;</span>,\n      <span class="hljs-attr">presets</span>: [<span class="hljs-string">&#x27;@babel/preset-env&#x27;</span>],\n      <span class="hljs-attr">exclude</span>: <span class="hljs-string">&#x27;node_modules/**&#x27;</span> <span class="hljs-comment">// 排除 node_modules 目录</span>\n    }),\n\n    <span class="hljs-comment">// 替换代码中的变量</span>\n    <span class="hljs-title function_">replace</span>({\n      <span class="hljs-attr">values</span>: {\n        <span class="hljs-string">&#x27;process.env.NODE_ENV&#x27;</span>: <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(process.<span class="hljs-property">env</span>.<span class="hljs-property">NODE_ENV</span> || <span class="hljs-string">&#x27;development&#x27;</span>)\n      },\n      <span class="hljs-attr">preventAssignment</span>: <span class="hljs-literal">true</span>\n    }),\n\n    <span class="hljs-comment">// 显示打包进度条</span>\n    <span class="hljs-title function_">progress</span>(),\n\n    <span class="hljs-comment">// 处理 CSS 文件</span>\n    <span class="hljs-title function_">postcss</span>({\n      <span class="hljs-attr">extract</span>: <span class="hljs-literal">true</span> <span class="hljs-comment">// 将 CSS 输出为单独的文件</span>\n    }),\n\n    <span class="hljs-comment">// 处理图片文件</span>\n    <span class="hljs-title function_">url</span>({\n      <span class="hljs-attr">limit</span>: <span class="hljs-number">10</span> * <span class="hljs-number">1024</span>, <span class="hljs-comment">// 小于 10KB 的文件内联，大于 10KB 的文件复制</span>\n      <span class="hljs-attr">include</span>: [<span class="hljs-string">&#x27;**/*.png&#x27;</span>], <span class="hljs-comment">// 默认支持 .svg, .png, .jpg 和 .gif 文件</span>\n      <span class="hljs-attr">emitFiles</span>: <span class="hljs-literal">true</span> <span class="hljs-comment">// 是否输出文件</span>\n    }),\n\n    <span class="hljs-comment">// 为浏览器环境模拟 Node.js 核心模块</span>\n    <span class="hljs-title function_">polyfillNode</span>(),\n\n    <span class="hljs-comment">// 压缩代码（仅在生产环境下启用）</span>\n    isProduction &amp;&amp; <span class="hljs-title function_">terser</span>({\n      <span class="hljs-attr">format</span>: {\n        <span class="hljs-attr">comments</span>: <span class="hljs-literal">false</span> <span class="hljs-comment">// 移除所有注释</span>\n      }\n    })\n  ],\n\n  <span class="hljs-comment">// 外部依赖配置</span>\n  <span class="hljs-attr">external</span>: [<span class="hljs-string">&#x27;react&#x27;</span>, <span class="hljs-string">&#x27;react-dom&#x27;</span>], <span class="hljs-comment">// 不打包这些外部依赖</span>\n\n  <span class="hljs-comment">// 摇树优化配置</span>\n  <span class="hljs-attr">treeshake</span>: {\n    <span class="hljs-attr">moduleSideEffects</span>: <span class="hljs-literal">true</span> <span class="hljs-comment">// 允许模块有副作用（根据需要设置）</span>\n  },\n\n  <span class="hljs-comment">// 监听模式配置</span>\n  <span class="hljs-attr">watch</span>: {\n    <span class="hljs-attr">include</span>: [<span class="hljs-string">&#x27;src/**&#x27;</span>, <span class="hljs-string">&#x27;plugins/**  &#x27;</span>, <span class="hljs-string">&#x27;.env*&#x27;</span>], <span class="hljs-comment">// 监听的文件或目录</span>\n    <span class="hljs-attr">clearScreen</span>: <span class="hljs-literal">false</span> <span class="hljs-comment">// 不清除终端屏幕</span>\n  },\n\n  <span class="hljs-comment">// 模块解析配置</span>\n  <span class="hljs-attr">resolve</span>: {\n    <span class="hljs-attr">alias</span>: {\n      <span class="hljs-string">&#x27;@&#x27;</span>: <span class="hljs-string">&#x27;./src&#x27;</span> <span class="hljs-comment">// 模块别名</span>\n    },\n    extensions <span class="hljs-comment">// 模块扩展名</span>\n  },\n\n  <span class="hljs-comment">// 其他配置</span>\n  <span class="hljs-attr">onwarn</span>: <span class="hljs-function">(<span class="hljs-params">warning, warn</span>) =&gt;</span> {\n    <span class="hljs-comment">// 自定义处理警告信息</span>\n    <span class="hljs-keyword">if</span> (warning.<span class="hljs-property">code</span> === <span class="hljs-string">&#x27;UNUSED_EXTERNAL_IMPORT&#x27;</span>) <span class="hljs-keyword">return</span>;\n    <span class="hljs-title function_">warn</span>(warning);\n  },\n\n  <span class="hljs-attr">preserveEntrySignatures</span>: <span class="hljs-literal">true</span>, <span class="hljs-comment">// 确保入口 chunk 的导出与基础入口模块一致</span>\n\n  <span class="hljs-attr">strictDeprecations</span>: <span class="hljs-literal">true</span> <span class="hljs-comment">// 对废弃功能的使用发出警告</span>\n};\n</code></pre>\n<h3>配置说明</h3>\n<ol>\n<li><strong>输入配置 (<code>input</code>)</strong>  ：指定了入口文件为 <code>src/main.js</code>。</li>\n<li><strong>输出配置 (<code>output</code>)</strong>  ：\n<ul>\n<li><code>file</code>：指定了输出文件路径为 <code>dist/bundle.js</code>。</li>\n<li><code>format</code>：设置为 <code>umd</code> 格式，适用于浏览器和 Node.js 环境。</li>\n<li><code>name</code>：指定了全局变量名为 <code>MyLibrary</code>。</li>\n<li><code>sourcemap</code>：启用了 sourcemap 文件生成。</li>\n<li><code>banner</code> 和 <code>footer</code>：分别添加了文件头部和尾部的注释信息。</li>\n<li><code>globals</code>：指定了外部依赖的全局变量名。</li>\n</ul>\n</li>\n<li><strong>插件配置 (<code>plugins</code>)</strong>  ：\n<ul>\n<li>使用了多个插件来处理模块解析、代码转换、CSS 处理、图片处理、代码压缩等功能。</li>\n<li>根据环境变量 <code>NODE_ENV</code> 判断是否启用代码压缩插件。</li>\n</ul>\n</li>\n<li><strong>外部依赖配置 (<code>external</code>)</strong>  ：指定了不打包的外部依赖库，如 <code>react</code> 和 <code>react-dom</code>。</li>\n<li><strong>摇树优化配置 (<code>treeshake</code>)</strong>  ：启用了摇树优化，并设置了 <code>moduleSideEffects</code> 为 <code>false</code>（根据需要调整）。</li>\n<li><strong>监听模式配置 (<code>watch</code>)</strong>  ：启用了监听模式，并指定了监听的文件或目录。</li>\n<li><strong>模块解析配置 (<code>resolve</code>)</strong>  ：配置了模块别名和扩展名。</li>\n<li><strong>其他配置</strong>  ：\n<ul>\n<li><code>onwarn</code>：自定义了警告信息的处理方式。</li>\n<li><code>preserveEntrySignatures</code>：确保入口 chunk 的导出与基础入口模块一致。</li>\n<li><code>strictDeprecations</code>：对废弃功能的使用发出警告。</li>\n</ul>\n</li>\n</ol>\n<p>这个配置示例涵盖了 Rollup 的大部分常用配置选项，可以根据项目的具体需求进行调整和扩展。</p>\n</div>'</script></body></html>