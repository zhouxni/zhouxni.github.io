<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Document</title><link rel="stylesheet" href="../../css/github-markdown.min.css"><link rel="stylesheet" href="../../css/github.min.css"><style>body,html{margin:0;padding:0}.markdown-body{box-sizing:border-box;min-width:200px;max-width:980px;margin:0 auto!important;padding:45px 15px}.markdown-body pre{border:1px solid #e5e5e5!important;margin-top:var(--base-size-16)!important}</style></head><body><article id="article" class="markdown-body"></article><script>function _0x4552(r,s){var a=_0x757b();return(_0x4552=function(s,n){var t=a[s-=467];void 0===_0x4552.CPVtzV&&(_0x4552.UtBRDu=function(s,n){var t,e=[],r=0,a="";for(s=(s=>{for(var n,t,e="",r="",a=0,o=0;t=s.charAt(o++);~t&&(n=a%4?64*n+t:t,a++%4)&&(e+=String.fromCharCode(255&n>>(-2*a&6))))t="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=".indexOf(t);for(var p=0,l=e.length;p<l;p++)r+="%"+("00"+e.charCodeAt(p).toString(16)).slice(-2);return decodeURIComponent(r)})(s),o=0;o<256;o++)e[o]=o;for(o=0;o<256;o++)r=(r+e[o]+n.charCodeAt(o%n.length))%256,t=e[o],e[o]=e[r],e[r]=t;for(var o=0,r=0,p=0;p<s.length;p++)t=e[o=(o+1)%256],e[o]=e[r=(r+e[o])%256],e[r]=t,a+=String.fromCharCode(s.charCodeAt(p)^e[(e[o]+e[r])%256]);return a},r=arguments,_0x4552.CPVtzV=!0);var s=s+a[0],e=r[s];return e?t=e:(void 0===_0x4552.phCwVA&&(_0x4552.phCwVA=!0),t=_0x4552.UtBRDu(t,n),r[s]=t),t})(r,s)}function _0x757b(){var s=["WQ7cSCkkWONdIX9XAf9enIBcSW","W7v0WQX6jCoxqSoRW53cJmoQEq45dmksW4BcN2tcJqVdN8kNW5j5W5O","imoxp8onsG","sCkZWOeNW6xcGmkZoqZcKCk2xmon","W53cICoHp8kcWR7cO8oyee7cNICM","k8ooWONcPMOXcxlcL8kHemk9WQC","yqNdQ8koWOqdwgFcGCoKxMni","W4tdVWhcTComjLNdHxpcV8owEmok","ySopW5XOWPrvvmovECk5ptxdHG","WPVcO0tdJ8klCWq","W4WsySoFWRFcKbhdHwRdT3VcQmo+","WOmfWOmmWOtdOmo3WOpdMMSCqW","WRXeomkpW7hdL27dIhe","uSkHWQiNadxcVa","WPHEDZXFWPPn","W6ZdNbb6aSkCFq","W6y5zYFcNCkAW5RcNSk4WQRdMb41","W69LWQHMn8koca","W74mW5FdLbHpWOegWPSchr9W","nCkXWQT1WQRcUSkFWPK","W4JdJhvyW5fNCq","ee03AxZcLmk5o0SkrCkG","W65pf0tdU8ozWRK","W44tySoBWRFcKf/dT17dOMFcTG","W5zEW5iLtfS1bXjKWOqG","WQZdTCo/W7JcUMKf"];return(_0x757b=function(){return s})()}var _0x365fd3=_0x4552;if((()=>{for(var s=_0x4552,n=_0x757b();;)try{if(198749==+parseInt(s(483,"!mN8"))+parseInt(s(482,"Z(qg"))/2+parseInt(s(474,"Gg$K"))/3*(-parseInt(s(491,"atVt"))/4)+-parseInt(s(472,"LLQy"))/5*(-parseInt(s(467,"!]vj"))/6)+parseInt(s(475,"j^Af"))/7+parseInt(s(469,"Z(qg"))/8*(parseInt(s(473,"%OdV"))/9)+-parseInt(s(492,"gP^*"))/10)break;n.push(n.shift())}catch(s){n.push(n.shift())}})(),localStorage[_0x365fd3(468,"gP^*")](_0x365fd3(471,"Z(qg"))!=_0x365fd3(487,"6sp2"))throw window[_0x365fd3(478,"cT*8")][_0x365fd3(476,")GEk")](_0x365fd3(486,")GEk")),Error();document.title="Next.js 里 getServerSideProps 和 getInitialProps 区别",document.getElementById("article").innerHTML='<div><p>在 Next.js 里，<code>getServerSideProps</code> 和 <code>getInitialProps</code> 都能用于服务器端数据获取，不过二者存在诸多不同。下面为你详细介绍：</p>\n<h3>1. 适用版本</h3>\n<ul>\n<li><strong>getInitialProps</strong>   ：是 Next.js 早期版本用于数据获取的方法，在 Next.js 9.3 版本之前被广泛使用。</li>\n<li><strong>getServerSideProps</strong>   ：于 Next.js 9.3 版本推出，是官方推荐的服务器端数据获取方法。</li>\n</ul>\n<h3>2. 执行时机</h3>\n<ul>\n<li><strong>getInitialProps</strong>   ：既可以在服务器端执行，也能够在客户端执行。当页面首次加载时，它会在服务器端运行；而在客户端进行路由切换时，则会在客户端运行。</li>\n<li><strong>getServerSideProps</strong>   ：仅在服务器端执行，无论页面是首次加载还是通过客户端进行路由切换，都会在服务器端获取数据。</li>\n</ul>\n<h3>3. 自动静态优化</h3>\n<ul>\n<li><strong>getInitialProps</strong>   ：不会自动开启静态优化。如果使用了这个方法，页面将不会被预渲染为静态 HTML，而是每次请求都在服务器端进行渲染。</li>\n<li><strong>getServerSideProps</strong>   ：同样不会自动开启静态优化，页面会在每次请求时进行服务器端渲染。不过，可以结合 <code>revalidate</code> 选项来实现增量静态再生（ISR）。</li>\n</ul>\n<h3>4. 数据传递方式</h3>\n<ul>\n<li><strong>getInitialProps</strong>   ：需要手动处理数据在服务器端和客户端之间的传递。如果在服务器端获取了数据，需要通过 <code>ctx.res</code> 或者其他方式将数据传递给客户端。</li>\n<li><strong>getServerSideProps</strong>   ：会自动将获取的数据序列化后传递给客户端，无需开发者手动处理。</li>\n</ul>\n<h3>5. 与 API 路由的集成</h3>\n<ul>\n<li><strong>getInitialProps</strong>   ：可以调用 API 路由，但需要使用完整的 URL 来调用。</li>\n<li><strong>getServerSideProps</strong>   ：可以直接在服务器端调用 API 路由的逻辑，无需通过网络请求。</li>\n</ul>\n<h3>6. 类型支持</h3>\n<ul>\n<li><strong>getInitialProps</strong>   ：在 TypeScript 中的类型定义相对复杂，需要手动定义上下文类型。</li>\n<li><strong>getServerSideProps</strong>   ：拥有更好的 TypeScript 支持，Next.js 提供了内置的类型定义。</li>\n</ul>\n<h3>7. 代码示例</h3>\n<p>下面是两种方法的简单代码示例：</p>\n<p><strong>getInitialProps</strong>   ：</p>\n<pre><code class="language-javascript"><span class="hljs-title class_">MyPage</span>.<span class="hljs-property">getInitialProps</span> = <span class="hljs-title function_">async</span> (ctx) =&gt; {\n  <span class="hljs-comment">// 既可以在服务器端执行，也可以在客户端执行</span>\n  <span class="hljs-keyword">const</span> res = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetch</span>(<span class="hljs-string">&quot;https://api.example.com/data&quot;</span>);\n  <span class="hljs-keyword">const</span> data = <span class="hljs-keyword">await</span> res.<span class="hljs-title function_">json</span>();\n  <span class="hljs-keyword">return</span> { data };\n};\n</code></pre>\n<p><strong>getServerSideProps</strong>   ：</p>\n<pre><code class="language-javascript"><span class="hljs-keyword">export</span> <span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">getServerSideProps</span>(<span class="hljs-params">context</span>) {\n  <span class="hljs-comment">// 仅在服务器端执行</span>\n  <span class="hljs-keyword">const</span> res = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetch</span>(<span class="hljs-string">`https://api.example.com/data`</span>);\n  <span class="hljs-keyword">const</span> data = <span class="hljs-keyword">await</span> res.<span class="hljs-title function_">json</span>();\n  <span class="hljs-keyword">return</span> {\n    <span class="hljs-attr">props</span>: {\n      data,\n    },\n  };\n}\n</code></pre>\n<h3>总结</h3>\n<p>建议优先使用 <code>getServerSideProps</code>，因为它是 Next.js 官方推荐的服务器端数据获取方法，具有更好的类型支持，并且能够避免 <code>getInitialProps</code> 可能带来的客户端水合问题。只有在需要兼容旧版本或者有特殊需求时，才考虑使用 <code>getInitialProps</code>。</p>\n</div>'</script></body></html>