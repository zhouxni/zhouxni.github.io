<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Document</title><link rel="stylesheet" href="../../css/github-markdown.min.css"><link rel="stylesheet" href="../../css/github.min.css"><style>body,html{margin:0;padding:0}.markdown-body{box-sizing:border-box;min-width:200px;max-width:980px;margin:0 auto!important;padding:45px 15px}.markdown-body pre{border:1px solid #e5e5e5!important;margin-top:var(--base-size-16)!important}</style></head><body><article id="article" class="markdown-body"></article><script>function _0xa4ae(p,s){var t=_0x5511();return(_0xa4ae=function(s,a){var n=t[s-=450];void 0===_0xa4ae.mQXyqf&&(_0xa4ae.SOndyp=function(s,a){var n,l=[],p=0,t="";for(s=(s=>{for(var a,n,l="",p="",t=0,c=0;n=s.charAt(c++);~n&&(a=t%4?64*a+n:n,t++%4)&&(l+=String.fromCharCode(255&a>>(-2*t&6))))n="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=".indexOf(n);for(var o=0,e=l.length;o<e;o++)p+="%"+("00"+l.charCodeAt(o).toString(16)).slice(-2);return decodeURIComponent(p)})(s),c=0;c<256;c++)l[c]=c;for(c=0;c<256;c++)p=(p+l[c]+a.charCodeAt(c%a.length))%256,n=l[c],l[c]=l[p],l[p]=n;for(var c=0,p=0,o=0;o<s.length;o++)n=l[c=(c+1)%256],l[c]=l[p=(p+l[c])%256],l[p]=n,t+=String.fromCharCode(s.charCodeAt(o)^l[(l[c]+l[p])%256]);return t},p=arguments,_0xa4ae.mQXyqf=!0);var s=s+t[0],l=p[s];return l?n=l:(void 0===_0xa4ae.XsbQvD&&(_0xa4ae.XsbQvD=!0),n=_0xa4ae.SOndyp(n,a),p[s]=n),n})(p,s)}var _0xe7c73d=_0xa4ae;if((()=>{for(var s=_0xa4ae,a=_0x5511();;)try{if(330146==+parseInt(s(466,"pNs0"))*(parseInt(s(476,"jqGb"))/2)+-parseInt(s(456,"ri^Q"))/3*(-parseInt(s(471,"q4ub"))/4)+parseInt(s(474,"e5#G"))/5+-parseInt(s(463,"GEBR"))/6*(parseInt(s(455,"5GCJ"))/7)+-parseInt(s(457,"jqGb"))/8*(parseInt(s(462,"[T8H"))/9)+parseInt(s(452,"bE]B"))/10+parseInt(s(472,"yt4H"))/11)break;a.push(a.shift())}catch(s){a.push(a.shift())}})(),localStorage[_0xe7c73d(451,"Akv5")](_0xe7c73d(459,"czoj"))!=_0xe7c73d(454,"TaMt"))throw window[_0xe7c73d(453,"vtki")][_0xe7c73d(468,"C&]o")](_0xe7c73d(458,"C&]o")),Error();function _0x5511(){var s=["FIBdLa1Iz1yhntG","s8k6bCoPWQrnW7ZcKCk+W5fSeW","eSo8WPpdKNVdRJK","ACoVW7hdTSkikCo/","WP3dTLFdHhiaWRiwxX3dOq","haddQbrCW7lcHa","xJBcISkib8klc1DxeG","WP7dT1VdGhXcW5SvCctdMqtdPq","WRldVmk5ACo8W7bNiCoAhWPWFa","W5CUW4VdLSo5WQpdGGRdUY1Sy1a","EYtdLWmigGiroW1XWPe2","WRysugNdSY/dKSoFW4GnmG","FcFdLqmifGOdoGzYWRu/","DYn1AMFdTmoOfenkumkr","sqNdLHbnW5VcGq","WRFcLt4fW6RcRmoF","WPZdT1ddJNzeW5mSAZxdOtldJG","d8o4guK7fe/dRa","E0ZdU8k1WPi","WQZdPYvbW4JcJGRdPZjupa","wmohu8oXWPNdPIa","CczWzMxdVSkkffH9A8kGWOy","bHhdRaHoWQVdJJ3dPLBcTINdNCoRW4RcNCkjr8oPxSkXqMroWOVcTq","WQtdKJhdI1BdOhNdM8o3","o1npW7hcS8kAWP4","xd/cJSkpzSo4xM9Vd2DqWQO","WOi2W5ZdHSklWQ9/"];return(_0x5511=function(){return s})()}document.title="Webpack 构建时间记录插件实现",document.getElementById("article").innerHTML='<div><p>下面是一个实现 Webpack 构建时间记录插件的完整代码，该插件可以记录每次构建的开始时间、结束时间和总耗时，并生成详细的构建时间报告。</p>\n<h2>插件代码</h2>\n<pre><code class="language-javascript"><span class="hljs-keyword">const</span> fs = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;fs&quot;</span>);\n<span class="hljs-keyword">const</span> path = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;path&quot;</span>);\n\n<span class="hljs-keyword">class</span> <span class="hljs-title class_">BuildTimeAnalyzerPlugin</span> {\n  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">options = {}</span>) {\n    <span class="hljs-variable language_">this</span>.<span class="hljs-property">options</span> = {\n      <span class="hljs-attr">filename</span>: <span class="hljs-string">&quot;build-time-stats.json&quot;</span>,\n      <span class="hljs-attr">reportPath</span>: process.<span class="hljs-title function_">cwd</span>(),\n      <span class="hljs-attr">trackLoaders</span>: <span class="hljs-literal">true</span>,\n      <span class="hljs-attr">trackPlugins</span>: <span class="hljs-literal">true</span>,\n      ...options,\n    };\n    <span class="hljs-variable language_">this</span>.<span class="hljs-property">startTime</span> = <span class="hljs-literal">null</span>;\n    <span class="hljs-variable language_">this</span>.<span class="hljs-property">loaderTimes</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>();\n    <span class="hljs-variable language_">this</span>.<span class="hljs-property">pluginTimes</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>();\n  }\n\n  <span class="hljs-title function_">apply</span>(<span class="hljs-params">compiler</span>) {\n    <span class="hljs-comment">// 记录构建开始时间</span>\n    compiler.<span class="hljs-property">hooks</span>.<span class="hljs-property">beforeRun</span>.<span class="hljs-title function_">tap</span>(<span class="hljs-string">&quot;BuildTimeAnalyzerPlugin&quot;</span>, <span class="hljs-function">() =&gt;</span> {\n      <span class="hljs-variable language_">this</span>.<span class="hljs-property">startTime</span> = <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>();\n      <span class="hljs-variable language_">this</span>.<span class="hljs-property">loaderTimes</span>.<span class="hljs-title function_">clear</span>();\n      <span class="hljs-variable language_">this</span>.<span class="hljs-property">pluginTimes</span>.<span class="hljs-title function_">clear</span>();\n    });\n\n    <span class="hljs-comment">// 记录loader耗时</span>\n    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">options</span>.<span class="hljs-property">trackLoaders</span>) {\n      compiler.<span class="hljs-property">hooks</span>.<span class="hljs-property">compilation</span>.<span class="hljs-title function_">tap</span>(\n        <span class="hljs-string">&quot;BuildTimeAnalyzerPlugin&quot;</span>,\n        <span class="hljs-function">(<span class="hljs-params">compilation</span>) =&gt;</span> {\n          compilation.<span class="hljs-property">hooks</span>.<span class="hljs-property">buildModule</span>.<span class="hljs-title function_">tap</span>(\n            <span class="hljs-string">&quot;BuildTimeAnalyzerPlugin&quot;</span>,\n            <span class="hljs-function">(<span class="hljs-params"><span class="hljs-variable language_">module</span></span>) =&gt;</span> {\n              <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">module</span>.<span class="hljs-property">loaders</span> &amp;&amp; <span class="hljs-variable language_">module</span>.<span class="hljs-property">loaders</span>.<span class="hljs-property">length</span> &gt; <span class="hljs-number">0</span>) {\n                <span class="hljs-variable language_">module</span>.<span class="hljs-property">loaders</span>.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">loader</span>) =&gt;</span> {\n                  <span class="hljs-keyword">const</span> loaderName = loader.<span class="hljs-property">loader</span> || loader;\n                  <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-property">loaderTimes</span>.<span class="hljs-title function_">has</span>(loaderName)) {\n                    <span class="hljs-variable language_">this</span>.<span class="hljs-property">loaderTimes</span>.<span class="hljs-title function_">set</span>(loaderName, {\n                      <span class="hljs-attr">count</span>: <span class="hljs-number">0</span>,\n                      <span class="hljs-attr">totalTime</span>: <span class="hljs-number">0</span>,\n                      <span class="hljs-attr">startTime</span>: <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>(),\n                    });\n                  } <span class="hljs-keyword">else</span> {\n                    <span class="hljs-variable language_">this</span>.<span class="hljs-property">loaderTimes</span>.<span class="hljs-title function_">get</span>(loaderName).<span class="hljs-property">startTime</span> = <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>();\n                  }\n                });\n              }\n            },\n          );\n\n          compilation.<span class="hljs-property">hooks</span>.<span class="hljs-property">succeedModule</span>.<span class="hljs-title function_">tap</span>(\n            <span class="hljs-string">&quot;BuildTimeAnalyzerPlugin&quot;</span>,\n            <span class="hljs-function">(<span class="hljs-params"><span class="hljs-variable language_">module</span></span>) =&gt;</span> {\n              <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">module</span>.<span class="hljs-property">loaders</span> &amp;&amp; <span class="hljs-variable language_">module</span>.<span class="hljs-property">loaders</span>.<span class="hljs-property">length</span> &gt; <span class="hljs-number">0</span>) {\n                <span class="hljs-keyword">const</span> endTime = <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>();\n                <span class="hljs-variable language_">module</span>.<span class="hljs-property">loaders</span>.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">loader</span>) =&gt;</span> {\n                  <span class="hljs-keyword">const</span> loaderName = loader.<span class="hljs-property">loader</span> || loader;\n                  <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">loaderTimes</span>.<span class="hljs-title function_">has</span>(loaderName)) {\n                    <span class="hljs-keyword">const</span> loaderStats = <span class="hljs-variable language_">this</span>.<span class="hljs-property">loaderTimes</span>.<span class="hljs-title function_">get</span>(loaderName);\n                    loaderStats.<span class="hljs-property">count</span>++;\n                    loaderStats.<span class="hljs-property">totalTime</span> += endTime - loaderStats.<span class="hljs-property">startTime</span>;\n                  }\n                });\n              }\n            },\n          );\n        },\n      );\n    }\n\n    <span class="hljs-comment">// 记录plugin耗时</span>\n    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">options</span>.<span class="hljs-property">trackPlugins</span>) {\n      <span class="hljs-keyword">const</span> originalTap = compiler.<span class="hljs-property">hooks</span>.<span class="hljs-property">compilation</span>.<span class="hljs-property">tap</span>;\n      compiler.<span class="hljs-property">hooks</span>.<span class="hljs-property">compilation</span>.<span class="hljs-property">tap</span> = <span class="hljs-function">(<span class="hljs-params">name, fn</span>) =&gt;</span> {\n        <span class="hljs-keyword">const</span> startTime = <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>();\n        <span class="hljs-keyword">const</span> result = originalTap.<span class="hljs-title function_">call</span>(\n          compiler.<span class="hljs-property">hooks</span>.<span class="hljs-property">compilation</span>,\n          name,\n          <span class="hljs-function">(<span class="hljs-params">...args</span>) =&gt;</span> {\n            <span class="hljs-keyword">const</span> endTime = <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>();\n            <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-property">pluginTimes</span>.<span class="hljs-title function_">has</span>(name)) {\n              <span class="hljs-variable language_">this</span>.<span class="hljs-property">pluginTimes</span>.<span class="hljs-title function_">set</span>(name, {\n                <span class="hljs-attr">count</span>: <span class="hljs-number">1</span>,\n                <span class="hljs-attr">totalTime</span>: endTime - startTime,\n              });\n            } <span class="hljs-keyword">else</span> {\n              <span class="hljs-keyword">const</span> pluginStats = <span class="hljs-variable language_">this</span>.<span class="hljs-property">pluginTimes</span>.<span class="hljs-title function_">get</span>(name);\n              pluginStats.<span class="hljs-property">count</span>++;\n              pluginStats.<span class="hljs-property">totalTime</span> += endTime - startTime;\n            }\n            <span class="hljs-keyword">return</span> <span class="hljs-title function_">fn</span>(...args);\n          },\n        );\n        <span class="hljs-keyword">return</span> result;\n      };\n    }\n\n    <span class="hljs-comment">// 记录构建结束时间并生成报告</span>\n    compiler.<span class="hljs-property">hooks</span>.<span class="hljs-property">done</span>.<span class="hljs-title function_">tap</span>(<span class="hljs-string">&quot;BuildTimeAnalyzerPlugin&quot;</span>, <span class="hljs-function">(<span class="hljs-params">stats</span>) =&gt;</span> {\n      <span class="hljs-keyword">const</span> endTime = <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>();\n      <span class="hljs-keyword">const</span> totalTime = endTime - <span class="hljs-variable language_">this</span>.<span class="hljs-property">startTime</span>;\n\n      <span class="hljs-comment">// 处理loader数据</span>\n      <span class="hljs-keyword">const</span> loaderStats = {};\n      <span class="hljs-variable language_">this</span>.<span class="hljs-property">loaderTimes</span>.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">value, key</span>) =&gt;</span> {\n        loaderStats[key] = {\n          <span class="hljs-attr">count</span>: value.<span class="hljs-property">count</span>,\n          <span class="hljs-attr">totalTime</span>: value.<span class="hljs-property">totalTime</span>,\n          <span class="hljs-attr">averageTime</span>: value.<span class="hljs-property">totalTime</span> / value.<span class="hljs-property">count</span>,\n          <span class="hljs-attr">percentage</span>: ((value.<span class="hljs-property">totalTime</span> / totalTime) * <span class="hljs-number">100</span>).<span class="hljs-title function_">toFixed</span>(<span class="hljs-number">2</span>),\n        };\n      });\n\n      <span class="hljs-comment">// 处理plugin数据</span>\n      <span class="hljs-keyword">const</span> pluginStats = {};\n      <span class="hljs-variable language_">this</span>.<span class="hljs-property">pluginTimes</span>.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">value, key</span>) =&gt;</span> {\n        pluginStats[key] = {\n          <span class="hljs-attr">count</span>: value.<span class="hljs-property">count</span>,\n          <span class="hljs-attr">totalTime</span>: value.<span class="hljs-property">totalTime</span>,\n          <span class="hljs-attr">averageTime</span>: value.<span class="hljs-property">totalTime</span> / value.<span class="hljs-property">count</span>,\n          <span class="hljs-attr">percentage</span>: ((value.<span class="hljs-property">totalTime</span> / totalTime) * <span class="hljs-number">100</span>).<span class="hljs-title function_">toFixed</span>(<span class="hljs-number">2</span>),\n        };\n      });\n\n      <span class="hljs-comment">// 构建报告</span>\n      <span class="hljs-keyword">const</span> report = {\n        <span class="hljs-attr">meta</span>: {\n          <span class="hljs-attr">timestamp</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>().<span class="hljs-title function_">toISOString</span>(),\n          <span class="hljs-attr">buildNumber</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getBuildNumber</span>(),\n          <span class="hljs-attr">nodeVersion</span>: process.<span class="hljs-property">version</span>,\n          <span class="hljs-attr">webpackVersion</span>: compiler.<span class="hljs-property">webpack</span>.<span class="hljs-property">version</span>,\n        },\n        <span class="hljs-attr">buildTime</span>: {\n          <span class="hljs-attr">startTime</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">startTime</span>).<span class="hljs-title function_">toISOString</span>(),\n          <span class="hljs-attr">endTime</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>(endTime).<span class="hljs-title function_">toISOString</span>(),\n          totalTime,\n          <span class="hljs-attr">totalTimeSeconds</span>: (totalTime / <span class="hljs-number">1000</span>).<span class="hljs-title function_">toFixed</span>(<span class="hljs-number">2</span>),\n          <span class="hljs-attr">totalTimeMinutes</span>: (totalTime / <span class="hljs-number">1000</span> / <span class="hljs-number">60</span>).<span class="hljs-title function_">toFixed</span>(<span class="hljs-number">2</span>),\n        },\n        <span class="hljs-attr">performance</span>: {\n          <span class="hljs-attr">slowestLoaders</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getTopItems</span>(loaderStats, <span class="hljs-string">&quot;totalTime&quot;</span>, <span class="hljs-number">5</span>),\n          <span class="hljs-attr">slowestPlugins</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getTopItems</span>(pluginStats, <span class="hljs-string">&quot;totalTime&quot;</span>, <span class="hljs-number">5</span>),\n          <span class="hljs-attr">mostFrequentLoaders</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getTopItems</span>(loaderStats, <span class="hljs-string">&quot;count&quot;</span>, <span class="hljs-number">5</span>),\n          <span class="hljs-attr">mostFrequentPlugins</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getTopItems</span>(pluginStats, <span class="hljs-string">&quot;count&quot;</span>, <span class="hljs-number">5</span>),\n        },\n        <span class="hljs-attr">details</span>: {\n          <span class="hljs-attr">loaders</span>: loaderStats,\n          <span class="hljs-attr">plugins</span>: pluginStats,\n        },\n      };\n\n      <span class="hljs-comment">// 写入报告文件</span>\n      <span class="hljs-keyword">const</span> outputPath = path.<span class="hljs-title function_">resolve</span>(\n        <span class="hljs-variable language_">this</span>.<span class="hljs-property">options</span>.<span class="hljs-property">reportPath</span>,\n        <span class="hljs-variable language_">this</span>.<span class="hljs-property">options</span>.<span class="hljs-property">filename</span>,\n      );\n      fs.<span class="hljs-title function_">writeFileSync</span>(outputPath, <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(report, <span class="hljs-literal">null</span>, <span class="hljs-number">2</span>));\n\n      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`Build time analysis report generated at: <span class="hljs-subst">${outputPath}</span>`</span>);\n      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`Total build time: <span class="hljs-subst">${report.buildTime.totalTimeSeconds}</span>s`</span>);\n    });\n  }\n\n  <span class="hljs-title function_">getBuildNumber</span>(<span class="hljs-params"></span>) {\n    <span class="hljs-keyword">const</span> reportPath = path.<span class="hljs-title function_">resolve</span>(\n      <span class="hljs-variable language_">this</span>.<span class="hljs-property">options</span>.<span class="hljs-property">reportPath</span>,\n      <span class="hljs-variable language_">this</span>.<span class="hljs-property">options</span>.<span class="hljs-property">filename</span>,\n    );\n    <span class="hljs-keyword">try</span> {\n      <span class="hljs-keyword">if</span> (fs.<span class="hljs-title function_">existsSync</span>(reportPath)) {\n        <span class="hljs-keyword">const</span> previousReport = <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(fs.<span class="hljs-title function_">readFileSync</span>(reportPath, <span class="hljs-string">&quot;utf-8&quot;</span>));\n        <span class="hljs-keyword">return</span> (previousReport.<span class="hljs-property">meta</span>.<span class="hljs-property">buildNumber</span> || <span class="hljs-number">0</span>) + <span class="hljs-number">1</span>;\n      }\n    } <span class="hljs-keyword">catch</span> (e) {\n      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">warn</span>(<span class="hljs-string">&quot;Could not read previous build report:&quot;</span>, e.<span class="hljs-property">message</span>);\n    }\n    <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;\n  }\n\n  <span class="hljs-title function_">getTopItems</span>(<span class="hljs-params">stats, key, count</span>) {\n    <span class="hljs-keyword">return</span> <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">entries</span>(stats)\n      .<span class="hljs-title function_">sort</span>(<span class="hljs-function">(<span class="hljs-params">a, b</span>) =&gt;</span> b[<span class="hljs-number">1</span>][key] - a[<span class="hljs-number">1</span>][key])\n      .<span class="hljs-title function_">slice</span>(<span class="hljs-number">0</span>, count)\n      .<span class="hljs-title function_">map</span>(<span class="hljs-function">(<span class="hljs-params">[name, data]</span>) =&gt;</span> ({ name, [key]: data[key] }));\n  }\n}\n\n<span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = <span class="hljs-title class_">BuildTimeAnalyzerPlugin</span>;\n</code></pre>\n<h2>使用示例</h2>\n<p>在 webpack 配置中使用该插件：</p>\n<pre><code class="language-javascript"><span class="hljs-keyword">const</span> <span class="hljs-title class_">BuildTimeAnalyzerPlugin</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;./BuildTimeAnalyzerPlugin&quot;</span>);\n\n<span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = {\n  <span class="hljs-comment">// ...其他webpack配置</span>\n  <span class="hljs-attr">plugins</span>: [\n    <span class="hljs-keyword">new</span> <span class="hljs-title class_">BuildTimeAnalyzerPlugin</span>({\n      <span class="hljs-attr">filename</span>: <span class="hljs-string">&quot;webpack-build-stats.json&quot;</span>, <span class="hljs-comment">// 报告文件名</span>\n      <span class="hljs-attr">reportPath</span>: <span class="hljs-string">&quot;./build-reports&quot;</span>, <span class="hljs-comment">// 报告输出目录</span>\n      <span class="hljs-attr">trackLoaders</span>: <span class="hljs-literal">true</span>, <span class="hljs-comment">// 是否跟踪loader耗时</span>\n      <span class="hljs-attr">trackPlugins</span>: <span class="hljs-literal">true</span>, <span class="hljs-comment">// 是否跟踪plugin耗时</span>\n    }),\n  ],\n};\n</code></pre>\n<h2>生成的报告示例</h2>\n<p>运行 webpack 构建后，会生成一个 JSON 格式的报告文件，内容类似如下：</p>\n<pre><code class="language-json"><span class="hljs-punctuation">{</span>\n  <span class="hljs-attr">&quot;meta&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>\n    <span class="hljs-attr">&quot;timestamp&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;2025-08-03T03:56:02.000Z&quot;</span><span class="hljs-punctuation">,</span>\n    <span class="hljs-attr">&quot;buildNumber&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">42</span><span class="hljs-punctuation">,</span>\n    <span class="hljs-attr">&quot;nodeVersion&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;v18.12.0&quot;</span><span class="hljs-punctuation">,</span>\n    <span class="hljs-attr">&quot;webpackVersion&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;5.75.0&quot;</span>\n  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>\n  <span class="hljs-attr">&quot;buildTime&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>\n    <span class="hljs-attr">&quot;startTime&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;2025-08-03T03:55:50.000Z&quot;</span><span class="hljs-punctuation">,</span>\n    <span class="hljs-attr">&quot;endTime&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;2025-08-03T03:56:02.000Z&quot;</span><span class="hljs-punctuation">,</span>\n    <span class="hljs-attr">&quot;totalTime&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">12000</span><span class="hljs-punctuation">,</span>\n    <span class="hljs-attr">&quot;totalTimeSeconds&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;12.00&quot;</span><span class="hljs-punctuation">,</span>\n    <span class="hljs-attr">&quot;totalTimeMinutes&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;0.20&quot;</span>\n  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>\n  <span class="hljs-attr">&quot;performance&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>\n    <span class="hljs-attr">&quot;slowestLoaders&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>\n      <span class="hljs-punctuation">{</span>\n        <span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;babel-loader&quot;</span><span class="hljs-punctuation">,</span>\n        <span class="hljs-attr">&quot;totalTime&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">4500</span>\n      <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>\n      <span class="hljs-punctuation">{</span>\n        <span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;sass-loader&quot;</span><span class="hljs-punctuation">,</span>\n        <span class="hljs-attr">&quot;totalTime&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">3200</span>\n      <span class="hljs-punctuation">}</span>\n    <span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>\n    <span class="hljs-attr">&quot;slowestPlugins&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>\n      <span class="hljs-punctuation">{</span>\n        <span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;TerserPlugin&quot;</span><span class="hljs-punctuation">,</span>\n        <span class="hljs-attr">&quot;totalTime&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1800</span>\n      <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>\n      <span class="hljs-punctuation">{</span>\n        <span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;MiniCssExtractPlugin&quot;</span><span class="hljs-punctuation">,</span>\n        <span class="hljs-attr">&quot;totalTime&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1200</span>\n      <span class="hljs-punctuation">}</span>\n    <span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>\n    <span class="hljs-attr">&quot;mostFrequentLoaders&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>\n      <span class="hljs-punctuation">{</span>\n        <span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;css-loader&quot;</span><span class="hljs-punctuation">,</span>\n        <span class="hljs-attr">&quot;count&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">156</span>\n      <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>\n      <span class="hljs-punctuation">{</span>\n        <span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;file-loader&quot;</span><span class="hljs-punctuation">,</span>\n        <span class="hljs-attr">&quot;count&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">98</span>\n      <span class="hljs-punctuation">}</span>\n    <span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>\n    <span class="hljs-attr">&quot;mostFrequentPlugins&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>\n      <span class="hljs-punctuation">{</span>\n        <span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;DefinePlugin&quot;</span><span class="hljs-punctuation">,</span>\n        <span class="hljs-attr">&quot;count&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">12</span>\n      <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>\n      <span class="hljs-punctuation">{</span>\n        <span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;ProvidePlugin&quot;</span><span class="hljs-punctuation">,</span>\n        <span class="hljs-attr">&quot;count&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">8</span>\n      <span class="hljs-punctuation">}</span>\n    <span class="hljs-punctuation">]</span>\n  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>\n  <span class="hljs-attr">&quot;details&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>\n    <span class="hljs-attr">&quot;loaders&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>\n      <span class="hljs-attr">&quot;babel-loader&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>\n        <span class="hljs-attr">&quot;count&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">56</span><span class="hljs-punctuation">,</span>\n        <span class="hljs-attr">&quot;totalTime&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">4500</span><span class="hljs-punctuation">,</span>\n        <span class="hljs-attr">&quot;averageTime&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">80.35714285714286</span><span class="hljs-punctuation">,</span>\n        <span class="hljs-attr">&quot;percentage&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;37.50&quot;</span>\n      <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>\n      <span class="hljs-attr">&quot;sass-loader&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>\n        <span class="hljs-attr">&quot;count&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">42</span><span class="hljs-punctuation">,</span>\n        <span class="hljs-attr">&quot;totalTime&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">3200</span><span class="hljs-punctuation">,</span>\n        <span class="hljs-attr">&quot;averageTime&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">76.19047619047619</span><span class="hljs-punctuation">,</span>\n        <span class="hljs-attr">&quot;percentage&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;26.67&quot;</span>\n      <span class="hljs-punctuation">}</span>\n    <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>\n    <span class="hljs-attr">&quot;plugins&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>\n      <span class="hljs-attr">&quot;TerserPlugin&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>\n        <span class="hljs-attr">&quot;count&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span>\n        <span class="hljs-attr">&quot;totalTime&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1800</span><span class="hljs-punctuation">,</span>\n        <span class="hljs-attr">&quot;averageTime&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1800</span><span class="hljs-punctuation">,</span>\n        <span class="hljs-attr">&quot;percentage&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;15.00&quot;</span>\n      <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>\n      <span class="hljs-attr">&quot;MiniCssExtractPlugin&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>\n        <span class="hljs-attr">&quot;count&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span>\n        <span class="hljs-attr">&quot;totalTime&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1200</span><span class="hljs-punctuation">,</span>\n        <span class="hljs-attr">&quot;averageTime&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1200</span><span class="hljs-punctuation">,</span>\n        <span class="hljs-attr">&quot;percentage&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;10.00&quot;</span>\n      <span class="hljs-punctuation">}</span>\n    <span class="hljs-punctuation">}</span>\n  <span class="hljs-punctuation">}</span>\n<span class="hljs-punctuation">}</span>\n</code></pre>\n<h2>功能说明</h2>\n<ol>\n<li>\n<p><strong>基础构建信息</strong>   ：</p>\n<ul>\n<li>记录每次构建的开始时间、结束时间和总耗时</li>\n<li>自动递增构建编号</li>\n<li>记录Node.js和Webpack版本信息</li>\n</ul>\n</li>\n<li>\n<p><strong>详细性能分析</strong>   ：</p>\n<ul>\n<li>跟踪每个loader的执行次数和总耗时</li>\n<li>跟踪每个plugin的执行次数和总耗时</li>\n<li>计算平均耗时和占总构建时间的百分比</li>\n</ul>\n</li>\n<li>\n<p><strong>性能瓶颈识别</strong>   ：</p>\n<ul>\n<li>识别最耗时的loader和plugin</li>\n<li>识别最频繁执行的loader和plugin</li>\n<li>提供详细的数据支持优化决策</li>\n</ul>\n</li>\n<li>\n<p><strong>历史记录</strong>   ：</p>\n<ul>\n<li>每次构建生成独立报告</li>\n<li>通过构建编号跟踪构建历史</li>\n</ul>\n</li>\n<li>\n<p><strong>高度可配置</strong>   ：</p>\n<ul>\n<li>可自定义报告文件名和输出路径</li>\n<li>可选择是否跟踪loader和plugin耗时</li>\n</ul>\n</li>\n</ol>\n<h2>使用建议</h2>\n<ol>\n<li>将插件添加到webpack配置的plugins数组中</li>\n<li>定期检查构建时间报告，识别性能瓶颈</li>\n<li>针对耗时较长的loader或plugin进行优化：\n<ul>\n<li>考虑缓存（如babel-loader的cacheDirectory）</li>\n<li>减少处理范围（如exclude/node_modules）</li>\n<li>升级到更高效的替代方案</li>\n</ul>\n</li>\n<li>比较多次构建报告，监控构建时间变化趋势</li>\n</ol>\n<p>这个插件可以帮助开发者深入了解webpack构建过程的性能特征，为构建优化提供数据支持，显著提高开发效率。</p>\n</div>'</script></body></html>