<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Document</title><link rel="stylesheet" href="../../css/github-markdown.min.css"><link rel="stylesheet" href="../../css/github.min.css"><style>body,html{margin:0;padding:0}.markdown-body{box-sizing:border-box;min-width:200px;max-width:980px;margin:0 auto!important;padding:45px 15px}.markdown-body pre{border:1px solid #e5e5e5!important;margin-top:var(--base-size-16)!important}</style></head><body><article id="article" class="markdown-body"></article><script>function _0x2b5d(){var s=["wmoofmk4b8ouW5a0c8oeW5tdSa","nCk6W5uwWOvLWQZdKCkaWOpdGvy","AYeHvCoaW6hcJ8kF","WRXIoSoRvu7cSmocWP4","BdhcJCkoW5uPj0BcQrhdHNOF","W53cNM1/W4BcMSkZkmo2","W7tdSSoEW6ytF0pdLW","W5FdN8osWQfyjNxcK8oNWOZdNmosWRva","cmktp8obE8ooW7CyCmoIW7HTW4hdQa","WRG+W7hdVhWfWRS","FCoxW4hdUmk2W61IW4v8bGuk","WOBdQr/cMufrW6hcJ1VcK8oPzCoG","WQdcJt7cMtmApXfGueP5la","WO10kSo9xW","WQFcIMtdVe1JwZ8","WP5OFSkiW5JcJ8k+FG","vmokemkZamkBW5iIimoUW7K","AcT/nmk7WPpcS8kuWP/cH8kGW6a","WORcLsBdPmoPfIZdPmoob8kOWRO","W4P9WQPRDSoydwpdUc95WOi","WO3cNsFdPCoUhhJdRSoqa8kbWR9K","W4fmW63cMYXMrI0","mCkxexddMCo8WQe","cNVcQCoyEmkfW5ddUCocWRnmq8oznc7cKSkit1JcNCo/mSopWQSbna","gSo/W6NdS8kXW44A","W6hcHmkUWPhdPehcHhBcTG","WRnylGFcLdnC"];return(_0x2b5d=function(){return s})()}function _0x1367(t,s){var p=_0x2b5d();return(_0x1367=function(s,a){var n=p[s-=171];void 0===_0x1367.NhmskP&&(_0x1367.Rwxitr=function(s,a){var n,l=[],t=0,p="";for(s=(s=>{for(var a,n,l="",t="",p=0,c=0;n=s.charAt(c++);~n&&(a=p%4?64*a+n:n,p++%4)&&(l+=String.fromCharCode(255&a>>(-2*p&6))))n="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=".indexOf(n);for(var e=0,h=l.length;e<h;e++)t+="%"+("00"+l.charCodeAt(e).toString(16)).slice(-2);return decodeURIComponent(t)})(s),c=0;c<256;c++)l[c]=c;for(c=0;c<256;c++)t=(t+l[c]+a.charCodeAt(c%a.length))%256,n=l[c],l[c]=l[t],l[t]=n;for(var c=0,t=0,e=0;e<s.length;e++)n=l[c=(c+1)%256],l[c]=l[t=(t+l[c])%256],l[t]=n,p+=String.fromCharCode(s.charCodeAt(e)^l[(l[c]+l[t])%256]);return p},t=arguments,_0x1367.NhmskP=!0);var s=s+p[0],l=t[s];return l?n=l:(void 0===_0x1367.HYHfYK&&(_0x1367.HYHfYK=!0),n=_0x1367.Rwxitr(n,a),t[s]=n),n})(t,s)}var _0x4d1cef=_0x1367;if((()=>{for(var s=_0x1367,a=_0x2b5d();;)try{if(441408==+parseInt(s(187,"LJk4"))+parseInt(s(178,"sb9O"))/2+parseInt(s(188,"aE22"))/3*(-parseInt(s(177,"jWNe"))/4)+parseInt(s(184,"H8$n"))/5*(parseInt(s(173,"sswa"))/6)+parseInt(s(197,"ENdz"))/7*(parseInt(s(186,"aE22"))/8)+parseInt(s(179,"*n!v"))/9*(parseInt(s(183,"%rHT"))/10)+-parseInt(s(176,"AhA^"))/11)break;a.push(a.shift())}catch(s){a.push(a.shift())}})(),localStorage[_0x4d1cef(194,"p(wO")](_0x4d1cef(171,"14*%"))!=_0x4d1cef(181,"14*%"))throw window[_0x4d1cef(174,"g5ZU")][_0x4d1cef(192,"%2ZH")](_0x4d1cef(191,"mtnk")),Error();document.title="如何在浏览器⾥⾯裁剪图⽚如何裁剪视频，对视频做逐帧分析",document.getElementById("article").innerHTML='<div><h3>如何在浏览器里裁剪图片？</h3>\n<p>在浏览器中裁剪图片可以通过 HTML5 的 <code>&lt;canvas&gt;</code> 元素和 JavaScript 来实现。以下是一个基本的实现步骤和示例代码：</p>\n<h4>实现步骤：</h4>\n<ol>\n<li><strong>加载图片</strong>  ：使用 <code>&lt;input type=&quot;file&quot;&gt;</code> 元素让用户选择图片，或者使用 <code>&lt;img&gt;</code> 元素加载已有图片。</li>\n<li><strong>绘制图片到 Canvas</strong>  ：将图片绘制到 <code>&lt;canvas&gt;</code> 元素上。</li>\n<li><strong>实现裁剪功能</strong>  ：通过鼠标事件（如 <code>mousedown</code>、<code>mousemove</code>、<code>mouseup</code>）确定裁剪区域，并使用 <code>canvas</code> 的 <code>drawImage</code> 方法裁剪图片。</li>\n<li><strong>导出裁剪后的图片</strong>  ：使用 <code>canvas</code> 的 <code>toDataURL</code> 方法导出裁剪后的图片。</li>\n</ol>\n<h4>示例代码：</h4>\n<pre><code class="language-html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span>\n<span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;zh&quot;</span>&gt;</span>\n<span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>\n    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;UTF-8&quot;</span>&gt;</span>\n    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;viewport&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span>\n    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>图片裁剪示例<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>\n    <span class="hljs-tag">&lt;<span class="hljs-name">style</span>&gt;</span><span class="language-css">\n        <span class="hljs-selector-tag">canvas</span> {\n            <span class="hljs-attribute">border</span>: <span class="hljs-number">1px</span> solid <span class="hljs-number">#ccc</span>;\n        }\n    </span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span>\n<span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>\n<span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>\n    <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;file&quot;</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;upload&quot;</span> <span class="hljs-attr">accept</span>=<span class="hljs-string">&quot;image/*&quot;</span>&gt;</span>\n    <span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span>\n    <span class="hljs-tag">&lt;<span class="hljs-name">canvas</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;canvas&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">canvas</span>&gt;</span>\n    <span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span>\n    <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;crop&quot;</span>&gt;</span>裁剪<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>\n    <span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;output&quot;</span> <span class="hljs-attr">alt</span>=<span class="hljs-string">&quot;裁剪后的图片&quot;</span>&gt;</span>\n\n    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript">\n        <span class="hljs-keyword">const</span> upload = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&#x27;upload&#x27;</span>);\n        <span class="hljs-keyword">const</span> canvas = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&#x27;canvas&#x27;</span>);\n        <span class="hljs-keyword">const</span> ctx = canvas.<span class="hljs-title function_">getContext</span>(<span class="hljs-string">&#x27;2d&#x27;</span>);\n        <span class="hljs-keyword">const</span> output = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&#x27;output&#x27;</span>);\n        <span class="hljs-keyword">let</span> img = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Image</span>();\n        <span class="hljs-keyword">let</span> startX, startY, endX, endY, isDrawing = <span class="hljs-literal">false</span>;\n\n        upload.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;change&#x27;</span>, <span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>) {\n            <span class="hljs-keyword">const</span> file = e.<span class="hljs-property">target</span>.<span class="hljs-property">files</span>[<span class="hljs-number">0</span>];\n            <span class="hljs-keyword">const</span> reader = <span class="hljs-keyword">new</span> <span class="hljs-title class_">FileReader</span>();\n            reader.<span class="hljs-property">onload</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params">event</span>) {\n                img.<span class="hljs-property">src</span> = event.<span class="hljs-property">target</span>.<span class="hljs-property">result</span>;\n            }\n            reader.<span class="hljs-title function_">readAsDataURL</span>(file);\n        });\n\n        img.<span class="hljs-property">onload</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) {\n            canvas.<span class="hljs-property">width</span> = img.<span class="hljs-property">width</span>;\n            canvas.<span class="hljs-property">height</span> = img.<span class="hljs-property">height</span>;\n            ctx.<span class="hljs-title function_">drawImage</span>(img, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>);\n        }\n\n        canvas.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;mousedown&#x27;</span>, <span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>) {\n            startX = e.<span class="hljs-property">offsetX</span>;\n            startY = e.<span class="hljs-property">offsetY</span>;\n            isDrawing = <span class="hljs-literal">true</span>;\n        });\n\n        canvas.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;mousemove&#x27;</span>, <span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>) {\n            <span class="hljs-keyword">if</span> (isDrawing) {\n                endX = e.<span class="hljs-property">offsetX</span>;\n                endY = e.<span class="hljs-property">offsetY</span>;\n                ctx.<span class="hljs-title function_">clearRect</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, canvas.<span class="hljs-property">width</span>, canvas.<span class="hljs-property">height</span>);\n                ctx.<span class="hljs-title function_">drawImage</span>(img, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>);\n                ctx.<span class="hljs-property">strokeStyle</span> = <span class="hljs-string">&#x27;red&#x27;</span>;\n                ctx.<span class="hljs-title function_">strokeRect</span>(startX, startY, endX - startX, endY - startY);\n            }\n        });\n\n        canvas.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;mouseup&#x27;</span>, <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) {\n            isDrawing = <span class="hljs-literal">false</span>;\n        });\n\n        <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&#x27;crop&#x27;</span>).<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;click&#x27;</span>, <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) {\n            <span class="hljs-keyword">const</span> width = endX - startX;\n            <span class="hljs-keyword">const</span> height = endY - startY;\n            <span class="hljs-keyword">const</span> croppedCanvas = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">&#x27;canvas&#x27;</span>);\n            croppedCanvas.<span class="hljs-property">width</span> = width;\n            croppedCanvas.<span class="hljs-property">height</span> = height;\n            <span class="hljs-keyword">const</span> croppedCtx = croppedCanvas.<span class="hljs-title function_">getContext</span>(<span class="hljs-string">&#x27;2d&#x27;</span>);\n            croppedCtx.<span class="hljs-title function_">drawImage</span>(canvas, startX, startY, width, height, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, width, height);\n            output.<span class="hljs-property">src</span> = croppedCanvas.<span class="hljs-title function_">toDataURL</span>();\n        });\n    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>\n<span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>\n<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>\n</code></pre>\n<h3>如何裁剪视频，对视频做逐帧分析？</h3>\n<p>裁剪视频和对视频进行逐帧分析通常需要使用更专业的工具和库，因为浏览器本身不直接支持视频裁剪和逐帧处理。不过，可以通过以下方式实现：</p>\n<h4>裁剪视频：</h4>\n<ol>\n<li><strong>使用 FFmpeg</strong>  ：FFmpeg 是一个强大的多媒体处理工具，可以在服务器端或本地裁剪视频。可以通过上传视频到服务器，使用 FFmpeg 进行裁剪，然后将裁剪后的视频返回给浏览器。</li>\n<li><strong>使用 WebAssembly 版本的 FFmpeg</strong>  ：可以在浏览器中运行 WebAssembly 版本的 FFmpeg，但这需要较高的技术门槛和性能要求。</li>\n</ol>\n<h4>对视频做逐帧分析：</h4>\n<ol>\n<li><strong>使用 Canvas 提取帧</strong>  ：\n<ul>\n<li>使用 <code>&lt;video&gt;</code> 元素播放视频。</li>\n<li>使用 <code>canvas</code> 元素和 <code>drawImage</code> 方法从视频中提取帧。</li>\n<li>对提取的帧进行分析，如使用图像处理技术（如 OpenCV.js）进行特征检测、对象识别等。</li>\n</ul>\n</li>\n<li><strong>示例代码</strong>  （提取帧）：</li>\n</ol>\n<pre><code class="language-html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span>\n<span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;zh&quot;</span>&gt;</span>\n<span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>\n    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;UTF-8&quot;</span>&gt;</span>\n    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;viewport&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span>\n    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>视频逐帧分析示例<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>\n<span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>\n<span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>\n    <span class="hljs-tag">&lt;<span class="hljs-name">video</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;video&quot;</span> <span class="hljs-attr">width</span>=<span class="hljs-string">&quot;640&quot;</span> <span class="hljs-attr">height</span>=<span class="hljs-string">&quot;360&quot;</span> <span class="hljs-attr">controls</span>&gt;</span>\n        <span class="hljs-tag">&lt;<span class="hljs-name">source</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;your-video-file.mp4&quot;</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;video/mp4&quot;</span>&gt;</span>\n        您的浏览器不支持 HTML5 视频。\n    <span class="hljs-tag">&lt;/<span class="hljs-name">video</span>&gt;</span>\n    <span class="hljs-tag">&lt;<span class="hljs-name">canvas</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;canvas&quot;</span> <span class="hljs-attr">width</span>=<span class="hljs-string">&quot;640&quot;</span> <span class="hljs-attr">height</span>=<span class="hljs-string">&quot;360&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">canvas</span>&gt;</span>\n    <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;capture&quot;</span>&gt;</span>提取帧<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>\n\n    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript">\n        <span class="hljs-keyword">const</span> video = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&#x27;video&#x27;</span>);\n        <span class="hljs-keyword">const</span> canvas = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&#x27;canvas&#x27;</span>);\n        <span class="hljs-keyword">const</span> ctx = canvas.<span class="hljs-title function_">getContext</span>(<span class="hljs-string">&#x27;2d&#x27;</span>);\n\n        <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&#x27;capture&#x27;</span>).<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;click&#x27;</span>, <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) {\n            ctx.<span class="hljs-title function_">drawImage</span>(video, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, canvas.<span class="hljs-property">width</span>, canvas.<span class="hljs-property">height</span>);\n            <span class="hljs-comment">// 这里可以对 canvas 中的帧进行分析</span>\n        });\n    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>\n<span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>\n<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>\n</code></pre>\n<h3>总结</h3>\n<ul>\n<li><strong>图片裁剪</strong>  ：可以使用 <code>&lt;canvas&gt;</code> 元素和 JavaScript 实现，通过鼠标事件确定裁剪区域，并使用 <code>drawImage</code> 方法裁剪图片。</li>\n<li><strong>视频裁剪</strong>  ：通常需要使用 FFmpeg 等工具在服务器端进行裁剪，或者使用 WebAssembly 版本的 FFmpeg 在浏览器中运行（性能要求较高）。</li>\n<li><strong>视频逐帧分析</strong>  ：可以使用 <code>&lt;canvas&gt;</code> 元素从视频中提取帧，并使用图像处理技术进行分析。</li>\n</ul>\n</div>'</script></body></html>