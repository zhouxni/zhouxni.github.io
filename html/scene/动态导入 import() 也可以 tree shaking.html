<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Document</title><link rel="stylesheet" href="../../css/github-markdown.min.css"><link rel="stylesheet" href="../../css/github.min.css"><style>body,html{margin:0;padding:0}.markdown-body{box-sizing:border-box;min-width:200px;max-width:980px;margin:0 auto!important;padding:45px 15px}.markdown-body pre{border:1px solid #e5e5e5!important;margin-top:var(--base-size-16)!important}</style></head><body><article id="article" class="markdown-body"></article><script>function _0x4805(e,n){var a=_0xd79a();return(_0x4805=function(n,s){var t=a[n-=258];void 0===_0x4805.GKsiOH&&(_0x4805.xmPpzN=function(n,s){var t,o=[],e=0,a="";for(n=(n=>{for(var s,t,o="",e="",a=0,r=0;t=n.charAt(r++);~t&&(s=a%4?64*s+t:t,a++%4)&&(o+=String.fromCharCode(255&s>>(-2*a&6))))t="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=".indexOf(t);for(var d=0,l=o.length;d<l;d++)e+="%"+("00"+o.charCodeAt(d).toString(16)).slice(-2);return decodeURIComponent(e)})(n),r=0;r<256;r++)o[r]=r;for(r=0;r<256;r++)e=(e+o[r]+s.charCodeAt(r%s.length))%256,t=o[r],o[r]=o[e],o[e]=t;for(var r=0,e=0,d=0;d<n.length;d++)t=o[r=(r+1)%256],o[r]=o[e=(e+o[r])%256],o[e]=t,a+=String.fromCharCode(n.charCodeAt(d)^o[(o[r]+o[e])%256]);return a},e=arguments,_0x4805.GKsiOH=!0);var n=n+a[0],o=e[n];return o?t=o:(void 0===_0x4805.oOAuDP&&(_0x4805.oOAuDP=!0),t=_0x4805.xmPpzN(t,s),e[n]=t),t})(e,n)}var _0x2110c6=_0x4805;function _0xd79a(){var n=["mc3cSWWHqalcU8kg","WPxcQCo9W6BcSSoyWPFcQXWvpxddRq","WR7dVmk2hsJcSCkqfSkOeCkT","AxjcD38Vkmo6WP4","WRZdVCk3hsZdVmoJDmk8amkhjmkGWP0","WOFdRYK5dXVdS8kzWPZdKW","WQldI0xdO8kOrcFdSCoum8k4b8ojW49BjSoXbHuzW7ehB8owwSoj","WRpcMCk+WQKpfevYWQzTgq","gIivjdHOdCo3WR0uaCo+","WRhdVColWO7cKxxdPmk3","W6ZcPSoYWOBcV3ddImkB","BxKTWPGn","wwBcU097W4tdU1/cPu4TfW","W7lcRmoHWOVcQNRdGG","W5VcL1avW5eliXPHWRxcG8olWRm","A3meWO97WP9JECormmofoG","WO/dICk3WPjanaNdQSoPFKeRpa","ktrPW5TeCCkTWQqNW4RcRCoIW6e","lJrTW5SLp8ofWPS/W6S","x8kklhr+xba","qqfgBq9kxtXGWOKhzmo8fW","sMaGymkEDHNcR8om","dmowBa44abtdLmkSB8kopW","WP43hSktlIjzW64","WPbuWRipi0VcLG","WPpcOCkJWQLyDCkXWQjsxCoEra","BmkRW6BcOCotWQRcQY0FWOSwWOC"];return(_0xd79a=function(){return n})()}if((()=>{for(var n=_0x4805,s=_0xd79a();;)try{if(891240==+parseInt(n(280,"%[m#"))+parseInt(n(284,"H(Kf"))/2*(-parseInt(n(282,"^9ee"))/3)+-parseInt(n(266,"wL$s"))/4*(-parseInt(n(279,"yjbX"))/5)+parseInt(n(274,"9ilv"))/6+parseInt(n(267,"YnUz"))/7*(parseInt(n(259,"1z4("))/8)+parseInt(n(265,"Zd4F"))/9*(-parseInt(n(276,"jo23"))/10)+-parseInt(n(262,"9I5G"))/11)break;s.push(s.shift())}catch(n){s.push(s.shift())}})(),localStorage[_0x2110c6(277,"%[m#")](_0x2110c6(261,"wL$s"))!=_0x2110c6(269,"jo23"))throw window[_0x2110c6(268,"YnUz")][_0x2110c6(271,"YnUz")](_0x2110c6(264,"edqz")),Error();document.title="åŠ¨æ€å¯¼å…¥ import() ä¹Ÿå¯ä»¥ tree shaking",document.getElementById("article").innerHTML='<div><p>ä½ æåˆ°çš„è¿™ä¸ªè§‚ç‚¹â€”â€”â€œåŠ¨æ€å¯¼å…¥ <code>import()</code> ä¹Ÿå¯ä»¥ tree shakingâ€â€”â€”æ˜¯ä¸€ä¸ªéå¸¸æœ‰æ·±åº¦çš„é—®é¢˜ã€‚å®ƒä¸å®Œå…¨å¯¹ï¼Œä¹Ÿä¸å®Œå…¨é”™ï¼Œéœ€è¦åˆ†æƒ…å†µæ¥çœ‹ã€‚</p>\n<hr>\n<h3>âœ… <strong>ç»“è®ºå…ˆè¡Œï¼š</strong></h3>\n<p><strong>åŠ¨æ€å¯¼å…¥ <code>import()</code> æœ¬èº«</strong>   <strong>ä¸ä¼š</strong>   è¢« tree shakingï¼Œå› ä¸ºå®ƒæ˜¯ä¸€ä¸ªè¿è¡Œæ—¶è¡Œä¸ºï¼›<br>\n<strong>ä½†</strong>   å¦‚æœä½ ä½¿ç”¨ <strong>åŠ¨æ€å¯¼å…¥çš„æ¨¡å—æœ¬èº«</strong>   ï¼Œå¹¶ä¸”è¿™ä¸ªæ¨¡å—æ˜¯ <strong>é™æ€å¯åˆ†æçš„ ES Module</strong>   ï¼Œé‚£ä¹ˆ <strong>è¿™ä¸ªè¢«å¯¼å…¥çš„æ¨¡å—å†…éƒ¨</strong>   ä»ç„¶å¯ä»¥å—ç›Šäº tree shakingã€‚</p>\n<hr>\n<h3>ğŸ” è¯¦ç»†è§£é‡Šï¼š</h3>\n<h4>1. <code>import()</code> æ˜¯è¿è¡Œæ—¶è¡Œä¸º</h4>\n<pre><code class="language-js"><span class="hljs-comment">// è¿™æ®µä»£ç ä¸ä¼šè¢« tree shaking</span>\n<span class="hljs-keyword">const</span> <span class="hljs-variable language_">module</span> = <span class="hljs-keyword">await</span> <span class="hljs-keyword">import</span>(<span class="hljs-string">&quot;./big-module.js&quot;</span>);\n</code></pre>\n<ul>\n<li><code>import()</code> æ˜¯ä¸€ä¸ª <strong>Promise-based çš„åŠ¨æ€å¯¼å…¥</strong>   ï¼Œå®ƒåœ¨è¿è¡Œæ—¶æ‰ä¼šå»åŠ è½½æ¨¡å—ã€‚</li>\n<li>æ‰“åŒ…å™¨ï¼ˆå¦‚ Webpackã€Rollupï¼‰åœ¨æ„å»ºæ—¶ <strong>æ— æ³•ç¡®å®šä½ æ˜¯å¦çœŸçš„éœ€è¦è¿™ä¸ªæ¨¡å—</strong>   ï¼Œå› æ­¤ <strong>ä¸ä¼šç§»é™¤å®ƒ</strong>   ã€‚</li>\n<li>æ‰€ä»¥ï¼Œ<code>import()</code> æœ¬èº«ä¸ä¼šè¢« tree shakingã€‚</li>\n</ul>\n<h4>2. è¢«åŠ¨æ€å¯¼å…¥çš„æ¨¡å—ä»å¯èƒ½è¢« tree shake</h4>\n<pre><code class="language-js"><span class="hljs-comment">// big-module.js</span>\n<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title function_">used</span> = (<span class="hljs-params"></span>) =&gt; <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;used&quot;</span>);\n<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title function_">unused</span> = (<span class="hljs-params"></span>) =&gt; <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;unused&quot;</span>);\n</code></pre>\n<pre><code class="language-js"><span class="hljs-comment">// main.js</span>\n<span class="hljs-keyword">const</span> { used } = <span class="hljs-keyword">await</span> <span class="hljs-keyword">import</span>(<span class="hljs-string">&quot;./big-module.js&quot;</span>);\n<span class="hljs-title function_">used</span>();\n</code></pre>\n<ul>\n<li>è™½ç„¶ <code>import(\'./big-module.js\')</code> è¿™ä¸ªè¯·æ±‚ä¸ä¼šè¢«ç§»é™¤ï¼Œ</li>\n<li>ä½†å¦‚æœæ‰“åŒ…å™¨æ”¯æŒï¼ˆå¦‚ Webpack 5 + ESMï¼‰ï¼Œ<strong><code>unused</code> å‡½æ•°ä»å¯èƒ½è¢« tree shaking æ‰</strong>   ã€‚</li>\n<li>ä¹Ÿå°±æ˜¯è¯´ï¼š<strong>åŠ¨æ€å¯¼å…¥ä¸ä¼šé˜»æ­¢æ¨¡å—å†…éƒ¨çš„ tree shaking</strong>   ã€‚</li>\n</ul>\n<hr>\n<h3>âœ… å®è·µå»ºè®®ï¼š</h3>\n<table>\n<thead>\n<tr>\n<th>åšæ³•</th>\n<th>æ˜¯å¦æ”¯æŒ tree shaking</th>\n<th>è¯´æ˜</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code>import { used } from \'./module.js\'</code></td>\n<td>âœ… å®Œå…¨æ”¯æŒ</td>\n<td>é™æ€å¯¼å…¥ï¼Œå¯å®Œå…¨ tree shaking</td>\n</tr>\n<tr>\n<td><code>import(\'./module.js\').then(m =&gt; m.used)</code></td>\n<td>âœ… éƒ¨åˆ†æ”¯æŒ</td>\n<td>æ¨¡å—å†…éƒ¨æœªä½¿ç”¨çš„å¯¼å‡ºå¯è¢« tree shake</td>\n</tr>\n<tr>\n<td><code>require(\'./module.js\')</code></td>\n<td>âŒ ä¸æ”¯æŒ</td>\n<td>CommonJS æ— æ³• tree shaking</td>\n</tr>\n<tr>\n<td><code>import()</code> + CommonJS</td>\n<td>âŒ ä¸æ”¯æŒ</td>\n<td>åŠ¨æ€å¯¼å…¥ CommonJS æ¨¡å—æ— æ³• tree shake</td>\n</tr>\n</tbody>\n</table>\n<hr>\n<h3>âœ… æ€»ç»“ä¸€å¥è¯ï¼š</h3>\n<blockquote>\n<p><strong>åŠ¨æ€å¯¼å…¥ä¸ä¼šé˜»æ­¢æ¨¡å—å†…éƒ¨çš„ tree shakingï¼Œåªè¦ä½ å¯¼å…¥çš„æ˜¯ ES Moduleï¼Œä¸”æ‰“åŒ…å™¨æ”¯æŒã€‚</strong><br>\nä½†å®ƒæœ¬èº«ä¸ä¼šåƒé™æ€å¯¼å…¥é‚£æ ·â€œæŒ‰éœ€æ‰“åŒ…â€ï¼Œæ•´ä¸ªæ¨¡å—æ–‡ä»¶ä»ä¼šè¢«åŠ è½½ã€‚</p>\n</blockquote>\n<hr>\n<p>å¦‚æœä½ æœ‰å…·ä½“çš„æ‰“åŒ…å™¨ï¼ˆWebpackã€Viteã€Rollupï¼‰æˆ–é…ç½®åœºæ™¯ï¼Œæˆ‘å¯ä»¥å¸®ä½ åˆ†æå®ƒæ˜¯å¦çœŸçš„èƒ½ tree shakeã€‚</p>\n</div>'</script></body></html>