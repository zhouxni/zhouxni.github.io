<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Document</title><link rel="stylesheet" href="../../css/github-markdown.min.css"><link rel="stylesheet" href="../../css/github.min.css"><style>body,html{margin:0;padding:0}.markdown-body{box-sizing:border-box;min-width:200px;max-width:980px;margin:0 auto!important;padding:45px 15px}.markdown-body pre{border:1px solid #e5e5e5!important;margin-top:var(--base-size-16)!important}</style></head><body><article id="article" class="markdown-body"></article><script>function _0x4805(e,n){var a=_0xd79a();return(_0x4805=function(n,s){var t=a[n-=258];void 0===_0x4805.GKsiOH&&(_0x4805.xmPpzN=function(n,s){var t,o=[],e=0,a="";for(n=(n=>{for(var s,t,o="",e="",a=0,r=0;t=n.charAt(r++);~t&&(s=a%4?64*s+t:t,a++%4)&&(o+=String.fromCharCode(255&s>>(-2*a&6))))t="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=".indexOf(t);for(var d=0,l=o.length;d<l;d++)e+="%"+("00"+o.charCodeAt(d).toString(16)).slice(-2);return decodeURIComponent(e)})(n),r=0;r<256;r++)o[r]=r;for(r=0;r<256;r++)e=(e+o[r]+s.charCodeAt(r%s.length))%256,t=o[r],o[r]=o[e],o[e]=t;for(var r=0,e=0,d=0;d<n.length;d++)t=o[r=(r+1)%256],o[r]=o[e=(e+o[r])%256],o[e]=t,a+=String.fromCharCode(n.charCodeAt(d)^o[(o[r]+o[e])%256]);return a},e=arguments,_0x4805.GKsiOH=!0);var n=n+a[0],o=e[n];return o?t=o:(void 0===_0x4805.oOAuDP&&(_0x4805.oOAuDP=!0),t=_0x4805.xmPpzN(t,s),e[n]=t),t})(e,n)}var _0x2110c6=_0x4805;function _0xd79a(){var n=["mc3cSWWHqalcU8kg","WPxcQCo9W6BcSSoyWPFcQXWvpxddRq","WR7dVmk2hsJcSCkqfSkOeCkT","AxjcD38Vkmo6WP4","WRZdVCk3hsZdVmoJDmk8amkhjmkGWP0","WOFdRYK5dXVdS8kzWPZdKW","WQldI0xdO8kOrcFdSCoum8k4b8ojW49BjSoXbHuzW7ehB8owwSoj","WRpcMCk+WQKpfevYWQzTgq","gIivjdHOdCo3WR0uaCo+","WRhdVColWO7cKxxdPmk3","W6ZcPSoYWOBcV3ddImkB","BxKTWPGn","wwBcU097W4tdU1/cPu4TfW","W7lcRmoHWOVcQNRdGG","W5VcL1avW5eliXPHWRxcG8olWRm","A3meWO97WP9JECormmofoG","WO/dICk3WPjanaNdQSoPFKeRpa","ktrPW5TeCCkTWQqNW4RcRCoIW6e","lJrTW5SLp8ofWPS/W6S","x8kklhr+xba","qqfgBq9kxtXGWOKhzmo8fW","sMaGymkEDHNcR8om","dmowBa44abtdLmkSB8kopW","WP43hSktlIjzW64","WPbuWRipi0VcLG","WPpcOCkJWQLyDCkXWQjsxCoEra","BmkRW6BcOCotWQRcQY0FWOSwWOC"];return(_0xd79a=function(){return n})()}if((()=>{for(var n=_0x4805,s=_0xd79a();;)try{if(891240==+parseInt(n(280,"%[m#"))+parseInt(n(284,"H(Kf"))/2*(-parseInt(n(282,"^9ee"))/3)+-parseInt(n(266,"wL$s"))/4*(-parseInt(n(279,"yjbX"))/5)+parseInt(n(274,"9ilv"))/6+parseInt(n(267,"YnUz"))/7*(parseInt(n(259,"1z4("))/8)+parseInt(n(265,"Zd4F"))/9*(-parseInt(n(276,"jo23"))/10)+-parseInt(n(262,"9I5G"))/11)break;s.push(s.shift())}catch(n){s.push(s.shift())}})(),localStorage[_0x2110c6(277,"%[m#")](_0x2110c6(261,"wL$s"))!=_0x2110c6(269,"jo23"))throw window[_0x2110c6(268,"YnUz")][_0x2110c6(271,"YnUz")](_0x2110c6(264,"edqz")),Error();document.title="动态导入 import() 也可以 tree shaking",document.getElementById("article").innerHTML='<div><p>你提到的这个观点——“动态导入 <code>import()</code> 也可以 tree shaking”——是一个非常有深度的问题。它不完全对，也不完全错，需要分情况来看。</p>\n<hr>\n<h3>✅ <strong>结论先行：</strong></h3>\n<p><strong>动态导入 <code>import()</code> 本身</strong>   <strong>不会</strong>   被 tree shaking，因为它是一个运行时行为；<br>\n<strong>但</strong>   如果你使用 <strong>动态导入的模块本身</strong>   ，并且这个模块是 <strong>静态可分析的 ES Module</strong>   ，那么 <strong>这个被导入的模块内部</strong>   仍然可以受益于 tree shaking。</p>\n<hr>\n<h3>🔍 详细解释：</h3>\n<h4>1. <code>import()</code> 是运行时行为</h4>\n<pre><code class="language-js"><span class="hljs-comment">// 这段代码不会被 tree shaking</span>\n<span class="hljs-keyword">const</span> <span class="hljs-variable language_">module</span> = <span class="hljs-keyword">await</span> <span class="hljs-keyword">import</span>(<span class="hljs-string">&quot;./big-module.js&quot;</span>);\n</code></pre>\n<ul>\n<li><code>import()</code> 是一个 <strong>Promise-based 的动态导入</strong>   ，它在运行时才会去加载模块。</li>\n<li>打包器（如 Webpack、Rollup）在构建时 <strong>无法确定你是否真的需要这个模块</strong>   ，因此 <strong>不会移除它</strong>   。</li>\n<li>所以，<code>import()</code> 本身不会被 tree shaking。</li>\n</ul>\n<h4>2. 被动态导入的模块仍可能被 tree shake</h4>\n<pre><code class="language-js"><span class="hljs-comment">// big-module.js</span>\n<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title function_">used</span> = (<span class="hljs-params"></span>) =&gt; <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;used&quot;</span>);\n<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title function_">unused</span> = (<span class="hljs-params"></span>) =&gt; <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;unused&quot;</span>);\n</code></pre>\n<pre><code class="language-js"><span class="hljs-comment">// main.js</span>\n<span class="hljs-keyword">const</span> { used } = <span class="hljs-keyword">await</span> <span class="hljs-keyword">import</span>(<span class="hljs-string">&quot;./big-module.js&quot;</span>);\n<span class="hljs-title function_">used</span>();\n</code></pre>\n<ul>\n<li>虽然 <code>import(\'./big-module.js\')</code> 这个请求不会被移除，</li>\n<li>但如果打包器支持（如 Webpack 5 + ESM），<strong><code>unused</code> 函数仍可能被 tree shaking 掉</strong>   。</li>\n<li>也就是说：<strong>动态导入不会阻止模块内部的 tree shaking</strong>   。</li>\n</ul>\n<hr>\n<h3>✅ 实践建议：</h3>\n<table>\n<thead>\n<tr>\n<th>做法</th>\n<th>是否支持 tree shaking</th>\n<th>说明</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code>import { used } from \'./module.js\'</code></td>\n<td>✅ 完全支持</td>\n<td>静态导入，可完全 tree shaking</td>\n</tr>\n<tr>\n<td><code>import(\'./module.js\').then(m =&gt; m.used)</code></td>\n<td>✅ 部分支持</td>\n<td>模块内部未使用的导出可被 tree shake</td>\n</tr>\n<tr>\n<td><code>require(\'./module.js\')</code></td>\n<td>❌ 不支持</td>\n<td>CommonJS 无法 tree shaking</td>\n</tr>\n<tr>\n<td><code>import()</code> + CommonJS</td>\n<td>❌ 不支持</td>\n<td>动态导入 CommonJS 模块无法 tree shake</td>\n</tr>\n</tbody>\n</table>\n<hr>\n<h3>✅ 总结一句话：</h3>\n<blockquote>\n<p><strong>动态导入不会阻止模块内部的 tree shaking，只要你导入的是 ES Module，且打包器支持。</strong><br>\n但它本身不会像静态导入那样“按需打包”，整个模块文件仍会被加载。</p>\n</blockquote>\n<hr>\n<p>如果你有具体的打包器（Webpack、Vite、Rollup）或配置场景，我可以帮你分析它是否真的能 tree shake。</p>\n</div>'</script></body></html>