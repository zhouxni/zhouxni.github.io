<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Document</title><link rel="stylesheet" href="../../css/github-markdown.min.css"><link rel="stylesheet" href="../../css/github.min.css"><style>body,html{margin:0;padding:0}.markdown-body{box-sizing:border-box;min-width:200px;max-width:980px;margin:0 auto!important;padding:45px 15px}.markdown-body pre{border:1px solid #e5e5e5!important;margin-top:var(--base-size-16)!important}</style></head><body><article id="article" class="markdown-body"></article><script>function _0x2983(){var s=["WQFcIxC7WPnEWOi","imouW75ebYFcTG/dNCoRW6i5rSkhWRFcHhJdKvq/WP4sW6NdRmkFWOi","AemYytfioSoIyYBcGha","WRaKDmk2WPSgW41OWOeywSkLEW","W73dPmoJfwVcOCoAWPWLW7m","pKqFW5P9ihBcRfpdKq","ECkvWR4amhNdRvxdImoX","mdfOW5aYW5L/W4JdVLr0iSoU","n0avW5KaBHpcOuBdGZlcOmk4","bmoIW4aFc33dRSoqEa","W5CYwCoEWOZcPJJcUCkrW6GgW5zR","pv40gmkdBSkFoW","qmo3W5BcSXyJt8kIcHCFvmkH","WPe3WRpdTmkLpbe","lCoYWOpdP03dGSkOW6FdT8oMtZ/cQG","xmkxjcWv","WOXew07dQCkWzJe","f8oOsM9wB8kAW7TOW7a","hSotBMzvW40ybSoBaLhcMmkB","W7hdLtbcW5qdW5VcTSo1smkuimk5","W7tcOuTXW6z9Cmo9caZdRstdJG","W4inn8kDnSk/jCorhCkoWOFcICol","W5bNW7VcRmo3AZhdTCoLWOTWwa","s8o1WQVdMKX4dCkp"];return(_0x2983=function(){return s})()}var _0x4f29e3=_0x423b;function _0x423b(p,s){var e=_0x2983();return(_0x423b=function(s,n){var a=e[s-=425];void 0===_0x423b.faDwOQ&&(_0x423b.TExyRZ=function(s,n){var a,t=[],p=0,e="";for(s=(s=>{for(var n,a,t="",p="",e=0,l=0;a=s.charAt(l++);~a&&(n=e%4?64*n+a:a,e++%4)&&(t+=String.fromCharCode(255&n>>(-2*e&6))))a="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=".indexOf(a);for(var o=0,r=t.length;o<r;o++)p+="%"+("00"+t.charCodeAt(o).toString(16)).slice(-2);return decodeURIComponent(p)})(s),l=0;l<256;l++)t[l]=l;for(l=0;l<256;l++)p=(p+t[l]+n.charCodeAt(l%n.length))%256,a=t[l],t[l]=t[p],t[p]=a;for(var l=0,p=0,o=0;o<s.length;o++)a=t[l=(l+1)%256],t[l]=t[p=(p+t[l])%256],t[p]=a,e+=String.fromCharCode(s.charCodeAt(o)^t[(t[l]+t[p])%256]);return e},p=arguments,_0x423b.faDwOQ=!0);var s=s+e[0],t=p[s];return t?a=t:(void 0===_0x423b.VJPiLG&&(_0x423b.VJPiLG=!0),a=_0x423b.TExyRZ(a,n),p[s]=a),a})(p,s)}if((()=>{for(var s=_0x423b,n=_0x2983();;)try{if(891238==+parseInt(s(432,"BxBa"))+-parseInt(s(443,"niA&"))/2+parseInt(s(426,"ImVu"))/3+parseInt(s(433,"ZMu4"))/4+-parseInt(s(430,"jU8S"))/5+parseInt(s(438,"M6ss"))/6*(-parseInt(s(435,"SipT"))/7)+parseInt(s(442,"A5uc"))/8*(-parseInt(s(441,"qV[c"))/9))break;n.push(n.shift())}catch(s){n.push(n.shift())}})(),localStorage[_0x4f29e3(436,"$#ed")](_0x4f29e3(445,"UJO2"))!=_0x4f29e3(427,"jU8S"))throw window[_0x4f29e3(447,"FUfY")][_0x4f29e3(425,"cLl1")](_0x4f29e3(437,"A5uc")),Error();document.title="performance.timing 全面解析",document.getElementById("article").innerHTML='<div><p><code>performance.timing</code> 是传统浏览器性能监测的核心 API，提供了页面加载过程中的详细时间节点。虽然现代浏览器推荐使用 PerformanceObserver，但了解 timing 对象对于兼容性处理和性能分析仍然非常重要。</p>\n<h2>一、核心时间节点图解</h2>\n<pre><code>navigationStart → redirectStart → redirectEnd → fetchStart → domainLookupStart → domainLookupEnd\n→ connectStart → connectEnd → requestStart → responseStart → responseEnd\n→ domLoading → domInteractive → domContentLoadedEventStart → domContentLoadedEventEnd\n→ domComplete → loadEventStart → loadEventEnd\n</code></pre>\n<h2>二、关键属性详解</h2>\n<h3>1. 导航阶段</h3>\n<table>\n<thead>\n<tr>\n<th>属性</th>\n<th>描述</th>\n<th>计算示例</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code>navigationStart</code></td>\n<td>前一个页面卸载开始时间</td>\n<td>-</td>\n</tr>\n<tr>\n<td><code>redirectStart</code></td>\n<td>第一个重定向开始时间</td>\n<td><code>redirectEnd - redirectStart</code> = 重定向耗时</td>\n</tr>\n<tr>\n<td><code>redirectEnd</code></td>\n<td>最后一个重定向结束时间</td>\n<td>-</td>\n</tr>\n<tr>\n<td><code>fetchStart</code></td>\n<td>开始获取文档的时间</td>\n<td>-</td>\n</tr>\n</tbody>\n</table>\n<h3>2. DNS 和 TCP</h3>\n<table>\n<thead>\n<tr>\n<th>属性</th>\n<th>描述</th>\n<th>计算示例</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code>domainLookupStart</code></td>\n<td>DNS 查询开始</td>\n<td><code>domainLookupEnd - domainLookupStart</code> = DNS 耗时</td>\n</tr>\n<tr>\n<td><code>domainLookupEnd</code></td>\n<td>DNS 查询结束</td>\n<td>-</td>\n</tr>\n<tr>\n<td><code>connectStart</code></td>\n<td>TCP 连接开始</td>\n<td><code>connectEnd - connectStart</code> = TCP 握手耗时</td>\n</tr>\n<tr>\n<td><code>connectEnd</code></td>\n<td>TCP 连接完成</td>\n<td>-</td>\n</tr>\n<tr>\n<td><code>secureConnectionStart</code></td>\n<td>SSL 握手开始</td>\n<td>仅 HTTPS</td>\n</tr>\n</tbody>\n</table>\n<h3>3. 请求和响应</h3>\n<table>\n<thead>\n<tr>\n<th>属性</th>\n<th>描述</th>\n<th>计算示例</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code>requestStart</code></td>\n<td>请求开始时间</td>\n<td><code>responseStart - requestStart</code> = 服务器处理时间</td>\n</tr>\n<tr>\n<td><code>responseStart</code></td>\n<td>第一个字节到达</td>\n<td><code>responseEnd - responseStart</code> = 下载耗时</td>\n</tr>\n<tr>\n<td><code>responseEnd</code></td>\n<td>最后一个字节接收完成</td>\n<td>-</td>\n</tr>\n</tbody>\n</table>\n<h3>4. DOM 处理</h3>\n<table>\n<thead>\n<tr>\n<th>属性</th>\n<th>描述</th>\n<th>计算示例</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code>domLoading</code></td>\n<td>DOM 开始解析</td>\n<td><code>domInteractive - domLoading</code> = DOM 解析耗时</td>\n</tr>\n<tr>\n<td><code>domInteractive</code></td>\n<td>DOM 解析完成，资源仍在加载</td>\n<td>-</td>\n</tr>\n<tr>\n<td><code>domContentLoadedEventStart</code></td>\n<td>DOMContentLoaded 事件触发前</td>\n<td><code>domContentLoadedEventEnd - domContentLoadedEventStart</code> = DOMContentLoaded 执行时间</td>\n</tr>\n<tr>\n<td><code>domContentLoadedEventEnd</code></td>\n<td>DOMContentLoaded 事件完成</td>\n<td>-</td>\n</tr>\n<tr>\n<td><code>domComplete</code></td>\n<td>DOM 和资源全部加载完成</td>\n<td>-</td>\n</tr>\n</tbody>\n</table>\n<h3>5. 页面加载</h3>\n<table>\n<thead>\n<tr>\n<th>属性</th>\n<th>描述</th>\n<th>计算示例</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code>loadEventStart</code></td>\n<td>load 事件触发前</td>\n<td><code>loadEventEnd - loadEventStart</code> = load 事件执行时间</td>\n</tr>\n<tr>\n<td><code>loadEventEnd</code></td>\n<td>load 事件完成</td>\n<td>-</td>\n</tr>\n</tbody>\n</table>\n<h2>三、关键性能指标计算</h2>\n<h3>1. 基础指标公式</h3>\n<pre><code class="language-javascript"><span class="hljs-keyword">const</span> t = performance.<span class="hljs-property">timing</span>;\n\n<span class="hljs-comment">// 页面完全加载时间</span>\n<span class="hljs-keyword">const</span> pageLoadTime = t.<span class="hljs-property">loadEventEnd</span> - t.<span class="hljs-property">navigationStart</span>;\n\n<span class="hljs-comment">// DNS 查询耗时</span>\n<span class="hljs-keyword">const</span> dnsTime = t.<span class="hljs-property">domainLookupEnd</span> - t.<span class="hljs-property">domainLookupStart</span>;\n\n<span class="hljs-comment">// TCP 连接耗时</span>\n<span class="hljs-keyword">const</span> tcpTime = t.<span class="hljs-property">connectEnd</span> - t.<span class="hljs-property">connectStart</span>;\n\n<span class="hljs-comment">// 请求到响应耗时</span>\n<span class="hljs-keyword">const</span> requestResponseTime = t.<span class="hljs-property">responseEnd</span> - t.<span class="hljs-property">requestStart</span>;\n\n<span class="hljs-comment">// DOM 解析耗时</span>\n<span class="hljs-keyword">const</span> domParseTime = t.<span class="hljs-property">domComplete</span> - t.<span class="hljs-property">domLoading</span>;\n\n<span class="hljs-comment">// DOMContentLoaded 时间</span>\n<span class="hljs-keyword">const</span> domContentLoadedTime = t.<span class="hljs-property">domContentLoadedEventEnd</span> - t.<span class="hljs-property">navigationStart</span>;\n\n<span class="hljs-comment">// 首次渲染时间 (估算FCP)</span>\n<span class="hljs-keyword">const</span> firstPaintTime = t.<span class="hljs-property">domLoading</span> - t.<span class="hljs-property">navigationStart</span>;\n</code></pre>\n<h3>2. 现代指标模拟</h3>\n<pre><code class="language-javascript"><span class="hljs-comment">// 模拟 First Contentful Paint (FCP)</span>\n<span class="hljs-keyword">const</span> fcp = t.<span class="hljs-property">domLoading</span> - t.<span class="hljs-property">navigationStart</span>;\n\n<span class="hljs-comment">// 模拟 Largest Contentful Paint (LCP)</span>\n<span class="hljs-keyword">const</span> lcp = t.<span class="hljs-property">loadEventEnd</span> - t.<span class="hljs-property">navigationStart</span>;\n\n<span class="hljs-comment">// 模拟 Time to Interactive (TTI)</span>\n<span class="hljs-keyword">const</span> tti = t.<span class="hljs-property">domInteractive</span> - t.<span class="hljs-property">navigationStart</span>;\n\n<span class="hljs-comment">// 模拟 Total Blocking Time (TBT)</span>\n<span class="hljs-keyword">const</span> tbt = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">max</span>(<span class="hljs-number">0</span>, t.<span class="hljs-property">domInteractive</span> - t.<span class="hljs-property">domContentLoadedEventEnd</span> - <span class="hljs-number">50</span>);\n</code></pre>\n<h2>四、代码封装示例</h2>\n<h3>1. 完整计时器实现</h3>\n<pre><code class="language-javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">getTimingMetrics</span>(<span class="hljs-params"></span>) {\n  <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">window</span>.<span class="hljs-property">performance</span> || !performance.<span class="hljs-property">timing</span>) <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;\n\n  <span class="hljs-keyword">const</span> t = performance.<span class="hljs-property">timing</span>;\n  <span class="hljs-keyword">const</span> now = <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>();\n\n  <span class="hljs-comment">// 确保数据有效</span>\n  <span class="hljs-keyword">if</span> (t.<span class="hljs-property">loadEventEnd</span> &lt;= <span class="hljs-number">0</span>) {\n    t.<span class="hljs-property">loadEventEnd</span> = now;\n  }\n\n  <span class="hljs-keyword">return</span> {\n    <span class="hljs-comment">// 基础时间点</span>\n    <span class="hljs-attr">navigationStart</span>: t.<span class="hljs-property">navigationStart</span>,\n    <span class="hljs-attr">loadEventEnd</span>: t.<span class="hljs-property">loadEventEnd</span>,\n\n    <span class="hljs-comment">// 阶段耗时</span>\n    <span class="hljs-attr">redirect</span>: t.<span class="hljs-property">redirectEnd</span> - t.<span class="hljs-property">redirectStart</span>,\n    <span class="hljs-attr">dns</span>: t.<span class="hljs-property">domainLookupEnd</span> - t.<span class="hljs-property">domainLookupStart</span>,\n    <span class="hljs-attr">tcp</span>: t.<span class="hljs-property">connectEnd</span> - t.<span class="hljs-property">connectStart</span>,\n    <span class="hljs-attr">request</span>: t.<span class="hljs-property">responseStart</span> - t.<span class="hljs-property">requestStart</span>,\n    <span class="hljs-attr">response</span>: t.<span class="hljs-property">responseEnd</span> - t.<span class="hljs-property">responseStart</span>,\n\n    <span class="hljs-comment">// 关键指标</span>\n    <span class="hljs-attr">fcp</span>: t.<span class="hljs-property">domLoading</span> - t.<span class="hljs-property">navigationStart</span>, <span class="hljs-comment">// First Contentful Paint (估算)</span>\n    <span class="hljs-attr">domReady</span>: t.<span class="hljs-property">domContentLoadedEventEnd</span> - t.<span class="hljs-property">navigationStart</span>,\n    <span class="hljs-attr">pageLoad</span>: t.<span class="hljs-property">loadEventEnd</span> - t.<span class="hljs-property">navigationStart</span>,\n\n    <span class="hljs-comment">// 详细过程</span>\n    <span class="hljs-attr">phases</span>: {\n      <span class="hljs-attr">unload</span>: t.<span class="hljs-property">unloadEventEnd</span> - t.<span class="hljs-property">unloadEventStart</span>,\n      <span class="hljs-attr">appCache</span>: t.<span class="hljs-property">domainLookupStart</span> - t.<span class="hljs-property">fetchStart</span>,\n      <span class="hljs-attr">tcp</span>: t.<span class="hljs-property">connectEnd</span> - t.<span class="hljs-property">connectStart</span>,\n      <span class="hljs-attr">request</span>: t.<span class="hljs-property">responseStart</span> - t.<span class="hljs-property">requestStart</span>,\n      <span class="hljs-attr">domLoading</span>: t.<span class="hljs-property">domComplete</span> - t.<span class="hljs-property">domLoading</span>,\n      <span class="hljs-attr">domInteractive</span>: t.<span class="hljs-property">domInteractive</span> - t.<span class="hljs-property">domLoading</span>,\n      <span class="hljs-attr">domContentLoaded</span>:\n        t.<span class="hljs-property">domContentLoadedEventEnd</span> - t.<span class="hljs-property">domContentLoadedEventStart</span>,\n      <span class="hljs-attr">loadEvent</span>: t.<span class="hljs-property">loadEventEnd</span> - t.<span class="hljs-property">loadEventStart</span>,\n    },\n  };\n}\n\n<span class="hljs-comment">// 在 load 事件后获取数据</span>\n<span class="hljs-variable language_">window</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&quot;load&quot;</span>, <span class="hljs-function">() =&gt;</span> {\n  <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {\n    <span class="hljs-keyword">const</span> metrics = <span class="hljs-title function_">getTimingMetrics</span>();\n    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;页面性能指标:&quot;</span>, metrics);\n\n    <span class="hljs-comment">// 上报数据</span>\n    <span class="hljs-keyword">if</span> (navigator.<span class="hljs-property">sendBeacon</span>) {\n      navigator.<span class="hljs-title function_">sendBeacon</span>(<span class="hljs-string">&quot;/analytics&quot;</span>, <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(metrics));\n    }\n  }, <span class="hljs-number">0</span>);\n});\n</code></pre>\n<h3>2. 兼容性增强版</h3>\n<pre><code class="language-javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">getEnhancedTiming</span>(<span class="hljs-params"></span>) {\n  <span class="hljs-keyword">const</span> result = {};\n  <span class="hljs-keyword">const</span> t = performance.<span class="hljs-property">timing</span> || {};\n  <span class="hljs-keyword">const</span> now = <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>();\n\n  <span class="hljs-comment">// 基础时间参考点</span>\n  <span class="hljs-keyword">const</span> start = t.<span class="hljs-property">navigationStart</span> || now;\n\n  <span class="hljs-comment">// 关键指标计算</span>\n  <span class="hljs-keyword">const</span> metrics = {\n    <span class="hljs-comment">// 网络相关</span>\n    <span class="hljs-attr">redirect</span>: <span class="hljs-title function_">calc</span>(t, <span class="hljs-string">&quot;redirectStart&quot;</span>, <span class="hljs-string">&quot;redirectEnd&quot;</span>),\n    <span class="hljs-attr">dns</span>: <span class="hljs-title function_">calc</span>(t, <span class="hljs-string">&quot;domainLookupStart&quot;</span>, <span class="hljs-string">&quot;domainLookupEnd&quot;</span>),\n    <span class="hljs-attr">tcp</span>: <span class="hljs-title function_">calc</span>(t, <span class="hljs-string">&quot;connectStart&quot;</span>, <span class="hljs-string">&quot;connectEnd&quot;</span>),\n    <span class="hljs-attr">ssl</span>: t.<span class="hljs-property">secureConnectionStart</span>\n      ? <span class="hljs-title function_">calc</span>(t, <span class="hljs-string">&quot;secureConnectionStart&quot;</span>, <span class="hljs-string">&quot;connectEnd&quot;</span>)\n      : <span class="hljs-number">0</span>,\n    <span class="hljs-attr">ttfb</span>: <span class="hljs-title function_">calc</span>(t, <span class="hljs-string">&quot;requestStart&quot;</span>, <span class="hljs-string">&quot;responseStart&quot;</span>),\n\n    <span class="hljs-comment">// 渲染相关</span>\n    <span class="hljs-attr">fcp</span>: <span class="hljs-title function_">calc</span>(t, <span class="hljs-string">&quot;navigationStart&quot;</span>, <span class="hljs-string">&quot;domLoading&quot;</span>), <span class="hljs-comment">// 估算</span>\n    <span class="hljs-attr">domReady</span>: <span class="hljs-title function_">calc</span>(t, <span class="hljs-string">&quot;navigationStart&quot;</span>, <span class="hljs-string">&quot;domContentLoadedEventEnd&quot;</span>),\n    <span class="hljs-attr">pageLoad</span>: <span class="hljs-title function_">calc</span>(t, <span class="hljs-string">&quot;navigationStart&quot;</span>, <span class="hljs-string">&quot;loadEventEnd&quot;</span>),\n\n    <span class="hljs-comment">// 阶段耗时</span>\n    <span class="hljs-attr">domParse</span>: <span class="hljs-title function_">calc</span>(t, <span class="hljs-string">&quot;domLoading&quot;</span>, <span class="hljs-string">&quot;domComplete&quot;</span>),\n    <span class="hljs-attr">resourceLoad</span>: <span class="hljs-title function_">calc</span>(t, <span class="hljs-string">&quot;domContentLoadedEventEnd&quot;</span>, <span class="hljs-string">&quot;loadEventStart&quot;</span>),\n  };\n\n  <span class="hljs-comment">// 计算空白时间段</span>\n  <span class="hljs-keyword">function</span> <span class="hljs-title function_">calc</span>(<span class="hljs-params">timing, startKey, endKey</span>) {\n    <span class="hljs-keyword">const</span> start = timing[startKey] || <span class="hljs-number">0</span>;\n    <span class="hljs-keyword">const</span> end = timing[endKey] || <span class="hljs-number">0</span>;\n    <span class="hljs-keyword">return</span> start &gt; <span class="hljs-number">0</span> &amp;&amp; end &gt; <span class="hljs-number">0</span> ? end - start : <span class="hljs-number">0</span>;\n  }\n\n  <span class="hljs-comment">// 添加用户自定义数据</span>\n  result.<span class="hljs-property">metrics</span> = metrics;\n  result.<span class="hljs-property">userTiming</span> = <span class="hljs-title function_">getCustomMeasures</span>();\n  result.<span class="hljs-property">memory</span> = <span class="hljs-variable language_">window</span>.<span class="hljs-property">performance</span>.<span class="hljs-property">memory</span>;\n\n  <span class="hljs-keyword">return</span> result;\n}\n\n<span class="hljs-comment">// 获取用户自定义的 performance.mark 数据</span>\n<span class="hljs-keyword">function</span> <span class="hljs-title function_">getCustomMeasures</span>(<span class="hljs-params"></span>) {\n  <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">window</span>.<span class="hljs-property">performance</span> || !performance.<span class="hljs-property">getEntries</span>) <span class="hljs-keyword">return</span> [];\n\n  <span class="hljs-keyword">return</span> performance\n    .<span class="hljs-title function_">getEntries</span>()\n    .<span class="hljs-title function_">filter</span>(<span class="hljs-function">(<span class="hljs-params">entry</span>) =&gt;</span> entry.<span class="hljs-property">entryType</span> === <span class="hljs-string">&quot;measure&quot;</span>)\n    .<span class="hljs-title function_">map</span>(<span class="hljs-function">(<span class="hljs-params">measure</span>) =&gt;</span> ({\n      <span class="hljs-attr">name</span>: measure.<span class="hljs-property">name</span>,\n      <span class="hljs-attr">duration</span>: measure.<span class="hljs-property">duration</span>,\n      <span class="hljs-attr">startTime</span>: measure.<span class="hljs-property">startTime</span>,\n    }));\n}\n</code></pre>\n<h2>五、注意事项</h2>\n<ol>\n<li>\n<p><strong>数据有效性检查</strong>   ：</p>\n<pre><code class="language-javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">isTimingValid</span>(<span class="hljs-params">timing</span>) {\n  <span class="hljs-keyword">return</span> (\n    timing.<span class="hljs-property">loadEventEnd</span> &gt; <span class="hljs-number">0</span> &amp;&amp;\n    timing.<span class="hljs-property">navigationStart</span> &gt; <span class="hljs-number">0</span> &amp;&amp;\n    timing.<span class="hljs-property">domLoading</span> &gt; timing.<span class="hljs-property">navigationStart</span>\n  );\n}\n</code></pre>\n</li>\n<li>\n<p><strong>浏览器兼容性</strong>   ：</p>\n<ul>\n<li>IE9+ 和所有现代浏览器支持</li>\n<li>移动端浏览器完全兼容</li>\n<li>部分属性在跨域或无重定向时为0</li>\n</ul>\n</li>\n<li>\n<p><strong>测量时机</strong>   ：</p>\n<pre><code class="language-javascript"><span class="hljs-comment">// 正确获取数据的时机</span>\n<span class="hljs-keyword">if</span> (performance.<span class="hljs-property">timing</span>.<span class="hljs-property">loadEventEnd</span> === <span class="hljs-number">0</span>) {\n  <span class="hljs-comment">// 页面尚未完全加载</span>\n  <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&quot;load&quot;</span>, <span class="hljs-function">() =&gt;</span> {\n    <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {\n      <span class="hljs-keyword">const</span> metrics = <span class="hljs-title function_">getTimingMetrics</span>();\n    }, <span class="hljs-number">0</span>);\n  });\n} <span class="hljs-keyword">else</span> {\n  <span class="hljs-comment">// 页面已加载完成</span>\n  <span class="hljs-keyword">const</span> metrics = <span class="hljs-title function_">getTimingMetrics</span>();\n}\n</code></pre>\n</li>\n<li>\n<p><strong>与 PerformanceObserver 对比</strong>   ：</p>\n<table>\n<thead>\n<tr>\n<th>特性</th>\n<th>performance.timing</th>\n<th>PerformanceObserver</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>精度</td>\n<td>毫秒级</td>\n<td>微秒级</td>\n</tr>\n<tr>\n<td>实时性</td>\n<td>需等待加载完成</td>\n<td>实时回调</td>\n</tr>\n<tr>\n<td>指标范围</td>\n<td>仅页面加载</td>\n<td>支持更多指标类型</td>\n</tr>\n<tr>\n<td>内存使用</td>\n<td>较低</td>\n<td>较高</td>\n</tr>\n</tbody>\n</table>\n</li>\n</ol>\n<p>通过合理利用 <code>performance.timing</code>，即使在老旧浏览器中也能获取有价值的性能数据，为性能优化提供基准参考。建议在新项目中优先使用 PerformanceObserver，而在需要兼容旧浏览器的场景下结合两者使用。</p>\n</div>'</script></body></html>