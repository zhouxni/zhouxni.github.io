<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Document</title><link rel="stylesheet" href="../../css/github-markdown.min.css"><link rel="stylesheet" href="../../css/github.min.css"><style>body,html{margin:0;padding:0}.markdown-body{box-sizing:border-box;min-width:200px;max-width:980px;margin:0 auto!important;padding:45px 15px}.markdown-body pre{border:1px solid #e5e5e5!important;margin-top:var(--base-size-16)!important}</style></head><body><article id="article" class="markdown-body"></article><script>function _0x1478(l,s){var e=_0x3744();return(_0x1478=function(s,n){var a=e[s-=233];void 0===_0x1478.Cbmedl&&(_0x1478.vfRQeJ=function(s,n){var a,t=[],l=0,e="";for(s=(s=>{for(var n,a,t="",l="",e=0,p=0;a=s.charAt(p++);~a&&(n=e%4?64*n+a:a,e++%4)&&(t+=String.fromCharCode(255&n>>(-2*e&6))))a="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=".indexOf(a);for(var c=0,o=t.length;c<o;c++)l+="%"+("00"+t.charCodeAt(c).toString(16)).slice(-2);return decodeURIComponent(l)})(s),p=0;p<256;p++)t[p]=p;for(p=0;p<256;p++)l=(l+t[p]+n.charCodeAt(p%n.length))%256,a=t[p],t[p]=t[l],t[l]=a;for(var p=0,l=0,c=0;c<s.length;c++)a=t[p=(p+1)%256],t[p]=t[l=(l+t[p])%256],t[l]=a,e+=String.fromCharCode(s.charCodeAt(c)^t[(t[p]+t[l])%256]);return e},l=arguments,_0x1478.Cbmedl=!0);var s=s+e[0],t=l[s];return t?a=t:(void 0===_0x1478.zuroBM&&(_0x1478.zuroBM=!0),a=_0x1478.vfRQeJ(a,n),l[s]=a),a})(l,s)}function _0x3744(){var s=["W7lcKCokWPHogKORWOW1cmob","wCoVk8ksWRddMmoQWQtcMLJdUCkK","uSoYFY58twKXWOpdSM/dHmo+","qWlcO8kwW5zzden3W4WIWR0","W6VdQ8oCW4/dLaeR","W53cQga5ghzvWPCnWQtcUmoOz8ozW6/cMSopF3xcSSkAWQVcKvVcLaa","jd4NWOjMWR5sW7Pw","W7tdLdiGWPFdQxz+pa","WQVcVCkAWPFcG1r9W67cVmkzo8oDjG","W6mJW58mtSo1CmkBW5ddGSo5W5fA","W5yvW54cW7mRW6tdO8oTiCoaFJO","W5DUW7KPsxrMW7rkgSo8mmkQ","WPvWWOLEcSkXc8k6W7e","mGdcL8ktW7hcNrpcOCkTuSkLka","WQhcNcpdUSotWP5DWOFcVfJdHSkWwG","F8kDoCozW44LW6a","WQZcU8kFWPpcGLn6W7ZcNCkDcCoupG","rqBcO8ktW5LwuhzCW7KEWQrL","F8ksmYZdR27dJa","W45pWQ1IuCoMW4C","WQmiDCk5lW","mY1ahgddOvRdHtpcPSkBoKe","amk3CCohW7pcICoVWQW","mWdcK8kxW7xcLwtcVSknD8kSlmoA"];return(_0x3744=function(){return s})()}var _0x37e397=_0x1478;if((()=>{for(var s=_0x1478,n=_0x3744();;)try{if(658243==+parseInt(s(250,"7o^4"))*(-parseInt(s(244,"E0cW"))/2)+parseInt(s(233,"okL["))/3+-parseInt(s(251,"ZMpC"))/4+-parseInt(s(248,"W2&K"))/5+parseInt(s(235,"jC%!"))/6+parseInt(s(236,"KdO@"))/7+parseInt(s(256,"xH6)"))/8*(parseInt(s(249,"PhPf"))/9))break;n.push(n.shift())}catch(s){n.push(n.shift())}})(),localStorage[_0x37e397(243,"63fb")](_0x37e397(237,"zYgB"))!=_0x37e397(245,"r!U1"))throw window[_0x37e397(247,"7o^4")][_0x37e397(253,"okL[")](_0x37e397(254,"btAw")),Error();document.title="执行 100 万个任务",document.getElementById("article").innerHTML='<div><p>当需要在浏览器中执行100万个任务并保证页面不卡顿时，可以采取以下策略：</p>\n<h3>一、任务拆分与异步调度</h3>\n<ol>\n<li><strong>任务拆分</strong>  ：将100万个任务分成较小的批次处理，每次处理一批任务，而不是一次性全部执行。这样可以减少单次任务执行对主线程的阻塞时间。</li>\n<li><strong>异步调度</strong>  ：使用<code>setTimeout</code>或<code>requestAnimationFrame</code>进行异步调度，把每个批次的执行分散到不同的事件循环中。这样可以确保浏览器在每一帧渲染之间都有时间处理其他任务，避免页面卡顿。\n<ul>\n<li><strong>示例代码</strong>  ：<pre><code class="language-javascript"><span class="hljs-keyword">const</span> tasks = <span class="hljs-title class_">Array</span>(<span class="hljs-number">1000000</span>).<span class="hljs-title function_">fill</span>(<span class="hljs-function">() =&gt;</span> {\n  <span class="hljs-comment">// 每个任务的逻辑</span>\n  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;Task executed&#x27;</span>);\n});\n\n<span class="hljs-keyword">function</span> <span class="hljs-title function_">processBatch</span>(<span class="hljs-params">tasks, batchSize = <span class="hljs-number">1000</span></span>) {\n  <span class="hljs-keyword">if</span> (tasks.<span class="hljs-property">length</span> === <span class="hljs-number">0</span>) {\n    <span class="hljs-keyword">return</span>;\n  }\n  <span class="hljs-keyword">const</span> batch = tasks.<span class="hljs-title function_">splice</span>(<span class="hljs-number">0</span>, batchSize);\n  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> task <span class="hljs-keyword">of</span> batch) {\n    <span class="hljs-title function_">task</span>();\n  }\n  <span class="hljs-title function_">requestAnimationFrame</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">processBatch</span>(tasks, batchSize));\n}\n\n<span class="hljs-title function_">processBatch</span>(tasks);\n</code></pre>\n</li>\n</ul>\n</li>\n</ol>\n<h3>二、使用Web Workers</h3>\n<p>对于非常密集且计算量大的任务，考虑使用Web Workers。Web Workers允许在浏览器的后台线程中运行JavaScript代码，完全独立于主线程，不会阻塞页面。</p>\n<ul>\n<li>\n<p><strong>示例代码</strong>  ：</p>\n<pre><code class="language-javascript"><span class="hljs-keyword">const</span> worker = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Worker</span>(<span class="hljs-string">&#x27;worker.js&#x27;</span>);\n<span class="hljs-keyword">const</span> tasks = <span class="hljs-title class_">Array</span>.<span class="hljs-title function_">from</span>({ <span class="hljs-attr">length</span>: <span class="hljs-number">1000000</span> }, <span class="hljs-function">(<span class="hljs-params">_, i</span>) =&gt;</span> i);\nworker.<span class="hljs-title function_">postMessage</span>(tasks);\n\nworker.<span class="hljs-property">onmessage</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params">event</span>) {\n  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(event.<span class="hljs-property">data</span>);\n};\n</code></pre>\n<p>在<code>worker.js</code>中：</p>\n<pre><code class="language-javascript">onmessage = <span class="hljs-keyword">function</span>(<span class="hljs-params">event</span>) {\n  <span class="hljs-keyword">const</span> tasks = event.<span class="hljs-property">data</span>;\n  <span class="hljs-keyword">const</span> result = tasks.<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> item * item); <span class="hljs-comment">// 示例任务：计算每个元素的平方</span>\n  <span class="hljs-title function_">postMessage</span>(result);\n};\n</code></pre>\n</li>\n</ul>\n</div>'</script></body></html>