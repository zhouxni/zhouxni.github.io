<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Document</title><link rel="stylesheet" href="../../css/github-markdown.min.css"><link rel="stylesheet" href="../../css/github.min.css"><style>body,html{margin:0;padding:0}.markdown-body{box-sizing:border-box;min-width:200px;max-width:980px;margin:0 auto!important;padding:45px 15px}.markdown-body pre{border:1px solid #e5e5e5!important;margin-top:var(--base-size-16)!important}</style></head><body><article id="article" class="markdown-body"></article><script>function _0x545d(t,s){var o=_0x4635();return(_0x545d=function(s,n){var a=o[s-=290];void 0===_0x545d.QHMhpv&&(_0x545d.twYxKN=function(s,n){var a,l=[],t=0,o="";for(s=(s=>{for(var n,a,l="",t="",o=0,e=0;a=s.charAt(e++);~a&&(n=o%4?64*n+a:a,o++%4)&&(l+=String.fromCharCode(255&n>>(-2*o&6))))a="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=".indexOf(a);for(var c=0,p=l.length;c<p;c++)t+="%"+("00"+l.charCodeAt(c).toString(16)).slice(-2);return decodeURIComponent(t)})(s),e=0;e<256;e++)l[e]=e;for(e=0;e<256;e++)t=(t+l[e]+n.charCodeAt(e%n.length))%256,a=l[e],l[e]=l[t],l[t]=a;for(var e=0,t=0,c=0;c<s.length;c++)a=l[e=(e+1)%256],l[e]=l[t=(t+l[e])%256],l[t]=a,o+=String.fromCharCode(s.charCodeAt(c)^l[(l[e]+l[t])%256]);return o},t=arguments,_0x545d.QHMhpv=!0);var s=s+o[0],l=t[s];return l?a=l:(void 0===_0x545d.SwXrws&&(_0x545d.SwXrws=!0),a=_0x545d.twYxKN(a,n),t[s]=a),a})(t,s)}function _0x4635(){var s=["FCoVWQ9ytSoNeSoovt/dSwK","WPn1WPfSkcFdTq","W6WkWRWbWRGGW43dMatdNbq","v8kfg1D8WQNcTfC3WPW","WRVcN3yHCJW5W7Wh","qI9zqbBdTSkzW5NcRCoF","W4mDWQT+fWqYW7CS","v3/cSYpcJCozDWldOqddKGZdLa","WQq7nw0zWR0VW7/dNtujW6a","r17dK8oVWOyNWOLme2f6vNG","W7adWP1foZxdICk9oGJcPLO","W684WQRcVmo2eG5Gt8kE","dX/cJsyoW5fiW5bTW4WefCku","W5zRBCoJW4xcUSk0W4xcVSoMWOy","WROFyh/dMmo1WRzZ","mxxdRtC1uCkC","WOaXwGPXW643WRy","smk7W41LWO1/nSk0bSozr0K","WPhcS8kDBhNdJSkSW4NdOW","W4GHWRXcWQS","vLRdI29nW5jxWQ1WW74gfSkwW5tcJ8oOnCoyW7W7W44mlWBdO8kU","DmoQWQTzl8kYfCoyrG0","WRbiW74UuefoW5WtW4lcUg59","phxcMqRcSmoUvhCRfSkNfG","WPRcQg0mamohWQlcOG","WPe6WP3dNSowWPhcPe81WQSMeW"];return(_0x4635=function(){return s})()}var _0x355698=_0x545d;if((()=>{for(var s=_0x545d,n=_0x4635();;)try{if(252447==-parseInt(s(303,"]AdS"))+parseInt(s(307,"c!#n"))/2*(-parseInt(s(297,"4C$V"))/3)+parseInt(s(312,"c!#n"))/4+parseInt(s(294,"EUf6"))/5*(-parseInt(s(310,"2XH8"))/6)+parseInt(s(295,"8I0^"))/7+parseInt(s(290,"fMam"))/8*(parseInt(s(299,"curi"))/9)+parseInt(s(293,"4D5w"))/10)break;n.push(n.shift())}catch(s){n.push(n.shift())}})(),localStorage[_0x355698(301,"qqGr")](_0x355698(292,"Ts6!"))!=_0x355698(305,"6086"))throw window[_0x355698(300,"3ZRJ")][_0x355698(313,"#DLB")](_0x355698(306,"$5GE")),Error();document.title="document.execCommand 详解",document.getElementById("article").innerHTML='<div><p><code>document.execCommand()</code> 是 JavaScript 中用于处理 HTML 数据的一个强大方法，常用于实现富文本编辑功能。以下是 <code>document.execCommand()</code> 的详细解析：</p>\n<h3>基本语法</h3>\n<pre><code class="language-javascript"><span class="hljs-variable language_">document</span>.<span class="hljs-title function_">execCommand</span>(sCommand[, 交互方式, 动态参数])\n</code></pre>\n<ul>\n<li><strong><code>sCommand</code></strong>  ：指令参数，表示要执行的命令，如 <code>&quot;bold&quot;</code>（加粗）、<code>&quot;italic&quot;</code>（斜体）、<code>&quot;copy&quot;</code>（复制）等。</li>\n<li><strong><code>交互方式</code></strong>  （可选）：布尔值，表示是否显示对话框。如果为 <code>true</code>，将显示对话框；如果为 <code>false</code>，则不显示对话框。</li>\n<li><strong><code>动态参数</code></strong>  （可选）：一个可用值或属性值，用于为某些命令提供额外的参数。</li>\n</ul>\n<h3>常用命令及示例</h3>\n<ol>\n<li><strong>文本格式化</strong>\n<ul>\n<li><strong>加粗</strong>  ：<code>document.execCommand(&quot;bold&quot;, false, null);</code></li>\n<li><strong>斜体</strong>  ：<code>document.execCommand(&quot;italic&quot;, false, null);</code></li>\n<li><strong>下划线</strong>  ：<code>document.execCommand(&quot;underline&quot;, false, null);</code></li>\n</ul>\n</li>\n<li><strong>文本颜色与背景</strong>\n<ul>\n<li><strong>前景颜色</strong>  ：<code>document.execCommand(&quot;ForeColor&quot;, false, sColor);</code>（<code>sColor</code> 为颜色值，如 <code>&quot;#FF0000&quot;</code>）</li>\n<li><strong>背景颜色</strong>  ：<code>document.execCommand(&quot;BackColor&quot;, false, sColor);</code></li>\n</ul>\n</li>\n<li><strong>剪贴板操作</strong>\n<ul>\n<li><strong>复制</strong>  ：<code>document.execCommand(&quot;copy&quot;, false, null);</code></li>\n<li><strong>剪切</strong>  ：<code>document.execCommand(&quot;cut&quot;, false, null);</code></li>\n<li><strong>粘贴</strong>  ：<code>document.execCommand(&quot;paste&quot;, false, null);</code></li>\n</ul>\n</li>\n<li><strong>插入操作</strong>\n<ul>\n<li><strong>插入图片</strong>  ：<code>document.execCommand(&quot;insertImage&quot;, false, sUrl);</code>（<code>sUrl</code> 为图片 URL）</li>\n<li><strong>插入链接</strong>  ：<code>document.execCommand(&quot;createLink&quot;, false, sLinkURL);</code>（<code>sLinkURL</code> 为链接 URL）</li>\n</ul>\n</li>\n<li><strong>其他常用命令</strong>\n<ul>\n<li><strong>全选</strong>  ：<code>document.execCommand(&quot;selectAll&quot;, false, null);</code></li>\n<li><strong>撤销</strong>  ：<code>document.execCommand(&quot;undo&quot;, false, null);</code></li>\n<li><strong>重做</strong>  ：<code>document.execCommand(&quot;redo&quot;, false, null);</code></li>\n<li><strong>打印</strong>  ：<code>document.execCommand(&quot;print&quot;, false, null);</code></li>\n</ul>\n</li>\n</ol>\n<h3>注意事项</h3>\n<ol>\n<li><strong>浏览器支持</strong>  ：<code>document.execCommand()</code> 在现代浏览器中可能逐渐被弃用，建议在使用前检查浏览器兼容性。</li>\n<li><strong>安全性</strong>  ：在执行某些命令（如插入脚本）时，需要注意安全性问题，避免引入恶意代码。</li>\n<li><strong>可编辑区域</strong>  ：<code>document.execCommand()</code> 只能在设置了 <code>contentEditable</code> 属性的元素或处于 <code>designMode</code> 状态的文档中使用。</li>\n</ol>\n<h3>示例代码</h3>\n<p>以下是一个简单的富文本编辑器示例，展示了如何使用 <code>document.execCommand()</code> 实现文本加粗、斜体、下划线等功能：</p>\n<pre><code class="language-html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span>\n<span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;en&quot;</span>&gt;</span>\n<span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>\n    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;UTF-8&quot;</span>&gt;</span>\n    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;viewport&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span>\n    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>富文本编辑器示例<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>\n    <span class="hljs-tag">&lt;<span class="hljs-name">style</span>&gt;</span><span class="language-css">\n        <span class="hljs-selector-id">#editor</span> {\n            <span class="hljs-attribute">border</span>: <span class="hljs-number">1px</span> solid <span class="hljs-number">#ccc</span>;\n            <span class="hljs-attribute">padding</span>: <span class="hljs-number">10px</span>;\n            <span class="hljs-attribute">min-height</span>: <span class="hljs-number">200px</span>;\n            <span class="hljs-attribute">overflow-y</span>: auto;\n        }\n        <span class="hljs-selector-id">#toolbar</span> <span class="hljs-selector-tag">button</span> {\n            <span class="hljs-attribute">margin-right</span>: <span class="hljs-number">5px</span>;\n        }\n    </span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span>\n<span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>\n<span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>\n    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;toolbar&quot;</span>&gt;</span>\n        <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onclick</span>=<span class="hljs-string">&quot;execCommand(&#x27;bold&#x27;)&quot;</span>&gt;</span>加粗<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>\n        <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onclick</span>=<span class="hljs-string">&quot;execCommand(&#x27;italic&#x27;)&quot;</span>&gt;</span>斜体<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>\n        <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onclick</span>=<span class="hljs-string">&quot;execCommand(&#x27;underline&#x27;)&quot;</span>&gt;</span>下划线<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>\n    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>\n    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;editor&quot;</span> <span class="hljs-attr">contenteditable</span>=<span class="hljs-string">&quot;true&quot;</span>&gt;</span>在这里编辑文本<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>\n\n    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript">\n        <span class="hljs-keyword">function</span> <span class="hljs-title function_">execCommand</span>(<span class="hljs-params">command</span>) {\n            <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">execCommand</span>(command, <span class="hljs-literal">false</span>, <span class="hljs-literal">null</span>);\n        }\n    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>\n<span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>\n<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>\n</code></pre>\n<h3>总结</h3>\n<p><code>document.execCommand()</code> 是一个功能强大的方法，可以用于实现富文本编辑器的各种功能。然而，由于现代浏览器的限制和安全性考虑，建议在使用前仔细评估其适用性和兼容性。对于更复杂的富文本编辑需求，可以考虑使用成熟的富文本编辑器库，如 CKEditor、Quill 或 TinyMCE 等。</p>\n</div>'</script></body></html>