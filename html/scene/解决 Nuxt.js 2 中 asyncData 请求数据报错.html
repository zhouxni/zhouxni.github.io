<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Document</title><link rel="stylesheet" href="../../css/github-markdown.min.css"><link rel="stylesheet" href="../../css/github.min.css"><style>body,html{margin:0;padding:0}.markdown-body{box-sizing:border-box;min-width:200px;max-width:980px;margin:0 auto!important;padding:45px 15px}.markdown-body pre{border:1px solid #e5e5e5!important;margin-top:var(--base-size-16)!important}</style></head><body><article id="article" class="markdown-body"></article><script>var _0x1c7938=_0x35fe;function _0x35fe(l,s){var r=_0x467b();return(_0x35fe=function(s,a){var n=r[s-=367];void 0===_0x35fe.LVzEol&&(_0x35fe.oVFkMz=function(s,a){var n,p=[],l=0,r="";for(s=(s=>{for(var a,n,p="",l="",r=0,e=0;n=s.charAt(e++);~n&&(a=r%4?64*a+n:n,r++%4)&&(p+=String.fromCharCode(255&a>>(-2*r&6))))n="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=".indexOf(n);for(var t=0,c=p.length;t<c;t++)l+="%"+("00"+p.charCodeAt(t).toString(16)).slice(-2);return decodeURIComponent(l)})(s),e=0;e<256;e++)p[e]=e;for(e=0;e<256;e++)l=(l+p[e]+a.charCodeAt(e%a.length))%256,n=p[e],p[e]=p[l],p[l]=n;for(var e=0,l=0,t=0;t<s.length;t++)n=p[e=(e+1)%256],p[e]=p[l=(l+p[e])%256],p[l]=n,r+=String.fromCharCode(s.charCodeAt(t)^p[(p[e]+p[l])%256]);return r},l=arguments,_0x35fe.LVzEol=!0);var s=s+r[0],p=l[s];return p?n=p:(void 0===_0x35fe.ZXgQnL&&(_0x35fe.ZXgQnL=!0),n=_0x35fe.oVFkMz(n,a),l[s]=n),n})(l,s)}function _0x467b(){var s=["WQFdQCkSbZtdTmo4Emk+vw4zjq","WR3dS8ocW6rvv8oQW7qb","u0VcHCkFWPZcQCkTCNpcTSoOwa","hmoRxSksWO4YW4XzWPu","W4fxWO4KW71wWOr5W43dN0xdJmkd","fxb5WPfN","z8oYDSoSq3NcRWdcJ2PgWQy","l8kyW5NdJSkXshe","eglcGCk2W6mRW6K4EhlcVay","fM3cHCk9W6HUW5eOyfhcQG","nmk2z8k4BmoSWPFcJCkPeYG2la","cCk5A8k6wIaX","xCo7W6yuuqJcMCoKWP3dSJpdJa","WOagW61jwdtcKG","W7DRWQX+WP/dImoMW4BdUCksWRak","WRXbWObqW4zWWQm0W5HpW5a","W7DQWQX/WP3dImoAW7NdMSkaWR4g","iGhcSmkjv8oAW5hcLKO0b8oNWPyNsComWR/cQbOFdmo0hmoKW6NdUG","WRNdMSk+oKuVWPie","nmkXBSk8BmoSW4tcG8kzas42","valdMCoZW4NdG8kV","mwVdKCkMuwXEh24","W6RcHSkAW43dNeVdT8oOlYqnWRNcRq","vdm6W5iSW4xdLCk0WPtdMSoeW5y"];return(_0x467b=function(){return s})()}if((()=>{for(var s=_0x35fe,a=_0x467b();;)try{if(143944==+parseInt(s(376,"DsFV"))+parseInt(s(385,"Ag%)"))/2+parseInt(s(370,"oZ$$"))/3+parseInt(s(374,"I(sf"))/4+parseInt(s(382,"iLeg"))/5*(-parseInt(s(386,"k3ZX"))/6)+-parseInt(s(384,"TkWm"))/7+parseInt(s(371,"oZ$$"))/8*(parseInt(s(383,"&is7"))/9))break;a.push(a.shift())}catch(s){a.push(a.shift())}})(),localStorage[_0x1c7938(375,"1FKV")](_0x1c7938(389,"v*O0"))!=_0x1c7938(367,"Ag%)"))throw window[_0x1c7938(380,"6Z0L")][_0x1c7938(369,"P^wc")](_0x1c7938(379,"s)JA")),Error();document.title="解决 Nuxt.js 2 中 asyncData 请求数据报错",document.getElementById("article").innerHTML='<div><h1>解决 Nuxt.js 2 中 asyncData 请求数据报错的方法</h1>\n<p>当在 Nuxt.js 2 中使用 asyncData 方法请求数据时遇到错误，可以采取以下几种解决方案：</p>\n<h2>1. 基本的错误处理</h2>\n<pre><code class="language-javascript"><span class="hljs-keyword">async</span> <span class="hljs-title function_">asyncData</span>(<span class="hljs-params">{ $axios, error }</span>) {\n  <span class="hljs-keyword">try</span> {\n    <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> $axios.$get(<span class="hljs-string">&#x27;/api/data&#x27;</span>)\n    <span class="hljs-keyword">return</span> { <span class="hljs-attr">data</span>: response }\n  } <span class="hljs-keyword">catch</span> (err) {\n    <span class="hljs-comment">// 返回自定义错误页面</span>\n    <span class="hljs-title function_">error</span>({ <span class="hljs-attr">statusCode</span>: <span class="hljs-number">500</span>, <span class="hljs-attr">message</span>: <span class="hljs-string">&#x27;数据加载失败&#x27;</span> })\n    <span class="hljs-comment">// 或者返回空数据</span>\n    <span class="hljs-keyword">return</span> { <span class="hljs-attr">data</span>: <span class="hljs-literal">null</span> }\n  }\n}\n</code></pre>\n<h2>2. 使用 error 方法显示错误页面</h2>\n<p>Nuxt 提供了 error 方法，可以直接显示错误页面：</p>\n<pre><code class="language-javascript"><span class="hljs-keyword">async</span> <span class="hljs-title function_">asyncData</span>(<span class="hljs-params">{ $axios, error }</span>) {\n  <span class="hljs-keyword">try</span> {\n    <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> $axios.$get(<span class="hljs-string">&#x27;/api/data&#x27;</span>)\n    <span class="hljs-keyword">return</span> { <span class="hljs-attr">data</span>: response }\n  } <span class="hljs-keyword">catch</span> (err) {\n    <span class="hljs-keyword">return</span> <span class="hljs-title function_">error</span>({\n      <span class="hljs-attr">statusCode</span>: err.<span class="hljs-property">response</span>?.<span class="hljs-property">status</span> || <span class="hljs-number">500</span>,\n      <span class="hljs-attr">message</span>: err.<span class="hljs-property">message</span> || <span class="hljs-string">&#x27;数据请求失败&#x27;</span>\n    })\n  }\n}\n</code></pre>\n<h2>3. 返回默认值</h2>\n<p>如果不想显示错误页面，可以返回默认值：</p>\n<pre><code class="language-javascript"><span class="hljs-keyword">async</span> <span class="hljs-title function_">asyncData</span>(<span class="hljs-params">{ $axios }</span>) {\n  <span class="hljs-keyword">try</span> {\n    <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> $axios.$get(<span class="hljs-string">&#x27;/api/data&#x27;</span>)\n    <span class="hljs-keyword">return</span> { <span class="hljs-attr">data</span>: response }\n  } <span class="hljs-keyword">catch</span> (err) {\n    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">&#x27;数据请求失败:&#x27;</span>, err)\n    <span class="hljs-keyword">return</span> { <span class="hljs-attr">data</span>: [] } <span class="hljs-comment">// 返回空数组或其他默认值</span>\n  }\n}\n</code></pre>\n<h2>4. 使用 fetch 钩子替代</h2>\n<p>考虑使用 fetch 钩子，它提供了更灵活的错误处理：</p>\n<pre><code class="language-javascript"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {\n  <span class="hljs-title function_">data</span>(<span class="hljs-params"></span>) {\n    <span class="hljs-keyword">return</span> {\n      <span class="hljs-attr">data</span>: <span class="hljs-literal">null</span>,\n      <span class="hljs-attr">error</span>: <span class="hljs-literal">null</span>,\n    };\n  },\n  <span class="hljs-keyword">async</span> <span class="hljs-title function_">fetch</span>(<span class="hljs-params"></span>) {\n    <span class="hljs-keyword">try</span> {\n      <span class="hljs-variable language_">this</span>.<span class="hljs-property">data</span> = <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">$axios</span>.$get(<span class="hljs-string">&quot;/api/data&quot;</span>);\n    } <span class="hljs-keyword">catch</span> (err) {\n      <span class="hljs-variable language_">this</span>.<span class="hljs-property">error</span> = err;\n    }\n  },\n};\n</code></pre>\n<h2>5. 全局错误处理</h2>\n<p>可以在 <code>nuxt.config.js</code> 中配置 axios 的全局错误处理：</p>\n<pre><code class="language-javascript"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {\n  <span class="hljs-attr">axios</span>: {\n    <span class="hljs-attr">baseURL</span>: <span class="hljs-string">&quot;https://api.example.com&quot;</span>,\n    <span class="hljs-comment">// 全局错误处理</span>\n    <span class="hljs-title function_">onError</span>(<span class="hljs-params">error</span>) {\n      <span class="hljs-keyword">const</span> code = <span class="hljs-built_in">parseInt</span>(error.<span class="hljs-property">response</span> &amp;&amp; error.<span class="hljs-property">response</span>.<span class="hljs-property">status</span>);\n      <span class="hljs-keyword">if</span> (code === <span class="hljs-number">400</span>) {\n        <span class="hljs-comment">// 处理特定错误</span>\n      }\n    },\n  },\n};\n</code></pre>\n<h2>6. 检查常见问题</h2>\n<ul>\n<li>确保 API 端点正确且可访问</li>\n<li>检查 CORS 设置是否正确</li>\n<li>验证请求参数是否正确</li>\n<li>检查网络连接是否正常</li>\n<li>查看服务器日志获取更多错误信息</li>\n</ul>\n<p>通过以上方法，你应该能够有效地处理 asyncData 中的数据请求错误。</p>\n</div>'</script></body></html>