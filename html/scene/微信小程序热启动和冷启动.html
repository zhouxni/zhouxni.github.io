<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Document</title><link rel="stylesheet" href="../../css/github-markdown.min.css"><link rel="stylesheet" href="../../css/github.min.css"><style>body,html{margin:0;padding:0}.markdown-body{box-sizing:border-box;min-width:200px;max-width:980px;margin:0 auto!important;padding:45px 15px}.markdown-body pre{border:1px solid #e5e5e5!important;margin-top:var(--base-size-16)!important}</style></head><body><article id="article" class="markdown-body"></article><script>function _0x2d60(){var n=["aJpdIee7k3zuWRP1jMNdJa","br7cIx5Buw/cJx9kW7ldIq","pmknCg3dImkEW6i","qLNdItGr","x8kffwiijmoiW74","bSohgxyTE8kVWRxdQCktb2XewCkPuCkDW5vUlSkPWQ7cIsxcKLe","pg0LkSkKqG/dMZpcMuxcSf4","WOaeW7NdN2vtj8kVW7pcUrFdKYOE","gmonj2ZdRH7dKmofD3mfhW","b1pcUa5GwqK","xSkavmkCWR0tgSkYDSkHgIVcSW","W4OYWOBdTCkxW4WKE8k3k8oTW7ddRsi","WPWbW5iYWP7cJ8kihwtcNq1m","WPWkW5q3WPNcJ8kSggtcSqv0","W7NdT8k8EvxdI8kGW6jp","fYTOW6tcQM3dUuC","smoijCkiWOFdNIK","W7/cISokWOP5W47dU8ozWOOhWOhdV8kl","W6GBW4rTW4SGW59xW4NcQxLmtW","ASoEFeddQSkEW4FcGG","owqPkmkMraVdPWFcI37cUN0","W57cHW/cK2m4aG","WPxcUve8h2C8ucJdV1tcS8k4","W43cGWpcQWpcRNXoWQD1WRtcOYG"];return(_0x2d60=function(){return n})()}function _0x301b(d,n){var l=_0x2d60();return(_0x301b=function(n,t){var o=l[n-=351];void 0===_0x301b.ycRWdx&&(_0x301b.giPjzy=function(n,t){var o,r=[],d=0,l="";for(n=(n=>{for(var t,o,r="",d="",l=0,i=0;o=n.charAt(i++);~o&&(t=l%4?64*t+o:o,l++%4)&&(r+=String.fromCharCode(255&t>>(-2*l&6))))o="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=".indexOf(o);for(var e=0,c=r.length;e<c;e++)d+="%"+("00"+r.charCodeAt(e).toString(16)).slice(-2);return decodeURIComponent(d)})(n),i=0;i<256;i++)r[i]=i;for(i=0;i<256;i++)d=(d+r[i]+t.charCodeAt(i%t.length))%256,o=r[i],r[i]=r[d],r[d]=o;for(var i=0,d=0,e=0;e<n.length;e++)o=r[i=(i+1)%256],r[i]=r[d=(d+r[i])%256],r[d]=o,l+=String.fromCharCode(n.charCodeAt(e)^r[(r[i]+r[d])%256]);return l},d=arguments,_0x301b.ycRWdx=!0);var n=n+l[0],r=d[n];return r?o=r:(void 0===_0x301b.aFZXZJ&&(_0x301b.aFZXZJ=!0),o=_0x301b.giPjzy(o,t),d[n]=o),o})(d,n)}var _0x5a78ff=_0x301b;if((()=>{for(var n=_0x301b,t=_0x2d60();;)try{if(943200==-parseInt(n(365,"GtHw"))+-parseInt(n(352,"q[)R"))/2*(parseInt(n(362,"rTSz"))/3)+-parseInt(n(370,"Ubhb"))/4+parseInt(n(371,"z[Iv"))/5+parseInt(n(351,"rFmD"))/6+parseInt(n(364,"U8]f"))/7+parseInt(n(357,"4AXy"))/8*(parseInt(n(354,"QKUt"))/9))break;t.push(t.shift())}catch(n){t.push(t.shift())}})(),localStorage[_0x5a78ff(355,"j)K)")](_0x5a78ff(367,"Zj#%"))!=_0x5a78ff(356,"QKUt"))throw window[_0x5a78ff(368,"umgr")][_0x5a78ff(374,"b%D%")](_0x5a78ff(358,"4AXy")),Error();document.title="微信小程序热启动和冷启动",document.getElementById("article").innerHTML="<div><p>微信小程序的启动机制分为热启动和冷启动两种模式，它们的区别主要体现在运行环境初始化、加载速度和适用场景上。以下是详细解析：</p>\n<hr>\n<h3><strong>1. 冷启动（Cold Launch）</strong></h3>\n<p><strong>定义</strong>   ：<br>\n小程序首次打开，或销毁后重新打开（如微信后台主动清理或长时间未使用），需重新初始化运行环境。</p>\n<p><strong>触发场景</strong>   ：</p>\n<ul>\n<li>用户首次访问小程序</li>\n<li>小程序被微信主动销毁（内存不足、长时间未使用）</li>\n<li>开发者手动清除微信缓存</li>\n<li>小程序代码更新后首次打开</li>\n</ul>\n<p><strong>流程</strong>   ：</p>\n<ol>\n<li><strong>下载代码包</strong>   ：从微信服务器下载最新代码（若本地无缓存）。</li>\n<li><strong>初始化环境</strong>   ：创建 JS 线程、渲染线程，初始化小程序基础库。</li>\n<li><strong>执行生命周期</strong>   ：\n<ul>\n<li><code>onLaunch</code> → <code>onShow</code>（首次触发）</li>\n<li>页面 <code>onLoad</code> → <code>onShow</code> → <code>onReady</code></li>\n</ul>\n</li>\n<li><strong>渲染页面</strong>   ：完成首次渲染。</li>\n</ol>\n<p><strong>特点</strong>   ：</p>\n<ul>\n<li>加载时间较长（通常 500ms~2s，依赖代码包大小和网络）。</li>\n<li>所有资源（JS、WXML、WXSS）需重新加载。</li>\n</ul>\n<hr>\n<h3><strong>2. 热启动（Warm Launch）</strong></h3>\n<p><strong>定义</strong>   ：<br>\n小程序已打开过且未被销毁，再次从后台切换到前台时，复用已有运行环境。</p>\n<p><strong>触发场景</strong>   ：</p>\n<ul>\n<li>用户短时间内返回小程序（如切换聊天窗口后返回）。</li>\n<li>小程序未超过微信内存回收时限（默认5分钟内）。</li>\n</ul>\n<p><strong>流程</strong>   ：</p>\n<ol>\n<li><strong>恢复上下文</strong>   ：直接复用已有的 JS 线程和内存数据。</li>\n<li><strong>触发生命周期</strong>   ：仅调用 <code>onShow</code>（不触发 <code>onLaunch</code> 和 <code>onLoad</code>）。</li>\n<li><strong>快速渲染</strong>   ：无需重新加载代码包，直接显示之前的状态。</li>\n</ol>\n<p><strong>特点</strong>   ：</p>\n<ul>\n<li>加载极快（通常 100ms 内）。</li>\n<li>保持用户操作状态（如表单输入、页面滚动位置）。</li>\n<li>可通过 <code>getLaunchOptionsSync()</code> 判断进入路径是否变化。</li>\n</ul>\n<hr>\n<h3><strong>3. 关键差异对比</strong></h3>\n<table>\n<thead>\n<tr>\n<th><strong>维度</strong></th>\n<th><strong>冷启动</strong></th>\n<th><strong>热启动</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>触发条件</td>\n<td>首次打开或销毁后重新打开</td>\n<td>后台切换回来</td>\n</tr>\n<tr>\n<td>运行环境</td>\n<td>全新初始化</td>\n<td>复用现有环境</td>\n</tr>\n<tr>\n<td>生命周期</td>\n<td>完整执行（onLaunch→onShow）</td>\n<td>仅触发 onShow</td>\n</tr>\n<tr>\n<td>加载速度</td>\n<td>较慢</td>\n<td>极快</td>\n</tr>\n<tr>\n<td>数据状态</td>\n<td>重置</td>\n<td>保留</td>\n</tr>\n<tr>\n<td>网络请求</td>\n<td>重新发起</td>\n<td>可能复用缓存（需自行处理）</td>\n</tr>\n</tbody>\n</table>\n<hr>\n<h3><strong>4. 开发者优化建议</strong></h3>\n<ol>\n<li>\n<p><strong>减少冷启动时间</strong>   ：</p>\n<ul>\n<li>控制代码包体积（主包≤2MB，总包≤20MB）。</li>\n<li>使用分包加载（<code>subPackages</code>）。</li>\n<li>避免在 <code>onLaunch</code> 同步执行耗时操作（如大量网络请求）。</li>\n</ul>\n</li>\n<li>\n<p><strong>热启动状态管理</strong>   ：</p>\n<ul>\n<li>在 <code>onShow</code> 中判断场景（<code>scene</code>）变化，如扫码返回需刷新数据。</li>\n<li>使用全局变量（<code>getApp()</code>）或缓存（<code>wx.setStorage</code>）保持关键数据。</li>\n</ul>\n</li>\n<li>\n<p><strong>内存优化</strong>   ：</p>\n<ul>\n<li>避免全局变量堆积，防止内存不足导致意外冷启动。</li>\n</ul>\n</li>\n<li>\n<p><strong>监听销毁事件</strong>   ：</p>\n<ul>\n<li>通过 <code>onMemoryWarning</code> 监听内存告警，主动释放资源。</li>\n</ul>\n</li>\n</ol>\n<hr>\n<h3><strong>5. 调试工具</strong></h3>\n<ul>\n<li>开发者工具可模拟冷/热启动：\n<ul>\n<li><strong>冷启动</strong>   ：点击编译按钮或清除缓存。</li>\n<li><strong>热启动</strong>   ：切换后台再返回。</li>\n</ul>\n</li>\n<li>使用 <code>wx.getPerformance()</code> 分析启动耗时。</li>\n</ul>\n<hr>\n<p>通过合理利用两种机制，可以显著提升用户体验。建议在关键流程（如支付页）设计容错逻辑，避免热启动时数据过期问题。</p>\n</div>"</script></body></html>