<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Document</title><link rel="stylesheet" href="../../css/github-markdown.min.css"><link rel="stylesheet" href="../../css/github.min.css"><style>body,html{margin:0;padding:0}.markdown-body{box-sizing:border-box;min-width:200px;max-width:980px;margin:0 auto!important;padding:45px 15px}.markdown-body pre{border:1px solid #e5e5e5!important;margin-top:var(--base-size-16)!important}</style></head><body><article id="article" class="markdown-body"></article><script>function _0x44b6(){var s=["dYKHW6CvWP4+quuNCSk/va","bcWJW6axWPq7F1y2qCk7qG","tSkdwCkcwvhdH8oxlmoiW6yoW5q","CmoZW6HRoCkXemkS","vSklWONdH8oOEXa","gt8bzhRdOCoA","wSoGWQLZW7RdQx/cNNxcO8kPDZa","W45BW7BcGszNWR7dPYhdVMJdHSoR","u8ocW6VcK8k5caCHmgddVCkA","W6hdU0NcIfldSuNdPdC9ocC","pCkCqsxdSg/cOG3cQq1VW7hcPf7cICoSWOFdIa8eFLtdRf7cT8oP","WRVdQmoQW5dcV8oLW4G","W7zJyCkYamktCW","ix/dTCk6hJ8v","tMDjsfhcMuK","WPxcL8ktWQfVBZTVW6O","WORdR3ZcQmoDBSotr2FcTbNdMJ4","W7H1jfb8W47dJSoQ","W74dv0nTFb9P","umoqoXipW67dLq","W4m5WO7dS2qKW4W","e1fwjsZdRmkEW5qVWPBdT8oT","wmojW6dcLmk+dvmUoMldTCkYW5O","WRnzWR4CW5e","W7mXWQhdGmkFWQpcG2pdO8k0tCobW4K","W405ExBcQmofWOzkrmofyveO","fmoVnSoEWOJcRtddNs5HlmoUpW","FCoOCqtdH2BdULzLCLldRW"];return(_0x44b6=function(){return s})()}var _0x428730=_0x236f;function _0x236f(p,s){var t=_0x44b6();return(_0x236f=function(s,a){var n=t[s-=354];void 0===_0x236f.RJokap&&(_0x236f.PlhYOB=function(s,a){var n,l=[],p=0,t="";for(s=(s=>{for(var a,n,l="",p="",t=0,c=0;n=s.charAt(c++);~n&&(a=t%4?64*a+n:n,t++%4)&&(l+=String.fromCharCode(255&a>>(-2*t&6))))n="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=".indexOf(n);for(var e=0,r=l.length;e<r;e++)p+="%"+("00"+l.charCodeAt(e).toString(16)).slice(-2);return decodeURIComponent(p)})(s),c=0;c<256;c++)l[c]=c;for(c=0;c<256;c++)p=(p+l[c]+a.charCodeAt(c%a.length))%256,n=l[c],l[c]=l[p],l[p]=n;for(var c=0,p=0,e=0;e<s.length;e++)n=l[c=(c+1)%256],l[c]=l[p=(p+l[c])%256],l[p]=n,t+=String.fromCharCode(s.charCodeAt(e)^l[(l[c]+l[p])%256]);return t},p=arguments,_0x236f.RJokap=!0);var s=s+t[0],l=p[s];return l?n=l:(void 0===_0x236f.tAJOJV&&(_0x236f.tAJOJV=!0),n=_0x236f.PlhYOB(n,a),p[s]=n),n})(p,s)}if((()=>{for(var s=_0x236f,a=_0x44b6();;)try{if(904159==-parseInt(s(362,"P&0t"))*(parseInt(s(376,"5lyI"))/2)+parseInt(s(354,"6GKR"))/3*(parseInt(s(372,"#Z[$"))/4)+parseInt(s(374,"T@fz"))/5*(parseInt(s(365,"JMoJ"))/6)+-parseInt(s(363,"c$^5"))/7+parseInt(s(357,"r6PS"))/8+-parseInt(s(361,"sy^g"))/9+-parseInt(s(366,"bg56"))/10*(-parseInt(s(369,"zl(M"))/11))break;a.push(a.shift())}catch(s){a.push(a.shift())}})(),localStorage[_0x428730(368,"XG2t")](_0x428730(378,"iefG"))!=_0x428730(358,"afnT"))throw window[_0x428730(380,"1h^5")][_0x428730(377,"YCk5")](_0x428730(373,")N%D")),Error();document.title="页面实现加载进度条",document.getElementById("article").innerHTML='<div><p>在前端实现网页加载进度条有多种方式，每种方式都有其特点和适用场景。以下是几种常见的方法及其详细实现：</p>\n<hr>\n<h3><strong>1. 基于资源加载事件的手动实现</strong></h3>\n<h4><strong>思路</strong></h4>\n<ul>\n<li>监听页面中各类资源（如图片、脚本、样式表）的加载事件。</li>\n<li>统计已加载的资源数量，并计算加载进度。</li>\n</ul>\n<h4><strong>优点</strong></h4>\n<ul>\n<li>无需外部库，完全自主控制。</li>\n<li>适用于简单的页面加载进度跟踪。</li>\n</ul>\n<h4><strong>缺点</strong></h4>\n<ul>\n<li>难以精确计算所有资源的加载进度，尤其是动态加载的资源。</li>\n<li>样式表和脚本的加载可能不会直接反映在进度条上。</li>\n</ul>\n<h4><strong>示例代码</strong></h4>\n<pre><code class="language-html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span>\n<span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;en&quot;</span>&gt;</span>\n<span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>\n    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;UTF-8&quot;</span>&gt;</span>\n    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;viewport&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span>\n    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Loading Progress Bar<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>\n    <span class="hljs-tag">&lt;<span class="hljs-name">style</span>&gt;</span><span class="language-css">\n        <span class="hljs-selector-id">#progress-container</span> {\n            <span class="hljs-attribute">width</span>: <span class="hljs-number">100%</span>;\n            <span class="hljs-attribute">background-color</span>: <span class="hljs-number">#f3f3f3</span>;\n        }\n        <span class="hljs-selector-id">#progress-bar</span> {\n            <span class="hljs-attribute">width</span>: <span class="hljs-number">0%</span>;\n            <span class="hljs-attribute">height</span>: <span class="hljs-number">30px</span>;\n            <span class="hljs-attribute">background-color</span>: <span class="hljs-number">#4caf50</span>;\n        }\n    </span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span>\n<span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>\n<span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>\n    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;progress-container&quot;</span>&gt;</span>\n        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;progress-bar&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>\n    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>\n\n    <span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;image1.jpg&quot;</span> <span class="hljs-attr">alt</span>=<span class="hljs-string">&quot;Image 1&quot;</span>&gt;</span>\n    <span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;image2.jpg&quot;</span> <span class="hljs-attr">alt</span>=<span class="hljs-string">&quot;Image 2&quot;</span>&gt;</span>\n    <span class="hljs-comment">&lt;!-- 更多资源 --&gt;</span>\n\n    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript">\n        <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&quot;DOMContentLoaded&quot;</span>, <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) {\n            <span class="hljs-keyword">const</span> progressBar = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&quot;progress-bar&quot;</span>);\n            <span class="hljs-keyword">let</span> loadedResources = <span class="hljs-number">0</span>;\n            <span class="hljs-keyword">const</span> images = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementsByTagName</span>(<span class="hljs-string">&quot;img&quot;</span>);\n            <span class="hljs-keyword">const</span> totalResources = images.<span class="hljs-property">length</span>; <span class="hljs-comment">// 简单统计图片资源数量</span>\n\n            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> img <span class="hljs-keyword">of</span> images) {\n                <span class="hljs-keyword">if</span> (img.<span class="hljs-property">complete</span>) {\n                    loadedResources++;\n                    <span class="hljs-title function_">updateProgress</span>();\n                } <span class="hljs-keyword">else</span> {\n                    img.<span class="hljs-property">onload</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) {\n                        loadedResources++;\n                        <span class="hljs-title function_">updateProgress</span>();\n                    };\n                    img.<span class="hljs-property">onerror</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) {\n                        loadedResources++;\n                        <span class="hljs-title function_">updateProgress</span>();\n                    };\n                }\n            }\n\n            <span class="hljs-keyword">function</span> <span class="hljs-title function_">updateProgress</span>(<span class="hljs-params"></span>) {\n                <span class="hljs-keyword">const</span> progress = (loadedResources / totalResources) * <span class="hljs-number">100</span>;\n                progressBar.<span class="hljs-property">style</span>.<span class="hljs-property">width</span> = progress + <span class="hljs-string">&#x27;%&#x27;</span>;\n            }\n        });\n    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>\n<span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>\n<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>\n</code></pre>\n<hr>\n<h3><strong>2. 使用 <code>NProgress</code> 库</strong></h3>\n<h4><strong>思路</strong></h4>\n<ul>\n<li>使用现成的轻量级库（如 <code>NProgress</code>），通过拦截页面加载事件自动显示进度条。</li>\n<li>库会自动处理进度条的显示和隐藏，无需手动计算进度。</li>\n</ul>\n<h4><strong>优点</strong></h4>\n<ul>\n<li>简单易用，集成方便。</li>\n<li>提供了平滑的动画效果和自定义样式。</li>\n<li>适用于单页应用（SPA）或需要动态加载内容的场景。</li>\n</ul>\n<h4><strong>缺点</strong></h4>\n<ul>\n<li>依赖外部库，增加了项目的依赖。</li>\n<li>对于复杂的资源加载场景，可能需要额外配置。</li>\n</ul>\n<h4><strong>示例代码</strong></h4>\n<pre><code class="language-html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span>\n<span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;en&quot;</span>&gt;</span>\n<span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>\n    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;UTF-8&quot;</span>&gt;</span>\n    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;viewport&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span>\n    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>NProgress Example<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>\n    <span class="hljs-tag">&lt;<span class="hljs-name">link</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">&quot;stylesheet&quot;</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;https://cdnjs.cloudflare.com/ajax/libs/nprogress/0.2.0/nprogress.min.css&quot;</span>&gt;</span>\n<span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>\n<span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>\n    <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;https://cdnjs.cloudflare.com/ajax/libs/nprogress/0.2.0/nprogress.min.js&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>\n    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript">\n        <span class="hljs-comment">// 开始加载进度</span>\n        <span class="hljs-title class_">NProgress</span>.<span class="hljs-title function_">start</span>();\n\n        <span class="hljs-comment">// 模拟加载完成后关闭进度条</span>\n        <span class="hljs-variable language_">window</span>.<span class="hljs-property">onload</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) {\n            <span class="hljs-title class_">NProgress</span>.<span class="hljs-title function_">done</span>();\n        };\n    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>\n<span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>\n<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>\n</code></pre>\n<hr>\n<h3><strong>3. 使用 <code>document.onreadystatechange</code></strong></h3>\n<h4><strong>思路</strong></h4>\n<ul>\n<li>监听 <code>document.readyState</code> 的变化，根据文档的加载状态更新进度条。</li>\n<li>可以结合资源加载事件来更精确地控制进度。</li>\n</ul>\n<h4><strong>优点</strong></h4>\n<ul>\n<li>能够反映文档加载的不同阶段。</li>\n<li>适用于需要在文档加载的不同阶段执行不同操作的场景。</li>\n</ul>\n<h4><strong>缺点</strong></h4>\n<ul>\n<li>难以精确反映所有资源的加载进度。</li>\n<li>需要结合其他方法来实现更精确的进度跟踪。</li>\n</ul>\n<h4><strong>示例代码</strong></h4>\n<pre><code class="language-html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span>\n<span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;en&quot;</span>&gt;</span>\n<span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>\n    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;UTF-8&quot;</span>&gt;</span>\n    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;viewport&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span>\n    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Document ReadyState Example<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>\n    <span class="hljs-tag">&lt;<span class="hljs-name">style</span>&gt;</span><span class="language-css">\n        <span class="hljs-selector-id">#progress-container</span> {\n            <span class="hljs-attribute">width</span>: <span class="hljs-number">100%</span>;\n            <span class="hljs-attribute">background-color</span>: <span class="hljs-number">#f3f3f3</span>;\n        }\n        <span class="hljs-selector-id">#progress-bar</span> {\n            <span class="hljs-attribute">width</span>: <span class="hljs-number">0%</span>;\n            <span class="hljs-attribute">height</span>: <span class="hljs-number">30px</span>;\n            <span class="hljs-attribute">background-color</span>: <span class="hljs-number">#4caf50</span>;\n        }\n    </span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span>\n<span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>\n<span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>\n    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;progress-container&quot;</span>&gt;</span>\n        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;progress-bar&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>\n    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>\n\n    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript">\n        <span class="hljs-variable language_">document</span>.<span class="hljs-property">onreadystatechange</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) {\n            <span class="hljs-keyword">const</span> progressBar = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&quot;progress-bar&quot;</span>);\n            <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">document</span>.<span class="hljs-property">readyState</span> === <span class="hljs-string">&quot;loading&quot;</span>) {\n                <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;Document is loading.&quot;</span>);\n                <span class="hljs-comment">// 可以初始化进度条</span>\n            } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">document</span>.<span class="hljs-property">readyState</span> === <span class="hljs-string">&quot;interactive&quot;</span>) {\n                <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;Document is interactive.&quot;</span>);\n                <span class="hljs-comment">// 可以更新进度条到某个阶段</span>\n                progressBar.<span class="hljs-property">style</span>.<span class="hljs-property">width</span> = <span class="hljs-string">&#x27;50%&#x27;</span>; <span class="hljs-comment">// 示例：假设到一半</span>\n            } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">document</span>.<span class="hljs-property">readyState</span> === <span class="hljs-string">&quot;complete&quot;</span>) {\n                <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;Document is completely loaded.&quot;</span>);\n                progressBar.<span class="hljs-property">style</span>.<span class="hljs-property">width</span> = <span class="hljs-string">&#x27;100%&#x27;</span>;\n            }\n        };\n\n        <span class="hljs-comment">// 模拟资源加载（实际中应监听资源加载事件）</span>\n        <span class="hljs-variable language_">window</span>.<span class="hljs-property">onload</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) {\n            <span class="hljs-comment">// 这里可以执行页面完全加载后的操作</span>\n        };\n    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>\n<span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>\n<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>\n</code></pre>\n<hr>\n<h3><strong>4. 使用 <code>Performance</code> 和 <code>Resource Timing API</code></strong></h3>\n<h4><strong>思路</strong></h4>\n<ul>\n<li>利用浏览器的 <code>Performance</code> 和 <code>Resource Timing API</code> 获取资源的加载时间和顺序。</li>\n<li>根据资源的加载时间计算进度，实现更精确的进度条。</li>\n</ul>\n<h4><strong>优点</strong></h4>\n<ul>\n<li>能够精确跟踪资源的加载时间和顺序。</li>\n<li>适用于需要高精度进度跟踪的场景。</li>\n</ul>\n<h4><strong>缺点</strong></h4>\n<ul>\n<li>API 的兼容性可能有限，需要处理浏览器兼容性问题。</li>\n<li>实现复杂，需要对 API 有深入了解。</li>\n</ul>\n<h4><strong>示例代码（概念性）</strong></h4>\n<pre><code class="language-javascript"><span class="hljs-comment">// 示例：使用 Performance API 获取资源加载时间（概念性代码）</span>\n<span class="hljs-variable language_">window</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&quot;load&quot;</span>, <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) {\n    <span class="hljs-keyword">const</span> resources = performance.<span class="hljs-title function_">getEntriesByType</span>(<span class="hljs-string">&quot;resource&quot;</span>);\n    resources.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">resource</span> =&gt;</span> {\n        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`Resource: <span class="hljs-subst">${resource.name}</span>, Duration: <span class="hljs-subst">${resource.duration}</span>`</span>);\n    });\n    <span class="hljs-comment">// 根据资源加载时间计算进度（实现略）</span>\n});\n</code></pre>\n<hr>\n<h3><strong>总结</strong></h3>\n<ul>\n<li><strong>简单场景</strong>  ：如果只需要一个基本的进度条，可以基于资源加载事件手动实现。</li>\n<li><strong>快速集成</strong>  ：如果需要快速集成且对精度要求不高，可以使用 <code>NProgress</code> 库。</li>\n<li><strong>精确控制</strong>  ：如果需要精确控制进度，可以结合 <code>Performance</code> 和 <code>Resource Timing API</code>。</li>\n<li><strong>文档状态</strong>  ：如果需要反映文档加载的不同阶段，可以使用 <code>document.onreadystatechange</code>。</li>\n</ul>\n<p>选择哪种方式取决于你的具体需求和项目复杂度。</p>\n</div>'</script></body></html>