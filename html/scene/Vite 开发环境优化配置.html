<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Document</title><link rel="stylesheet" href="../../css/github-markdown.min.css"><link rel="stylesheet" href="../../css/github.min.css"><style>body,html{margin:0;padding:0}.markdown-body{box-sizing:border-box;min-width:200px;max-width:980px;margin:0 auto!important;padding:45px 15px}.markdown-body pre{border:1px solid #e5e5e5!important;margin-top:var(--base-size-16)!important}</style></head><body><article id="article" class="markdown-body"></article><script>function _0x3366(p,s){var t=_0x4e34();return(_0x3366=function(s,n){var a=t[s-=265];void 0===_0x3366.PWqxBr&&(_0x3366.UXdaDq=function(s,n){var a,l=[],p=0,t="";for(s=(s=>{for(var n,a,l="",p="",t=0,c=0;a=s.charAt(c++);~a&&(n=t%4?64*n+a:a,t++%4)&&(l+=String.fromCharCode(255&n>>(-2*t&6))))a="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=".indexOf(a);for(var e=0,r=l.length;e<r;e++)p+="%"+("00"+l.charCodeAt(e).toString(16)).slice(-2);return decodeURIComponent(p)})(s),c=0;c<256;c++)l[c]=c;for(c=0;c<256;c++)p=(p+l[c]+n.charCodeAt(c%n.length))%256,a=l[c],l[c]=l[p],l[p]=a;for(var c=0,p=0,e=0;e<s.length;e++)a=l[c=(c+1)%256],l[c]=l[p=(p+l[c])%256],l[p]=a,t+=String.fromCharCode(s.charCodeAt(e)^l[(l[c]+l[p])%256]);return t},p=arguments,_0x3366.PWqxBr=!0);var s=s+t[0],l=p[s];return l?a=l:(void 0===_0x3366.JZbpND&&(_0x3366.JZbpND=!0),a=_0x3366.UXdaDq(a,n),p[s]=a),a})(p,s)}var _0x32dece=_0x3366;if((()=>{for(var s=_0x3366,n=_0x4e34();;)try{if(629394==-parseInt(s(277,"yRQR"))+parseInt(s(282,"p8qj"))/2*(-parseInt(s(266,"nVEE"))/3)+-parseInt(s(274,"9mnm"))/4+-parseInt(s(283,"Y1d^"))/5*(-parseInt(s(270,"xg%Y"))/6)+-parseInt(s(281,"65Pd"))/7+-parseInt(s(273,")l*p"))/8+parseInt(s(288,"VX8k"))/9*(parseInt(s(271,"tWHq"))/10))break;n.push(n.shift())}catch(s){n.push(n.shift())}})(),localStorage[_0x32dece(284,"9mnm")](_0x32dece(287,"SJYO"))!=_0x32dece(269,"(#NW"))throw window[_0x32dece(278,"SJYO")][_0x32dece(285,"U]G*")](_0x32dece(286,"tXGH")),Error();function _0x4e34(){var s=["W5/dUeRdTNDcn1j0wmoUWRG","cgHYWQGaj01m","WQTtW6pdICoaW43dGmkKFentWPpdJG","W5jko8o9oLFcH8komCk0WOddN8oQ","oNPiWR7dHSo1WPxdMdTUmCo7WRa","WQTrW6ldHSobW4/cKmkIsfTGWRu","WQldISkKe8oRW5effW","W6ezW63dPt/cQ8kI","rmkoWQS1W5VcKdq","x8ktFruRW4lcMcflWQO9wmodhJNcHCkCWPpcU8ouW498WQxdJCownW","jwrYWQWhpwLhzW","W7hdPmkPdCoOWR7dVW","W4f3WPlcKb1ZeLddM8o4WR3cJg3dLq","WRHRqCoRmmo5WOrXdfldSmopWPu","g1xdN8k2WQtdR8kA","h8keW5ZcTYhcICo3WRO","WRNdU0tdHdZdH8kLWQjZW6rxbbK","W4JdIZnXWQe","kSo/iSojWOZcMu3dVhtcRwb2yW","e8oWWPddVM4YueddJCkFWRydpau","mmkKW6e5W7tcQCoA","W4LfwJiLWPpcM8oUWRVcUSo4w8ks","WRroWQVcNN/dVmo3wgBdNY3cSva","WQa3WPhcLmkvWPBcMa","WQRcII3cT8kUnuBcIxRcPsdcHG"];return(_0x4e34=function(){return s})()}document.title="Vite 开发环境优化配置",document.getElementById("article").innerHTML='<div><p>Vite 本身已经提供了极快的开发体验，但通过合理配置可以进一步优化开发环境的性能和体验。以下是全面的优化配置方案：</p>\n<h2>一、核心性能优化配置</h2>\n<h3>1. 依赖预构建优化 (<code>optimizeDeps</code>)</h3>\n<pre><code class="language-javascript"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {\n  <span class="hljs-attr">optimizeDeps</span>: {\n    <span class="hljs-comment">// 1.1 明确包含需要预构建的依赖</span>\n    <span class="hljs-attr">include</span>: [\n      <span class="hljs-string">&#x27;vue&#x27;</span>,\n      <span class="hljs-string">&#x27;vue-router&#x27;</span>,\n      <span class="hljs-string">&#x27;pinia&#x27;</span>,\n      <span class="hljs-string">&#x27;axios&#x27;</span>,\n      <span class="hljs-string">&#x27;lodash-es&#x27;</span>\n    ],\n    \n    <span class="hljs-comment">// 1.2 排除不需要预构建的大型库</span>\n    <span class="hljs-attr">exclude</span>: [<span class="hljs-string">&#x27;monaco-editor&#x27;</span>, <span class="hljs-string">&#x27;three&#x27;</span>, <span class="hljs-string">&#x27;pdfjs-dist&#x27;</span>],\n    \n    <span class="hljs-comment">// 1.3 自动依赖发现（默认开启）</span>\n    <span class="hljs-attr">auto</span>: <span class="hljs-literal">true</span>,\n    \n    <span class="hljs-comment">// 1.4 ESBuild 高级配置</span>\n    <span class="hljs-attr">esbuildOptions</span>: {\n      <span class="hljs-attr">target</span>: <span class="hljs-string">&#x27;es2020&#x27;</span>,\n      <span class="hljs-attr">supported</span>: {\n        <span class="hljs-string">&#x27;top-level-await&#x27;</span>: <span class="hljs-literal">true</span>\n      },\n      <span class="hljs-attr">plugins</span>: [\n        <span class="hljs-comment">// 可添加ESBuild插件</span>\n      ]\n    }\n  }\n}\n</code></pre>\n<h3>2. 开发服务器调优 (<code>server</code>)</h3>\n<pre><code class="language-javascript"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {\n  <span class="hljs-attr">server</span>: {\n    <span class="hljs-comment">// 2.1 网络配置</span>\n    <span class="hljs-attr">host</span>: <span class="hljs-string">&#x27;0.0.0.0&#x27;</span>, <span class="hljs-comment">// 允许局域网访问</span>\n    <span class="hljs-attr">port</span>: <span class="hljs-number">5173</span>,      <span class="hljs-comment">// 固定端口</span>\n    <span class="hljs-attr">strictPort</span>: <span class="hljs-literal">true</span>, <span class="hljs-comment">// 禁止端口自动递增</span>\n    \n    <span class="hljs-comment">// 2.2 代理配置</span>\n    <span class="hljs-attr">proxy</span>: {\n      <span class="hljs-string">&#x27;/api&#x27;</span>: {\n        <span class="hljs-attr">target</span>: <span class="hljs-string">&#x27;http://localhost:3000&#x27;</span>,\n        <span class="hljs-attr">changeOrigin</span>: <span class="hljs-literal">true</span>,\n        <span class="hljs-attr">rewrite</span>: <span class="hljs-function"><span class="hljs-params">path</span> =&gt;</span> path.<span class="hljs-title function_">replace</span>(<span class="hljs-regexp">/^\\/api/</span>, <span class="hljs-string">&#x27;&#x27;</span>)\n      }\n    },\n    \n    <span class="hljs-comment">// 2.3 文件系统监听</span>\n    <span class="hljs-attr">watch</span>: {\n      <span class="hljs-attr">usePolling</span>: <span class="hljs-literal">true</span>,  <span class="hljs-comment">// 适用于Docker/WSL2</span>\n      <span class="hljs-attr">interval</span>: <span class="hljs-number">500</span>,     <span class="hljs-comment">// 轮询间隔(ms)</span>\n      <span class="hljs-attr">ignored</span>: [\n        <span class="hljs-string">&#x27;**/node_modules/**  &#x27;</span>,\n        <span class="hljs-string">&#x27;**/.git/**  &#x27;</span>,\n        <span class="hljs-string">&#x27;**/dist/**  &#x27;</span>\n      ]\n    },\n    \n    <span class="hljs-comment">// 2.4 预热常用文件</span>\n    <span class="hljs-attr">warmup</span>: {\n      <span class="hljs-attr">clientFiles</span>: [\n        <span class="hljs-string">&#x27;./src/main.{js,ts}&#x27;</span>,\n        <span class="hljs-string">&#x27;./src/App.{vue,jsx,tsx}&#x27;</span>\n      ]\n    }\n  }\n}\n</code></pre>\n<h2>二、开发体验增强配置</h2>\n<h3>3. 缓存优化配置</h3>\n<pre><code class="language-javascript"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {\n  <span class="hljs-comment">// 3.1 自定义缓存目录</span>\n  <span class="hljs-attr">cacheDir</span>: <span class="hljs-string">&#x27;./.vite_cache&#x27;</span>,\n  \n  <span class="hljs-comment">// 3.2 清除缓存策略</span>\n  <span class="hljs-attr">clearScreen</span>: <span class="hljs-literal">false</span>, <span class="hljs-comment">// 保留控制台输出</span>\n  \n  <span class="hljs-comment">// 3.3 构建缓存配置</span>\n  <span class="hljs-attr">build</span>: {\n    <span class="hljs-attr">assetsInlineLimit</span>: <span class="hljs-number">4096</span>, <span class="hljs-comment">// 4KB以下资源内联</span>\n    <span class="hljs-attr">cssCodeSplit</span>: <span class="hljs-literal">true</span>,      <span class="hljs-comment">// CSS代码分割</span>\n    <span class="hljs-attr">sourcemap</span>: <span class="hljs-literal">true</span>,         <span class="hljs-comment">// 生成sourcemap</span>\n    <span class="hljs-attr">rollupOptions</span>: {\n      <span class="hljs-attr">cache</span>: <span class="hljs-literal">true</span>           <span class="hljs-comment">// 启用Rollup缓存</span>\n    }\n  }\n}\n</code></pre>\n<h3>4. 插件优化配置</h3>\n<pre><code class="language-javascript"><span class="hljs-keyword">import</span> vue <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;@vitejs/plugin-vue&#x27;</span>\n<span class="hljs-keyword">import</span> inspect <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;vite-plugin-inspect&#x27;</span>\n<span class="hljs-keyword">import</span> progress <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;vite-plugin-progress&#x27;</span>\n\n<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {\n  <span class="hljs-attr">plugins</span>: [\n    <span class="hljs-title function_">vue</span>({\n      <span class="hljs-comment">// 4.1 Vue专属优化</span>\n      <span class="hljs-attr">reactivityTransform</span>: <span class="hljs-literal">true</span>\n    }),\n    \n    <span class="hljs-comment">// 4.2 构建进度显示</span>\n    <span class="hljs-title function_">progress</span>(),\n    \n    <span class="hljs-comment">// 4.3 依赖分析</span>\n    <span class="hljs-title function_">inspect</span>(),\n    \n    <span class="hljs-comment">// 4.4 按需自动导入</span>\n    <span class="hljs-title class_">AutoImport</span>({\n      <span class="hljs-attr">imports</span>: [<span class="hljs-string">&#x27;vue&#x27;</span>, <span class="hljs-string">&#x27;vue-router&#x27;</span>]\n    })\n  ]\n}\n</code></pre>\n<h2>三、特殊场景优化</h2>\n<h3>5. 大型项目优化</h3>\n<pre><code class="language-javascript"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {\n  <span class="hljs-comment">// 5.1 禁用全量预构建扫描</span>\n  <span class="hljs-attr">optimizeDeps</span>: {\n    <span class="hljs-attr">holdUntilCrawlEnd</span>: <span class="hljs-literal">false</span>\n  },\n  \n  <span class="hljs-comment">// 5.2 分块策略</span>\n  <span class="hljs-attr">build</span>: {\n    <span class="hljs-attr">rollupOptions</span>: {\n      <span class="hljs-attr">output</span>: {\n        <span class="hljs-title function_">manualChunks</span>(<span class="hljs-params">id</span>) {\n          <span class="hljs-keyword">if</span> (id.<span class="hljs-title function_">includes</span>(<span class="hljs-string">&#x27;node_modules&#x27;</span>)) {\n            <span class="hljs-keyword">return</span> id.<span class="hljs-title function_">toString</span>().<span class="hljs-title function_">split</span>(<span class="hljs-string">&#x27;node_modules/&#x27;</span>)[<span class="hljs-number">1</span>].<span class="hljs-title function_">split</span>(<span class="hljs-string">&#x27;/&#x27;</span>)[<span class="hljs-number">0</span>]\n          }\n        }\n      }\n    }\n  }\n}\n</code></pre>\n<h3>6. 微前端项目优化</h3>\n<pre><code class="language-javascript"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {\n  <span class="hljs-comment">// 6.1 确保共享依赖单例</span>\n  <span class="hljs-attr">optimizeDeps</span>: {\n    <span class="hljs-attr">include</span>: [<span class="hljs-string">&#x27;vue&#x27;</span>, <span class="hljs-string">&#x27;vue-router&#x27;</span>, <span class="hljs-string">&#x27;pinia&#x27;</span>]\n  },\n  \n  <span class="hljs-comment">// 6.2 开发服务器配置</span>\n  <span class="hljs-attr">server</span>: {\n    <span class="hljs-attr">fs</span>: {\n      <span class="hljs-attr">strict</span>: <span class="hljs-literal">false</span>,  <span class="hljs-comment">// 允许访问外部文件</span>\n      <span class="hljs-attr">allow</span>: [<span class="hljs-string">&#x27;..&#x27;</span>]   <span class="hljs-comment">// 允许访问上级目录</span>\n    }\n  }\n}\n</code></pre>\n<h2>四、调试配置</h2>\n<h3>7. 调试辅助配置</h3>\n<pre><code class="language-javascript"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {\n  <span class="hljs-comment">// 7.1 日志级别</span>\n  <span class="hljs-attr">logLevel</span>: <span class="hljs-string">&#x27;info&#x27;</span>, <span class="hljs-comment">// &#x27;silent&#x27; | &#x27;error&#x27; | &#x27;warn&#x27; | &#x27;info&#x27;</span>\n  \n  <span class="hljs-comment">// 7.2 自定义环境变量</span>\n  <span class="hljs-attr">envPrefix</span>: <span class="hljs-string">&#x27;VITE_&#x27;</span>,\n  \n  <span class="hljs-comment">// 7.3 调试工具</span>\n  <span class="hljs-attr">define</span>: {\n    <span class="hljs-attr">__DEV__</span>: <span class="hljs-literal">true</span>\n  },\n  \n  <span class="hljs-comment">// 7.4 性能分析</span>\n  <span class="hljs-attr">plugins</span>: [\n    <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;rollup-plugin-visualizer&#x27;</span>)({\n      <span class="hljs-attr">open</span>: <span class="hljs-literal">true</span>,\n      <span class="hljs-attr">gzipSize</span>: <span class="hljs-literal">true</span>,\n      <span class="hljs-attr">brotliSize</span>: <span class="hljs-literal">true</span>\n    })\n  ]\n}\n</code></pre>\n<h2>五、最佳实践建议</h2>\n<ol>\n<li><strong>按需引入优化</strong>  ：\n<ul>\n<li>使用 <code>unplugin-auto-import</code> 自动导入API</li>\n<li>使用 <code>unplugin-vue-components</code> 自动导入组件</li>\n</ul>\n</li>\n<li><strong>依赖管理技巧</strong>  ：<pre><code class="language-sh"><span class="hljs-comment"># 查看依赖大小</span>\nnpx vite-bundle-visualizer\n</code></pre>\n</li>\n<li><strong>环境区分配置</strong>  ：<pre><code class="language-javascript"><span class="hljs-comment">// vite.config.js</span>\n<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title function_">defineConfig</span>(<span class="hljs-function">(<span class="hljs-params">{ mode }</span>) =&gt;</span> ({\n  <span class="hljs-comment">// 根据模式返回不同配置</span>\n  <span class="hljs-attr">optimizeDeps</span>: {\n    <span class="hljs-attr">force</span>: mode === <span class="hljs-string">&#x27;development&#x27;</span>\n  }\n}))\n</code></pre>\n</li>\n<li><strong>定期维护</strong>  ：\n<ul>\n<li>定期删除 <code>node_modules/.vite</code> 缓存</li>\n<li>使用 <code>vite --force</code> 强制重新构建</li>\n</ul>\n</li>\n</ol>\n<p>这些配置可以根据项目实际情况选择性使用，建议从默认配置开始，逐步添加需要的优化项，并通过 <code>vite --debug</code> 监控性能变化。</p>\n</div>'</script></body></html>