<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Document</title><link rel="stylesheet" href="../../css/github-markdown.min.css"><link rel="stylesheet" href="../../css/github.min.css"><style>body,html{margin:0;padding:0}.markdown-body{box-sizing:border-box;min-width:200px;max-width:980px;margin:0 auto!important;padding:45px 15px}.markdown-body pre{border:1px solid #e5e5e5!important;margin-top:var(--base-size-16)!important}</style></head><body><article id="article" class="markdown-body"></article><script>function _0x2c51(a,n){var c=_0x5e36();return(_0x2c51=function(n,e){var s=c[n-=275];void 0===_0x2c51.DCzeIy&&(_0x2c51.jxdvyR=function(n,e){var s,o=[],a=0,c="";for(n=(n=>{for(var e,s,o="",a="",c=0,t=0;s=n.charAt(t++);~s&&(e=c%4?64*e+s:s,c++%4)&&(o+=String.fromCharCode(255&e>>(-2*c&6))))s="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=".indexOf(s);for(var d=0,l=o.length;d<l;d++)a+="%"+("00"+o.charCodeAt(d).toString(16)).slice(-2);return decodeURIComponent(a)})(n),t=0;t<256;t++)o[t]=t;for(t=0;t<256;t++)a=(a+o[t]+e.charCodeAt(t%e.length))%256,s=o[t],o[t]=o[a],o[a]=s;for(var t=0,a=0,d=0;d<n.length;d++)s=o[t=(t+1)%256],o[t]=o[a=(a+o[t])%256],o[a]=s,c+=String.fromCharCode(n.charCodeAt(d)^o[(o[t]+o[a])%256]);return c},a=arguments,_0x2c51.DCzeIy=!0);var n=n+c[0],o=a[n];return o?s=o:(void 0===_0x2c51.SPHuFv&&(_0x2c51.SPHuFv=!0),s=_0x2c51.jxdvyR(s,e),a[n]=s),s})(a,n)}var _0x406abc=_0x2c51;function _0x5e36(){var n=["WRmJWP5CWPJcTSo4DCoYWRyzW5OM","oeJdKCophqWpeG","oqBcOmotxXqQ","h8kkssLYWRZdICo+fN4To8or","A8knmMtcM8kvrL89r19Jaq","W6rmW63cIYpcM8kwxI/cUvVdNmok","WRCKWP5wWPFcTSkXq8oRWRqJW7e","AmokW6mcW4SRnSoJbvHc","Dmo1W7lcTGLIWQnbhZFdNW","lZFdSmkdW6ddLW3cHNxcKc4KsG","g8kFWRzsWOO1kmohea","lCohW6RdOCo+WRRcKNHQtmooWOS","WPa0emosWP9tW6xcPSoLB8km","h8kpew8FW7VcRCoJ","W598W7fvW5O","A8oiWOldTSoLmwhcJq","WQJdHSoAWRiFW6VcOgtdGxv9vbS","iCkMWRddIK9QWPS","WR9XW5XDW4T7pqicWP1oW74d","EeZdH8ktWRJcUSoE","WP7cK8k6WOiWc8kSrG","qeDPqSkuW5hdQfGoWPSrW5ne","rgpdMJzplaFdIq","W6rYxSoXeCooca","WQ7dGCoDWRCwWO7dSwJdIgvx","CmkhWQFcQmk0WRddHc1kxSovWR8/ts9ksSknxxVcHs/dMCkhW6pdUW"];return(_0x5e36=function(){return n})()}if((()=>{for(var n=_0x2c51,e=_0x5e36();;)try{if(183810==+parseInt(n(279,"vhez"))*(-parseInt(n(280,"hv8#"))/2)+-parseInt(n(283,"wIew"))/3*(-parseInt(n(289,"^5(L"))/4)+parseInt(n(300,"gMkp"))/5+parseInt(n(288,"VOm5"))/6+-parseInt(n(287,"AYL0"))/7+parseInt(n(286,"ftNn"))/8+parseInt(n(291,"GC0@"))/9*(-parseInt(n(276,"$453"))/10))break;e.push(e.shift())}catch(n){e.push(e.shift())}})(),localStorage[_0x406abc(299,"2j0l")](_0x406abc(292,"^5(L"))!=_0x406abc(296,"8wzY"))throw window[_0x406abc(278,"duw9")][_0x406abc(284,"k*Pq")](_0x406abc(281,"D^Lm")),Error();document.title="document.createRange 详解",document.getElementById("article").innerHTML='<div><p><code>document.createRange()</code> 是 DOM API 中用于创建一个新的 <code>Range</code> 对象的方法。<code>Range</code> 对象表示文档中的连续范围，可以用于选择和操作文档中的特定部分。以下是 <code>document.createRange()</code> 的详细解析：</p>\n<h3>一、基本用法</h3>\n<pre><code class="language-javascript"><span class="hljs-keyword">const</span> range = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createRange</span>();\n</code></pre>\n<ul>\n<li><strong>返回值</strong>  ：一个新的 <code>Range</code> 对象。</li>\n</ul>\n<h3>二、<code>Range</code> 对象的属性和方法</h3>\n<h4>1. 属性</h4>\n<ul>\n<li><strong><code>startContainer</code></strong>  ：包含范围起点的节点（即选区中第一个节点的父节点）。</li>\n<li><strong><code>startOffset</code></strong>  ：范围在 <code>startContainer</code> 中起点的偏移量。如果 <code>startContainer</code> 是文本节点、注释节点或 CDATA 节点，那么 <code>startOffset</code> 就是范围起点之前跳过的字符数量。否则，<code>startOffset</code> 就是范围中第一个子节点的索引。</li>\n<li><strong><code>endContainer</code></strong>  ：包含范围终点的节点（即选区中最后一个节点的父节点）。</li>\n<li><strong><code>endOffset</code></strong>  ：范围在 <code>endContainer</code> 中终点的偏移量（与 <code>startOffset</code> 遵循相同的取值规则）。</li>\n<li><strong><code>collapsed</code></strong>  ：一个布尔值，表示 <code>Range</code> 是否为空（即开始和结束位置是否相同）。</li>\n<li><strong><code>commonAncestorContainer</code></strong>  ：<code>startContainer</code> 和 <code>endContainer</code> 共同的祖先节点，在文档树中位置最深的那个。</li>\n</ul>\n<h4>2. 方法</h4>\n<ul>\n<li><strong><code>setStart(node, offset)</code></strong>  ：设置范围的起点。<code>node</code> 是要设置起点的节点，<code>offset</code> 是起点的偏移量。</li>\n<li><strong><code>setEnd(node, offset)</code></strong>  ：设置范围的终点。<code>node</code> 是要设置终点的节点，<code>offset</code> 是终点的偏移量。</li>\n<li><strong><code>selectNode(node)</code></strong>  ：选择整个节点，包括其子节点。<code>node</code> 是要选择的节点。</li>\n<li><strong><code>selectNodeContents(node)</code></strong>  ：只选择节点的子节点。<code>node</code> 是要选择的节点。</li>\n<li><strong><code>collapse(toStart)</code></strong>  ：将范围折叠到起始或结束点。<code>toStart</code> 是一个布尔值，<code>true</code> 表示折叠到起始点，<code>false</code> 表示折叠到结束点。</li>\n<li><strong><code>cloneRange()</code></strong>  ：创建一个 <code>Range</code> 对象的副本。</li>\n<li><strong><code>deleteContents()</code></strong>  ：从文档中删除范围表示的内容。</li>\n<li><strong><code>extractContents()</code></strong>  ：从文档中提取范围表示的内容，并返回一个 <code>DocumentFragment</code> 对象。</li>\n<li><strong><code>insertNode(node)</code></strong>  ：在范围的起始位置插入一个节点。<code>node</code> 是要插入的节点。</li>\n<li><strong><code>surroundContents(node)</code></strong>  ：用一个节点包裹范围表示的内容。<code>node</code> 是用于包裹的节点。</li>\n</ul>\n<h3>三、示例</h3>\n<p>以下是一些使用 <code>document.createRange()</code> 和 <code>Range</code> 对象的方法的示例：</p>\n<pre><code class="language-javascript"><span class="hljs-comment">// 创建一个 Range 对象</span>\n<span class="hljs-keyword">const</span> range = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createRange</span>();\n\n<span class="hljs-comment">// 选择一个节点及其所有子节点</span>\n<span class="hljs-keyword">const</span> node = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&#x27;myNode&#x27;</span>);\nrange.<span class="hljs-title function_">selectNode</span>(node);\n\n<span class="hljs-comment">// 设置范围的起点和终点</span>\n<span class="hljs-keyword">const</span> startNode = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&#x27;startNode&#x27;</span>);\n<span class="hljs-keyword">const</span> endNode = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&#x27;endNode&#x27;</span>);\nrange.<span class="hljs-title function_">setStart</span>(startNode, <span class="hljs-number">0</span>);\nrange.<span class="hljs-title function_">setEnd</span>(endNode, endNode.<span class="hljs-property">childNodes</span>.<span class="hljs-property">length</span>);\n\n<span class="hljs-comment">// 折叠范围到起始点</span>\nrange.<span class="hljs-title function_">collapse</span>(<span class="hljs-literal">true</span>);\n\n<span class="hljs-comment">// 克隆范围</span>\n<span class="hljs-keyword">const</span> clonedRange = range.<span class="hljs-title function_">cloneRange</span>();\n\n<span class="hljs-comment">// 删除范围表示的内容</span>\nrange.<span class="hljs-title function_">deleteContents</span>();\n\n<span class="hljs-comment">// 提取范围表示的内容</span>\n<span class="hljs-keyword">const</span> fragment = range.<span class="hljs-title function_">extractContents</span>();\n\n<span class="hljs-comment">// 在范围的起始位置插入一个节点</span>\n<span class="hljs-keyword">const</span> newNode = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">&#x27;span&#x27;</span>);\nnewNode.<span class="hljs-property">textContent</span> = <span class="hljs-string">&#x27;新插入的节点&#x27;</span>;\nrange.<span class="hljs-title function_">insertNode</span>(newNode);\n\n<span class="hljs-comment">// 用一个节点包裹范围表示的内容</span>\n<span class="hljs-keyword">const</span> wrapperNode = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">&#x27;div&#x27;</span>);\nrange.<span class="hljs-title function_">surroundContents</span>(wrapperNode);\n</code></pre>\n<h3>四、注意事项</h3>\n<ol>\n<li><strong>浏览器兼容性</strong>  ：<code>document.createRange()</code> 在现代浏览器中广泛支持，但在某些旧版浏览器中可能存在差异。</li>\n<li><strong>范围边界</strong>  ：在创建范围后，需要设置其边界点（起点和终点）才能使用大多数方法。</li>\n<li><strong>DOM 操作</strong>  ：使用 <code>Range</code> 对象进行 DOM 操作时，需要注意对 DOM 树的影响，避免不必要的重排和重绘。</li>\n</ol>\n<h3>五、总结</h3>\n<p><code>document.createRange()</code> 是创建和操作文档范围的重要方法。通过 <code>Range</code> 对象，开发者可以精确地选择和操作文档中的特定部分，实现复杂的文本编辑和 DOM 操作功能。掌握 <code>document.createRange()</code> 和 <code>Range</code> 对象的使用，对于开发富文本编辑器、文本处理工具等具有重要意义。</p>\n</div>'</script></body></html>