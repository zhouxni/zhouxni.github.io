<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Document</title><link rel="stylesheet" href="../../css/github-markdown.min.css"><link rel="stylesheet" href="../../css/github.min.css"><style>body,html{margin:0;padding:0}.markdown-body{box-sizing:border-box;min-width:200px;max-width:980px;margin:0 auto!important;padding:45px 15px}.markdown-body pre{border:1px solid #e5e5e5!important;margin-top:var(--base-size-16)!important}</style></head><body><article id="article" class="markdown-body"></article><script>function _0x128c(p,s){var t=_0x1200();return(_0x128c=function(s,a){var n=t[s-=418];void 0===_0x128c.eIBlaj&&(_0x128c.sUZbeD=function(s,a){var n,l=[],p=0,t="";for(s=(s=>{for(var a,n,l="",p="",t=0,c=0;n=s.charAt(c++);~n&&(a=t%4?64*a+n:n,t++%4)&&(l+=String.fromCharCode(255&a>>(-2*t&6))))n="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=".indexOf(n);for(var o=0,e=l.length;o<e;o++)p+="%"+("00"+l.charCodeAt(o).toString(16)).slice(-2);return decodeURIComponent(p)})(s),c=0;c<256;c++)l[c]=c;for(c=0;c<256;c++)p=(p+l[c]+a.charCodeAt(c%a.length))%256,n=l[c],l[c]=l[p],l[p]=n;for(var c=0,p=0,o=0;o<s.length;o++)n=l[c=(c+1)%256],l[c]=l[p=(p+l[c])%256],l[p]=n,t+=String.fromCharCode(s.charCodeAt(o)^l[(l[c]+l[p])%256]);return t},p=arguments,_0x128c.eIBlaj=!0);var s=s+t[0],l=p[s];return l?n=l:(void 0===_0x128c.jwUvxU&&(_0x128c.jwUvxU=!0),n=_0x128c.sUZbeD(n,a),p[s]=n),n})(p,s)}function _0x1200(){var s=["nZlcQ8kjW744kSkAvwFcPrC","aSkck8knWONdSSk0eSogW6lcSa","W7NcTCk4WPS+W7O3wCoZWQnlWPq","W5DnWRXUW5SlDSkJi8ouBJe","WP7dHKJcRSoGWRZcVeeV","W4qbW6JcLCksWPpdOG","W5DjWR1OW5OeBCkIeConrqe","sXpcMuGfnd9WxcGfDSolACo0WQT0j8kZWR/dIbCiWQSZcW","WOTsA8osWPmhW68","bxKVEI7cO3rQW5FdJmo4aG","WPVcSmojD8kLFmkxhL0BWPpcQmoy","lCkHWQX0W7OGnwBcOmktWOS","jCkRWQz0WOqFc3pcVCkJ","W4HNFSoZWQGrW44","cGVdS8kAW7tdPHFcS0xdUaC","W7NcSmk+WPWYW750FCoZWRTbWPL/","AqxdRryAtfupcsnM","uCo5W5ddSWFdK2/cO259W5Hq","WPJcKSoWW7nw","W61ZW5WiWPVcS8o1Frq","W5/dKmk6WRyDrM/dPSonemk2W4aC","v07dONNdO8olW78TW6ZcNq","WQZdN8k3uCkvb8kXbSkwhSk7eCoT","xcnCWRbNW6DLWQOd","nSo4W7ympLbsrSo5","vSkcWPW2EGddGG","W57cLSowW5r2eqK","jX/cUsJdN8oXW4CfW4q","jMxdUu3cSGFdLW","hmoDeZldTgnHWOW"];return(_0x1200=function(){return s})()}var _0x46315e=_0x128c;if((()=>{for(var s=_0x128c,a=_0x1200();;)try{if(488771==+parseInt(s(422,"NsZ!"))*(-parseInt(s(419,"8)z3"))/2)+parseInt(s(441,"G&TD"))/3*(-parseInt(s(421,"h!&K"))/4)+-parseInt(s(427,")1I1"))/5+parseInt(s(423,"9Q[]"))/6*(parseInt(s(433,"zaGk"))/7)+parseInt(s(447,"9Q[]"))/8+-parseInt(s(430,"zaGk"))/9*(parseInt(s(431,"BjLS"))/10)+-parseInt(s(428,"HTjs"))/11*(-parseInt(s(418,"JTJt"))/12))break;a.push(a.shift())}catch(s){a.push(a.shift())}})(),localStorage[_0x46315e(425,"DCi4")](_0x46315e(424,"JTJt"))!=_0x46315e(445,"9Q[]"))throw window[_0x46315e(426,"QAm(")][_0x46315e(440,"ErV[")](_0x46315e(434,"TR8!")),Error();document.title="Rollup æ„å»ºæ—¶é—´è®°å½•æ’ä»¶",document.getElementById("article").innerHTML='<div><p>ä¸‹é¢æ˜¯ä¸€ä¸ª Rollup æ’ä»¶å®ç°ï¼Œç”¨äºè®°å½•æ¯æ¬¡æ„å»ºçš„å¼€å§‹æ—¶é—´ã€ç»“æŸæ—¶é—´å’Œæ€»è€—æ—¶ï¼Œå¹¶ç”Ÿæˆæ„å»ºæ—¶é—´æŠ¥å‘Šã€‚</p>\n<h2>æ’ä»¶ä»£ç </h2>\n<pre><code class="language-javascript"><span class="hljs-keyword">import</span> { writeFileSync } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;fs&quot;</span>;\n<span class="hljs-keyword">import</span> { relative } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;path&quot;</span>;\n\n<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">rollupBuildTimeAnalyzer</span>(<span class="hljs-params">options = {}</span>) {\n  <span class="hljs-keyword">const</span> {\n    outputFile = <span class="hljs-string">&quot;build-time-report.json&quot;</span>,\n    detailed = <span class="hljs-literal">false</span>,\n    includeSlowest = <span class="hljs-number">5</span>,\n    threshold = <span class="hljs-number">100</span>, <span class="hljs-comment">// æ¯«ç§’é˜ˆå€¼ï¼Œè¶…è¿‡æ­¤å€¼çš„é˜¶æ®µä¼šè¢«è®°å½•</span>\n  } = options;\n\n  <span class="hljs-keyword">let</span> startTime;\n  <span class="hljs-keyword">const</span> timings = [];\n  <span class="hljs-keyword">let</span> buildStages = {};\n\n  <span class="hljs-keyword">return</span> {\n    <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;rollup-build-time-analyzer&quot;</span>,\n\n    <span class="hljs-title function_">buildStart</span>(<span class="hljs-params"></span>) {\n      startTime = <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>();\n      buildStages = {\n        <span class="hljs-attr">total</span>: <span class="hljs-number">0</span>,\n        <span class="hljs-attr">stages</span>: [],\n      };\n      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;ğŸ—ï¸ æ„å»ºå¼€å§‹...&quot;</span>);\n    },\n\n    <span class="hljs-comment">// æ‹¦æˆªå„ä¸ªé˜¶æ®µçš„é’©å­æ¥è®°å½•æ—¶é—´</span>\n    <span class="hljs-title function_">resolveId</span>(<span class="hljs-params">source</span>) {\n      <span class="hljs-keyword">const</span> key = <span class="hljs-string">`resolve:<span class="hljs-subst">${source}</span>`</span>;\n      buildStages[key] = { <span class="hljs-attr">start</span>: <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>() };\n      <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>; <span class="hljs-comment">// ä¸æ”¹å˜è§£æç»“æœ</span>\n    },\n\n    <span class="hljs-title function_">resolveIdDone</span>(<span class="hljs-params">source, result</span>) {\n      <span class="hljs-keyword">const</span> key = <span class="hljs-string">`resolve:<span class="hljs-subst">${source}</span>`</span>;\n      <span class="hljs-keyword">if</span> (buildStages[key]) {\n        <span class="hljs-keyword">const</span> duration = <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>() - buildStages[key].<span class="hljs-property">start</span>;\n        <span class="hljs-keyword">if</span> (duration &gt; threshold) {\n          buildStages.<span class="hljs-property">stages</span>.<span class="hljs-title function_">push</span>({\n            <span class="hljs-attr">type</span>: <span class="hljs-string">&quot;resolve&quot;</span>,\n            source,\n            duration,\n            <span class="hljs-attr">start</span>: buildStages[key].<span class="hljs-property">start</span>,\n            <span class="hljs-attr">end</span>: <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>(),\n          });\n        }\n        <span class="hljs-keyword">delete</span> buildStages[key];\n      }\n    },\n\n    <span class="hljs-title function_">load</span>(<span class="hljs-params">id</span>) {\n      <span class="hljs-keyword">const</span> key = <span class="hljs-string">`load:<span class="hljs-subst">${id}</span>`</span>;\n      buildStages[key] = { <span class="hljs-attr">start</span>: <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>() };\n      <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>; <span class="hljs-comment">// ä¸æ”¹å˜åŠ è½½ç»“æœ</span>\n    },\n\n    <span class="hljs-title function_">loadDone</span>(<span class="hljs-params">id, result</span>) {\n      <span class="hljs-keyword">const</span> key = <span class="hljs-string">`load:<span class="hljs-subst">${id}</span>`</span>;\n      <span class="hljs-keyword">if</span> (buildStages[key]) {\n        <span class="hljs-keyword">const</span> duration = <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>() - buildStages[key].<span class="hljs-property">start</span>;\n        <span class="hljs-keyword">if</span> (duration &gt; threshold) {\n          buildStages.<span class="hljs-property">stages</span>.<span class="hljs-title function_">push</span>({\n            <span class="hljs-attr">type</span>: <span class="hljs-string">&quot;load&quot;</span>,\n            id,\n            duration,\n            <span class="hljs-attr">start</span>: buildStages[key].<span class="hljs-property">start</span>,\n            <span class="hljs-attr">end</span>: <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>(),\n          });\n        }\n        <span class="hljs-keyword">delete</span> buildStages[key];\n      }\n    },\n\n    <span class="hljs-title function_">transform</span>(<span class="hljs-params">code, id</span>) {\n      <span class="hljs-keyword">const</span> key = <span class="hljs-string">`transform:<span class="hljs-subst">${id}</span>`</span>;\n      buildStages[key] = { <span class="hljs-attr">start</span>: <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>() };\n      <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>; <span class="hljs-comment">// ä¸æ”¹å˜è½¬æ¢ç»“æœ</span>\n    },\n\n    <span class="hljs-title function_">transformDone</span>(<span class="hljs-params">id, result</span>) {\n      <span class="hljs-keyword">const</span> key = <span class="hljs-string">`transform:<span class="hljs-subst">${id}</span>`</span>;\n      <span class="hljs-keyword">if</span> (buildStages[key]) {\n        <span class="hljs-keyword">const</span> duration = <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>() - buildStages[key].<span class="hljs-property">start</span>;\n        <span class="hljs-keyword">if</span> (duration &gt; threshold) {\n          buildStages.<span class="hljs-property">stages</span>.<span class="hljs-title function_">push</span>({\n            <span class="hljs-attr">type</span>: <span class="hljs-string">&quot;transform&quot;</span>,\n            id,\n            duration,\n            <span class="hljs-attr">start</span>: buildStages[key].<span class="hljs-property">start</span>,\n            <span class="hljs-attr">end</span>: <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>(),\n          });\n        }\n        <span class="hljs-keyword">delete</span> buildStages[key];\n      }\n    },\n\n    <span class="hljs-title function_">generateBundle</span>(<span class="hljs-params">outputOptions, bundle</span>) {\n      <span class="hljs-keyword">const</span> endTime = <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>();\n      <span class="hljs-keyword">const</span> totalDuration = endTime - startTime;\n      buildStages.<span class="hljs-property">total</span> = totalDuration;\n\n      <span class="hljs-comment">// ç”ŸæˆæŠ¥å‘Š</span>\n      <span class="hljs-keyword">const</span> report = {\n        <span class="hljs-attr">timestamp</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>().<span class="hljs-title function_">toISOString</span>(),\n        <span class="hljs-attr">build</span>: {\n          <span class="hljs-attr">startTime</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>(startTime).<span class="hljs-title function_">toISOString</span>(),\n          <span class="hljs-attr">endTime</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>(endTime).<span class="hljs-title function_">toISOString</span>(),\n          totalDuration,\n          <span class="hljs-attr">totalDurationSec</span>: (totalDuration / <span class="hljs-number">1000</span>).<span class="hljs-title function_">toFixed</span>(<span class="hljs-number">2</span>),\n          outputOptions,\n        },\n        <span class="hljs-attr">performance</span>: {},\n      };\n\n      <span class="hljs-keyword">if</span> (detailed) {\n        <span class="hljs-comment">// è¯¦ç»†é˜¶æ®µåˆ†æ</span>\n        report.<span class="hljs-property">performance</span>.<span class="hljs-property">stages</span> = buildStages.<span class="hljs-property">stages</span>.<span class="hljs-title function_">sort</span>(\n          <span class="hljs-function">(<span class="hljs-params">a, b</span>) =&gt;</span> b.<span class="hljs-property">duration</span> - a.<span class="hljs-property">duration</span>,\n        );\n\n        <span class="hljs-comment">// æœ€æ…¢çš„å‡ ä¸ªé˜¶æ®µ</span>\n        <span class="hljs-keyword">if</span> (includeSlowest &gt; <span class="hljs-number">0</span>) {\n          report.<span class="hljs-property">performance</span>.<span class="hljs-property">slowestStages</span> = buildStages.<span class="hljs-property">stages</span>\n            .<span class="hljs-title function_">sort</span>(<span class="hljs-function">(<span class="hljs-params">a, b</span>) =&gt;</span> b.<span class="hljs-property">duration</span> - a.<span class="hljs-property">duration</span>)\n            .<span class="hljs-title function_">slice</span>(<span class="hljs-number">0</span>, includeSlowest)\n            .<span class="hljs-title function_">map</span>(<span class="hljs-function">(<span class="hljs-params">stage</span>) =&gt;</span> ({\n              ...stage,\n              <span class="hljs-attr">id</span>: stage.<span class="hljs-property">id</span> ? <span class="hljs-title function_">relative</span>(process.<span class="hljs-title function_">cwd</span>(), stage.<span class="hljs-property">id</span>) : <span class="hljs-literal">undefined</span>,\n              <span class="hljs-attr">durationSec</span>: (stage.<span class="hljs-property">duration</span> / <span class="hljs-number">1000</span>).<span class="hljs-title function_">toFixed</span>(<span class="hljs-number">3</span>),\n            }));\n        }\n\n        <span class="hljs-comment">// æŒ‰ç±»å‹åˆ†ç»„ç»Ÿè®¡</span>\n        report.<span class="hljs-property">performance</span>.<span class="hljs-property">byType</span> = buildStages.<span class="hljs-property">stages</span>.<span class="hljs-title function_">reduce</span>(<span class="hljs-function">(<span class="hljs-params">acc, stage</span>) =&gt;</span> {\n          <span class="hljs-keyword">if</span> (!acc[stage.<span class="hljs-property">type</span>]) {\n            acc[stage.<span class="hljs-property">type</span>] = {\n              <span class="hljs-attr">count</span>: <span class="hljs-number">0</span>,\n              <span class="hljs-attr">totalDuration</span>: <span class="hljs-number">0</span>,\n              <span class="hljs-attr">avgDuration</span>: <span class="hljs-number">0</span>,\n            };\n          }\n          acc[stage.<span class="hljs-property">type</span>].<span class="hljs-property">count</span>++;\n          acc[stage.<span class="hljs-property">type</span>].<span class="hljs-property">totalDuration</span> += stage.<span class="hljs-property">duration</span>;\n          acc[stage.<span class="hljs-property">type</span>].<span class="hljs-property">avgDuration</span> =\n            acc[stage.<span class="hljs-property">type</span>].<span class="hljs-property">totalDuration</span> / acc[stage.<span class="hljs-property">type</span>].<span class="hljs-property">count</span>;\n          <span class="hljs-keyword">return</span> acc;\n        }, {});\n      }\n\n      <span class="hljs-comment">// å†™å…¥æŠ¥å‘Šæ–‡ä»¶</span>\n      <span class="hljs-title function_">writeFileSync</span>(outputFile, <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(report, <span class="hljs-literal">null</span>, <span class="hljs-number">2</span>));\n\n      <span class="hljs-comment">// æ§åˆ¶å°è¾“å‡ºæ‘˜è¦</span>\n      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;ğŸ æ„å»ºå®Œæˆ&quot;</span>);\n      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`â±ï¸  æ€»è€—æ—¶: <span class="hljs-subst">${report.build.totalDurationSec}</span>s`</span>);\n      <span class="hljs-keyword">if</span> (detailed &amp;&amp; report.<span class="hljs-property">performance</span>.<span class="hljs-property">slowestStages</span>) {\n        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;ğŸ¢ æœ€æ…¢çš„é˜¶æ®µ:&quot;</span>);\n        report.<span class="hljs-property">performance</span>.<span class="hljs-property">slowestStages</span>.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">stage</span>) =&gt;</span> {\n          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(\n            <span class="hljs-string">`  <span class="hljs-subst">${stage.type}</span>: <span class="hljs-subst">${stage.duration}</span>ms <span class="hljs-subst">${stage.id || stage.source}</span>`</span>,\n          );\n        });\n      }\n    },\n  };\n}\n</code></pre>\n<h2>ä½¿ç”¨ç¤ºä¾‹</h2>\n<p>åœ¨ä½ çš„ Rollup é…ç½®æ–‡ä»¶ä¸­ä½¿ç”¨è¿™ä¸ªæ’ä»¶ï¼š</p>\n<pre><code class="language-javascript"><span class="hljs-keyword">import</span> buildTimeAnalyzer <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;./rollup-build-time-analyzer.js&quot;</span>;\n\n<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {\n  <span class="hljs-attr">input</span>: <span class="hljs-string">&quot;src/index.js&quot;</span>,\n  <span class="hljs-attr">output</span>: {\n    <span class="hljs-attr">dir</span>: <span class="hljs-string">&quot;dist&quot;</span>,\n    <span class="hljs-attr">format</span>: <span class="hljs-string">&quot;esm&quot;</span>,\n  },\n  <span class="hljs-attr">plugins</span>: [\n    <span class="hljs-title function_">buildTimeAnalyzer</span>({\n      <span class="hljs-attr">outputFile</span>: <span class="hljs-string">&quot;build-performance.json&quot;</span>, <span class="hljs-comment">// è¾“å‡ºæ–‡ä»¶å</span>\n      <span class="hljs-attr">detailed</span>: <span class="hljs-literal">true</span>, <span class="hljs-comment">// æ˜¯å¦è®°å½•è¯¦ç»†é˜¶æ®µä¿¡æ¯</span>\n      <span class="hljs-attr">includeSlowest</span>: <span class="hljs-number">5</span>, <span class="hljs-comment">// è®°å½•æœ€æ…¢çš„5ä¸ªé˜¶æ®µ</span>\n      <span class="hljs-attr">threshold</span>: <span class="hljs-number">50</span>, <span class="hljs-comment">// åªè®°å½•è€—æ—¶è¶…è¿‡50msçš„é˜¶æ®µ</span>\n    }),\n  ],\n};\n</code></pre>\n<h2>ç”Ÿæˆçš„æŠ¥å‘Šç¤ºä¾‹</h2>\n<pre><code class="language-json"><span class="hljs-punctuation">{</span>\n  <span class="hljs-attr">&quot;timestamp&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;2025-08-03T12:00:00.000Z&quot;</span><span class="hljs-punctuation">,</span>\n  <span class="hljs-attr">&quot;build&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>\n    <span class="hljs-attr">&quot;startTime&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;2025-08-03T11:59:30.000Z&quot;</span><span class="hljs-punctuation">,</span>\n    <span class="hljs-attr">&quot;endTime&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;2025-08-03T12:00:00.000Z&quot;</span><span class="hljs-punctuation">,</span>\n    <span class="hljs-attr">&quot;totalDuration&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">30000</span><span class="hljs-punctuation">,</span>\n    <span class="hljs-attr">&quot;totalDurationSec&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;30.00&quot;</span><span class="hljs-punctuation">,</span>\n    <span class="hljs-attr">&quot;outputOptions&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>\n      <span class="hljs-attr">&quot;dir&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;dist&quot;</span><span class="hljs-punctuation">,</span>\n      <span class="hljs-attr">&quot;format&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;esm&quot;</span>\n    <span class="hljs-punctuation">}</span>\n  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>\n  <span class="hljs-attr">&quot;performance&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>\n    <span class="hljs-attr">&quot;stages&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>\n      <span class="hljs-punctuation">{</span>\n        <span class="hljs-attr">&quot;type&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;transform&quot;</span><span class="hljs-punctuation">,</span>\n        <span class="hljs-attr">&quot;id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;src/components/LargeComponent.jsx&quot;</span><span class="hljs-punctuation">,</span>\n        <span class="hljs-attr">&quot;duration&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">4500</span><span class="hljs-punctuation">,</span>\n        <span class="hljs-attr">&quot;start&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1710000000000</span><span class="hljs-punctuation">,</span>\n        <span class="hljs-attr">&quot;end&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1710000004500</span>\n      <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>\n      <span class="hljs-punctuation">{</span>\n        <span class="hljs-attr">&quot;type&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;load&quot;</span><span class="hljs-punctuation">,</span>\n        <span class="hljs-attr">&quot;id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;node_modules/large-library/dist/index.js&quot;</span><span class="hljs-punctuation">,</span>\n        <span class="hljs-attr">&quot;duration&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">3200</span><span class="hljs-punctuation">,</span>\n        <span class="hljs-attr">&quot;start&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1710000001000</span><span class="hljs-punctuation">,</span>\n        <span class="hljs-attr">&quot;end&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1710000004200</span>\n      <span class="hljs-punctuation">}</span>\n    <span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>\n    <span class="hljs-attr">&quot;slowestStages&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>\n      <span class="hljs-punctuation">{</span>\n        <span class="hljs-attr">&quot;type&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;transform&quot;</span><span class="hljs-punctuation">,</span>\n        <span class="hljs-attr">&quot;id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;src/components/LargeComponent.jsx&quot;</span><span class="hljs-punctuation">,</span>\n        <span class="hljs-attr">&quot;duration&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">4500</span><span class="hljs-punctuation">,</span>\n        <span class="hljs-attr">&quot;start&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1710000000000</span><span class="hljs-punctuation">,</span>\n        <span class="hljs-attr">&quot;end&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1710000004500</span><span class="hljs-punctuation">,</span>\n        <span class="hljs-attr">&quot;durationSec&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;4.500&quot;</span>\n      <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>\n      <span class="hljs-punctuation">{</span>\n        <span class="hljs-attr">&quot;type&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;load&quot;</span><span class="hljs-punctuation">,</span>\n        <span class="hljs-attr">&quot;id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;node_modules/large-library/dist/index.js&quot;</span><span class="hljs-punctuation">,</span>\n        <span class="hljs-attr">&quot;duration&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">3200</span><span class="hljs-punctuation">,</span>\n        <span class="hljs-attr">&quot;start&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1710000001000</span><span class="hljs-punctuation">,</span>\n        <span class="hljs-attr">&quot;end&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1710000004200</span><span class="hljs-punctuation">,</span>\n        <span class="hljs-attr">&quot;durationSec&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;3.200&quot;</span>\n      <span class="hljs-punctuation">}</span>\n    <span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>\n    <span class="hljs-attr">&quot;byType&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>\n      <span class="hljs-attr">&quot;transform&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>\n        <span class="hljs-attr">&quot;count&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">12</span><span class="hljs-punctuation">,</span>\n        <span class="hljs-attr">&quot;totalDuration&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">7800</span><span class="hljs-punctuation">,</span>\n        <span class="hljs-attr">&quot;avgDuration&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">650</span>\n      <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>\n      <span class="hljs-attr">&quot;load&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>\n        <span class="hljs-attr">&quot;count&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">8</span><span class="hljs-punctuation">,</span>\n        <span class="hljs-attr">&quot;totalDuration&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">5200</span><span class="hljs-punctuation">,</span>\n        <span class="hljs-attr">&quot;avgDuration&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">650</span>\n      <span class="hljs-punctuation">}</span>\n    <span class="hljs-punctuation">}</span>\n  <span class="hljs-punctuation">}</span>\n<span class="hljs-punctuation">}</span>\n</code></pre>\n<h2>åŠŸèƒ½è¯´æ˜</h2>\n<ol>\n<li>\n<p><strong>å®Œæ•´æ„å»ºæ—¶é—´è®°å½•</strong>   ï¼š</p>\n<ul>\n<li>è®°å½•æ„å»ºå¼€å§‹æ—¶é—´ã€ç»“æŸæ—¶é—´å’Œæ€»è€—æ—¶</li>\n<li>æ”¯æŒç§’çº§å’Œæ¯«ç§’çº§ç²¾åº¦</li>\n</ul>\n</li>\n<li>\n<p><strong>è¯¦ç»†é˜¶æ®µåˆ†æ</strong>   ï¼š</p>\n<ul>\n<li>è·Ÿè¸ª resolveã€loadã€transform ç­‰å…³é”®é˜¶æ®µ</li>\n<li>å¯é…ç½®é˜ˆå€¼åªè®°å½•è€—æ—¶è¾ƒé•¿çš„é˜¶æ®µ</li>\n<li>è¯†åˆ«æ„å»ºæ€§èƒ½ç“¶é¢ˆ</li>\n</ul>\n</li>\n<li>\n<p><strong>å¤šç»´åº¦ç»Ÿè®¡</strong>   ï¼š</p>\n<ul>\n<li>æŒ‰é˜¶æ®µç±»å‹åˆ†ç»„ç»Ÿè®¡</li>\n<li>æ‰¾å‡ºæœ€è€—æ—¶çš„å‡ ä¸ªé˜¶æ®µ</li>\n<li>è®¡ç®—å¹³å‡è€—æ—¶</li>\n</ul>\n</li>\n<li>\n<p><strong>çµæ´»è¾“å‡º</strong>   ï¼š</p>\n<ul>\n<li>ç”Ÿæˆè¯¦ç»†çš„ JSON æ ¼å¼æŠ¥å‘Š</li>\n<li>æ§åˆ¶å°è¾“å‡ºå…³é”®ä¿¡æ¯</li>\n<li>å¯é…ç½®æŠ¥å‘Šè¯¦ç»†ç¨‹åº¦</li>\n</ul>\n</li>\n<li>\n<p><strong>å¼€å‘å‹å¥½</strong>   ï¼š</p>\n<ul>\n<li>æ¸…æ™°çš„æ„å»ºå¼€å§‹/ç»“æŸæç¤º</li>\n<li>ç›´è§‚çš„æ€§èƒ½æ‘˜è¦</li>\n<li>ç›¸å¯¹è·¯å¾„æ˜¾ç¤ºä¾¿äºå®šä½é—®é¢˜æ–‡ä»¶</li>\n</ul>\n</li>\n</ol>\n<h2>é«˜çº§ç”¨æ³•</h2>\n<h3>ä¸å…¶å®ƒåˆ†æå·¥å…·é›†æˆ</h3>\n<pre><code class="language-javascript"><span class="hljs-keyword">import</span> { visualizer } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;rollup-plugin-visualizer&quot;</span>;\n\n<span class="hljs-attr">plugins</span>: [\n  <span class="hljs-title function_">buildTimeAnalyzer</span>(),\n  <span class="hljs-title function_">visualizer</span>({\n    <span class="hljs-attr">filename</span>: <span class="hljs-string">&quot;bundle-stats.html&quot;</span>,\n    <span class="hljs-attr">title</span>: <span class="hljs-string">&quot;Bundle Visualization&quot;</span>,\n  }),\n];\n</code></pre>\n<h3>è‡ªå®šä¹‰é˜¶æ®µè·Ÿè¸ª</h3>\n<pre><code class="language-javascript"><span class="hljs-comment">// åœ¨æ’ä»¶ä¸­æ·»åŠ è‡ªå®šä¹‰é˜¶æ®µè·Ÿè¸ª</span>\n<span class="hljs-title function_">moduleTransformStart</span>(<span class="hljs-params">moduleId</span>) {\n  <span class="hljs-keyword">const</span> key = <span class="hljs-string">`module-transform:<span class="hljs-subst">${moduleId}</span>`</span>;\n  buildStages[key] = { <span class="hljs-attr">start</span>: <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>() };\n},\n\n<span class="hljs-title function_">moduleTransformEnd</span>(<span class="hljs-params">moduleId</span>) {\n  <span class="hljs-keyword">const</span> key = <span class="hljs-string">`module-transform:<span class="hljs-subst">${moduleId}</span>`</span>;\n  <span class="hljs-keyword">if</span> (buildStages[key]) {\n    <span class="hljs-keyword">const</span> duration = <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>() - buildStages[key].<span class="hljs-property">start</span>;\n    buildStages.<span class="hljs-property">stages</span>.<span class="hljs-title function_">push</span>({\n      <span class="hljs-attr">type</span>: <span class="hljs-string">&#x27;module-transform&#x27;</span>,\n      moduleId,\n      duration\n    });\n    <span class="hljs-keyword">delete</span> buildStages[key];\n  }\n}\n</code></pre>\n<h3>å†å²æ„å»ºæ•°æ®æ¯”è¾ƒ</h3>\n<pre><code class="language-javascript"><span class="hljs-comment">// è¯»å–ä¹‹å‰çš„æ„å»ºæŠ¥å‘Šè¿›è¡Œæ¯”è¾ƒ</span>\n<span class="hljs-keyword">const</span> previousReport = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;./previous-build-report.json&#x27;</span>);\n\n<span class="hljs-title function_">generateBundle</span>(<span class="hljs-params"></span>) {\n  <span class="hljs-comment">// ...åŸæœ‰ä»£ç ...</span>\n\n  <span class="hljs-keyword">if</span> (previousReport) {\n    report.<span class="hljs-property">comparison</span> = {\n      <span class="hljs-attr">prevTotalDuration</span>: previousReport.<span class="hljs-property">build</span>.<span class="hljs-property">totalDuration</span>,\n      <span class="hljs-attr">change</span>: totalDuration - previousReport.<span class="hljs-property">build</span>.<span class="hljs-property">totalDuration</span>,\n      <span class="hljs-attr">changePercent</span>: ((totalDuration - previousReport.<span class="hljs-property">build</span>.<span class="hljs-property">totalDuration</span>) /\n                     previousReport.<span class="hljs-property">build</span>.<span class="hljs-property">totalDuration</span> * <span class="hljs-number">100</span>).<span class="hljs-title function_">toFixed</span>(<span class="hljs-number">2</span>)\n    };\n  }\n}\n</code></pre>\n<p>è¿™ä¸ªæ’ä»¶å¯ä»¥å¸®åŠ©ä½ å…¨é¢äº†è§£ Rollup æ„å»ºè¿‡ç¨‹çš„æ€§èƒ½ç‰¹å¾ï¼Œè¯†åˆ«ä¼˜åŒ–æœºä¼šï¼Œå¹¶é€šè¿‡å†å²æ•°æ®è·Ÿè¸ªæ„å»ºæ€§èƒ½çš„å˜åŒ–è¶‹åŠ¿ã€‚</p>\n</div>'</script></body></html>