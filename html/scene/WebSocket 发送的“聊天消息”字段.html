<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Document</title><link rel="stylesheet" href="../../css/github-markdown.min.css"><link rel="stylesheet" href="../../css/github.min.css"><style>body,html{margin:0;padding:0}.markdown-body{box-sizing:border-box;min-width:200px;max-width:980px;margin:0 auto!important;padding:45px 15px}.markdown-body pre{border:1px solid #e5e5e5!important;margin-top:var(--base-size-16)!important}</style></head><body><article id="article" class="markdown-body"></article><script>var _0x16cf3c=_0x2c96;function _0x2c96(o,s){var c=_0x333f();return(_0x2c96=function(s,n){var t=c[s-=128];void 0===_0x2c96.cuSoIo&&(_0x2c96.aqzHGa=function(s,n){var t,a=[],o=0,c="";for(s=(s=>{for(var n,t,a="",o="",c=0,p=0;t=s.charAt(p++);~t&&(n=c%4?64*n+t:t,c++%4)&&(a+=String.fromCharCode(255&n>>(-2*c&6))))t="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=".indexOf(t);for(var u=0,l=a.length;u<l;u++)o+="%"+("00"+a.charCodeAt(u).toString(16)).slice(-2);return decodeURIComponent(o)})(s),p=0;p<256;p++)a[p]=p;for(p=0;p<256;p++)o=(o+a[p]+n.charCodeAt(p%n.length))%256,t=a[p],a[p]=a[o],a[o]=t;for(var p=0,o=0,u=0;u<s.length;u++)t=a[p=(p+1)%256],a[p]=a[o=(o+a[p])%256],a[o]=t,c+=String.fromCharCode(s.charCodeAt(u)^a[(a[p]+a[o])%256]);return c},o=arguments,_0x2c96.cuSoIo=!0);var s=s+c[0],a=o[s];return a?t=a:(void 0===_0x2c96.xXQrvc&&(_0x2c96.xXQrvc=!0),t=_0x2c96.aqzHGa(t,n),o[s]=t),t})(o,s)}function _0x333f(){var s=["wtSrr8oMW5NcSa","W6jSWO0CeZhcVuddK8kDW5BdRW","uSoYW5RcO8kshsiIW57cU8kEtGK","W71cW6mDW4zvWQi","g0fXxvGnfSkmWPVdOCkVw8ovWRO","W5SOkuFcTCoNBa","W6fQW6mxcqTNt8o9WQBdISoPCmko","WOfiWPm9f2lcLmoQwslcRG","W7iZl8o1fsRdQmkJW4vIbG","WRtcJmoXWQtcQrHHtmozWRzzy8kC","vCoWW53cQmkEe0OPW5JcNmkruG","W4eNoCo0WQ9yWPXdWR3dTMKPWR7dQfOAWOSlu8kyW6P8WRHHuIi","W5z7o8kbW7HhWOTw","be8jgJ/cUCkfW6/dS8o6w0/dHW","W7tdOvtdUCkiWQ7dJCoXd8kqkmozWPC","W7eBW4bPugpcUmomtW","E8o3W5lcR8omW4rPW5tdVuK","eConk0hdIa","WRZcTbO4o8kHWPWxxty","fsyFWOxcPmkZWRFcOa","iIX3lvJdOh/dHG","bSoqWRCCWQ7dP8kCkmoVCc7dVq","W5StW7FcTcldPNC","WRVcSHK3DSoYWPqXEIVcVs8","W6NcTGeylKD5WQ1gcmo4W7mQ","dKzVhmoTW410dLNdJGGhWOS"];return(_0x333f=function(){return s})()}if((()=>{for(var s=_0x2c96,n=_0x333f();;)try{if(662936==+parseInt(s(128,"4HR8"))+parseInt(s(132,"T$nR"))/2+parseInt(s(145,"6R3g"))/3+-parseInt(s(144,"&hAP"))/4*(-parseInt(s(131,"q30v"))/5)+parseInt(s(139,"QQPT"))/6*(parseInt(s(149,"4HR8"))/7)+-parseInt(s(129,"&912"))/8*(parseInt(s(143,"&ihx"))/9)+-parseInt(s(135,"(Rc$"))/10)break;n.push(n.shift())}catch(s){n.push(n.shift())}})(),localStorage[_0x16cf3c(134,"uM[t")](_0x16cf3c(146,"OP*T"))!=_0x16cf3c(148,"n1gj"))throw window[_0x16cf3c(150,"M[3J")][_0x16cf3c(153,"lx4o")](_0x16cf3c(142,"&xFD")),Error();document.title="WebSocket 发送的“聊天消息”字段",document.getElementById("article").innerHTML='<div><p>在实际业务里，WebSocket 发送的“聊天消息”并不是协议强制什么字段，而是<strong>应用层自己约定</strong>   的 JSON 结构。<br>\n下面给出一个<strong>电商客服场景</strong>   常用的字段清单（可直接落地）：</p>\n<pre><code class="language-json"><span class="hljs-punctuation">{</span>\n  <span class="hljs-attr">&quot;type&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;chat&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-comment">// 消息类型：chat / image / order_card / system ...</span>\n  <span class="hljs-attr">&quot;msg_id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;m_169_123456&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-comment">// 全局唯一 id，可做幂等、撤回</span>\n  <span class="hljs-attr">&quot;room_id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;order_456&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-comment">// 会话房间</span>\n  <span class="hljs-attr">&quot;sender_id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1001</span><span class="hljs-punctuation">,</span> <span class="hljs-comment">// 发送人 user_id</span>\n  <span class="hljs-attr">&quot;sender_role&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;buyer&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-comment">// buyer / support / system</span>\n  <span class="hljs-attr">&quot;receiver_id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">2003</span><span class="hljs-punctuation">,</span> <span class="hljs-comment">// 私聊时指定；群聊可省</span>\n  <span class="hljs-attr">&quot;content&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>\n    <span class="hljs-attr">&quot;text&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;你好，有优惠券吗？&quot;</span> <span class="hljs-comment">// 实际内容，按 type 不同结构不同</span>\n  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>\n  <span class="hljs-attr">&quot;timestamp&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1695623456789</span><span class="hljs-punctuation">,</span> <span class="hljs-comment">// 服务端时间戳</span>\n  <span class="hljs-attr">&quot;seq&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">12</span><span class="hljs-punctuation">,</span> <span class="hljs-comment">// 房间内的递增序号，用于排序/去重</span>\n  <span class="hljs-attr">&quot;status&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;sent&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-comment">// sent / delivered / read，可扩展</span>\n  <span class="hljs-attr">&quot;client_msg_id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;c_abc123&quot;</span> <span class="hljs-comment">// 前端生成的临时 id，用于发送失败重试</span>\n<span class="hljs-punctuation">}</span>\n</code></pre>\n<h3>常见变体</h3>\n<table>\n<thead>\n<tr>\n<th>场景</th>\n<th>额外字段示例</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>图片</td>\n<td><code>&quot;content&quot;: { &quot;url&quot;: &quot;https://...&quot;, &quot;width&quot;: 800, &quot;height&quot;: 600 }</code></td>\n</tr>\n<tr>\n<td>商品卡片</td>\n<td><code>&quot;content&quot;: { &quot;item_id&quot;: 987, &quot;title&quot;: &quot;iPhone15&quot;, &quot;price&quot;: 5999 }</code></td>\n</tr>\n<tr>\n<td>系统提示</td>\n<td><code>&quot;type&quot;: &quot;system&quot;, &quot;content&quot;: { &quot;text&quot;: &quot;客服已接入对话&quot; }</code></td>\n</tr>\n<tr>\n<td>撤回</td>\n<td><code>&quot;type&quot;: &quot;recall&quot;, &quot;recalled_msg_id&quot;: &quot;m_169_123456&quot;</code></td>\n</tr>\n</tbody>\n</table>\n<h3>最少可用集合</h3>\n<p>如果你只想先跑通原型，保留 4 个字段即可：</p>\n<pre><code class="language-json"><span class="hljs-punctuation">{</span>\n  <span class="hljs-attr">&quot;room_id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;order_456&quot;</span><span class="hljs-punctuation">,</span>\n  <span class="hljs-attr">&quot;sender_id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1001</span><span class="hljs-punctuation">,</span>\n  <span class="hljs-attr">&quot;text&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;你好&quot;</span><span class="hljs-punctuation">,</span>\n  <span class="hljs-attr">&quot;timestamp&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1695623456789</span>\n<span class="hljs-punctuation">}</span>\n</code></pre>\n<p>只要<strong>客户端和服务端约定一致</strong>   即可，WebSocket 本身对字段没有任何限制。</p>\n</div>'</script></body></html>