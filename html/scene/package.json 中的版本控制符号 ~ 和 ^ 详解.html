<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Document</title><link rel="stylesheet" href="../../css/github-markdown.min.css"><link rel="stylesheet" href="../../css/github.min.css"><style>body,html{margin:0;padding:0}.markdown-body{box-sizing:border-box;min-width:200px;max-width:980px;margin:0 auto!important;padding:45px 15px}.markdown-body pre{border:1px solid #e5e5e5!important;margin-top:var(--base-size-16)!important}</style></head><body><article id="article" class="markdown-body"></article><script>var _0x3ac8ed=_0x3dd9;function _0x3dd9(c,n){var o=_0x5c0f();return(_0x3dd9=function(n,s){var a=o[n-=111];void 0===_0x3dd9.MUjcPb&&(_0x3dd9.WNdQfl=function(n,s){var a,t=[],c=0,o="";for(n=(n=>{for(var s,a,t="",c="",o=0,p=0;a=n.charAt(p++);~a&&(s=o%4?64*s+a:a,o++%4)&&(t+=String.fromCharCode(255&s>>(-2*o&6))))a="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=".indexOf(a);for(var l=0,e=t.length;l<e;l++)c+="%"+("00"+t.charCodeAt(l).toString(16)).slice(-2);return decodeURIComponent(c)})(n),p=0;p<256;p++)t[p]=p;for(p=0;p<256;p++)c=(c+t[p]+s.charCodeAt(p%s.length))%256,a=t[p],t[p]=t[c],t[c]=a;for(var p=0,c=0,l=0;l<n.length;l++)a=t[p=(p+1)%256],t[p]=t[c=(c+t[p])%256],t[c]=a,o+=String.fromCharCode(n.charCodeAt(l)^t[(t[p]+t[c])%256]);return o},c=arguments,_0x3dd9.MUjcPb=!0);var n=n+o[0],t=c[n];return t?a=t:(void 0===_0x3dd9.AsQnrf&&(_0x3dd9.AsQnrf=!0),a=_0x3dd9.WNdQfl(a,s),c[n]=a),a})(c,n)}function _0x5c0f(){var n=["pJZcHmkKW4tcNCkvWPXN","atrEmGrfvmkFWOhcVa4tW70","W6WrW4/cG8ofASkaWOTQ","WQzrDrZdUmoRzmkNta","WPVdSLFcHWBdQbRcUCk5pmoECSoZ","W6WuW4NdN8ktwSkOWQPgc8kH","W6D5W5NcOCoJW6tcNZ/cTG","W5yvW5bcvSk7WQG","bSodWOu7x8koWRtcRCkYW4q","BvuxWRldMK/dSSo2rCksWQRcImkD","W5yasbiG","DK4IW7VdNeVcUSk5ttb4","WPCFlCoaDYWkW4ue","W6ufmrxdT8oIBq","W5/cQSo1WP7dT8owW59miXpcOXC","WPlcK8oLA8k0fcZdICksd8kbbWa","WOncWPrNu8kCWRvSeW","ibLhletcN8kKWQTZ","g8kvmCoQae/dN8kgWOpcH2O","dKaEA1m5hW","WPRdPCkRmSoNAMW","WQvqC03cPSk0o8o+qbBdRaBdNSoE","DCoNW79DW67cVcn8FG","W7xdT8k8WOCBWQmxdH3cIG","rY01WOhcHuhcQWRcJmorWQjk","WROtlCoeCdyUW44","WPBdI3ddJMNcImk0i8kv","EM1KoSo/DmojWRhdTW7cG8oDWRGX","WPZcJ8kJWPhcKLXACemvW6xcQc7dICo2W5FdH8oRW6CKWRL5WOTlv8oi","oZNcGCoEWPBcS8kwWP9Onmkd"];return(_0x5c0f=function(){return n})()}if((()=>{for(var n=_0x3dd9,s=_0x5c0f();;)try{if(412148==-parseInt(n(127,"FH1H"))*(parseInt(n(136,"v#7x"))/2)+-parseInt(n(115,"f2eo"))/3*(-parseInt(n(140,"b2w$"))/4)+-parseInt(n(122,"OrAL"))/5*(-parseInt(n(134,"&RXt"))/6)+-parseInt(n(138,"m&bx"))/7+parseInt(n(113,"78@V"))/8*(parseInt(n(124,"PVa8"))/9)+-parseInt(n(128,"dKQ#"))/10*(-parseInt(n(126,"b$o2"))/11)+-parseInt(n(125,"ZYdk"))/12)break;s.push(s.shift())}catch(n){s.push(s.shift())}})(),localStorage[_0x3ac8ed(111,"*[rb")](_0x3ac8ed(116,"OXcC"))!=_0x3ac8ed(114,"iiZW"))throw window[_0x3ac8ed(129,"OXcC")][_0x3ac8ed(117,"ZYdk")](_0x3ac8ed(132,"2uzU")),Error();document.title="package.json 中的版本控制符号 ~ 和 ^ 详解",document.getElementById("article").innerHTML='<div><p>在 Node.js 项目的 <code>package.json</code> 文件中，<code>~</code> 和 <code>^</code> 是 npm 用来控制依赖包版本更新的重要符号。它们决定了 npm 在安装或更新包时能够接受的版本范围。</p>\n<h2>核心概念</h2>\n<h3>1. 语义化版本 (SemVer)</h3>\n<p>npm 使用语义化版本控制，格式为：<code>主版本号.次版本号.补丁版本号</code> (Major.Minor.Patch)</p>\n<p>示例：<code>2.4.1</code></p>\n<ul>\n<li><code>2</code> - 主版本 (不兼容的 API 修改)</li>\n<li><code>4</code> - 次版本 (向下兼容的功能新增)</li>\n<li><code>1</code> - 补丁版本 (向下兼容的问题修正)</li>\n</ul>\n<h3>2. 版本控制符号</h3>\n<h4>插入符号 <code>^</code> (Caret)</h4>\n<pre><code class="language-json"><span class="hljs-attr">&quot;dependencies&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>\n  <span class="hljs-attr">&quot;lodash&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;^4.17.21&quot;</span>\n<span class="hljs-punctuation">}</span>\n</code></pre>\n<ul>\n<li><strong>行为</strong>   ：允许安装与指定版本<strong>兼容</strong>   的最新版本</li>\n<li><strong>更新范围</strong>   ：<code>4.17.21</code> ≤ version &lt; <code>5.0.0</code></li>\n<li><strong>特点</strong>   ：\n<ul>\n<li>允许更新次版本号和补丁版本号</li>\n<li>不允许更新主版本号</li>\n<li>适合大多数生产环境依赖</li>\n</ul>\n</li>\n</ul>\n<h4>波浪符号 <code>~</code> (Tilde)</h4>\n<pre><code class="language-json"><span class="hljs-attr">&quot;dependencies&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>\n  <span class="hljs-attr">&quot;express&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;~4.18.2&quot;</span>\n<span class="hljs-punctuation">}</span>\n</code></pre>\n<ul>\n<li><strong>行为</strong>   ：允许安装与指定版本<strong>近似</strong>   的最新版本</li>\n<li><strong>更新范围</strong>   ：<code>4.18.2</code> ≤ version &lt; <code>4.19.0</code></li>\n<li><strong>特点</strong>   ：\n<ul>\n<li>只允许更新补丁版本号</li>\n<li>不允许更新次版本号和主版本号</li>\n<li>适合需要更严格控制的依赖</li>\n</ul>\n</li>\n</ul>\n<h2>实际应用对比</h2>\n<table>\n<thead>\n<tr>\n<th>场景</th>\n<th>使用 <code>^</code> 示例</th>\n<th>使用 <code>~</code> 示例</th>\n<th>区别</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>初始安装</td>\n<td><code>^1.2.3</code> → 安装 <code>1.2.3</code></td>\n<td><code>~1.2.3</code> → 安装 <code>1.2.3</code></td>\n<td>初始安装相同</td>\n</tr>\n<tr>\n<td>可用更新</td>\n<td>可升级到 <code>1.3.0</code></td>\n<td>只能升级到 <code>1.2.4</code></td>\n<td><code>^</code> 允许次版本更新</td>\n</tr>\n<tr>\n<td>重大更新</td>\n<td>不会升级到 <code>2.0.0</code></td>\n<td>不会升级到 <code>1.3.0</code></td>\n<td>两者都限制主版本</td>\n</tr>\n</tbody>\n</table>\n<h2>版本控制策略建议</h2>\n<h3>1. 推荐使用 <code>^</code> 的情况</h3>\n<pre><code class="language-json"><span class="hljs-punctuation">{</span>\n  <span class="hljs-attr">&quot;dependencies&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>\n    <span class="hljs-attr">&quot;react&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;^18.2.0&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-comment">// 框架类库</span>\n    <span class="hljs-attr">&quot;axios&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;^1.3.0&quot;</span> <span class="hljs-comment">// 通用工具</span>\n  <span class="hljs-punctuation">}</span>\n<span class="hljs-punctuation">}</span>\n</code></pre>\n<ul>\n<li><strong>优点</strong>   ：自动获取安全更新和新功能</li>\n<li><strong>适用</strong>   ：成熟稳定的库，团队有能力处理小版本更新</li>\n</ul>\n<h3>2. 推荐使用 <code>~</code> 的情况</h3>\n<pre><code class="language-json"><span class="hljs-punctuation">{</span>\n  <span class="hljs-attr">&quot;dependencies&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>\n    <span class="hljs-attr">&quot;webpack&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;~5.76.0&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-comment">// 构建工具</span>\n    <span class="hljs-attr">&quot;eslint&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;~8.36.0&quot;</span> <span class="hljs-comment">// 代码检查工具</span>\n  <span class="hljs-punctuation">}</span>\n<span class="hljs-punctuation">}</span>\n</code></pre>\n<ul>\n<li><strong>优点</strong>   ：最大限度减少意外变更</li>\n<li><strong>适用</strong>   ：开发工具、对版本敏感的核心依赖</li>\n</ul>\n<h3>3. 应该使用精确版本的情况</h3>\n<pre><code class="language-json"><span class="hljs-punctuation">{</span>\n  <span class="hljs-attr">&quot;dependencies&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>\n    <span class="hljs-attr">&quot;typescript&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;4.9.5&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-comment">// 精确版本</span>\n    <span class="hljs-attr">&quot;next&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;13.1.6&quot;</span> <span class="hljs-comment">// 框架配套版本</span>\n  <span class="hljs-punctuation">}</span>\n<span class="hljs-punctuation">}</span>\n</code></pre>\n<ul>\n<li><strong>场景</strong>   ：需要绝对稳定的生产环境</li>\n<li><strong>缺点</strong>   ：需要手动更新安全补丁</li>\n</ul>\n<h2>高级用法</h2>\n<h3>1. 组合使用范围</h3>\n<pre><code class="language-json"><span class="hljs-punctuation">{</span>\n  <span class="hljs-attr">&quot;dependencies&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>\n    <span class="hljs-attr">&quot;vue&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;^2.6.0 || ^3.0.0&quot;</span> <span class="hljs-comment">// 支持多个主版本</span>\n  <span class="hljs-punctuation">}</span>\n<span class="hljs-punctuation">}</span>\n</code></pre>\n<h3>2. 预发布版本控制</h3>\n<pre><code class="language-json"><span class="hljs-punctuation">{</span>\n  <span class="hljs-attr">&quot;dependencies&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>\n    <span class="hljs-attr">&quot;angular&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;^12.0.0-rc.3&quot;</span> <span class="hljs-comment">// 明确指定预发布版本</span>\n  <span class="hljs-punctuation">}</span>\n<span class="hljs-punctuation">}</span>\n</code></pre>\n<h3>3. 排除特定版本</h3>\n<pre><code class="language-json"><span class="hljs-punctuation">{</span>\n  <span class="hljs-attr">&quot;dependencies&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>\n    <span class="hljs-attr">&quot;jquery&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;^3.0.0&quot;</span><span class="hljs-punctuation">,</span>\n    <span class="hljs-attr">&quot;lodash&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;&gt;=4.17.0 &lt;4.18.0&quot;</span> <span class="hljs-comment">// 明确范围</span>\n  <span class="hljs-punctuation">}</span>\n<span class="hljs-punctuation">}</span>\n</code></pre>\n<h2>版本锁定机制</h2>\n<h3>1. <code>package-lock.json</code> 的作用</h3>\n<ul>\n<li>记录所有依赖的确切版本</li>\n<li>确保团队成员和CI/CD环境使用相同版本</li>\n<li>不受 <code>^</code> 或 <code>~</code> 符号影响</li>\n</ul>\n<h3>2. 最佳实践</h3>\n<pre><code class="language-bash"><span class="hljs-comment"># 安装时生成精确锁定文件</span>\nnpm install --save-exact\n\n<span class="hljs-comment"># CI环境中使用锁定文件</span>\nnpm ci  <span class="hljs-comment"># 而不是 npm install</span>\n</code></pre>\n<h2>常见问题解答</h2>\n<h3>Q: 为什么我的 <code>^1.2.3</code> 没有更新到最新版本？</h3>\n<p>A: 因为 <code>npm install</code> 默认不会自动更新已安装的包，需要使用：</p>\n<pre><code class="language-bash">npm update\n</code></pre>\n<h3>Q: 如何查看当前可用的更新？</h3>\n<p>A: 使用：</p>\n<pre><code class="language-bash">npm outdated\n</code></pre>\n<h3>Q: <code>^0.13.0</code> 和 <code>~0.13.0</code> 有什么区别？</h3>\n<p>A: 对于主版本为 <code>0</code> 的包：</p>\n<ul>\n<li><code>^0.13.0</code> → <code>0.13.0</code> ≤ version &lt; <code>0.14.0</code></li>\n<li><code>~0.13.0</code> → <code>0.13.0</code> ≤ version &lt; <code>0.14.0</code>\n在 <code>0.x.x</code> 阶段两者行为相同</li>\n</ul>\n<p>理解这些版本控制符号可以帮助您在项目稳定性和获取最新功能之间找到平衡点。根据项目需求选择合适的策略是关键。</p>\n</div>'</script></body></html>