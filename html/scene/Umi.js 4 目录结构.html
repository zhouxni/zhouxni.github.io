<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Document</title><link rel="stylesheet" href="../../css/github-markdown.min.css"><link rel="stylesheet" href="../../css/github.min.css"><style>body,html{margin:0;padding:0}.markdown-body{box-sizing:border-box;min-width:200px;max-width:980px;margin:0 auto!important;padding:45px 15px}.markdown-body pre{border:1px solid #e5e5e5!important;margin-top:var(--base-size-16)!important}</style></head><body><article id="article" class="markdown-body"></article><script>var _0x4dffaa=_0xda23;function _0xcb65(){var s=["wXxcMby+W5HTxW","s8ouW4FdT8olamkPsmkR","W48FWPRdP29cW4PPeqDBia","W4JcV8kAWQ7cGCkvaCocrCoIW4RdJG","BSkyW45/W4NcJbNcJ8oVW5FcOSoC","WROzWOeDFSkJW44zWPVdMCoKW4K","eWdcUxJcKehcTG","W6G4WOjYW5lcKwe0","yMDAdJdcGWxcIW","dCkiWO3dOtC","W54buCk7WQXpida4W5PIa8ozoa","WRHFpgjzW652WQCkiCk3Aa","jX5hWRWGW7NdL2/cUG","CCkXsSkrW6qdWOjQW7fMW6JdG8oE","W44xWPRdO2PcW5rSmazzdW","nSooWPGSWO7dLXhcQG","r13dUxVcI3tcOISx","W44AWPhdO2rgWODRdILUgmoi","WPvBW5ZcOs9oWP8VgWbLd8o6emoOW4xdVXeYu8o0W5qll8k4za","a1LEd8knrWBdTCkvWP17WQZcL3i","W6T/yCkJWOnzW4a","aCkCW7ldMbKNWQOKet/dHYNcSq","w3iJFdmMW7BcJLC","yMWydJlcQZ7cQWS","y2qBCw7dJ3lcKXdcTIj+W40","eZFdJSovW6dcLvXJ"];return(_0xcb65=function(){return s})()}function _0xda23(l,s){var t=_0xcb65();return(_0xda23=function(s,n){var a=t[s-=266];void 0===_0xda23.KCOpaP&&(_0xda23.TsdukB=function(s,n){var a,e=[],l=0,t="";for(s=(s=>{for(var n,a,e="",l="",t=0,c=0;a=s.charAt(c++);~a&&(n=t%4?64*n+a:a,t++%4)&&(e+=String.fromCharCode(255&n>>(-2*t&6))))a="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=".indexOf(a);for(var o=0,r=e.length;o<r;o++)l+="%"+("00"+e.charCodeAt(o).toString(16)).slice(-2);return decodeURIComponent(l)})(s),c=0;c<256;c++)e[c]=c;for(c=0;c<256;c++)l=(l+e[c]+n.charCodeAt(c%n.length))%256,a=e[c],e[c]=e[l],e[l]=a;for(var c=0,l=0,o=0;o<s.length;o++)a=e[c=(c+1)%256],e[c]=e[l=(l+e[c])%256],e[l]=a,t+=String.fromCharCode(s.charCodeAt(o)^e[(e[c]+e[l])%256]);return t},l=arguments,_0xda23.KCOpaP=!0);var s=s+t[0],e=l[s];return e?a=e:(void 0===_0xda23.xySCkd&&(_0xda23.xySCkd=!0),a=_0xda23.TsdukB(a,n),l[s]=a),a})(l,s)}if((()=>{for(var s=_0xda23,n=_0xcb65();;)try{if(350991==+parseInt(s(278,"[Xkz"))*(parseInt(s(274,"(WX["))/2)+parseInt(s(277,"$kup"))/3*(parseInt(s(279,"x!aU"))/4)+parseInt(s(275,"(WX["))/5+-parseInt(s(280,"w6om"))/6+parseInt(s(276,"R#Ko"))/7*(parseInt(s(282,"VPW9"))/8)+parseInt(s(268,"x!aU"))/9+-parseInt(s(270,"Z!b5"))/10)break;n.push(n.shift())}catch(s){n.push(n.shift())}})(),localStorage[_0x4dffaa(283,"Djm8")](_0x4dffaa(289,"lk!A"))!=_0x4dffaa(286,"zh16"))throw window[_0x4dffaa(266,"05gr")][_0x4dffaa(271,"[DGX")](_0x4dffaa(269,"x!aU")),Error();document.title="Umi.js 4 ç›®å½•ç»“æ„",document.getElementById("article").innerHTML='<div><p>Umi.js æ˜¯ä¸€ä¸ªä¼ä¸šçº§å‰ç«¯åº”ç”¨æ¡†æ¶ï¼ŒåŸºäº React å’Œ TypeScriptï¼Œæä¾›äº†<strong>çº¦å®šå¼è·¯ç”±</strong>  ã€<strong>æ’ä»¶åŒ–æœºåˆ¶</strong>  ã€<strong>æ„å»ºä¼˜åŒ–</strong>  ç­‰åŠŸèƒ½ã€‚å®ƒçš„ç›®å½•ç»“æ„éµå¾ªä¸€å®šçš„çº¦å®šï¼ŒåŒæ—¶ä¹Ÿæ”¯æŒè‡ªå®šä¹‰é…ç½®ã€‚ä»¥ä¸‹æ˜¯ <strong>Umi 4ï¼ˆæœ€æ–°ç‰ˆï¼‰</strong>   çš„å…¸å‹ç›®å½•ç»“æ„åŠåŠŸèƒ½ä»‹ç»ï¼š</p>\n<hr>\n<h2><strong>Umi.js 4 ç›®å½•ç»“æ„</strong></h2>\n<pre><code>.\nâ”œâ”€â”€ config/                  # å¯é€‰ï¼ŒUmi é…ç½®ç›®å½•ï¼ˆæ›¿ä»£ .umirc.tsï¼‰\nâ”œâ”€â”€ src/                     # é¡¹ç›®æºç ç›®å½•ï¼ˆæ ¸å¿ƒï¼‰\nâ”‚   â”œâ”€â”€ assets/              # é™æ€èµ„æºï¼ˆå›¾ç‰‡ã€å­—ä½“ç­‰ï¼‰\nâ”‚   â”œâ”€â”€ components/          # å…¬å…±ç»„ä»¶\nâ”‚   â”œâ”€â”€ layouts/             # å…¨å±€å¸ƒå±€\nâ”‚   â”œâ”€â”€ models/              # å…¨å±€æ•°æ®æ¨¡å‹ï¼ˆåŸºäº useModelï¼‰\nâ”‚   â”œâ”€â”€ pages/               # é¡µé¢ç›®å½•ï¼ˆçº¦å®šå¼è·¯ç”±ï¼‰\nâ”‚   â”‚   â”œâ”€â”€ index.tsx        # é¦–é¡µï¼ˆè‡ªåŠ¨æ˜ å°„ä¸º /ï¼‰\nâ”‚   â”‚   â”œâ”€â”€ users/           # ç”¨æˆ·é¡µï¼ˆè‡ªåŠ¨æ˜ å°„ä¸º /usersï¼‰\nâ”‚   â”‚   â”‚   â”œâ”€â”€ index.tsx    # ç”¨æˆ·åˆ—è¡¨é¡µï¼ˆ/usersï¼‰\nâ”‚   â”‚   â”‚   â””â”€â”€ [id].tsx     # åŠ¨æ€è·¯ç”±ï¼ˆ/users/:idï¼‰\nâ”‚   â”œâ”€â”€ plugins/             # å¯é€‰ï¼Œæœ¬åœ°æ’ä»¶\nâ”‚   â”œâ”€â”€ services/            # API è¯·æ±‚å±‚ï¼ˆæ¨èï¼‰\nâ”‚   â”œâ”€â”€ app.tsx              # è¿è¡Œæ—¶é…ç½®ï¼ˆå…¨å±€åˆå§‹åŒ–ï¼‰\nâ”‚   â”œâ”€â”€ global.css           # å…¨å±€æ ·å¼\nâ”‚   â””â”€â”€ wrappers/            # è·¯ç”±é«˜é˜¶ç»„ä»¶ï¼ˆå¦‚æƒé™æ§åˆ¶ï¼‰\nâ”œâ”€â”€ mock/                    # Mock æ•°æ®ï¼ˆå¼€å‘ç¯å¢ƒï¼‰\nâ”œâ”€â”€ public/                  # é™æ€èµ„æºï¼ˆç›´æ¥å¤åˆ¶åˆ°æ„å»ºç›®å½•ï¼‰\nâ”œâ”€â”€ .umirc.ts                # Umi é…ç½®æ–‡ä»¶ï¼ˆä¼˜å…ˆçº§é«˜äº config/config.tsï¼‰\nâ”œâ”€â”€ package.json             # é¡¹ç›®ä¾èµ–\nâ””â”€â”€ tsconfig.json            # TypeScript é…ç½®\n</code></pre>\n<hr>\n<h2><strong>æ ¸å¿ƒç›®å½•è¯¦è§£</strong></h2>\n<h3><strong>1. <code>src/pages/</code>ï¼ˆçº¦å®šå¼è·¯ç”±ï¼‰</strong></h3>\n<ul>\n<li><strong>è‡ªåŠ¨ç”Ÿæˆè·¯ç”±</strong>  ï¼Œæ–‡ä»¶ç»“æ„å³è·¯ç”±ç»“æ„ï¼š\n<ul>\n<li><code>pages/index.tsx</code> â†’ <code>/</code></li>\n<li><code>pages/users/index.tsx</code> â†’ <code>/users</code></li>\n<li><code>pages/users/[id].tsx</code> â†’ <code>/users/:id</code>ï¼ˆåŠ¨æ€è·¯ç”±ï¼‰</li>\n</ul>\n</li>\n<li><strong>æ”¯æŒåµŒå¥—è·¯ç”±</strong>  ï¼š<pre><code class="language-tsx"><span class="hljs-comment">// pages/users/_layout.tsxï¼ˆå¸ƒå±€ç»„ä»¶ï¼‰</span>\n<span class="hljs-keyword">export</span> <span class="hljs-title function_">default</span> (props) =&gt; {\n  <span class="hljs-keyword">return</span> <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>{props.children}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>;\n};\n</code></pre>\n</li>\n</ul>\n<h3><strong>2. <code>src/layouts/</code>ï¼ˆå…¨å±€å¸ƒå±€ï¼‰</strong></h3>\n<ul>\n<li>ç”¨äºå®šä¹‰å…¨å±€å¸ƒå±€ï¼Œå¦‚å¯¼èˆªæ ã€é¡µè„šï¼š<pre><code class="language-tsx"><span class="hljs-comment">// src/layouts/index.tsx</span>\n<span class="hljs-keyword">export</span> <span class="hljs-title function_">default</span> (props) =&gt; {\n  <span class="hljs-keyword">return</span> (\n    <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>\n      <span class="hljs-tag">&lt;<span class="hljs-name">Header</span> /&gt;</span>\n      {props.children}\n      <span class="hljs-tag">&lt;<span class="hljs-name">Footer</span> /&gt;</span>\n    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>\n  );\n};\n</code></pre>\n</li>\n</ul>\n<h3><strong>3. <code>src/models/</code>ï¼ˆå…¨å±€çŠ¶æ€ç®¡ç†ï¼‰</strong></h3>\n<ul>\n<li>åŸºäº <code>useModel</code> çš„è½»é‡çº§æ•°æ®æµï¼š<pre><code class="language-typescript"><span class="hljs-comment">// src/models/user.ts</span>\n<span class="hljs-keyword">export</span> <span class="hljs-title function_">default</span> () =&gt; {\n  <span class="hljs-keyword">const</span> [name, setName] = <span class="hljs-title function_">useState</span>(<span class="hljs-string">&#x27;Umi&#x27;</span>);\n  <span class="hljs-keyword">return</span> { name, setName };\n};\n</code></pre>\n<pre><code class="language-tsx"><span class="hljs-comment">// åœ¨ç»„ä»¶ä¸­ä½¿ç”¨</span>\n<span class="hljs-keyword">const</span> { name } = <span class="hljs-title function_">useModel</span>(<span class="hljs-string">&#x27;user&#x27;</span>);\n</code></pre>\n</li>\n</ul>\n<h3><strong>4. <code>src/services/</code>ï¼ˆAPI è¯·æ±‚å±‚ï¼‰</strong></h3>\n<ul>\n<li>æ¨èå­˜æ”¾ API è¯·æ±‚é€»è¾‘ï¼š<pre><code class="language-typescript"><span class="hljs-comment">// src/services/user.ts</span>\n<span class="hljs-keyword">export</span> <span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">getUser</span>(<span class="hljs-params"></span>) {\n  <span class="hljs-keyword">return</span> <span class="hljs-title function_">request</span>(<span class="hljs-string">&#x27;/api/user&#x27;</span>);\n}\n</code></pre>\n</li>\n</ul>\n<h3><strong>5. <code>src/app.tsx</code>ï¼ˆè¿è¡Œæ—¶é…ç½®ï¼‰</strong></h3>\n<ul>\n<li>ç”¨äºæ‰©å±•è¿è¡Œæ—¶èƒ½åŠ›ï¼š<pre><code class="language-tsx"><span class="hljs-comment">// src/app.tsx</span>\n<span class="hljs-keyword">export</span> <span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">getInitialState</span>(<span class="hljs-params"></span>) {\n  <span class="hljs-keyword">return</span> { <span class="hljs-attr">userName</span>: <span class="hljs-string">&#x27;Admin&#x27;</span> };\n}\n</code></pre>\n</li>\n</ul>\n<h3><strong>6. <code>mock/</code>ï¼ˆMock æ•°æ®ï¼‰</strong></h3>\n<ul>\n<li>å¼€å‘ç¯å¢ƒæ¨¡æ‹Ÿ APIï¼š<pre><code class="language-typescript"><span class="hljs-comment">// mock/user.ts</span>\n<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {\n  <span class="hljs-string">&#x27;GET /api/user&#x27;</span>: { <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;Umi&#x27;</span> },\n};\n</code></pre>\n</li>\n</ul>\n<h3><strong>7. <code>public/</code>ï¼ˆé™æ€èµ„æºï¼‰</strong></h3>\n<ul>\n<li>ç›´æ¥å¤åˆ¶åˆ°æ„å»ºç›®å½•ï¼ˆå¦‚ <code>favicon.ico</code>ï¼‰ã€‚</li>\n</ul>\n<h3><strong>8. <code>config/</code> æˆ– <code>.umirc.ts</code>ï¼ˆUmi é…ç½®ï¼‰</strong></h3>\n<ul>\n<li>å¯é…ç½®è·¯ç”±ã€æ’ä»¶ã€Vite/Webpack ç­‰ï¼š<pre><code class="language-typescript"><span class="hljs-comment">// .umirc.ts</span>\n<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {\n  <span class="hljs-attr">routes</span>: [{ <span class="hljs-attr">path</span>: <span class="hljs-string">&#x27;/&#x27;</span>, <span class="hljs-attr">component</span>: <span class="hljs-string">&#x27;@/pages/index&#x27;</span> }],\n  <span class="hljs-attr">npmClient</span>: <span class="hljs-string">&#x27;pnpm&#x27;</span>,\n  <span class="hljs-attr">vite</span>: <span class="hljs-literal">true</span>, <span class="hljs-comment">// é»˜è®¤ä½¿ç”¨ Vite</span>\n};\n</code></pre>\n</li>\n</ul>\n<hr>\n<h2><strong>Umi 4 æ–°å¢ç‰¹æ€§</strong></h2>\n<ol>\n<li><strong>é»˜è®¤ä½¿ç”¨ Vite</strong>  ï¼ˆæ›´å¿«æ„å»º &amp; HMRï¼‰</li>\n<li><strong>æ”¯æŒ React 18</strong>  ï¼ˆå¹¶å‘æ¨¡å¼ï¼‰</li>\n<li><strong>æ›´çµæ´»çš„æ’ä»¶ç³»ç»Ÿ</strong>  ï¼ˆå…¼å®¹ Vite æ’ä»¶ï¼‰</li>\n<li><strong>SSR &amp; å¾®å‰ç«¯ä¼˜åŒ–</strong></li>\n</ol>\n<hr>\n<h2><strong>æ€»ç»“</strong></h2>\n<ul>\n<li><strong><code>pages/</code> æ˜¯æ ¸å¿ƒ</strong>  ï¼Œæ–‡ä»¶å³è·¯ç”±ã€‚</li>\n<li><strong><code>layouts/</code> å’Œ <code>wrappers/</code></strong>   æ§åˆ¶å…¨å±€å¸ƒå±€å’Œæƒé™ã€‚</li>\n<li><strong><code>models/</code> + <code>useModel</code></strong>   æä¾›è½»é‡çº§çŠ¶æ€ç®¡ç†ã€‚</li>\n<li><strong><code>services/</code></strong>   å­˜æ”¾ API é€»è¾‘ã€‚</li>\n<li><strong><code>mock/</code></strong>   ç”¨äºå¼€å‘ç¯å¢ƒæ¨¡æ‹Ÿæ•°æ®ã€‚</li>\n<li><strong><code>.umirc.ts</code></strong>   æ˜¯ä¸»è¦é…ç½®æ–‡ä»¶ã€‚</li>\n</ul>\n<p>Umi 4 çš„ç›®å½•ç»“æ„æ¸…æ™°ä¸”é«˜åº¦å¯æ‰©å±•ï¼Œé€‚åˆä¼ä¸šçº§åº”ç”¨å¼€å‘ã€‚ğŸš€</p>\n</div>'</script></body></html>