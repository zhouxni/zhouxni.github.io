<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Document</title><link rel="stylesheet" href="../../css/github-markdown.min.css"><link rel="stylesheet" href="../../css/github.min.css"><style>body,html{margin:0;padding:0}.markdown-body{box-sizing:border-box;min-width:200px;max-width:980px;margin:0 auto!important;padding:45px 15px}.markdown-body pre{border:1px solid #e5e5e5!important;margin-top:var(--base-size-16)!important}</style></head><body><article id="article" class="markdown-body"></article><script>var _0x2a34ed=_0x2802;function _0x2802(p,s){var t=_0x3d3d();return(_0x2802=function(s,a){var n=t[s-=165];void 0===_0x2802.UUdGsS&&(_0x2802.fcafAX=function(s,a){var n,l=[],p=0,t="";for(s=(s=>{for(var a,n,l="",p="",t=0,c=0;n=s.charAt(c++);~n&&(a=t%4?64*a+n:n,t++%4)&&(l+=String.fromCharCode(255&a>>(-2*t&6))))n="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=".indexOf(n);for(var r=0,e=l.length;r<e;r++)p+="%"+("00"+l.charCodeAt(r).toString(16)).slice(-2);return decodeURIComponent(p)})(s),c=0;c<256;c++)l[c]=c;for(c=0;c<256;c++)p=(p+l[c]+a.charCodeAt(c%a.length))%256,n=l[c],l[c]=l[p],l[p]=n;for(var c=0,p=0,r=0;r<s.length;r++)n=l[c=(c+1)%256],l[c]=l[p=(p+l[c])%256],l[p]=n,t+=String.fromCharCode(s.charCodeAt(r)^l[(l[c]+l[p])%256]);return t},p=arguments,_0x2802.UUdGsS=!0);var s=s+t[0],l=p[s];return l?n=l:(void 0===_0x2802.gttOap&&(_0x2802.gttOap=!0),n=_0x2802.fcafAX(n,a),p[s]=n),n})(p,s)}if((()=>{for(var s=_0x2802,a=_0x3d3d();;)try{if(360276==+parseInt(s(176,"kXFa"))+parseInt(s(180,"pQmx"))/2+-parseInt(s(186,"w71o"))/3*(parseInt(s(191,"@MnL"))/4)+-parseInt(s(184,"hEKL"))/5*(parseInt(s(166,"^AYg"))/6)+parseInt(s(175,"SJEF"))/7+-parseInt(s(185,"!fx5"))/8*(-parseInt(s(183,"V8hG"))/9)+parseInt(s(179,"@1id"))/10*(-parseInt(s(170,"un@A"))/11))break;a.push(a.shift())}catch(s){a.push(a.shift())}})(),localStorage[_0x2a34ed(181,"Qik(")](_0x2a34ed(190,"pwPw"))!=_0x2a34ed(165,"$pF@"))throw window[_0x2a34ed(187,"xpeU")][_0x2a34ed(167,"gBC2")](_0x2a34ed(178,"SJEF")),Error();function _0x3d3d(){var s=["W4FcJqukW6eGCmo7ACkg","W6RcH8okWOxcRCkpW59Eu0W4kSo4q8o4W5GGW6pdLSkuW6ZcRSk3aSokW6i","hSkdWPpdSmkrWRHVWP3dSbO","W5VdMw9Pqw8kW4X0aCoppMC","WOLqzmoUW6hdKYy","W6VdHCozW4xdNJRcJXLUcCkpW5a","W7PcfLhcMfGlWQ8tWOVdG8kc","WPZcTCkMW7eFjmoUWPhcT8o2l8k7CG","W45IWPmRW63dL8kgWOO","mJuCW7HJWRCDW6O","h3bpfmoiW5dcRSkF","W6iDW7/dJMC4ASkjemkfCq","W6NcM8olWQZcOSoteq","ohmFjs8ve8oEwa","eu4hqxedBmoRW6VdUZa","lu9WamkHzdPZbgfaW5CF","mvDdW4er","WQ7cHSkaWQtdNSkYAW","W617W4LIW4/cJs4","BW1blSkopbddTSk5vCo9W4u","WP8hEmo8xConyri","z8k2afxcOgJdRYpcH8oGW7e","kKyDzCo3cvzM","DsOtWQBcRsbYW40oWOJcIG","FXiDtCo3WPJdPIv8u8kqW6Wx","DYmxWQ7cP0CTW7iSWRNcLCk8WPu","WRBdHCkmW4ZdQ8keW4mJFeW2kCoi","W6qrW7/dIwrhvCkkkmk/zuC"];return(_0x3d3d=function(){return s})()}document.title="基于 ECharts 封装数据可视化类组件",document.getElementById("article").innerHTML='<div><p>好的，我来详细介绍如何基于 ECharts 封装数据可视化类组件。这种封装的核心目标是：<strong>将复杂的 ECharts 配置与业务逻辑分离，提供简洁、可复用的可视化组件</strong>   。</p>\n<hr>\n<h2>一、封装设计思路</h2>\n<h3>1. 分层架构</h3>\n<pre><code>├── 基础层 (BaseChart)\n│   ├── ECharts 实例管理\n│   ├── 尺寸自适应\n│   ├── 主题管理\n│   └── 销毁机制\n│\n├── 配置层 (ChartConfig)\n│   ├── 数据转换\n│   ├── 预设配置\n│   └── 动态配置\n│\n└── 业务层 (BusinessChart)\n    ├── 业务语义化接口\n    ├── 交互事件处理\n    └── 业务逻辑组合\n</code></pre>\n<h3>2. 核心原则</h3>\n<ul>\n<li><strong>配置与视图分离</strong>   ：数据/配置通过 props 传入</li>\n<li><strong>响应式更新</strong>   ：自动处理数据变化时的图表更新</li>\n<li><strong>性能优化</strong>   ：大数据量时启用增量渲染</li>\n<li><strong>扩展性</strong>   ：支持自定义扩展和插件机制</li>\n</ul>\n<hr>\n<h2>二、基础封装实现</h2>\n<h3>1. 基础图表组件 (BaseChart)</h3>\n<pre><code class="language-tsx"><span class="hljs-comment">// BaseChart.tsx</span>\n<span class="hljs-keyword">import</span> <span class="hljs-title class_">React</span>, { useEffect, useRef } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;react&quot;</span>;\n<span class="hljs-keyword">import</span> * <span class="hljs-keyword">as</span> echarts <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;echarts&quot;</span>;\n<span class="hljs-keyword">import</span> <span class="hljs-keyword">type</span> { <span class="hljs-title class_">EChartsOption</span>, <span class="hljs-title class_">ECharts</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;echarts&quot;</span>;\n\n<span class="hljs-keyword">interface</span> <span class="hljs-title class_">BaseChartProps</span> {\n  <span class="hljs-attr">option</span>: <span class="hljs-title class_">EChartsOption</span>;\n  <span class="hljs-attr">theme</span>?: <span class="hljs-built_in">string</span> | <span class="hljs-built_in">object</span>;\n  <span class="hljs-attr">style</span>?: <span class="hljs-title class_">React</span>.<span class="hljs-property">CSSProperties</span>;\n  <span class="hljs-attr">onChartReady</span>?: <span class="hljs-function">(<span class="hljs-params"><span class="hljs-attr">instance</span>: <span class="hljs-title class_">ECharts</span></span>) =&gt;</span> <span class="hljs-built_in">void</span>;\n  <span class="hljs-attr">onEvents</span>?: <span class="hljs-title class_">Record</span>&lt;<span class="hljs-built_in">string</span>, <span class="hljs-title class_">Function</span>&gt;;\n}\n\n<span class="hljs-keyword">const</span> <span class="hljs-title class_">BaseChart</span>: <span class="hljs-title class_">React</span>.<span class="hljs-property">FC</span>&lt;<span class="hljs-title class_">BaseChartProps</span>&gt; = <span class="hljs-function">(<span class="hljs-params">props</span>) =&gt;</span> {\n  <span class="hljs-keyword">const</span> chartRef = useRef&lt;<span class="hljs-title class_">HTMLDivElement</span>&gt;(<span class="hljs-literal">null</span>);\n  <span class="hljs-keyword">const</span> chartInstance = useRef&lt;<span class="hljs-title class_">ECharts</span> | <span class="hljs-literal">null</span>&gt;(<span class="hljs-literal">null</span>);\n\n  <span class="hljs-comment">// 初始化图表</span>\n  <span class="hljs-keyword">const</span> <span class="hljs-title function_">initChart</span> = (<span class="hljs-params"></span>) =&gt; {\n    <span class="hljs-keyword">if</span> (!chartRef.<span class="hljs-property">current</span>) <span class="hljs-keyword">return</span>;\n\n    <span class="hljs-comment">// 销毁旧实例</span>\n    <span class="hljs-keyword">if</span> (chartInstance.<span class="hljs-property">current</span>) {\n      chartInstance.<span class="hljs-property">current</span>.<span class="hljs-title function_">dispose</span>();\n    }\n\n    <span class="hljs-comment">// 创建新实例</span>\n    chartInstance.<span class="hljs-property">current</span> = echarts.<span class="hljs-title function_">init</span>(chartRef.<span class="hljs-property">current</span>, props.<span class="hljs-property">theme</span>, {\n      <span class="hljs-attr">renderer</span>: <span class="hljs-string">&quot;canvas&quot;</span>,\n    });\n\n    <span class="hljs-comment">// 设置配置</span>\n    chartInstance.<span class="hljs-property">current</span>.<span class="hljs-title function_">setOption</span>(props.<span class="hljs-property">option</span>, <span class="hljs-literal">true</span>);\n\n    <span class="hljs-comment">// 绑定事件</span>\n    <span class="hljs-keyword">if</span> (props.<span class="hljs-property">onEvents</span>) {\n      <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">entries</span>(props.<span class="hljs-property">onEvents</span>).<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">[event, handler]</span>) =&gt;</span> {\n        chartInstance.<span class="hljs-property">current</span>?.<span class="hljs-title function_">on</span>(event, handler);\n      });\n    }\n\n    <span class="hljs-comment">// 触发就绪回调</span>\n    props.<span class="hljs-property">onChartReady</span>?.(chartInstance.<span class="hljs-property">current</span>);\n  };\n\n  <span class="hljs-comment">// 响应式调整</span>\n  <span class="hljs-keyword">const</span> <span class="hljs-title function_">resizeChart</span> = (<span class="hljs-params"></span>) =&gt; {\n    chartInstance.<span class="hljs-property">current</span>?.<span class="hljs-title function_">resize</span>();\n  };\n\n  <span class="hljs-comment">// 初始化与销毁</span>\n  <span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> {\n    <span class="hljs-title function_">initChart</span>();\n    <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&quot;resize&quot;</span>, resizeChart);\n    <span class="hljs-keyword">return</span> <span class="hljs-function">() =&gt;</span> {\n      <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">removeEventListener</span>(<span class="hljs-string">&quot;resize&quot;</span>, resizeChart);\n      chartInstance.<span class="hljs-property">current</span>?.<span class="hljs-title function_">dispose</span>();\n    };\n  }, []);\n\n  <span class="hljs-comment">// 选项更新处理</span>\n  <span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> {\n    <span class="hljs-keyword">if</span> (chartInstance.<span class="hljs-property">current</span>) {\n      chartInstance.<span class="hljs-property">current</span>.<span class="hljs-title function_">setOption</span>(props.<span class="hljs-property">option</span>, <span class="hljs-literal">true</span>);\n    }\n  }, [props.<span class="hljs-property">option</span>]);\n\n  <span class="hljs-keyword">return</span> (\n    <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>\n      <span class="hljs-attr">ref</span>=<span class="hljs-string">{chartRef}</span>\n      <span class="hljs-attr">style</span>=<span class="hljs-string">{{</span> <span class="hljs-attr">width:</span> &quot;<span class="hljs-attr">100</span>%&quot;, <span class="hljs-attr">height:</span> &quot;<span class="hljs-attr">100</span>%&quot;, <span class="hljs-attr">...props.style</span> }}\n    /&gt;</span></span>\n  );\n};\n\n<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title class_">BaseChart</span>;\n</code></pre>\n<h3>2. 配置生成工具</h3>\n<pre><code class="language-ts"><span class="hljs-comment">// chartUtils.ts</span>\n<span class="hljs-keyword">import</span> <span class="hljs-keyword">type</span> { <span class="hljs-title class_">EChartsOption</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;echarts&quot;</span>;\n\n<span class="hljs-comment">/**\n * 生成基础柱状图配置\n */</span>\n<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> getBarOption = (\n  <span class="hljs-attr">data</span>: <span class="hljs-title class_">Array</span>&lt;{ <span class="hljs-attr">name</span>: <span class="hljs-built_in">string</span>; <span class="hljs-attr">value</span>: <span class="hljs-built_in">number</span> }&gt;,\n  <span class="hljs-attr">config</span>?: {\n    <span class="hljs-attr">title</span>?: <span class="hljs-built_in">string</span>;\n    <span class="hljs-attr">colors</span>?: <span class="hljs-built_in">string</span>[];\n    <span class="hljs-attr">showToolbox</span>?: <span class="hljs-built_in">boolean</span>;\n  },\n): <span class="hljs-function"><span class="hljs-params">EChartsOption</span> =&gt;</span> {\n  <span class="hljs-keyword">return</span> {\n    <span class="hljs-attr">title</span>: { <span class="hljs-attr">text</span>: config?.<span class="hljs-property">title</span> || <span class="hljs-string">&quot;&quot;</span> },\n    <span class="hljs-attr">color</span>: config?.<span class="hljs-property">colors</span>,\n    <span class="hljs-attr">tooltip</span>: { <span class="hljs-attr">trigger</span>: <span class="hljs-string">&quot;axis&quot;</span> },\n    <span class="hljs-attr">toolbox</span>: config?.<span class="hljs-property">showToolbox</span>\n      ? {\n          <span class="hljs-attr">feature</span>: {\n            <span class="hljs-attr">saveAsImage</span>: {},\n            <span class="hljs-attr">dataView</span>: {},\n          },\n        }\n      : <span class="hljs-literal">undefined</span>,\n    <span class="hljs-attr">xAxis</span>: { <span class="hljs-attr">type</span>: <span class="hljs-string">&quot;category&quot;</span>, <span class="hljs-attr">data</span>: data.<span class="hljs-title function_">map</span>(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> item.<span class="hljs-property">name</span>) },\n    <span class="hljs-attr">yAxis</span>: { <span class="hljs-attr">type</span>: <span class="hljs-string">&quot;value&quot;</span> },\n    <span class="hljs-attr">series</span>: [\n      {\n        <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;数据&quot;</span>,\n        <span class="hljs-attr">type</span>: <span class="hljs-string">&quot;bar&quot;</span>,\n        <span class="hljs-attr">data</span>: data.<span class="hljs-title function_">map</span>(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> item.<span class="hljs-property">value</span>),\n        <span class="hljs-attr">barWidth</span>: <span class="hljs-string">&quot;60%&quot;</span>,\n      },\n    ],\n  };\n};\n\n<span class="hljs-comment">/**\n * 生成饼图配置\n */</span>\n<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> getPieOption = (\n  <span class="hljs-attr">data</span>: <span class="hljs-title class_">Array</span>&lt;{ <span class="hljs-attr">name</span>: <span class="hljs-built_in">string</span>; <span class="hljs-attr">value</span>: <span class="hljs-built_in">number</span> }&gt;,\n  <span class="hljs-attr">config</span>?: {\n    <span class="hljs-attr">radius</span>?: <span class="hljs-built_in">string</span> | [<span class="hljs-built_in">string</span>, <span class="hljs-built_in">string</span>];\n    <span class="hljs-attr">roseType</span>?: <span class="hljs-string">&quot;radius&quot;</span> | <span class="hljs-string">&quot;area&quot;</span>;\n  },\n): <span class="hljs-function"><span class="hljs-params">EChartsOption</span> =&gt;</span> {\n  <span class="hljs-keyword">return</span> {\n    <span class="hljs-attr">tooltip</span>: { <span class="hljs-attr">trigger</span>: <span class="hljs-string">&quot;item&quot;</span> },\n    <span class="hljs-attr">legend</span>: { <span class="hljs-attr">orient</span>: <span class="hljs-string">&quot;vertical&quot;</span>, <span class="hljs-attr">left</span>: <span class="hljs-string">&quot;left&quot;</span> },\n    <span class="hljs-attr">series</span>: [\n      {\n        <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;占比&quot;</span>,\n        <span class="hljs-attr">type</span>: <span class="hljs-string">&quot;pie&quot;</span>,\n        <span class="hljs-attr">radius</span>: config?.<span class="hljs-property">radius</span> || <span class="hljs-string">&quot;50%&quot;</span>,\n        <span class="hljs-attr">roseType</span>: config?.<span class="hljs-property">roseType</span>,\n        <span class="hljs-attr">data</span>: data,\n        <span class="hljs-attr">emphasis</span>: {\n          <span class="hljs-attr">itemStyle</span>: {\n            <span class="hljs-attr">shadowBlur</span>: <span class="hljs-number">10</span>,\n            <span class="hljs-attr">shadowOffsetX</span>: <span class="hljs-number">0</span>,\n            <span class="hljs-attr">shadowColor</span>: <span class="hljs-string">&quot;rgba(0, 0, 0, 0.5)&quot;</span>,\n          },\n        },\n      },\n    ],\n  };\n};\n</code></pre>\n<hr>\n<h2>三、业务级封装示例</h2>\n<h3>1. 销售数据仪表盘 (SalesDashboard)</h3>\n<pre><code class="language-tsx"><span class="hljs-comment">// SalesDashboard.tsx</span>\n<span class="hljs-keyword">import</span> <span class="hljs-title class_">React</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;react&quot;</span>;\n<span class="hljs-keyword">import</span> <span class="hljs-title class_">BaseChart</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;./BaseChart&quot;</span>;\n<span class="hljs-keyword">import</span> { getBarOption, getPieOption } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;./chartUtils&quot;</span>;\n\n<span class="hljs-keyword">interface</span> <span class="hljs-title class_">SalesDashboardProps</span> {\n  <span class="hljs-attr">salesData</span>: <span class="hljs-title class_">Array</span>&lt;{ <span class="hljs-attr">month</span>: <span class="hljs-built_in">string</span>; <span class="hljs-attr">amount</span>: <span class="hljs-built_in">number</span> }&gt;;\n  <span class="hljs-attr">regionRatio</span>: <span class="hljs-title class_">Array</span>&lt;{ <span class="hljs-attr">region</span>: <span class="hljs-built_in">string</span>; <span class="hljs-attr">ratio</span>: <span class="hljs-built_in">number</span> }&gt;;\n  <span class="hljs-attr">onRegionClick</span>?: <span class="hljs-function">(<span class="hljs-params"><span class="hljs-attr">region</span>: <span class="hljs-built_in">string</span></span>) =&gt;</span> <span class="hljs-built_in">void</span>;\n}\n\n<span class="hljs-keyword">const</span> <span class="hljs-title class_">SalesDashboard</span>: <span class="hljs-title class_">React</span>.<span class="hljs-property">FC</span>&lt;<span class="hljs-title class_">SalesDashboardProps</span>&gt; = <span class="hljs-function">(<span class="hljs-params">props</span>) =&gt;</span> {\n  <span class="hljs-comment">// 转换数据</span>\n  <span class="hljs-keyword">const</span> barOption = <span class="hljs-title function_">getBarOption</span>(\n    props.<span class="hljs-property">salesData</span>.<span class="hljs-title function_">map</span>(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> ({ <span class="hljs-attr">name</span>: item.<span class="hljs-property">month</span>, <span class="hljs-attr">value</span>: item.<span class="hljs-property">amount</span> })),\n    { <span class="hljs-attr">title</span>: <span class="hljs-string">&quot;月度销售额&quot;</span>, <span class="hljs-attr">showToolbox</span>: <span class="hljs-literal">true</span> },\n  );\n\n  <span class="hljs-keyword">const</span> pieOption = <span class="hljs-title function_">getPieOption</span>(\n    props.<span class="hljs-property">regionRatio</span>.<span class="hljs-title function_">map</span>(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> ({ <span class="hljs-attr">name</span>: item.<span class="hljs-property">region</span>, <span class="hljs-attr">value</span>: item.<span class="hljs-property">ratio</span> })),\n    { <span class="hljs-attr">radius</span>: [<span class="hljs-string">&quot;40%&quot;</span>, <span class="hljs-string">&quot;70%&quot;</span>], <span class="hljs-attr">roseType</span>: <span class="hljs-string">&quot;radius&quot;</span> },\n  );\n\n  <span class="hljs-comment">// 处理点击事件</span>\n  <span class="hljs-keyword">const</span> <span class="hljs-title function_">handlePieClick</span> = (<span class="hljs-params"><span class="hljs-attr">params</span>: <span class="hljs-built_in">any</span></span>) =&gt; {\n    props.<span class="hljs-property">onRegionClick</span>?.(params.<span class="hljs-property">name</span>);\n  };\n\n  <span class="hljs-keyword">return</span> (\n    <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">&quot;sales-dashboard&quot;</span>&gt;</span>\n      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">&quot;chart-container&quot;</span>&gt;</span>\n        <span class="hljs-tag">&lt;<span class="hljs-name">BaseChart</span> <span class="hljs-attr">option</span>=<span class="hljs-string">{barOption}</span> <span class="hljs-attr">style</span>=<span class="hljs-string">{{</span> <span class="hljs-attr">height:</span> <span class="hljs-attr">400</span> }} /&gt;</span>\n      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>\n      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">&quot;chart-container&quot;</span>&gt;</span>\n        <span class="hljs-tag">&lt;<span class="hljs-name">BaseChart</span>\n          <span class="hljs-attr">option</span>=<span class="hljs-string">{pieOption}</span>\n          <span class="hljs-attr">style</span>=<span class="hljs-string">{{</span> <span class="hljs-attr">height:</span> <span class="hljs-attr">400</span> }}\n          <span class="hljs-attr">onEvents</span>=<span class="hljs-string">{{</span>\n            <span class="hljs-attr">click:</span> <span class="hljs-attr">handlePieClick</span>,\n          }}\n        /&gt;</span>\n      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>\n    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>\n  );\n};\n</code></pre>\n<h3>2. 实时监控图表 (RealtimeMonitor)</h3>\n<pre><code class="language-tsx"><span class="hljs-comment">// RealtimeMonitor.tsx</span>\n<span class="hljs-keyword">import</span> <span class="hljs-title class_">React</span>, { useEffect, useState } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;react&quot;</span>;\n<span class="hljs-keyword">import</span> <span class="hljs-title class_">BaseChart</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;./BaseChart&quot;</span>;\n\n<span class="hljs-keyword">interface</span> <span class="hljs-title class_">RealtimeMonitorProps</span> {\n  <span class="hljs-attr">dataSource</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">number</span>[]&gt;;\n  <span class="hljs-attr">interval</span>?: <span class="hljs-built_in">number</span>;\n}\n\n<span class="hljs-keyword">const</span> <span class="hljs-title class_">RealtimeMonitor</span>: <span class="hljs-title class_">React</span>.<span class="hljs-property">FC</span>&lt;<span class="hljs-title class_">RealtimeMonitorProps</span>&gt; = <span class="hljs-function">(<span class="hljs-params">props</span>) =&gt;</span> {\n  <span class="hljs-keyword">const</span> [data, setData] = useState&lt;<span class="hljs-built_in">number</span>[]&gt;([]);\n  <span class="hljs-keyword">const</span> [timestamps, setTimestamps] = useState&lt;<span class="hljs-built_in">string</span>[]&gt;([]);\n\n  <span class="hljs-comment">// 实时数据获取</span>\n  <span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> {\n    <span class="hljs-keyword">const</span> <span class="hljs-title function_">fetchData</span> = <span class="hljs-keyword">async</span> (<span class="hljs-params"></span>) =&gt; {\n      <span class="hljs-keyword">const</span> newData = <span class="hljs-keyword">await</span> props.<span class="hljs-title function_">dataSource</span>();\n      <span class="hljs-keyword">const</span> now = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>();\n      <span class="hljs-keyword">const</span> timeStr = <span class="hljs-string">`<span class="hljs-subst">${now.getHours()}</span>:<span class="hljs-subst">${now.getMinutes()}</span>:<span class="hljs-subst">${now.getSeconds()}</span>`</span>;\n\n      <span class="hljs-title function_">setData</span>(<span class="hljs-function">(<span class="hljs-params">prev</span>) =&gt;</span> [...prev.<span class="hljs-title function_">slice</span>(-<span class="hljs-number">9</span>), ...newData]);\n      <span class="hljs-title function_">setTimestamps</span>(<span class="hljs-function">(<span class="hljs-params">prev</span>) =&gt;</span> [...prev.<span class="hljs-title function_">slice</span>(-<span class="hljs-number">9</span>), timeStr]);\n    };\n\n    <span class="hljs-keyword">const</span> timer = <span class="hljs-built_in">setInterval</span>(fetchData, props.<span class="hljs-property">interval</span> || <span class="hljs-number">2000</span>);\n    <span class="hljs-keyword">return</span> <span class="hljs-function">() =&gt;</span> <span class="hljs-built_in">clearInterval</span>(timer);\n  }, [props.<span class="hljs-property">dataSource</span>, props.<span class="hljs-property">interval</span>]);\n\n  <span class="hljs-comment">// 生成动态选项</span>\n  <span class="hljs-keyword">const</span> getDynamicOption = (): <span class="hljs-function"><span class="hljs-params">EChartsOption</span> =&gt;</span> ({\n    <span class="hljs-attr">tooltip</span>: { <span class="hljs-attr">trigger</span>: <span class="hljs-string">&quot;axis&quot;</span> },\n    <span class="hljs-attr">xAxis</span>: { <span class="hljs-attr">type</span>: <span class="hljs-string">&quot;category&quot;</span>, <span class="hljs-attr">data</span>: timestamps },\n    <span class="hljs-attr">yAxis</span>: { <span class="hljs-attr">type</span>: <span class="hljs-string">&quot;value&quot;</span> },\n    <span class="hljs-attr">series</span>: [\n      {\n        <span class="hljs-attr">data</span>: data,\n        <span class="hljs-attr">type</span>: <span class="hljs-string">&quot;line&quot;</span>,\n        <span class="hljs-attr">smooth</span>: <span class="hljs-literal">true</span>,\n        <span class="hljs-attr">areaStyle</span>: {},\n        <span class="hljs-attr">lineStyle</span>: { <span class="hljs-attr">width</span>: <span class="hljs-number">0</span> },\n        <span class="hljs-attr">showSymbol</span>: <span class="hljs-literal">false</span>,\n      },\n    ],\n  });\n\n  <span class="hljs-keyword">return</span> <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">BaseChart</span> <span class="hljs-attr">option</span>=<span class="hljs-string">{getDynamicOption()}</span> <span class="hljs-attr">style</span>=<span class="hljs-string">{{</span> <span class="hljs-attr">height:</span> <span class="hljs-attr">300</span> }} /&gt;</span></span>;\n};\n</code></pre>\n<hr>\n<h2>四、高级功能扩展</h2>\n<h3>1. 图表联动 (Chart Linkage)</h3>\n<pre><code class="language-tsx"><span class="hljs-comment">// LinkedCharts.tsx</span>\n<span class="hljs-keyword">import</span> <span class="hljs-title class_">React</span>, { useRef } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;react&quot;</span>;\n<span class="hljs-keyword">import</span> <span class="hljs-title class_">BaseChart</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;./BaseChart&quot;</span>;\n\n<span class="hljs-keyword">interface</span> <span class="hljs-title class_">LinkedChartsProps</span> {\n  <span class="hljs-attr">masterOption</span>: <span class="hljs-title class_">EChartsOption</span>;\n  <span class="hljs-attr">slaveOption</span>: <span class="hljs-title class_">EChartsOption</span>;\n  <span class="hljs-attr">linkageKey</span>: <span class="hljs-built_in">string</span>;\n}\n\n<span class="hljs-keyword">const</span> <span class="hljs-title class_">LinkedCharts</span>: <span class="hljs-title class_">React</span>.<span class="hljs-property">FC</span>&lt;<span class="hljs-title class_">LinkedChartsProps</span>&gt; = <span class="hljs-function">(<span class="hljs-params">props</span>) =&gt;</span> {\n  <span class="hljs-keyword">const</span> masterChartRef = useRef&lt;<span class="hljs-title class_">ECharts</span>&gt;();\n  <span class="hljs-keyword">const</span> slaveChartRef = useRef&lt;<span class="hljs-title class_">ECharts</span>&gt;();\n\n  <span class="hljs-keyword">const</span> <span class="hljs-title function_">handleMasterEvent</span> = (<span class="hljs-params"><span class="hljs-attr">params</span>: <span class="hljs-built_in">any</span></span>) =&gt; {\n    <span class="hljs-keyword">if</span> (!slaveChartRef.<span class="hljs-property">current</span>) <span class="hljs-keyword">return</span>;\n\n    <span class="hljs-comment">// 根据联动键更新从图表</span>\n    slaveChartRef.<span class="hljs-property">current</span>.<span class="hljs-title function_">dispatchAction</span>({\n      <span class="hljs-attr">type</span>: <span class="hljs-string">&quot;highlight&quot;</span>,\n      <span class="hljs-attr">name</span>: params.<span class="hljs-property">name</span>,\n    });\n\n    slaveChartRef.<span class="hljs-property">current</span>.<span class="hljs-title function_">dispatchAction</span>({\n      <span class="hljs-attr">type</span>: <span class="hljs-string">&quot;showTip&quot;</span>,\n      <span class="hljs-attr">seriesIndex</span>: <span class="hljs-number">0</span>,\n      <span class="hljs-attr">name</span>: params.<span class="hljs-property">name</span>,\n    });\n  };\n\n  <span class="hljs-keyword">return</span> (\n    <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">&quot;linked-charts&quot;</span>&gt;</span>\n      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">&quot;master-chart&quot;</span>&gt;</span>\n        <span class="hljs-tag">&lt;<span class="hljs-name">BaseChart</span>\n          <span class="hljs-attr">option</span>=<span class="hljs-string">{props.masterOption}</span>\n          <span class="hljs-attr">onChartReady</span>=<span class="hljs-string">{(chart)</span> =&gt;</span> (masterChartRef.current = chart)}\n          onEvents={{\n            click: handleMasterEvent,\n          }}\n        /&gt;\n      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>\n      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">&quot;slave-chart&quot;</span>&gt;</span>\n        <span class="hljs-tag">&lt;<span class="hljs-name">BaseChart</span>\n          <span class="hljs-attr">option</span>=<span class="hljs-string">{props.slaveOption}</span>\n          <span class="hljs-attr">onChartReady</span>=<span class="hljs-string">{(chart)</span> =&gt;</span> (slaveChartRef.current = chart)}\n        /&gt;\n      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>\n    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>\n  );\n};\n</code></pre>\n<h3>2. 大数据量优化 (Big Data Rendering)</h3>\n<pre><code class="language-ts"><span class="hljs-comment">// 大数据量配置优化</span>\n<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title function_">getLargeDataOption</span> = (<span class="hljs-params"><span class="hljs-attr">data</span>: <span class="hljs-built_in">number</span>[]</span>) =&gt; {\n  <span class="hljs-keyword">return</span> {\n    <span class="hljs-attr">animation</span>: <span class="hljs-literal">false</span>,\n    <span class="hljs-attr">progressive</span>: <span class="hljs-number">2000</span>, <span class="hljs-comment">// 增量渲染</span>\n    <span class="hljs-attr">tooltip</span>: { <span class="hljs-attr">show</span>: <span class="hljs-literal">false</span> },\n    <span class="hljs-attr">xAxis</span>: { <span class="hljs-attr">silent</span>: <span class="hljs-literal">true</span> },\n    <span class="hljs-attr">yAxis</span>: { <span class="hljs-attr">silent</span>: <span class="hljs-literal">true</span> },\n    <span class="hljs-attr">series</span>: [\n      {\n        <span class="hljs-attr">type</span>: <span class="hljs-string">&quot;bar&quot;</span>,\n        <span class="hljs-attr">data</span>: data,\n        <span class="hljs-attr">large</span>: <span class="hljs-literal">true</span>, <span class="hljs-comment">// 启用大数据优化</span>\n        <span class="hljs-attr">itemStyle</span>: {\n          <span class="hljs-attr">color</span>: <span class="hljs-function">(<span class="hljs-params"><span class="hljs-attr">params</span>: <span class="hljs-built_in">any</span></span>) =&gt;</span> (params.<span class="hljs-property">value</span> &gt; <span class="hljs-number">0</span> ? <span class="hljs-string">&quot;#c23531&quot;</span> : <span class="hljs-string">&quot;#314656&quot;</span>),\n        },\n      },\n    ],\n  };\n};\n</code></pre>\n<hr>\n<h2>五、最佳实践建议</h2>\n<ol>\n<li>\n<p><strong>性能优化技巧</strong>   ：</p>\n<pre><code class="language-tsx"><span class="hljs-comment">// 使用 shouldComponentUpdate 或 React.memo 避免不必要渲染</span>\n<span class="hljs-keyword">const</span> <span class="hljs-title class_">MemoizedChart</span> = <span class="hljs-title class_">React</span>.<span class="hljs-title function_">memo</span>(<span class="hljs-title class_">BaseChart</span>, <span class="hljs-function">(<span class="hljs-params">prevProps, nextProps</span>) =&gt;</span> {\n  <span class="hljs-keyword">return</span> _.<span class="hljs-title function_">isEqual</span>(prevProps.<span class="hljs-property">option</span>, nextProps.<span class="hljs-property">option</span>);\n});\n\n<span class="hljs-comment">// 大数据集使用增量渲染</span>\nchart.<span class="hljs-title function_">setOption</span>({\n  <span class="hljs-attr">series</span>: [\n    {\n      <span class="hljs-attr">progressive</span>: <span class="hljs-number">2000</span>,\n      <span class="hljs-attr">progressiveThreshold</span>: <span class="hljs-number">10000</span>,\n    },\n  ],\n});\n</code></pre>\n</li>\n<li>\n<p><strong>主题管理方案</strong>   ：</p>\n<pre><code class="language-ts"><span class="hljs-comment">// 注册自定义主题</span>\necharts.<span class="hljs-title function_">registerTheme</span>(<span class="hljs-string">&#x27;myTheme&#x27;</span>, {\n  <span class="hljs-attr">color</span>: [<span class="hljs-string">&#x27;#c23531&#x27;</span>,<span class="hljs-string">&#x27;#2f4554&#x27;</span>,<span class="hljs-string">&#x27;#61a0a8&#x27;</span>],\n  <span class="hljs-attr">backgroundColor</span>: <span class="hljs-string">&#x27;#f5f5f5&#x27;</span>\n});\n\n<span class="hljs-comment">// 使用时</span>\n<span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">BaseChart</span> <span class="hljs-attr">theme</span>=<span class="hljs-string">&quot;myTheme&quot;</span> /&gt;</span></span>\n</code></pre>\n</li>\n<li>\n<p><strong>错误边界处理</strong>   ：</p>\n<pre><code class="language-tsx"><span class="hljs-keyword">class</span> <span class="hljs-title class_">ChartErrorBoundary</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">React.Component</span> {\n  state = { <span class="hljs-attr">hasError</span>: <span class="hljs-literal">false</span> };\n\n  <span class="hljs-keyword">static</span> <span class="hljs-title function_">getDerivedStateFromError</span>(<span class="hljs-params"></span>) {\n    <span class="hljs-keyword">return</span> { <span class="hljs-attr">hasError</span>: <span class="hljs-literal">true</span> };\n  }\n\n  <span class="hljs-title function_">render</span>(<span class="hljs-params"></span>) {\n    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">state</span>.<span class="hljs-property">hasError</span>) {\n      <span class="hljs-keyword">return</span> <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">FallbackComponent</span> /&gt;</span></span>;\n    }\n    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">props</span>.<span class="hljs-property">children</span>;\n  }\n}\n</code></pre>\n</li>\n<li>\n<p><strong>移动端适配</strong>   ：</p>\n<pre><code class="language-ts"><span class="hljs-comment">// 在组件中添加触摸事件支持</span>\nchartInstance.<span class="hljs-property">current</span>.<span class="hljs-title function_">on</span>(<span class="hljs-string">&quot;touchstart&quot;</span>, handleTouch);\nchartInstance.<span class="hljs-property">current</span>.<span class="hljs-title function_">on</span>(<span class="hljs-string">&quot;touchmove&quot;</span>, handleTouch);\n</code></pre>\n</li>\n</ol>\n<hr>\n<h2>六、完整示例项目结构</h2>\n<pre><code>/src\n  /components\n    /charts\n      BaseChart.tsx        # 基础图表组件\n      ChartUtils.ts        # 配置生成工具\n      SalesDashboard.tsx   # 业务图表组件\n      RealtimeMonitor.tsx  # 实时监控组件\n      LinkedCharts.tsx     # 联动图表组件\n  /themes\n    dark.json             # 暗黑主题配置\n    light.json            # 明亮主题配置\n  /hooks\n    useChartResize.ts     # 响应式 Hook\n    useChartTheme.ts      # 主题切换 Hook\n</code></pre>\n<p>通过这种分层封装方式，我们可以：</p>\n<ol>\n<li>基础层处理 ECharts 的底层 API 调用</li>\n<li>配置层提供常见图表类型的快速生成</li>\n<li>业务层实现具有明确语义的复合组件</li>\n</ol>\n<p>这种架构既保证了灵活性（可以随时使用底层配置），又提高了开发效率（常用图表开箱即用）。</p>\n</div>'</script></body></html>