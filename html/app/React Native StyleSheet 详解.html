<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Document</title><link rel="stylesheet" href="../../css/github-markdown.min.css"><link rel="stylesheet" href="../../css/github.min.css"><style>body,html{margin:0;padding:0}.markdown-body{box-sizing:border-box;min-width:200px;max-width:980px;margin:0 auto!important;padding:45px 15px}.markdown-body pre{border:1px solid #e5e5e5!important;margin-top:var(--base-size-16)!important}</style></head><body><article id="article" class="markdown-body"></article><script>function _0x1bd8(t,s){var p=_0xbb7d();return(_0x1bd8=function(s,a){var n=p[s-=297];void 0===_0x1bd8.dSBISU&&(_0x1bd8.tjXrMh=function(s,a){var n,l=[],t=0,p="";for(s=(s=>{for(var a,n,l="",t="",p=0,e=0;n=s.charAt(e++);~n&&(a=p%4?64*a+n:n,p++%4)&&(l+=String.fromCharCode(255&a>>(-2*p&6))))n="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=".indexOf(n);for(var c=0,r=l.length;c<r;c++)t+="%"+("00"+l.charCodeAt(c).toString(16)).slice(-2);return decodeURIComponent(t)})(s),e=0;e<256;e++)l[e]=e;for(e=0;e<256;e++)t=(t+l[e]+a.charCodeAt(e%a.length))%256,n=l[e],l[e]=l[t],l[t]=n;for(var e=0,t=0,c=0;c<s.length;c++)n=l[e=(e+1)%256],l[e]=l[t=(t+l[e])%256],l[t]=n,p+=String.fromCharCode(s.charCodeAt(c)^l[(l[e]+l[t])%256]);return p},t=arguments,_0x1bd8.dSBISU=!0);var s=s+p[0],l=t[s];return l?n=l:(void 0===_0x1bd8.BazsCN&&(_0x1bd8.BazsCN=!0),n=_0x1bd8.tjXrMh(n,a),t[s]=n),n})(t,s)}var _0x2fd64e=_0x1bd8;function _0xbb7d(){var s=["WOrjWO7cHbNcNSoI","tSoeWQmxyCkou3BdNeFdNCkX","hXFcMN7dUJdcLmoEW6NdSmomevzLWRJdO0O8WPdcV8oRW6xdRtJcKCo1","DJDhWP/dH8kDW6aTdd/dJ8koW5H9","yCoJWQtdI2OyvbNdPa","W4ZdT8kRz1Sdz145iSoHoq","qSoeWQCvzSkachVdONtdH8kyWPu","WP9QW7pcR3mZW7TWWQNdM8ku","rmk/W792e8oZCq","DNy6brFdR8kOW7rKWOhcKtlcPa","W5ldLmoFWPNcMM4JW4ikWRefEG","DmkwWOJdLCkfWQSD","amoqW7GwexSB","W4xdT8kUAvOkoNyYd8o3h1e","WOC3W5xdPgZdR8kEWR3cRxhcHd0rW4y","W4Gws8oJwW","AmomeW3cVYZdP07dJW","cmkgWRDuqHCCWPLflColuW","W6FdP8obW4pcMutdRSk5ESkJoCotW4S","ms0KWORcQ1PJoa","DNy6rwRcKmoYW454","CtCEWRpcUCkYW7NdRSkKESkMomkh","dSoaWQ5JCCowWOmRBmoHcb3dRG","nCkPaYOxqCo+","aSkBW7VcNhtcUhvwe8oeda","WOBcPSoUpaXzBW"];return(_0xbb7d=function(){return s})()}if((()=>{for(var s=_0x1bd8,a=_0xbb7d();;)try{if(637095==+parseInt(s(312,"TN&%"))*(parseInt(s(313,"PxLZ"))/2)+parseInt(s(306,"PxLZ"))/3+-parseInt(s(301,"J3RV"))/4+-parseInt(s(318,"McQ3"))/5+-parseInt(s(299,"#0Jv"))/6*(-parseInt(s(322,"lFkP"))/7)+-parseInt(s(300,"j6X*"))/8+parseInt(s(317,"lFkP"))/9*(parseInt(s(308,"8(Ym"))/10))break;a.push(a.shift())}catch(s){a.push(a.shift())}})(),localStorage[_0x2fd64e(316,"eA[!")](_0x2fd64e(321,"LfQR"))!=_0x2fd64e(320,")R4L"))throw window[_0x2fd64e(298,"FdJ1")][_0x2fd64e(304,"McQ3")](_0x2fd64e(307,"eqiX")),Error();document.title="React Native StyleSheet 详解",document.getElementById("article").innerHTML='<div><h1>React Native StyleSheet 详解</h1>\n<p>StyleSheet 是 React Native 提供的样式管理系统，用于创建和优化样式表。以下是全面解析：</p>\n<h2>一、核心概念与基础使用</h2>\n<h3>1. 基本创建方式</h3>\n<pre><code class="language-javascript"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">StyleSheet</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;react-native&#x27;</span>;\n\n<span class="hljs-keyword">const</span> styles = <span class="hljs-title class_">StyleSheet</span>.<span class="hljs-title function_">create</span>({\n  <span class="hljs-attr">container</span>: {\n    <span class="hljs-attr">flex</span>: <span class="hljs-number">1</span>,\n    <span class="hljs-attr">backgroundColor</span>: <span class="hljs-string">&#x27;#fff&#x27;</span>,\n    <span class="hljs-attr">padding</span>: <span class="hljs-number">20</span>\n  },\n  <span class="hljs-attr">title</span>: {\n    <span class="hljs-attr">fontSize</span>: <span class="hljs-number">18</span>,\n    <span class="hljs-attr">fontWeight</span>: <span class="hljs-string">&#x27;bold&#x27;</span>,\n    <span class="hljs-attr">color</span>: <span class="hljs-string">&#x27;#333&#x27;</span>\n  }\n});\n\n<span class="hljs-comment">// 使用</span>\n<span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">View</span> <span class="hljs-attr">style</span>=<span class="hljs-string">{styles.container}</span>&gt;</span>\n  <span class="hljs-tag">&lt;<span class="hljs-name">Text</span> <span class="hljs-attr">style</span>=<span class="hljs-string">{styles.title}</span>&gt;</span>标题<span class="hljs-tag">&lt;/<span class="hljs-name">Text</span>&gt;</span>\n<span class="hljs-tag">&lt;/<span class="hljs-name">View</span>&gt;</span></span>\n</code></pre>\n<h3>2. 样式继承特性</h3>\n<ul>\n<li><strong>不继承</strong>  ：与Web不同，RN样式默认不继承</li>\n<li><strong>组合样式</strong>  ：通过数组实现多样式组合</li>\n</ul>\n<pre><code class="language-javascript">&lt;<span class="hljs-title class_">Text</span> style={[styles.<span class="hljs-property">base</span>, styles.<span class="hljs-property">title</span>, { <span class="hljs-attr">color</span>: <span class="hljs-string">&#x27;red&#x27;</span> }]}&gt;\n  组合样式\n&lt;/<span class="hljs-title class_">Text</span>&gt;\n</code></pre>\n<h2>二、样式表优化原理</h2>\n<h3>1. 性能优势</h3>\n<table>\n<thead>\n<tr>\n<th>特性</th>\n<th>普通对象</th>\n<th>StyleSheet</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>序列化</td>\n<td>每次渲染</td>\n<td>仅一次</td>\n</tr>\n<tr>\n<td>内存使用</td>\n<td>高</td>\n<td>低</td>\n</tr>\n<tr>\n<td>桥接次数</td>\n<td>多次</td>\n<td>一次</td>\n</tr>\n</tbody>\n</table>\n<h3>2. 底层实现机制</h3>\n<pre><code class="language-javascript"><span class="hljs-comment">// 伪代码示意</span>\n<span class="hljs-keyword">const</span> <span class="hljs-title function_">styleSheetCreate</span> = (<span class="hljs-params">styles</span>) =&gt; {\n  <span class="hljs-keyword">const</span> result = {};\n  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> key <span class="hljs-keyword">in</span> styles) {\n    result[key] = <span class="hljs-title function_">processStyle</span>(styles[key]); <span class="hljs-comment">// 序列化并分配ID</span>\n  }\n  <span class="hljs-keyword">return</span> result;\n};\n</code></pre>\n<h2>三、高级样式技巧</h2>\n<h3>1. 动态样式处理</h3>\n<pre><code class="language-javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">DynamicStyleComponent</span>(<span class="hljs-params">{ active }</span>) {\n  <span class="hljs-keyword">return</span> (\n    <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">View</span> <span class="hljs-attr">style</span>=<span class="hljs-string">{[</span>\n      <span class="hljs-attr">styles.box</span>,\n      <span class="hljs-attr">active</span> &amp;&amp; <span class="hljs-attr">styles.activeBox</span>,\n      { <span class="hljs-attr">opacity:</span> <span class="hljs-attr">active</span> ? <span class="hljs-attr">1</span> <span class="hljs-attr">:</span> <span class="hljs-attr">0.5</span> }\n    ]} /&gt;</span></span>\n  );\n}\n\n<span class="hljs-keyword">const</span> styles = <span class="hljs-title class_">StyleSheet</span>.<span class="hljs-title function_">create</span>({\n  <span class="hljs-attr">box</span>: {\n    <span class="hljs-attr">width</span>: <span class="hljs-number">100</span>,\n    <span class="hljs-attr">height</span>: <span class="hljs-number">100</span>\n  },\n  <span class="hljs-attr">activeBox</span>: {\n    <span class="hljs-attr">borderWidth</span>: <span class="hljs-number">2</span>,\n    <span class="hljs-attr">borderColor</span>: <span class="hljs-string">&#x27;blue&#x27;</span>\n  }\n});\n</code></pre>\n<h3>2. 媒体查询替代方案</h3>\n<pre><code class="language-javascript"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">Dimensions</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;react-native&#x27;</span>;\n\n<span class="hljs-keyword">const</span> { width } = <span class="hljs-title class_">Dimensions</span>.<span class="hljs-title function_">get</span>(<span class="hljs-string">&#x27;window&#x27;</span>);\n\n<span class="hljs-keyword">const</span> styles = <span class="hljs-title class_">StyleSheet</span>.<span class="hljs-title function_">create</span>({\n  <span class="hljs-attr">container</span>: {\n    <span class="hljs-attr">flexDirection</span>: width &gt; <span class="hljs-number">500</span> ? <span class="hljs-string">&#x27;row&#x27;</span> : <span class="hljs-string">&#x27;column&#x27;</span>\n  }\n});\n</code></pre>\n<h2>三、平台特定样式</h2>\n<h3>1. 平台差异处理</h3>\n<pre><code class="language-javascript"><span class="hljs-keyword">const</span> styles = <span class="hljs-title class_">StyleSheet</span>.<span class="hljs-title function_">create</span>({\n  <span class="hljs-attr">header</span>: {\n    <span class="hljs-attr">height</span>: <span class="hljs-title class_">Platform</span>.<span class="hljs-title function_">select</span>({\n      <span class="hljs-attr">ios</span>: <span class="hljs-number">44</span>,\n      <span class="hljs-attr">android</span>: <span class="hljs-number">56</span>,\n      <span class="hljs-attr">default</span>: <span class="hljs-number">50</span>\n    }),\n    ...<span class="hljs-title class_">Platform</span>.<span class="hljs-title function_">select</span>({\n      <span class="hljs-attr">ios</span>: {\n        <span class="hljs-attr">shadowColor</span>: <span class="hljs-string">&#x27;#000&#x27;</span>,\n        <span class="hljs-attr">shadowOffset</span>: { <span class="hljs-attr">width</span>: <span class="hljs-number">0</span>, <span class="hljs-attr">height</span>: <span class="hljs-number">2</span> },\n        <span class="hljs-attr">shadowOpacity</span>: <span class="hljs-number">0.2</span>\n      },\n      <span class="hljs-attr">android</span>: {\n        <span class="hljs-attr">elevation</span>: <span class="hljs-number">3</span>\n      }\n    })\n  }\n});\n</code></pre>\n<h3>2. 像素精确处理</h3>\n<pre><code class="language-javascript"><span class="hljs-keyword">const</span> styles = <span class="hljs-title class_">StyleSheet</span>.<span class="hljs-title function_">create</span>({\n  <span class="hljs-attr">hairline</span>: {\n    <span class="hljs-attr">height</span>: <span class="hljs-title class_">StyleSheet</span>.<span class="hljs-property">hairlineWidth</span> <span class="hljs-comment">// 最细的物理像素宽度</span>\n  },\n  <span class="hljs-attr">pixelPerfect</span>: {\n    <span class="hljs-attr">borderWidth</span>: <span class="hljs-title class_">PixelRatio</span>.<span class="hljs-title function_">roundToNearestPixel</span>(<span class="hljs-number">1.3</span>)\n  }\n});\n</code></pre>\n<h2>四、实用工具方法</h2>\n<h3>1. 样式合并工具</h3>\n<pre><code class="language-javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">mergeStyles</span>(<span class="hljs-params">styleArray</span>) {\n  <span class="hljs-keyword">return</span> <span class="hljs-title class_">StyleSheet</span>.<span class="hljs-title function_">flatten</span>(styleArray);\n}\n\n<span class="hljs-comment">// 使用示例</span>\n<span class="hljs-keyword">const</span> combined = <span class="hljs-title function_">mergeStyles</span>([styles.<span class="hljs-property">base</span>, { <span class="hljs-attr">color</span>: <span class="hljs-string">&#x27;red&#x27;</span> }]);\n</code></pre>\n<h3>2. 响应式样式Hook</h3>\n<pre><code class="language-javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">useResponsiveStyle</span>(<span class="hljs-params">baseStyle, breakpoints</span>) {\n  <span class="hljs-keyword">const</span> { width } = <span class="hljs-title function_">useWindowDimensions</span>();\n  \n  <span class="hljs-keyword">return</span> <span class="hljs-title function_">useMemo</span>(<span class="hljs-function">() =&gt;</span> {\n    <span class="hljs-keyword">const</span> responsiveStyles = {};\n    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> [key, value] <span class="hljs-keyword">of</span> <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">entries</span>(breakpoints)) {\n      <span class="hljs-keyword">if</span> (width &gt;= value) {\n        <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">assign</span>(responsiveStyles, baseStyle[key]);\n      }\n    }\n    <span class="hljs-keyword">return</span> <span class="hljs-title class_">StyleSheet</span>.<span class="hljs-title function_">create</span>({ <span class="hljs-attr">responsive</span>: { ...baseStyle.<span class="hljs-property">common</span>, ...responsiveStyles } });\n  }, [width]);\n}\n\n<span class="hljs-comment">// 使用示例</span>\n<span class="hljs-keyword">const</span> { responsive } = <span class="hljs-title function_">useResponsiveStyle</span>(\n  {\n    <span class="hljs-attr">common</span>: { <span class="hljs-attr">fontSize</span>: <span class="hljs-number">16</span> },\n    <span class="hljs-attr">small</span>: { <span class="hljs-attr">padding</span>: <span class="hljs-number">10</span> },\n    <span class="hljs-attr">medium</span>: { <span class="hljs-attr">padding</span>: <span class="hljs-number">20</span> }\n  },\n  { <span class="hljs-attr">small</span>: <span class="hljs-number">0</span>, <span class="hljs-attr">medium</span>: <span class="hljs-number">768</span> }\n);\n</code></pre>\n<h2>五、最佳实践建议</h2>\n<ol>\n<li><strong>样式隔离</strong>  ：每个组件维护自己的StyleSheet</li>\n<li><strong>常量提取</strong>  ：将颜色、间距等提取为常量</li>\n<li><strong>避免内联</strong>  ：减少内联样式对象的使用</li>\n<li><strong>性能监控</strong>  ：用<code>Performance</code>API检测样式计算时间</li>\n</ol>\n<h2>六、调试技巧</h2>\n<h3>1. 样式调试工具</h3>\n<pre><code class="language-javascript"><span class="hljs-comment">// 打印编译后的样式</span>\n<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title class_">StyleSheet</span>.<span class="hljs-title function_">flatten</span>(styles.<span class="hljs-property">container</span>));\n</code></pre>\n<h3>2. 开发环境警告</h3>\n<pre><code class="language-javascript"><span class="hljs-comment">// 检测无效样式属性</span>\n<span class="hljs-keyword">if</span> (__DEV__) {\n  <span class="hljs-keyword">const</span> originalCreate = <span class="hljs-title class_">StyleSheet</span>.<span class="hljs-property">create</span>;\n  <span class="hljs-title class_">StyleSheet</span>.<span class="hljs-property">create</span> = <span class="hljs-function">(<span class="hljs-params">styles</span>) =&gt;</span> {\n    <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">keys</span>(styles).<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">key</span> =&gt;</span> {\n      <span class="hljs-keyword">const</span> invalidProps = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">keys</span>(styles[key])\n        .<span class="hljs-title function_">filter</span>(<span class="hljs-function"><span class="hljs-params">prop</span> =&gt;</span> !validStyleProps.<span class="hljs-title function_">has</span>(prop));\n      <span class="hljs-keyword">if</span> (invalidProps.<span class="hljs-property">length</span>) {\n        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">warn</span>(<span class="hljs-string">`无效样式属性: <span class="hljs-subst">${invalidProps.join(<span class="hljs-string">&#x27;, &#x27;</span>)}</span>`</span>);\n      }\n    });\n    <span class="hljs-keyword">return</span> <span class="hljs-title function_">originalCreate</span>(styles);\n  };\n}\n</code></pre>\n<h2>七、与CSS的差异对比</h2>\n<table>\n<thead>\n<tr>\n<th>特性</th>\n<th>CSS</th>\n<th>React Native StyleSheet</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>单位</td>\n<td>px/em/rem</td>\n<td>无单位数字</td>\n</tr>\n<tr>\n<td>选择器</td>\n<td>支持</td>\n<td>不支持</td>\n</tr>\n<tr>\n<td>继承</td>\n<td>支持</td>\n<td>不支持</td>\n</tr>\n<tr>\n<td>动画</td>\n<td>@keyframes</td>\n<td>Animated API</td>\n</tr>\n<tr>\n<td>伪类</td>\n<td>支持</td>\n<td>不支持</td>\n</tr>\n</tbody>\n</table>\n<p>通过深入理解 StyleSheet，开发者可以：</p>\n<ol>\n<li>创建高性能的样式系统</li>\n<li>实现精细的样式控制</li>\n<li>优化应用渲染性能</li>\n<li>维护可扩展的样式代码</li>\n</ol>\n<p>建议将全局样式常量与组件样式分离，保持代码的组织性和可维护性。</p>\n</div>'</script></body></html>