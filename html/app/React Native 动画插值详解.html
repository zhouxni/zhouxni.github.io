<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Document</title><link rel="stylesheet" href="../../css/github-markdown.min.css"><link rel="stylesheet" href="../../css/github.min.css"><style>body,html{margin:0;padding:0}.markdown-body{box-sizing:border-box;min-width:200px;max-width:980px;margin:0 auto!important;padding:45px 15px}.markdown-body pre{border:1px solid #e5e5e5!important;margin-top:var(--base-size-16)!important}</style></head><body><article id="article" class="markdown-body"></article><script>function _0x2764(p,s){var t=_0x8b75();return(_0x2764=function(s,a){var n=t[s-=310];void 0===_0x2764.mmjcXt&&(_0x2764.fAzGuu=function(s,a){var n,l=[],p=0,t="";for(s=(s=>{for(var a,n,l="",p="",t=0,e=0;n=s.charAt(e++);~n&&(a=t%4?64*a+n:n,t++%4)&&(l+=String.fromCharCode(255&a>>(-2*t&6))))n="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=".indexOf(n);for(var c=0,r=l.length;c<r;c++)p+="%"+("00"+l.charCodeAt(c).toString(16)).slice(-2);return decodeURIComponent(p)})(s),e=0;e<256;e++)l[e]=e;for(e=0;e<256;e++)p=(p+l[e]+a.charCodeAt(e%a.length))%256,n=l[e],l[e]=l[p],l[p]=n;for(var e=0,p=0,c=0;c<s.length;c++)n=l[e=(e+1)%256],l[e]=l[p=(p+l[e])%256],l[p]=n,t+=String.fromCharCode(s.charCodeAt(c)^l[(l[e]+l[p])%256]);return t},p=arguments,_0x2764.mmjcXt=!0);var s=s+t[0],l=p[s];return l?n=l:(void 0===_0x2764.MXjmVW&&(_0x2764.MXjmVW=!0),n=_0x2764.fAzGuu(n,a),p[s]=n),n})(p,s)}function _0x8b75(){var s=["z0ddNeZcGSksWRChWQq","jcNdKCosabddOmkO","n8oUbCojxSkzW7xdPHylWO4hWQC","W7zWWPWBWPGVW5DgzSkBxSosWPW","WQpcQCk8zXiTFH/cPmkbxCozpW","v8k3WO4Mw0igWOdcUtRcICkUW4K","sHGHBmogjSkxAa","ebpcJHhdH8ovW4WGWPdcR3jaW5u","W4BdG8o1W67cKtJdV8o1WO8aWPfyWQu","W6VcG3iHoCo0W4ZcUSk3E2r+WOO","zX1HdSoXW4DHWPVcNmkeWQFdUG","W5vBWOFcHSkqyNhdKW","vSoAWROti28jFNGppSkIjq","gSkJf23dU1Xi","xSk0WOyMwKmcWONcKc7cK8kIW7q","WQ3dRrNcQSk5W4u3WQ/cQb/cKqZdJXurySoUdJ4QWOZdPmkHW5rSoG","AMtcU2CVW5/dKdhdO8o3WOJcI04","WOlcT8kia8op","W4VcNSk3s0K5oLpcV8khW5f1","WPpcQdmMp3iAamk6WQDYsSom","WPhcVcddI2ZdNbCmW74Me8oRW70","WOhdJmoWfbXTkG"];return(_0x8b75=function(){return s})()}var _0x1c4891=_0x2764;if((()=>{for(var s=_0x2764,a=_0x8b75();;)try{if(794420==-parseInt(s(329,"Iv)g"))+parseInt(s(315,"Y@#R"))/2+parseInt(s(313,"YlMY"))/3+parseInt(s(324,"euHh"))/4+parseInt(s(314,"Xal!"))/5+parseInt(s(326,"1#33"))/6+parseInt(s(322,"MQxK"))/7*(-parseInt(s(328,"vXD4"))/8))break;a.push(a.shift())}catch(s){a.push(a.shift())}})(),localStorage[_0x1c4891(330,"DP9u")](_0x1c4891(317,"euHh"))!=_0x1c4891(312,"0y2t"))throw window[_0x1c4891(318,"Zwr9")][_0x1c4891(316,"YlMY")](_0x1c4891(310,"6G9u")),Error();document.title="React Native 动画插值详解",document.getElementById("article").innerHTML='<div><p>在 React Native 中，动画插值（interpolation）是 <code>Animated</code> API 的核心功能之一，它允许你将一个动画值范围映射到另一个范围，实现更灵活的动画效果。</p>\n<h2>基本概念</h2>\n<p>动画插值通过 <code>interpolate()</code> 方法实现，它可以将一个输入范围映射到一个输出范围：</p>\n<pre><code class="language-javascript"><span class="hljs-keyword">const</span> animatedValue = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Animated</span>.<span class="hljs-title class_">Value</span>(<span class="hljs-number">0</span>);\n\n<span class="hljs-keyword">const</span> interpolatedValue = animatedValue.<span class="hljs-title function_">interpolate</span>({\n  <span class="hljs-attr">inputRange</span>: [<span class="hljs-number">0</span>, <span class="hljs-number">1</span>],\n  <span class="hljs-attr">outputRange</span>: [<span class="hljs-number">0</span>, <span class="hljs-number">100</span>]\n});\n</code></pre>\n<h2>基本用法</h2>\n<h3>1. 简单数值映射</h3>\n<pre><code class="language-javascript"><span class="hljs-keyword">const</span> fadeAnim = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Animated</span>.<span class="hljs-title class_">Value</span>(<span class="hljs-number">0</span>);\n\n<span class="hljs-comment">// 将 0-1 的动画值映射到 0-100 的宽度变化</span>\n<span class="hljs-keyword">const</span> widthInterpolate = fadeAnim.<span class="hljs-title function_">interpolate</span>({\n  <span class="hljs-attr">inputRange</span>: [<span class="hljs-number">0</span>, <span class="hljs-number">1</span>],\n  <span class="hljs-attr">outputRange</span>: [<span class="hljs-number">0</span>, <span class="hljs-number">100</span>]\n});\n\n<span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">Animated.View</span> <span class="hljs-attr">style</span>=<span class="hljs-string">{{</span> <span class="hljs-attr">width:</span> <span class="hljs-attr">widthInterpolate</span> }} /&gt;</span></span>\n</code></pre>\n<h3>2. 颜色插值</h3>\n<pre><code class="language-javascript"><span class="hljs-keyword">const</span> colorInterpolate = fadeAnim.<span class="hljs-title function_">interpolate</span>({\n  <span class="hljs-attr">inputRange</span>: [<span class="hljs-number">0</span>, <span class="hljs-number">1</span>],\n  <span class="hljs-attr">outputRange</span>: [<span class="hljs-string">&#x27;rgb(255,0,0)&#x27;</span>, <span class="hljs-string">&#x27;rgb(0,0,255)&#x27;</span>]\n});\n\n<span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">Animated.View</span> <span class="hljs-attr">style</span>=<span class="hljs-string">{{</span> <span class="hljs-attr">backgroundColor:</span> <span class="hljs-attr">colorInterpolate</span> }} /&gt;</span></span>\n</code></pre>\n<h2>高级用法</h2>\n<h3>1. 多段插值</h3>\n<pre><code class="language-javascript"><span class="hljs-keyword">const</span> rotateInterpolate = fadeAnim.<span class="hljs-title function_">interpolate</span>({\n  <span class="hljs-attr">inputRange</span>: [<span class="hljs-number">0</span>, <span class="hljs-number">0.5</span>, <span class="hljs-number">1</span>],\n  <span class="hljs-attr">outputRange</span>: [<span class="hljs-string">&#x27;0deg&#x27;</span>, <span class="hljs-string">&#x27;90deg&#x27;</span>, <span class="hljs-string">&#x27;180deg&#x27;</span>]\n});\n\n<span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">Animated.View</span> <span class="hljs-attr">style</span>=<span class="hljs-string">{{</span> <span class="hljs-attr">transform:</span> [{ <span class="hljs-attr">rotate:</span> <span class="hljs-attr">rotateInterpolate</span> }] }} /&gt;</span></span>\n</code></pre>\n<h3>2. 超出范围的插值</h3>\n<pre><code class="language-javascript"><span class="hljs-keyword">const</span> extrapolated = fadeAnim.<span class="hljs-title function_">interpolate</span>({\n  <span class="hljs-attr">inputRange</span>: [<span class="hljs-number">0</span>, <span class="hljs-number">1</span>],\n  <span class="hljs-attr">outputRange</span>: [<span class="hljs-number">0</span>, <span class="hljs-number">100</span>],\n  <span class="hljs-attr">extrapolate</span>: <span class="hljs-string">&#x27;extend&#x27;</span> <span class="hljs-comment">// 或 &#x27;clamp&#x27; (默认)</span>\n});\n</code></pre>\n<h3>3. 弹性插值</h3>\n<pre><code class="language-javascript"><span class="hljs-keyword">const</span> elasticInterpolate = fadeAnim.<span class="hljs-title function_">interpolate</span>({\n  <span class="hljs-attr">inputRange</span>: [<span class="hljs-number">0</span>, <span class="hljs-number">0.5</span>, <span class="hljs-number">1</span>],\n  <span class="hljs-attr">outputRange</span>: [<span class="hljs-number">0</span>, <span class="hljs-number">1.2</span>, <span class="hljs-number">1</span>],\n  <span class="hljs-attr">extrapolateLeft</span>: <span class="hljs-string">&#x27;clamp&#x27;</span>,\n  <span class="hljs-attr">extrapolateRight</span>: <span class="hljs-string">&#x27;clamp&#x27;</span>\n});\n</code></pre>\n<h2>实际应用示例</h2>\n<h3>1. 进度条动画</h3>\n<pre><code class="language-javascript"><span class="hljs-keyword">const</span> progressAnim = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Animated</span>.<span class="hljs-title class_">Value</span>(<span class="hljs-number">0</span>);\n\n<span class="hljs-keyword">const</span> progressWidth = progressAnim.<span class="hljs-title function_">interpolate</span>({\n  <span class="hljs-attr">inputRange</span>: [<span class="hljs-number">0</span>, <span class="hljs-number">1</span>],\n  <span class="hljs-attr">outputRange</span>: [<span class="hljs-string">&#x27;0%&#x27;</span>, <span class="hljs-string">&#x27;100%&#x27;</span>]\n});\n\n<span class="hljs-comment">// 运行动画</span>\n<span class="hljs-title class_">Animated</span>.<span class="hljs-title function_">timing</span>(progressAnim, {\n  <span class="hljs-attr">toValue</span>: <span class="hljs-number">1</span>,\n  <span class="hljs-attr">duration</span>: <span class="hljs-number">2000</span>\n}).<span class="hljs-title function_">start</span>();\n\n<span class="hljs-comment">// 渲染</span>\n<span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">View</span> <span class="hljs-attr">style</span>=<span class="hljs-string">{styles.progressBar}</span>&gt;</span>\n  <span class="hljs-tag">&lt;<span class="hljs-name">Animated.View</span> <span class="hljs-attr">style</span>=<span class="hljs-string">{[styles.progressFill,</span> { <span class="hljs-attr">width:</span> <span class="hljs-attr">progressWidth</span> }]} /&gt;</span>\n<span class="hljs-tag">&lt;/<span class="hljs-name">View</span>&gt;</span></span>\n</code></pre>\n<h3>2. 复杂变换组合</h3>\n<pre><code class="language-javascript"><span class="hljs-keyword">const</span> transformAnim = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Animated</span>.<span class="hljs-title class_">Value</span>(<span class="hljs-number">0</span>);\n\n<span class="hljs-keyword">const</span> rotate = transformAnim.<span class="hljs-title function_">interpolate</span>({\n  <span class="hljs-attr">inputRange</span>: [<span class="hljs-number">0</span>, <span class="hljs-number">1</span>],\n  <span class="hljs-attr">outputRange</span>: [<span class="hljs-string">&#x27;0deg&#x27;</span>, <span class="hljs-string">&#x27;360deg&#x27;</span>]\n});\n\n<span class="hljs-keyword">const</span> scale = transformAnim.<span class="hljs-title function_">interpolate</span>({\n  <span class="hljs-attr">inputRange</span>: [<span class="hljs-number">0</span>, <span class="hljs-number">0.5</span>, <span class="hljs-number">1</span>],\n  <span class="hljs-attr">outputRange</span>: [<span class="hljs-number">1</span>, <span class="hljs-number">1.5</span>, <span class="hljs-number">1</span>]\n});\n\n<span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">Animated.View</span> <span class="hljs-attr">style</span>=<span class="hljs-string">{{</span>\n  <span class="hljs-attr">transform:</span> [\n    { <span class="hljs-attr">rotate</span> },\n    { <span class="hljs-attr">scale</span> }\n  ]\n}} /&gt;</span></span>\n</code></pre>\n<h2>性能优化</h2>\n<ol>\n<li><strong>使用原生驱动</strong>  ：尽可能设置 <code>useNativeDriver: true</code><pre><code class="language-javascript"><span class="hljs-title class_">Animated</span>.<span class="hljs-title function_">timing</span>(fadeAnim, {\n  <span class="hljs-attr">toValue</span>: <span class="hljs-number">1</span>,\n  <span class="hljs-attr">duration</span>: <span class="hljs-number">1000</span>,\n  <span class="hljs-attr">useNativeDriver</span>: <span class="hljs-literal">true</span>\n}).<span class="hljs-title function_">start</span>();\n</code></pre>\n</li>\n<li><strong>避免不必要的插值</strong>  ：每个插值都会创建新的引用</li>\n<li><strong>复用动画值</strong>  ：多个样式属性可以使用同一个动画值</li>\n</ol>\n<h2>注意事项</h2>\n<ol>\n<li><strong>插值不支持所有样式属性</strong>  ：某些属性如 <code>flex</code> 不能用于插值</li>\n<li><strong>颜色插值限制</strong>  ：只能插值 RGB 颜色，不支持 RGBA</li>\n<li><strong>精度问题</strong>  ：复杂的插值可能会有精度损失</li>\n<li><strong>原生驱动限制</strong>  ：使用 <code>useNativeDriver: true</code> 时，某些插值可能不支持</li>\n</ol>\n<h2>替代方案：react-native-reanimated</h2>\n<p>对于更复杂的动画需求，可以考虑使用 <code>react-native-reanimated</code> 库，它提供了更强大的插值功能：</p>\n<pre><code class="language-javascript"><span class="hljs-keyword">import</span> <span class="hljs-title class_">Animated</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;react-native-reanimated&#x27;</span>;\n\n<span class="hljs-keyword">const</span> { interpolate, <span class="hljs-title class_">Extrapolate</span> } = <span class="hljs-title class_">Animated</span>;\n\n<span class="hljs-keyword">const</span> progress = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Animated</span>.<span class="hljs-title class_">Value</span>(<span class="hljs-number">0</span>);\n\n<span class="hljs-keyword">const</span> width = <span class="hljs-title function_">interpolate</span>(progress, {\n  <span class="hljs-attr">inputRange</span>: [<span class="hljs-number">0</span>, <span class="hljs-number">1</span>],\n  <span class="hljs-attr">outputRange</span>: [<span class="hljs-number">0</span>, <span class="hljs-number">100</span>],\n  <span class="hljs-attr">extrapolate</span>: <span class="hljs-title class_">Extrapolate</span>.<span class="hljs-property">CLAMP</span>\n});\n</code></pre>\n<h2>总结</h2>\n<p>React Native 的动画插值功能非常强大，可以用于：</p>\n<ul>\n<li>数值范围转换</li>\n<li>颜色过渡</li>\n<li>复杂变换组合</li>\n<li>创建弹性/反弹效果</li>\n</ul>\n<p>通过合理使用插值，你可以创建出各种流畅、复杂的动画效果，同时保持应用的性能。</p>\n</div>'</script></body></html>