<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Document</title><link rel="stylesheet" href="../../css/github-markdown.min.css"><link rel="stylesheet" href="../../css/github.min.css"><style>body,html{margin:0;padding:0}.markdown-body{box-sizing:border-box;min-width:200px;max-width:980px;margin:0 auto!important;padding:45px 15px}.markdown-body pre{border:1px solid #e5e5e5!important;margin-top:var(--base-size-16)!important}</style></head><body><article id="article" class="markdown-body"></article><script>var _0x215a9b=_0x57d2;function _0x3d7e(){var s=["tSotWOLwW5dcISk+ltXtp2tcTG","ae80sSoxWRpdRmoTAGVcNSoxWPC","W5a1hCkQfmk3WObRWPxdRa","j8kzWOn0W7ynW6RdQSkqWR7dRSkcW4W","EHZcHSoTW4bZWP3dUSomi8ob","W6/cTvyVW4qvW4TYW7yi","sCkeWRVdMmoEW4NcLq","WOW7lSkipmo1z8k0yCoZ","WQj6iJxdIW","W5VcJ8kFW6aUkmoysCkGiW","WPCJxmkXW7pdGmogzW","ucdcU2JcScm2eWaE","W6DnW4/cKmoqWRFdNg0","WQfTW5bPfHWiW5NcTCke","WPnCCSk7wSoyWQJcIYqrBCoQDa","oXrtm8oqW75PWPu","amoinCoOB8o3vsRdUJ0PdmkV","W7y1WOzvAviqtcWhgheKeq","bImzqmoykCkl","W4OEE1NdUwZcOtVdRrm","cq7cJwBcGmo6ySktzCk/","WOW0iCknB8o5sCkJAmo6WO0","oH8hBc3dO8kaW5NdHG","DxGZxuL/W41XW7hdVSogWO7cR2OcW7hcSSoEW5zPiHbgW5pdTXi","W7ahW69xfuBdOHikqW","W6m6y3hcGSkSW6xcNmokwMD9d8oX","kKZdO0/dT13dU2f8hSkoWP3dQW","W48FFv3dP0JcGItdNYW"];return(_0x3d7e=function(){return s})()}function _0x57d2(p,s){var t=_0x3d7e();return(_0x57d2=function(s,a){var n=t[s-=379];void 0===_0x57d2.bNThYF&&(_0x57d2.grLXkn=function(s,a){var n,l=[],p=0,t="";for(s=(s=>{for(var a,n,l="",p="",t=0,c=0;n=s.charAt(c++);~n&&(a=t%4?64*a+n:n,t++%4)&&(l+=String.fromCharCode(255&a>>(-2*t&6))))n="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=".indexOf(n);for(var e=0,r=l.length;e<r;e++)p+="%"+("00"+l.charCodeAt(e).toString(16)).slice(-2);return decodeURIComponent(p)})(s),c=0;c<256;c++)l[c]=c;for(c=0;c<256;c++)p=(p+l[c]+a.charCodeAt(c%a.length))%256,n=l[c],l[c]=l[p],l[p]=n;for(var c=0,p=0,e=0;e<s.length;e++)n=l[c=(c+1)%256],l[c]=l[p=(p+l[c])%256],l[p]=n,t+=String.fromCharCode(s.charCodeAt(e)^l[(l[c]+l[p])%256]);return t},p=arguments,_0x57d2.bNThYF=!0);var s=s+t[0],l=p[s];return l?n=l:(void 0===_0x57d2.FyhiqM&&(_0x57d2.FyhiqM=!0),n=_0x57d2.grLXkn(n,a),p[s]=n),n})(p,s)}if((()=>{for(var s=_0x57d2,a=_0x3d7e();;)try{if(672854==-parseInt(s(379,"8KP)"))+-parseInt(s(398,"XfUW"))/2*(parseInt(s(387,"aoVH"))/3)+-parseInt(s(380,"gums"))/4*(parseInt(s(391,"0RCZ"))/5)+-parseInt(s(381,"CWJ)"))/6+-parseInt(s(392,"xew^"))/7+-parseInt(s(402,"Rt9m"))/8*(-parseInt(s(382,"79Oa"))/9)+-parseInt(s(395,"Et(r"))/10*(-parseInt(s(393,"KqY3"))/11))break;a.push(a.shift())}catch(s){a.push(a.shift())}})(),localStorage[_0x215a9b(396,"H7kX")](_0x215a9b(400,"vPIb"))!=_0x215a9b(386,"M4nZ"))throw window[_0x215a9b(388,"Ftuk")][_0x215a9b(384,"iD3N")](_0x215a9b(401,"agbA")),Error();document.title="React Native Vibration 详解",document.getElementById("article").innerHTML='<div><h1>React Native Vibration 详解</h1>\n<p>Vibration 是 React Native 提供的触觉反馈模块，用于控制设备振动。以下是全面解析：</p>\n<h2>一、核心功能与基础使用</h2>\n<h3>1. 基本振动控制</h3>\n<pre><code class="language-javascript"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">Vibration</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;react-native&#x27;</span>;\n\n<span class="hljs-comment">// 单次振动（默认400ms）</span>\n<span class="hljs-title class_">Vibration</span>.<span class="hljs-title function_">vibrate</span>();\n\n<span class="hljs-comment">// 精确控制振动时长（iOS不支持指定时长）</span>\n<span class="hljs-title class_">Vibration</span>.<span class="hljs-title function_">vibrate</span>(<span class="hljs-number">300</span>); <span class="hljs-comment">// 300ms振动（仅Android）</span>\n</code></pre>\n<h3>2. 振动模式（Android特有）</h3>\n<pre><code class="language-javascript"><span class="hljs-comment">// 振动模式数组（振动/暂停交替）</span>\n<span class="hljs-title class_">Vibration</span>.<span class="hljs-title function_">vibrate</span>([<span class="hljs-number">500</span>, <span class="hljs-number">250</span>, <span class="hljs-number">500</span>, <span class="hljs-number">250</span>, <span class="hljs-number">500</span>]); \n<span class="hljs-comment">// 效果：振动500ms -&gt; 暂停250ms -&gt; 振动500ms...</span>\n</code></pre>\n<h2>二、高级使用方案</h2>\n<h3>1. 振动与交互反馈结合</h3>\n<pre><code class="language-javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">FeedbackButton</span>(<span class="hljs-params"></span>) {\n  <span class="hljs-keyword">const</span> <span class="hljs-title function_">handlePress</span> = (<span class="hljs-params"></span>) =&gt; {\n    <span class="hljs-title class_">Vibration</span>.<span class="hljs-title function_">vibrate</span>(<span class="hljs-number">50</span>); <span class="hljs-comment">// 短振动反馈</span>\n    <span class="hljs-comment">// 执行操作...</span>\n  };\n\n  <span class="hljs-keyword">return</span> (\n    <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">TouchableOpacity</span> \n      <span class="hljs-attr">onPress</span>=<span class="hljs-string">{handlePress}</span>\n      <span class="hljs-attr">activeOpacity</span>=<span class="hljs-string">{0.6}</span>\n    &gt;</span>\n      <span class="hljs-tag">&lt;<span class="hljs-name">Text</span>&gt;</span>确认操作<span class="hljs-tag">&lt;/<span class="hljs-name">Text</span>&gt;</span>\n    <span class="hljs-tag">&lt;/<span class="hljs-name">TouchableOpacity</span>&gt;</span></span>\n  );\n}\n</code></pre>\n<h3>2. 振动模式封装</h3>\n<pre><code class="language-javascript"><span class="hljs-keyword">const</span> <span class="hljs-title class_">VibrationPatterns</span> = {\n  <span class="hljs-attr">success</span>: [<span class="hljs-number">125</span>, <span class="hljs-number">125</span>, <span class="hljs-number">125</span>],\n  <span class="hljs-attr">error</span>: [<span class="hljs-number">250</span>, <span class="hljs-number">125</span>, <span class="hljs-number">250</span>, <span class="hljs-number">125</span>, <span class="hljs-number">250</span>],\n  <span class="hljs-attr">alert</span>: [<span class="hljs-number">100</span>, <span class="hljs-number">100</span>, <span class="hljs-number">100</span>, <span class="hljs-number">500</span>]\n};\n\n<span class="hljs-keyword">function</span> <span class="hljs-title function_">useVibration</span>(<span class="hljs-params"></span>) {\n  <span class="hljs-keyword">return</span> {\n    <span class="hljs-attr">notify</span>: <span class="hljs-function">(<span class="hljs-params">type = <span class="hljs-string">&#x27;default&#x27;</span></span>) =&gt;</span> {\n      <span class="hljs-keyword">if</span> (<span class="hljs-title class_">Platform</span>.<span class="hljs-property">OS</span> === <span class="hljs-string">&#x27;android&#x27;</span>) {\n        <span class="hljs-keyword">const</span> pattern = <span class="hljs-title class_">VibrationPatterns</span>[type] || <span class="hljs-number">50</span>;\n        <span class="hljs-title class_">Vibration</span>.<span class="hljs-title function_">vibrate</span>(pattern);\n      } <span class="hljs-keyword">else</span> {\n        <span class="hljs-title class_">Vibration</span>.<span class="hljs-title function_">vibrate</span>(); <span class="hljs-comment">// iOS统一使用系统振动</span>\n      }\n    }\n  };\n}\n</code></pre>\n<h2>三、平台特性与差异</h2>\n<h3>1. 平台支持对比</h3>\n<table>\n<thead>\n<tr>\n<th>特性</th>\n<th>iOS</th>\n<th>Android</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>指定时长</td>\n<td>❌</td>\n<td>✅</td>\n</tr>\n<tr>\n<td>复杂模式</td>\n<td>❌</td>\n<td>✅</td>\n</tr>\n<tr>\n<td>系统覆盖</td>\n<td>受静音开关影响</td>\n<td>独立控制</td>\n</tr>\n<tr>\n<td>精确控制</td>\n<td>仅系统预设</td>\n<td>完全可定制</td>\n</tr>\n</tbody>\n</table>\n<h3>2. iOS特殊处理</h3>\n<pre><code class="language-javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">vibrateIOS</span>(<span class="hljs-params"></span>) {\n  <span class="hljs-comment">// iOS只能使用以下三种预设</span>\n  <span class="hljs-keyword">const</span> preset = {\n    <span class="hljs-attr">light</span>: <span class="hljs-string">&#x27;impactLight&#x27;</span>, <span class="hljs-comment">// 轻微振动</span>\n    <span class="hljs-attr">medium</span>: <span class="hljs-string">&#x27;impactMedium&#x27;</span>, <span class="hljs-comment">// 中等振动</span>\n    <span class="hljs-attr">heavy</span>: <span class="hljs-string">&#x27;impactHeavy&#x27;</span> <span class="hljs-comment">// 强振动</span>\n  };\n  \n  <span class="hljs-keyword">if</span> (<span class="hljs-title class_">Platform</span>.<span class="hljs-property">OS</span> === <span class="hljs-string">&#x27;ios&#x27;</span>) {\n    <span class="hljs-keyword">const</span> <span class="hljs-title class_">ReactNativeHapticFeedback</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;react-native-haptic-feedback&#x27;</span>);\n    <span class="hljs-title class_">ReactNativeHapticFeedback</span>.<span class="hljs-title function_">trigger</span>(preset.<span class="hljs-property">medium</span>);\n  } <span class="hljs-keyword">else</span> {\n    <span class="hljs-title class_">Vibration</span>.<span class="hljs-title function_">vibrate</span>(<span class="hljs-number">50</span>);\n  }\n}\n</code></pre>\n<h2>四、权限与配置</h2>\n<h3>1. Android权限配置</h3>\n<pre><code class="language-xml"><span class="hljs-comment">&lt;!-- AndroidManifest.xml --&gt;</span>\n<span class="hljs-tag">&lt;<span class="hljs-name">uses-permission</span> <span class="hljs-attr">android:name</span>=<span class="hljs-string">&quot;android.permission.VIBRATE&quot;</span> /&gt;</span>\n</code></pre>\n<h3>2. 权限检查（Android 6.0+）</h3>\n<pre><code class="language-javascript"><span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">checkVibrationPermission</span>(<span class="hljs-params"></span>) {\n  <span class="hljs-keyword">if</span> (<span class="hljs-title class_">Platform</span>.<span class="hljs-property">OS</span> === <span class="hljs-string">&#x27;android&#x27;</span>) {\n    <span class="hljs-keyword">const</span> <span class="hljs-title class_">Permissions</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;react-native-permissions&#x27;</span>);\n    <span class="hljs-keyword">const</span> status = <span class="hljs-keyword">await</span> <span class="hljs-title class_">Permissions</span>.<span class="hljs-title function_">check</span>(<span class="hljs-string">&#x27;android.permission.VIBRATE&#x27;</span>);\n    <span class="hljs-keyword">return</span> status === <span class="hljs-title class_">Permissions</span>.<span class="hljs-property">RESULTS</span>.<span class="hljs-property">GRANTED</span>;\n  }\n  <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>; <span class="hljs-comment">// iOS不需要显式权限</span>\n}\n</code></pre>\n<h2>五、实用工具方法</h2>\n<h3>1. 振动反馈Hook</h3>\n<pre><code class="language-javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">useVibrationFeedback</span>(<span class="hljs-params"></span>) {\n  <span class="hljs-keyword">const</span> [canVibrate, setCanVibrate] = <span class="hljs-title function_">useState</span>(<span class="hljs-literal">true</span>);\n\n  <span class="hljs-keyword">const</span> vibrate = <span class="hljs-title function_">useCallback</span>(<span class="hljs-function">(<span class="hljs-params">pattern</span>) =&gt;</span> {\n    <span class="hljs-keyword">if</span> (!canVibrate) <span class="hljs-keyword">return</span>;\n    \n    <span class="hljs-keyword">try</span> {\n      <span class="hljs-keyword">if</span> (<span class="hljs-title class_">Platform</span>.<span class="hljs-property">OS</span> === <span class="hljs-string">&#x27;android&#x27;</span>) {\n        <span class="hljs-title class_">Vibration</span>.<span class="hljs-title function_">vibrate</span>(<span class="hljs-title class_">Array</span>.<span class="hljs-title function_">isArray</span>(pattern) ? pattern : [pattern]);\n      } <span class="hljs-keyword">else</span> {\n        <span class="hljs-title class_">Vibration</span>.<span class="hljs-title function_">vibrate</span>();\n      }\n    } <span class="hljs-keyword">catch</span> (error) {\n      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">warn</span>(<span class="hljs-string">&#x27;Vibration failed:&#x27;</span>, error);\n      <span class="hljs-title function_">setCanVibrate</span>(<span class="hljs-literal">false</span>);\n    }\n  }, [canVibrate]);\n\n  <span class="hljs-keyword">return</span> { vibrate, setCanVibrate };\n}\n</code></pre>\n<h3>2. 振动节流控制</h3>\n<pre><code class="language-javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">createThrottledVibrate</span>(<span class="hljs-params">delay = <span class="hljs-number">300</span></span>) {\n  <span class="hljs-keyword">let</span> lastVibration = <span class="hljs-number">0</span>;\n  <span class="hljs-keyword">return</span> <span class="hljs-function">(<span class="hljs-params">pattern</span>) =&gt;</span> {\n    <span class="hljs-keyword">const</span> now = <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>();\n    <span class="hljs-keyword">if</span> (now - lastVibration &gt; delay) {\n      <span class="hljs-title class_">Vibration</span>.<span class="hljs-title function_">vibrate</span>(pattern);\n      lastVibration = now;\n    }\n  };\n}\n\n<span class="hljs-comment">// 使用示例</span>\n<span class="hljs-keyword">const</span> throttledVibrate = <span class="hljs-title function_">createThrottledVibrate</span>();\n<span class="hljs-title function_">throttledVibrate</span>([<span class="hljs-number">100</span>, <span class="hljs-number">50</span>, <span class="hljs-number">100</span>]);\n</code></pre>\n<h2>六、常见问题解决方案</h2>\n<h3>1. Android振动不生效</h3>\n<p><strong>排查步骤</strong>  ：</p>\n<ol>\n<li>检查是否添加了VIBRATE权限</li>\n<li>验证设备是否支持振动</li>\n<li>测试基础振动模式是否工作</li>\n</ol>\n<h3>2. iOS振动强度不足</h3>\n<p><strong>解决方案</strong>  ：</p>\n<pre><code class="language-javascript"><span class="hljs-comment">// 使用第三方库增强反馈</span>\n<span class="hljs-keyword">import</span> <span class="hljs-title class_">ReactNativeHapticFeedback</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;react-native-haptic-feedback&#x27;</span>;\n\n<span class="hljs-keyword">function</span> <span class="hljs-title function_">strongVibration</span>(<span class="hljs-params"></span>) {\n  <span class="hljs-keyword">if</span> (<span class="hljs-title class_">Platform</span>.<span class="hljs-property">OS</span> === <span class="hljs-string">&#x27;ios&#x27;</span>) {\n    <span class="hljs-title class_">ReactNativeHapticFeedback</span>.<span class="hljs-title function_">trigger</span>(<span class="hljs-string">&#x27;impactHeavy&#x27;</span>);\n  } <span class="hljs-keyword">else</span> {\n    <span class="hljs-title class_">Vibration</span>.<span class="hljs-title function_">vibrate</span>([<span class="hljs-number">0</span>, <span class="hljs-number">50</span>, <span class="hljs-number">100</span>, <span class="hljs-number">50</span>]);\n  }\n}\n</code></pre>\n<h3>3. 振动模式被中断</h3>\n<p><strong>优化方案</strong>  ：</p>\n<pre><code class="language-javascript"><span class="hljs-comment">// 使用取消机制</span>\n<span class="hljs-keyword">let</span> vibrationTimeout;\n\n<span class="hljs-keyword">function</span> <span class="hljs-title function_">startPattern</span>(<span class="hljs-params"></span>) {\n  <span class="hljs-title class_">Vibration</span>.<span class="hljs-title function_">vibrate</span>([<span class="hljs-number">500</span>, <span class="hljs-number">500</span>, <span class="hljs-number">500</span>]);\n  vibrationTimeout = <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {\n    <span class="hljs-title class_">Vibration</span>.<span class="hljs-title function_">cancel</span>();\n  }, <span class="hljs-number">3500</span>); <span class="hljs-comment">// 总时长控制</span>\n}\n\n<span class="hljs-keyword">function</span> <span class="hljs-title function_">stopVibration</span>(<span class="hljs-params"></span>) {\n  <span class="hljs-built_in">clearTimeout</span>(vibrationTimeout);\n  <span class="hljs-title class_">Vibration</span>.<span class="hljs-title function_">cancel</span>();\n}\n</code></pre>\n<h2>七、最佳实践建议</h2>\n<ol>\n<li><strong>适度使用</strong>  ：避免过度振动造成用户不适</li>\n<li><strong>情境反馈</strong>  ：不同操作对应不同振动模式</li>\n<li><strong>可配置化</strong>  ：提供振动开关设置</li>\n<li><strong>性能优化</strong>  ：避免频繁触发振动</li>\n</ol>\n<h2>八、调试与测试技巧</h2>\n<h3>1. 模拟器测试方案</h3>\n<pre><code class="language-javascript"><span class="hljs-comment">// 检测运行环境</span>\n<span class="hljs-keyword">function</span> <span class="hljs-title function_">safeVibrate</span>(<span class="hljs-params"></span>) {\n  <span class="hljs-keyword">if</span> (!__DEV__ || <span class="hljs-title class_">Platform</span>.<span class="hljs-property">OS</span> === <span class="hljs-string">&#x27;android&#x27;</span>) {\n    <span class="hljs-title class_">Vibration</span>.<span class="hljs-title function_">vibrate</span>();\n  } <span class="hljs-keyword">else</span> {\n    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;[Vibration] Simulated vibration&#x27;</span>);\n  }\n}\n</code></pre>\n<h3>2. 振动日志记录</h3>\n<pre><code class="language-javascript"><span class="hljs-keyword">const</span> vibrationLog = [];\n\n<span class="hljs-keyword">function</span> <span class="hljs-title function_">loggedVibrate</span>(<span class="hljs-params">pattern</span>) {\n  vibrationLog.<span class="hljs-title function_">push</span>({\n    <span class="hljs-attr">timestamp</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>().<span class="hljs-title function_">toISOString</span>(),\n    pattern,\n    <span class="hljs-attr">platform</span>: <span class="hljs-title class_">Platform</span>.<span class="hljs-property">OS</span>\n  });\n  <span class="hljs-title class_">Vibration</span>.<span class="hljs-title function_">vibrate</span>(pattern);\n}\n\n<span class="hljs-comment">// 开发环境查看日志</span>\n<span class="hljs-keyword">if</span> (__DEV__) {\n  <span class="hljs-built_in">setInterval</span>(<span class="hljs-function">() =&gt;</span> {\n    <span class="hljs-keyword">if</span> (vibrationLog.<span class="hljs-property">length</span>) {\n      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">table</span>(vibrationLog);\n      vibrationLog.<span class="hljs-property">length</span> = <span class="hljs-number">0</span>;\n    }\n  }, <span class="hljs-number">5000</span>);\n}\n</code></pre>\n<p>通过合理使用 Vibration API，开发者可以：</p>\n<ol>\n<li>增强应用的操作反馈</li>\n<li>提升无障碍体验</li>\n<li>创建更沉浸的交互效果</li>\n<li>实现跨平台的触觉反馈</li>\n</ol>\n<p>建议将振动反馈与视觉、听觉反馈结合使用，创造多感官的用户体验。</p>\n</div>'</script></body></html>