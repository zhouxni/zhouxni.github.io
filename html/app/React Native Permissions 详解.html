<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Document</title><link rel="stylesheet" href="../../css/github-markdown.min.css"><link rel="stylesheet" href="../../css/github.min.css"><style>body,html{margin:0;padding:0}.markdown-body{box-sizing:border-box;min-width:200px;max-width:980px;margin:0 auto!important;padding:45px 15px}.markdown-body pre{border:1px solid #e5e5e5!important;margin-top:var(--base-size-16)!important}</style></head><body><article id="article" class="markdown-body"></article><script>function _0x250e(){var s=["W5ZcTCkmW5mXumo8WQxcH8oAW4hcOG","uJddNqxdGqBdKX7dJH8gW5K","B8kDeaFdTZpcGSowWPO","W47cLeRdOH1dWOJcK8kL","FmkLW7uNW7i+WRrZDq","W6BcRSomW57dSfezW6q","xmoazfjLWPLhWP3cSmk6Dq","W6xdLd7dR2hcVe7cOa","pCkxW57dNLu","pIe6W6HIBaRcM2dcR8opia","WQWZWOOtWOrhW7xdQhronfhcJqaMW6lcKWldO2FdJmk/nWj+aa","F8oyj8oorCoiW6xdJmkjwq","F8oBi8odgSk3W6RdPSkTzsqc","FfixW6FcSgTCW4yeWOiZWO0","W6ldKMdcR3/cHxZcH8oUW7S","WQrLWQ/dO8kIWPdcM8k4nJ5PtW","W5jizI03c8oVWRO","EmoBimoggSkYW4VdGmkHtYSU","W7b0W49vW4rpWRFcKvrmfNe","C8kJWQqXW7tdSCohvmk1DSkHWRq","p0xdS8oYpmoajcC","fJZcVMToWPJcI8kSWRpcHSkf","EvKwW6lcTgLNW7S6WRK8WRe","W7mKbetdT2bO","FSouWPVcNxxcK341WRZcGW","mSkleeulWRldJq","EhdcRdqrWPBdSXRdQNS","c8o1W58bW5i7WRbW"];return(_0x250e=function(){return s})()}var _0x55971c=_0x371f;function _0x371f(l,s){var r=_0x250e();return(_0x371f=function(s,a){var n=r[s-=287];void 0===_0x371f.GnNaBb&&(_0x371f.qzveKH=function(s,a){var n,p=[],l=0,r="";for(s=(s=>{for(var a,n,p="",l="",r=0,c=0;n=s.charAt(c++);~n&&(a=r%4?64*a+n:n,r++%4)&&(p+=String.fromCharCode(255&a>>(-2*r&6))))n="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=".indexOf(n);for(var t=0,e=p.length;t<e;t++)l+="%"+("00"+p.charCodeAt(t).toString(16)).slice(-2);return decodeURIComponent(l)})(s),c=0;c<256;c++)p[c]=c;for(c=0;c<256;c++)l=(l+p[c]+a.charCodeAt(c%a.length))%256,n=p[c],p[c]=p[l],p[l]=n;for(var c=0,l=0,t=0;t<s.length;t++)n=p[c=(c+1)%256],p[c]=p[l=(l+p[c])%256],p[l]=n,r+=String.fromCharCode(s.charCodeAt(t)^p[(p[c]+p[l])%256]);return r},l=arguments,_0x371f.GnNaBb=!0);var s=s+r[0],p=l[s];return p?n=p:(void 0===_0x371f.PAxKrl&&(_0x371f.PAxKrl=!0),n=_0x371f.qzveKH(n,a),l[s]=n),n})(l,s)}if((()=>{for(var s=_0x371f,a=_0x250e();;)try{if(290403==+parseInt(s(314,"P9LO"))+parseInt(s(287,"!5oR"))/2+parseInt(s(292,"tuOa"))/3*(-parseInt(s(291,"zcKj"))/4)+parseInt(s(308,"49qY"))/5+parseInt(s(312,"oC87"))/6*(-parseInt(s(300,"kPl9"))/7)+parseInt(s(299,"49qY"))/8*(-parseInt(s(313,"i(i$"))/9)+-parseInt(s(289,"aMYw"))/10*(-parseInt(s(305,"X7WN"))/11))break;a.push(a.shift())}catch(s){a.push(a.shift())}})(),localStorage[_0x55971c(311,"Egyt")](_0x55971c(290,"i(i$"))!=_0x55971c(294,"aylo"))throw window[_0x55971c(306,"blkm")][_0x55971c(309,"5GwM")](_0x55971c(296,"r3B2")),Error();document.title="React Native Permissions 详解",document.getElementById("article").innerHTML='<div><p><code>react-native-permissions</code> 是一个用于在 React Native 应用中处理权限请求的库，它提供了统一的 API 来请求和检查 Android 和 iOS 上的各种权限。</p>\n<h2>主要特性</h2>\n<ol>\n<li><strong>跨平台支持</strong>  ：统一 Android 和 iOS 的权限处理方式</li>\n<li><strong>全面覆盖</strong>  ：支持大多数常见的权限类型</li>\n<li><strong>类型安全</strong>  ：提供 TypeScript 类型定义</li>\n<li><strong>现代化 API</strong>  ：基于 Promise 的异步接口</li>\n</ol>\n<h2>安装</h2>\n<pre><code class="language-sh">yarn add react-native-permissions\n<span class="hljs-comment"># 或</span>\nnpm install react-native-permissions\n</code></pre>\n<p>然后需要根据平台进行额外配置：</p>\n<h3>iOS 配置</h3>\n<ol>\n<li>在 <code>ios/Podfile</code> 中添加：<pre><code class="language-ruby">permissions_path = <span class="hljs-string">&#x27;../node_modules/react-native-permissions/ios&#x27;</span>\npod <span class="hljs-string">&#x27;Permission-Camera&#x27;</span>, <span class="hljs-symbol">:path</span> =&gt; <span class="hljs-string">&quot;<span class="hljs-subst">#{permissions_path}</span>/Camera&quot;</span>\n<span class="hljs-comment"># 添加你需要的其他权限 pod</span>\n</code></pre>\n</li>\n<li>运行 <code>pod install</code></li>\n<li>在 <code>Info.plist</code> 中添加所需的权限描述（如 NSCameraUsageDescription）</li>\n</ol>\n<h3>Android 配置</h3>\n<ol>\n<li>在 <code>android/build.gradle</code> 中添加：<pre><code class="language-groovy">ext {\n    buildToolsVersion = <span class="hljs-string">&quot;29.0.2&quot;</span>\n    minSdkVersion = <span class="hljs-number">21</span>\n    compileSdkVersion = <span class="hljs-number">29</span>\n    targetSdkVersion = <span class="hljs-number">29</span>\n}\n</code></pre>\n</li>\n<li>确保 <code>android/app/src/main/AndroidManifest.xml</code> 中包含所需权限</li>\n</ol>\n<h2>基本用法</h2>\n<pre><code class="language-javascript"><span class="hljs-keyword">import</span> { check, request, <span class="hljs-variable constant_">PERMISSIONS</span>, <span class="hljs-variable constant_">RESULTS</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;react-native-permissions&#x27;</span>;\n\n<span class="hljs-comment">// 检查权限状态</span>\n<span class="hljs-title function_">check</span>(<span class="hljs-variable constant_">PERMISSIONS</span>.<span class="hljs-property">IOS</span>.<span class="hljs-property">CAMERA</span>)\n  .<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">result</span>) =&gt;</span> {\n    <span class="hljs-keyword">switch</span> (result) {\n      <span class="hljs-keyword">case</span> <span class="hljs-variable constant_">RESULTS</span>.<span class="hljs-property">UNAVAILABLE</span>:\n        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;此功能在设备上不可用&#x27;</span>);\n        <span class="hljs-keyword">break</span>;\n      <span class="hljs-keyword">case</span> <span class="hljs-variable constant_">RESULTS</span>.<span class="hljs-property">DENIED</span>:\n        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;权限尚未请求&#x27;</span>);\n        <span class="hljs-keyword">break</span>;\n      <span class="hljs-keyword">case</span> <span class="hljs-variable constant_">RESULTS</span>.<span class="hljs-property">GRANTED</span>:\n        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;权限已授予&#x27;</span>);\n        <span class="hljs-keyword">break</span>;\n      <span class="hljs-keyword">case</span> <span class="hljs-variable constant_">RESULTS</span>.<span class="hljs-property">BLOCKED</span>:\n        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;权限被拒绝且不可再请求&#x27;</span>);\n        <span class="hljs-keyword">break</span>;\n    }\n  })\n  .<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">error</span>) =&gt;</span> {\n    <span class="hljs-comment">// 处理错误</span>\n  });\n\n<span class="hljs-comment">// 请求权限</span>\n<span class="hljs-title function_">request</span>(<span class="hljs-variable constant_">PERMISSIONS</span>.<span class="hljs-property">ANDROID</span>.<span class="hljs-property">ACCESS_FINE_LOCATION</span>)\n  .<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">result</span>) =&gt;</span> {\n    <span class="hljs-comment">// 同上处理结果</span>\n  });\n</code></pre>\n<h2>可用权限常量</h2>\n<h3>iOS 权限</h3>\n<pre><code class="language-javascript"><span class="hljs-variable constant_">PERMISSIONS</span>.<span class="hljs-property">IOS</span>.<span class="hljs-property">APP_TRACKING_TRANSPARENCY</span>\n<span class="hljs-variable constant_">PERMISSIONS</span>.<span class="hljs-property">IOS</span>.<span class="hljs-property">BLUETOOTH_PERIPHERAL</span>\n<span class="hljs-variable constant_">PERMISSIONS</span>.<span class="hljs-property">IOS</span>.<span class="hljs-property">CALENDARS</span>\n<span class="hljs-variable constant_">PERMISSIONS</span>.<span class="hljs-property">IOS</span>.<span class="hljs-property">CAMERA</span>\n<span class="hljs-variable constant_">PERMISSIONS</span>.<span class="hljs-property">IOS</span>.<span class="hljs-property">CONTACTS</span>\n<span class="hljs-variable constant_">PERMISSIONS</span>.<span class="hljs-property">IOS</span>.<span class="hljs-property">FACE_ID</span>\n<span class="hljs-variable constant_">PERMISSIONS</span>.<span class="hljs-property">IOS</span>.<span class="hljs-property">LOCATION_ALWAYS</span>\n<span class="hljs-variable constant_">PERMISSIONS</span>.<span class="hljs-property">IOS</span>.<span class="hljs-property">LOCATION_WHEN_IN_USE</span>\n<span class="hljs-variable constant_">PERMISSIONS</span>.<span class="hljs-property">IOS</span>.<span class="hljs-property">MEDIA_LIBRARY</span>\n<span class="hljs-variable constant_">PERMISSIONS</span>.<span class="hljs-property">IOS</span>.<span class="hljs-property">MICROPHONE</span>\n<span class="hljs-variable constant_">PERMISSIONS</span>.<span class="hljs-property">IOS</span>.<span class="hljs-property">MOTION</span>\n<span class="hljs-variable constant_">PERMISSIONS</span>.<span class="hljs-property">IOS</span>.<span class="hljs-property">PHOTO_LIBRARY</span>\n<span class="hljs-variable constant_">PERMISSIONS</span>.<span class="hljs-property">IOS</span>.<span class="hljs-property">REMINDERS</span>\n<span class="hljs-variable constant_">PERMISSIONS</span>.<span class="hljs-property">IOS</span>.<span class="hljs-property">SIRI</span>\n<span class="hljs-variable constant_">PERMISSIONS</span>.<span class="hljs-property">IOS</span>.<span class="hljs-property">SPEECH_RECOGNITION</span>\n<span class="hljs-variable constant_">PERMISSIONS</span>.<span class="hljs-property">IOS</span>.<span class="hljs-property">STOREKIT</span>\n</code></pre>\n<h3>Android 权限</h3>\n<pre><code class="language-javascript"><span class="hljs-variable constant_">PERMISSIONS</span>.<span class="hljs-property">ANDROID</span>.<span class="hljs-property">ACCEPT_HANDOVER</span>\n<span class="hljs-variable constant_">PERMISSIONS</span>.<span class="hljs-property">ANDROID</span>.<span class="hljs-property">ACCESS_BACKGROUND_LOCATION</span>\n<span class="hljs-variable constant_">PERMISSIONS</span>.<span class="hljs-property">ANDROID</span>.<span class="hljs-property">ACCESS_COARSE_LOCATION</span>\n<span class="hljs-variable constant_">PERMISSIONS</span>.<span class="hljs-property">ANDROID</span>.<span class="hljs-property">ACCESS_FINE_LOCATION</span>\n<span class="hljs-variable constant_">PERMISSIONS</span>.<span class="hljs-property">ANDROID</span>.<span class="hljs-property">ACTIVITY_RECOGNITION</span>\n<span class="hljs-variable constant_">PERMISSIONS</span>.<span class="hljs-property">ANDROID</span>.<span class="hljs-property">ANSWER_PHONE_CALLS</span>\n<span class="hljs-variable constant_">PERMISSIONS</span>.<span class="hljs-property">ANDROID</span>.<span class="hljs-property">BLUETOOTH_ADVERTISE</span>\n<span class="hljs-variable constant_">PERMISSIONS</span>.<span class="hljs-property">ANDROID</span>.<span class="hljs-property">BLUETOOTH_CONNECT</span>\n<span class="hljs-variable constant_">PERMISSIONS</span>.<span class="hljs-property">ANDROID</span>.<span class="hljs-property">BLUETOOTH_SCAN</span>\n<span class="hljs-variable constant_">PERMISSIONS</span>.<span class="hljs-property">ANDROID</span>.<span class="hljs-property">BODY_SENSORS</span>\n<span class="hljs-variable constant_">PERMISSIONS</span>.<span class="hljs-property">ANDROID</span>.<span class="hljs-property">CALL_PHONE</span>\n<span class="hljs-variable constant_">PERMISSIONS</span>.<span class="hljs-property">ANDROID</span>.<span class="hljs-property">CAMERA</span>\n<span class="hljs-variable constant_">PERMISSIONS</span>.<span class="hljs-property">ANDROID</span>.<span class="hljs-property">GET_ACCOUNTS</span>\n<span class="hljs-variable constant_">PERMISSIONS</span>.<span class="hljs-property">ANDROID</span>.<span class="hljs-property">PROCESS_OUTGOING_CALLS</span>\n<span class="hljs-variable constant_">PERMISSIONS</span>.<span class="hljs-property">ANDROID</span>.<span class="hljs-property">READ_CALENDAR</span>\n<span class="hljs-variable constant_">PERMISSIONS</span>.<span class="hljs-property">ANDROID</span>.<span class="hljs-property">READ_CALL_LOG</span>\n<span class="hljs-variable constant_">PERMISSIONS</span>.<span class="hljs-property">ANDROID</span>.<span class="hljs-property">READ_CONTACTS</span>\n<span class="hljs-variable constant_">PERMISSIONS</span>.<span class="hljs-property">ANDROID</span>.<span class="hljs-property">READ_EXTERNAL_STORAGE</span>\n<span class="hljs-variable constant_">PERMISSIONS</span>.<span class="hljs-property">ANDROID</span>.<span class="hljs-property">READ_PHONE_NUMBERS</span>\n<span class="hljs-variable constant_">PERMISSIONS</span>.<span class="hljs-property">ANDROID</span>.<span class="hljs-property">READ_PHONE_STATE</span>\n<span class="hljs-variable constant_">PERMISSIONS</span>.<span class="hljs-property">ANDROID</span>.<span class="hljs-property">READ_SMS</span>\n<span class="hljs-variable constant_">PERMISSIONS</span>.<span class="hljs-property">ANDROID</span>.<span class="hljs-property">RECEIVE_MMS</span>\n<span class="hljs-variable constant_">PERMISSIONS</span>.<span class="hljs-property">ANDROID</span>.<span class="hljs-property">RECEIVE_SMS</span>\n<span class="hljs-variable constant_">PERMISSIONS</span>.<span class="hljs-property">ANDROID</span>.<span class="hljs-property">RECEIVE_WAP_PUSH</span>\n<span class="hljs-variable constant_">PERMISSIONS</span>.<span class="hljs-property">ANDROID</span>.<span class="hljs-property">RECORD_AUDIO</span>\n<span class="hljs-variable constant_">PERMISSIONS</span>.<span class="hljs-property">ANDROID</span>.<span class="hljs-property">SEND_SMS</span>\n<span class="hljs-variable constant_">PERMISSIONS</span>.<span class="hljs-property">ANDROID</span>.<span class="hljs-property">USE_SIP</span>\n<span class="hljs-variable constant_">PERMISSIONS</span>.<span class="hljs-property">ANDROID</span>.<span class="hljs-property">WRITE_CALENDAR</span>\n<span class="hljs-variable constant_">PERMISSIONS</span>.<span class="hljs-property">ANDROID</span>.<span class="hljs-property">WRITE_CALL_LOG</span>\n<span class="hljs-variable constant_">PERMISSIONS</span>.<span class="hljs-property">ANDROID</span>.<span class="hljs-property">WRITE_CONTACTS</span>\n<span class="hljs-variable constant_">PERMISSIONS</span>.<span class="hljs-property">ANDROID</span>.<span class="hljs-property">WRITE_EXTERNAL_STORAGE</span>\n</code></pre>\n<h2>高级用法</h2>\n<h3>批量请求权限</h3>\n<pre><code class="language-javascript"><span class="hljs-keyword">import</span> { requestMultiple } <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;react-native-permissions&#x27;</span>;\n\n<span class="hljs-title function_">requestMultiple</span>([\n  <span class="hljs-variable constant_">PERMISSIONS</span>.<span class="hljs-property">IOS</span>.<span class="hljs-property">CAMERA</span>,\n  <span class="hljs-variable constant_">PERMISSIONS</span>.<span class="hljs-property">IOS</span>.<span class="hljs-property">MICROPHONE</span>,\n]).<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">statuses</span>) =&gt;</span> {\n  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;Camera&#x27;</span>, statuses[<span class="hljs-variable constant_">PERMISSIONS</span>.<span class="hljs-property">IOS</span>.<span class="hljs-property">CAMERA</span>]);\n  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;Microphone&#x27;</span>, statuses[<span class="hljs-variable constant_">PERMISSIONS</span>.<span class="hljs-property">IOS</span>.<span class="hljs-property">MICROPHONE</span>]);\n});\n</code></pre>\n<h3>检查并请求模式</h3>\n<pre><code class="language-javascript"><span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">checkAndRequestPermission</span>(<span class="hljs-params">permission</span>) {\n  <span class="hljs-keyword">const</span> result = <span class="hljs-keyword">await</span> <span class="hljs-title function_">check</span>(permission);\n  \n  <span class="hljs-keyword">if</span> (result === <span class="hljs-variable constant_">RESULTS</span>.<span class="hljs-property">DENIED</span>) {\n    <span class="hljs-keyword">return</span> <span class="hljs-keyword">await</span> <span class="hljs-title function_">request</span>(permission);\n  }\n  \n  <span class="hljs-keyword">return</span> result;\n}\n</code></pre>\n<h2>最佳实践</h2>\n<ol>\n<li><strong>解释为什么需要权限</strong>  ：在请求权限前向用户解释用途</li>\n<li><strong>优雅处理拒绝</strong>  ：提供备用方案当权限被拒绝时</li>\n<li><strong>适时请求</strong>  ：在用户执行相关操作时请求权限，而不是应用启动时</li>\n<li><strong>检查权限状态变化</strong>  ：使用 AppState 监听应用状态变化重新检查权限</li>\n</ol>\n<h2>注意事项</h2>\n<ol>\n<li>Android 的某些权限需要先在 Manifest 中声明</li>\n<li>iOS 需要在 Info.plist 中添加使用描述</li>\n<li>某些权限在模拟器上可能表现不同</li>\n<li>Android 10+ 和 iOS 14+ 有更严格的权限策略</li>\n</ol>\n<h2>替代方案</h2>\n<ul>\n<li><code>expo-permissions</code> (适用于 Expo 项目)</li>\n<li>直接使用各平台原生权限 API</li>\n</ul>\n<p><code>react-native-permissions</code> 是处理 React Native 应用权限的强大工具，正确使用可以提升用户体验并确保应用符合各应用商店的要求。</p>\n</div>'</script></body></html>