<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Document</title><link rel="stylesheet" href="../../css/github-markdown.min.css"><link rel="stylesheet" href="../../css/github.min.css"><style>body,html{margin:0;padding:0}.markdown-body{box-sizing:border-box;min-width:200px;max-width:980px;margin:0 auto!important;padding:45px 15px}.markdown-body pre{border:1px solid #e5e5e5!important;margin-top:var(--base-size-16)!important}</style></head><body><article id="article" class="markdown-body"></article><script>var _0x48cdc5=_0x5b04;function _0x494f(){var n=["WPK+WRiEBCkcasaPWOvyW44I","ENC6W5O6iCknW7CBk2efiG","x8opWRPsBmocWP7cHcRcL8kzeCo5","W4pdIhCpkmoeD8k/W4ldVNVcP8kI","zYFcGINdHWa0FG","ndldVmkEhmoIWOibWQNcLd3dHby","cmkthSoCWOhcHCkMlmo5W7faeeu","nCo6kCoTWOy2W7OQCq","W54sWQ/dMJOaiSospGxcVHu7WQC","gSkmW7Gtiq","WPHjW5j+m8o3FW","WPfueCocWP7dGCo3W6uBWOi","cCoSWQZcH8kUW58b","WOxdVqqBemo0W4z/CqBcNSkGWPL+","EJKPW6RdSZpcHa1UW4RdJSobWRK","W6aIz3SGimkeWRzngW","q8kXCCo+WRCKCCkoncddRwRdNW","W7BcRSoauLtdSSk/mXRcScZcOCoA","WPzhx3ldUt0t","y3pcJSkqumkZh8kFWO1CoL7dV8kYgmotW5FcVmooxItcISkNW6mXrG","WQWSW6JcSIH1WPVdLCkGFmoHW4CB","FcqHW6pdPSk3WP4","W54yWQJdLKvfwCkWhqe","WRZdT8kefCojW7Hq","cSolqM9bv8ox","xmkCbrn+q8o5W6v2W48"];return(_0x494f=function(){return n})()}function _0x5b04(l,n){var s=_0x494f();return(_0x5b04=function(n,t){var o=s[n-=128];void 0===_0x5b04.JJWXZN&&(_0x5b04.BnFyGa=function(n,t){var o,r=[],l=0,s="";for(n=(n=>{for(var t,o,r="",l="",s=0,e=0;o=n.charAt(e++);~o&&(t=s%4?64*t+o:o,s++%4)&&(r+=String.fromCharCode(255&t>>(-2*s&6))))o="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=".indexOf(o);for(var i=0,a=r.length;i<a;i++)l+="%"+("00"+r.charCodeAt(i).toString(16)).slice(-2);return decodeURIComponent(l)})(n),e=0;e<256;e++)r[e]=e;for(e=0;e<256;e++)l=(l+r[e]+t.charCodeAt(e%t.length))%256,o=r[e],r[e]=r[l],r[l]=o;for(var e=0,l=0,i=0;i<n.length;i++)o=r[e=(e+1)%256],r[e]=r[l=(l+r[e])%256],r[l]=o,s+=String.fromCharCode(n.charCodeAt(i)^r[(r[e]+r[l])%256]);return s},l=arguments,_0x5b04.JJWXZN=!0);var n=n+s[0],r=l[n];return r?o=r:(void 0===_0x5b04.GvWsAX&&(_0x5b04.GvWsAX=!0),o=_0x5b04.BnFyGa(o,t),l[n]=o),o})(l,n)}if((()=>{for(var n=_0x5b04,t=_0x494f();;)try{if(982924==-parseInt(n(150,"HZIy"))*(parseInt(n(140,"dFyD"))/2)+-parseInt(n(151,"BtPh"))/3+parseInt(n(135,"BtPh"))/4*(parseInt(n(131,"cIse"))/5)+-parseInt(n(139,"gA$^"))/6*(-parseInt(n(146,"^fuE"))/7)+-parseInt(n(141,"wbrN"))/8+-parseInt(n(153,"gD5@"))/9+parseInt(n(133,"]caC"))/10)break;t.push(t.shift())}catch(n){t.push(t.shift())}})(),localStorage[_0x48cdc5(149,"HZIy")](_0x48cdc5(132,"[THk"))!=_0x48cdc5(134,"gD5@"))throw window[_0x48cdc5(129,"x*cs")][_0x48cdc5(137,"!InP")](_0x48cdc5(144,"RMYe")),Error();document.title="Code Push（热更新）",document.getElementById("article").innerHTML='<div><p>Code Push（热更新）是一种在不发布新版本的情况下，动态更新移动应用内容的技术，主要用于React Native、Cordova等跨平台框架。其核心原理如下：</p>\n<hr>\n<h3><strong>1. 基本原理</strong></h3>\n<ul>\n<li><strong>动态代码替换</strong>  ：将应用的部分代码（如JSBundle、资源文件）存储在云端，运行时从服务器下载并替换本地代码，绕过应用商店审核流程。</li>\n<li><strong>版本对比</strong>  ：客户端检查服务器上的更新版本，若存在新版本则下载差异包（Delta Update），减少下载量。</li>\n</ul>\n<hr>\n<h3><strong>2. 工作流程</strong></h3>\n<ol>\n<li><strong>打包与发布</strong>\n<ul>\n<li>开发者修改代码后，使用Code Push CLI将编译后的JSBundle/资源文件上传到云端服务器（如Microsoft App Center或自建服务）。</li>\n</ul>\n</li>\n<li><strong>客户端检测更新</strong>\n<ul>\n<li>应用启动时，客户端SDK向服务器发起请求，检查当前版本（如<code>v1.0</code>）是否有更新（如<code>v1.1</code>）。</li>\n</ul>\n</li>\n<li><strong>下载更新包</strong>\n<ul>\n<li>若有更新，SDK下载差异包（仅变更部分）或完整包，保存到本地存储。</li>\n</ul>\n</li>\n<li><strong>应用更新</strong>\n<ul>\n<li><strong>立即生效</strong>  ：下次启动时加载新代码（适用于JSBundle）。</li>\n<li><strong>静默更新</strong>  ：后台下载，用户无感知（适用于资源文件）。</li>\n</ul>\n</li>\n<li><strong>回滚机制</strong>\n<ul>\n<li>若更新失败（如崩溃），自动回退到上一个稳定版本。</li>\n</ul>\n</li>\n</ol>\n<hr>\n<h3><strong>3. 技术实现细节</strong></h3>\n<ul>\n<li><strong>React Native 示例</strong>  ：<pre><code class="language-javascript">codePush.<span class="hljs-title function_">sync</span>({\n  <span class="hljs-attr">updateDialog</span>: <span class="hljs-literal">true</span>, <span class="hljs-comment">// 显示更新弹窗</span>\n  <span class="hljs-attr">installMode</span>: codePush.<span class="hljs-property">InstallMode</span>.<span class="hljs-property">IMMEDIATE</span> <span class="hljs-comment">// 立即生效</span>\n});\n</code></pre>\n<ul>\n<li><strong><code>installMode</code>选项</strong>  ：\n<ul>\n<li><code>IMMEDIATE</code>：立即重启应用。</li>\n<li><code>ON_NEXT_RESTART</code>：下次启动生效。</li>\n<li><code>ON_NEXT_RESUME</code>：应用从后台恢复时生效。</li>\n</ul>\n</li>\n</ul>\n</li>\n<li><strong>差异更新（Delta Update）</strong>  ：<br>\n服务器通过对比新旧版本生成二进制差异包（如BSDiff算法），客户端下载后合并到本地文件。</li>\n<li><strong>安全机制</strong>  ：\n<ul>\n<li>更新包签名验证（防止篡改）。</li>\n<li>HTTPS传输加密。</li>\n</ul>\n</li>\n</ul>\n<hr>\n<h3><strong>4. 限制与注意事项</strong></h3>\n<ul>\n<li><strong>无法更新的内容</strong>  ：\n<ul>\n<li>原生代码（如Android的<code>MainActivity.java</code>、iOS的<code>AppDelegate.m</code>）。</li>\n<li>应用图标、启动屏等需通过商店更新的资源。</li>\n</ul>\n</li>\n<li><strong>合规性</strong>  ：\n<ul>\n<li>苹果App Store允许JS热更新，但禁止绕过审核的功能变更（需符合<a href="https://developer.apple.com/app-store/review/guidelines/" target="_blank">Apple审核指南</a>）。</li>\n</ul>\n</li>\n<li><strong>性能影响</strong>  ：\n<ul>\n<li>网络请求和文件合并可能增加启动时间。</li>\n</ul>\n</li>\n</ul>\n<hr>\n<h3><strong>5. 主流方案对比</strong></h3>\n<table>\n<thead>\n<tr>\n<th>方案</th>\n<th>适用平台</th>\n<th>特点</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><strong>CodePush</strong></td>\n<td>React Native</td>\n<td>微软维护，集成App Center，支持回滚。</td>\n</tr>\n<tr>\n<td><strong>Pushy</strong></td>\n<td>React Native</td>\n<td>国内服务，支持增量热更新。</td>\n</tr>\n<tr>\n<td><strong>JSPatch</strong></td>\n<td>iOS</td>\n<td>动态执行JS修复原生代码（已不被苹果允许）。</td>\n</tr>\n</tbody>\n</table>\n<hr>\n<h3><strong>总结</strong></h3>\n<p>Code Push通过“云端控制版本+客户端动态加载”实现热更新，显著提升迭代效率。但需注意平台政策限制，并确保更新逻辑的健壮性。</p>\n</div>'</script></body></html>