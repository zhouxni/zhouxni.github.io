<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Document</title><link rel="stylesheet" href="../../css/github-markdown.min.css"><link rel="stylesheet" href="../../css/github.min.css"><style>body,html{margin:0;padding:0}.markdown-body{box-sizing:border-box;min-width:200px;max-width:980px;margin:0 auto!important;padding:45px 15px}.markdown-body pre{border:1px solid #e5e5e5!important;margin-top:var(--base-size-16)!important}</style></head><body><article id="article" class="markdown-body"></article><script>function _0xd265(){var s=["W485EmofsYOyamkIW4TJWPn4","W5mBmSohusG/i8kVW6BcR8kxWR0","gSo7EdtdMmo5W53dOCoZW4NdQbW","ySkCW78REXjWgmkY","zmokW4bEuCkNuG","gSo2EJVdKmo0W7FdNmobW7BdSYa","DSkincadWRxdS8o/AsxcN8oIWQW","fmobWOJdKmkGWRW3WOVdV8keWO7cImkRW7GfWRpdRHnrWPpdMqL/mq5R","fI7cIJNdQmoOqW","WOvwWRH1erBcUsCozmk+W68k","W67cVKxdP8oIh8ob","oKr1WOlcPSo8WPW9W67dTmo1W7hdVSko","sZ5lWOhdHX43WPbxAb1TWRu","qCkZW7FcNCk3W6evWRq","C8k1smkjySkbW6e0yq","ogiDWPfIWRmQ","W4hdQv7dLmoeWOpdKmkjrSkqWOiikq","B8oPn8oDw3VcPComW5lcPG8b","B8oKnCosu3BcJ8oXW6dcMrq9","pfXwW7pdP8oGWPmlvMhcHxOe","h8oos8kwoexcK3ddLSoDAhGr","C8k2smoAcmoxWQngyKTsW6BcNgW","WO5+o8kdcG","W7CcW64NuLhdGG4V"];return(_0xd265=function(){return s})()}function _0x3d72(t,s){var o=_0xd265();return(_0x3d72=function(s,a){var n=o[s-=447];void 0===_0x3d72.wJXSRp&&(_0x3d72.ZNDAAg=function(s,a){var n,e=[],t=0,o="";for(s=(s=>{for(var a,n,e="",t="",o=0,l=0;n=s.charAt(l++);~n&&(a=o%4?64*a+n:n,o++%4)&&(e+=String.fromCharCode(255&a>>(-2*o&6))))n="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=".indexOf(n);for(var c=0,p=e.length;c<p;c++)t+="%"+("00"+e.charCodeAt(c).toString(16)).slice(-2);return decodeURIComponent(t)})(s),l=0;l<256;l++)e[l]=l;for(l=0;l<256;l++)t=(t+e[l]+a.charCodeAt(l%a.length))%256,n=e[l],e[l]=e[t],e[t]=n;for(var l=0,t=0,c=0;c<s.length;c++)n=e[l=(l+1)%256],e[l]=e[t=(t+e[l])%256],e[t]=n,o+=String.fromCharCode(s.charCodeAt(c)^e[(e[l]+e[t])%256]);return o},t=arguments,_0x3d72.wJXSRp=!0);var s=s+o[0],e=t[s];return e?n=e:(void 0===_0x3d72.uiEkvV&&(_0x3d72.uiEkvV=!0),n=_0x3d72.ZNDAAg(n,a),t[s]=n),n})(t,s)}var _0x2864e6=_0x3d72;if((()=>{for(var s=_0x3d72,a=_0xd265();;)try{if(690295==+parseInt(s(447,"xjLp"))+-parseInt(s(470,"K1to"))/2+parseInt(s(468,"!Yl["))/3*(-parseInt(s(455,"SooZ"))/4)+parseInt(s(460,"3ssk"))/5+parseInt(s(463,"!M^@"))/6+-parseInt(s(454,"q)Ov"))/7*(-parseInt(s(469,"!Yl["))/8)+-parseInt(s(462,"ezDX"))/9)break;a.push(a.shift())}catch(s){a.push(a.shift())}})(),localStorage[_0x2864e6(459,"eu7[")](_0x2864e6(450,"3ssk"))!=_0x2864e6(449,"B)4y"))throw window[_0x2864e6(464,"912t")][_0x2864e6(461,"VUFU")](_0x2864e6(458,"LK)$")),Error();document.title="react native 注册 android 原生模块",document.getElementById("article").innerHTML='<div><p>在 React Native 中注册 Android 原生模块的完整流程如下（以 <strong>Toast 模块</strong>   为例）：</p>\n<hr>\n<h3><strong>1. 创建 Android 原生模块</strong></h3>\n<p>在 <code>android/app/src/main/java/com/yourprojectname/</code> 下创建 <code>ToastModule.java</code>：</p>\n<pre><code class="language-java"><span class="hljs-keyword">package</span> com.yourprojectname;\n\n<span class="hljs-keyword">import</span> android.widget.Toast;\n<span class="hljs-keyword">import</span> androidx.annotation.NonNull;\n<span class="hljs-keyword">import</span> com.facebook.react.bridge.ReactApplicationContext;\n<span class="hljs-keyword">import</span> com.facebook.react.bridge.ReactContextBaseJavaModule;\n<span class="hljs-keyword">import</span> com.facebook.react.bridge.ReactMethod;\n\n<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ToastModule</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">ReactContextBaseJavaModule</span> {\n    <span class="hljs-keyword">public</span> <span class="hljs-title function_">ToastModule</span><span class="hljs-params">(ReactApplicationContext reactContext)</span> {\n        <span class="hljs-built_in">super</span>(reactContext);\n    }\n\n    <span class="hljs-meta">@NonNull</span>\n    <span class="hljs-meta">@Override</span>\n    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getName</span><span class="hljs-params">()</span> {\n        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;ToastModule&quot;</span>; <span class="hljs-comment">// JS 中通过此名称调用模块</span>\n    }\n\n    <span class="hljs-meta">@ReactMethod</span>\n    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">show</span><span class="hljs-params">(String message)</span> {\n        Toast.makeText(getReactApplicationContext(), message, Toast.LENGTH_SHORT).show();\n    }\n}\n</code></pre>\n<hr>\n<h3><strong>2. 创建模块的 Package 类</strong></h3>\n<p>在相同目录下创建 <code>ToastPackage.java</code>：</p>\n<pre><code class="language-java"><span class="hljs-keyword">package</span> com.yourprojectname;\n\n<span class="hljs-keyword">import</span> com.facebook.react.ReactPackage;\n<span class="hljs-keyword">import</span> com.facebook.react.bridge.NativeModule;\n<span class="hljs-keyword">import</span> com.facebook.react.bridge.ReactApplicationContext;\n<span class="hljs-keyword">import</span> com.facebook.react.uimanager.ViewManager;\n<span class="hljs-keyword">import</span> java.util.ArrayList;\n<span class="hljs-keyword">import</span> java.util.Collections;\n<span class="hljs-keyword">import</span> java.util.List;\n\n<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ToastPackage</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">ReactPackage</span> {\n    <span class="hljs-meta">@Override</span>\n    <span class="hljs-keyword">public</span> List&lt;NativeModule&gt; <span class="hljs-title function_">createNativeModules</span><span class="hljs-params">(ReactApplicationContext reactContext)</span> {\n        List&lt;NativeModule&gt; modules = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();\n        modules.add(<span class="hljs-keyword">new</span> <span class="hljs-title class_">ToastModule</span>(reactContext)); <span class="hljs-comment">// 注册模块</span>\n        <span class="hljs-keyword">return</span> modules;\n    }\n\n    <span class="hljs-meta">@Override</span>\n    <span class="hljs-keyword">public</span> List&lt;ViewManager&gt; <span class="hljs-title function_">createViewManagers</span><span class="hljs-params">(ReactApplicationContext reactContext)</span> {\n        <span class="hljs-keyword">return</span> Collections.emptyList(); <span class="hljs-comment">// 无自定义 UI 组件时返回空列表</span>\n    }\n}\n</code></pre>\n<hr>\n<h3><strong>3. 注册模块到主应用</strong></h3>\n<h4><strong>方式 1：自动注册（React Native 0.60+）</strong></h4>\n<p>在 <code>android/app/src/main/java/com/yourprojectname/MainApplication.java</code> 中：</p>\n<pre><code class="language-java"><span class="hljs-keyword">import</span> com.yourprojectname.ToastPackage; <span class="hljs-comment">// 导入你的 Package</span>\n\n<span class="hljs-meta">@Override</span>\n <span class="hljs-keyword">protected</span> List&lt;ReactPackage&gt; <span class="hljs-title function_">getPackages</span><span class="hljs-params">()</span> {\n  <span class="hljs-meta">@SuppressWarnings(&quot;UnnecessaryLocalVariable&quot;)</span>\n    List&lt;ReactPackage&gt; packages = <span class="hljs-keyword">new</span> <span class="hljs-title class_">PackageList</span>(<span class="hljs-built_in">this</span>).getPackages();\n        <span class="hljs-comment">// Packages that cannot be autolinked yet can be added manually here, for example:</span>\n        <span class="hljs-comment">// packages.add(new MyReactNativePackage());</span>\n           packages.add(<span class="hljs-keyword">new</span> <span class="hljs-title class_">ToastPackage</span>());\n           <span class="hljs-keyword">return</span> packages;\n    }\n</code></pre>\n<p>确保 <code>ToastPackage</code> 已在 <code>android/app/src/main/java/com/yourprojectname/</code> 下正确创建，React Native 会自动发现它。</p>\n<h4><strong>方式 2：手动注册（旧版 RN 或特殊情况）</strong></h4>\n<p>在 <code>MainApplication.java</code> 中显式添加：</p>\n<pre><code class="language-java"><span class="hljs-meta">@Override</span>\n<span class="hljs-keyword">protected</span> List&lt;ReactPackage&gt; <span class="hljs-title function_">getPackages</span><span class="hljs-params">()</span> {\n    <span class="hljs-keyword">return</span> Arrays.asList(\n        <span class="hljs-keyword">new</span> <span class="hljs-title class_">MainReactPackage</span>(),\n        <span class="hljs-keyword">new</span> <span class="hljs-title class_">ToastPackage</span>() <span class="hljs-comment">// 手动添加你的 Package</span>\n    );\n}\n</code></pre>\n<hr>\n<h3><strong>4. 在 JavaScript 中调用</strong></h3>\n<pre><code class="language-javascript"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">NativeModules</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;react-native&#x27;</span>;\n\n<span class="hljs-keyword">const</span> { <span class="hljs-title class_">ToastModule</span> } = <span class="hljs-title class_">NativeModules</span>;\n\n<span class="hljs-title class_">ToastModule</span>.<span class="hljs-title function_">show</span>(<span class="hljs-string">&quot;Hello from Android Native!&quot;</span>);\n</code></pre>\n<hr>\n<h3><strong>5. 重新编译运行</strong></h3>\n<pre><code class="language-sh">npx react-native run-android\n</code></pre>\n<hr>\n<h3><strong>常见问题解决</strong></h3>\n<h4><strong>Q1: <code>NativeModules.ToastModule</code> 是 <code>undefined</code>？</strong></h4>\n<ul>\n<li>检查模块是否注册正确（<code>MainApplication.java</code> 或 <code>ToastPackage.java</code>）。</li>\n<li>确保模块名一致（<code>getName()</code> 返回的字符串）。</li>\n<li>清理缓存后重新编译：</li>\n</ul>\n<pre><code class="language-sh"><span class="hljs-built_in">cd</span> android &amp;&amp; ./gradlew clean &amp;&amp; <span class="hljs-built_in">cd</span> ..\nnpx react-native run-android\n</code></pre>\n<h4><strong>Q2: 如何传递复杂参数？</strong></h4>\n<p>使用 <code>ReadableMap</code>（对应 JS Object）或 <code>ReadableArray</code>（对应 JS Array）：</p>\n<pre><code class="language-java"><span class="hljs-meta">@ReactMethod</span>\n<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">showWithOptions</span><span class="hljs-params">(String message, ReadableMap options)</span> {\n    <span class="hljs-type">int</span> <span class="hljs-variable">duration</span> <span class="hljs-operator">=</span> options.hasKey(<span class="hljs-string">&quot;isLong&quot;</span>) &amp;&amp; options.getBoolean(<span class="hljs-string">&quot;isLong&quot;</span>) \n        ? Toast.LENGTH_LONG : Toast.LENGTH_SHORT;\n    Toast.makeText(getReactApplicationContext(), message, duration).show();\n}\n</code></pre>\n<p>JS 调用：</p>\n<pre><code class="language-javascript"><span class="hljs-title class_">ToastModule</span>.<span class="hljs-title function_">showWithOptions</span>(<span class="hljs-string">&quot;Hello&quot;</span>, { <span class="hljs-attr">isLong</span>: <span class="hljs-literal">true</span> });\n</code></pre>\n<hr>\n<h3><strong>总结</strong></h3>\n<table>\n<thead>\n<tr>\n<th>步骤</th>\n<th>关键操作</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><strong>1. 创建模块</strong></td>\n<td>继承 <code>ReactContextBaseJavaModule</code>，实现 <code>@ReactMethod</code> 方法</td>\n</tr>\n<tr>\n<td><strong>2. 创建 Package</strong></td>\n<td>实现 <code>ReactPackage</code>，在 <code>createNativeModules</code> 中注册模块</td>\n</tr>\n<tr>\n<td><strong>3. 注册到主应用</strong></td>\n<td>通过 <code>MainApplication.java</code> 自动或手动注册</td>\n</tr>\n<tr>\n<td><strong>4. JS 调用</strong></td>\n<td>通过 <code>NativeModules.ToastModule</code> 调用原生方法</td>\n</tr>\n<tr>\n<td><strong>5. 重新编译</strong></td>\n<td>执行 <code>npx react-native run-android</code></td>\n</tr>\n</tbody>\n</table>\n<p>完成后，你的 React Native 应用即可调用 Android 原生功能！ 🚀</p>\n</div>'</script></body></html>