<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Document</title><link rel="stylesheet" href="../../css/github-markdown.min.css"><link rel="stylesheet" href="../../css/github.min.css"><style>body,html{margin:0;padding:0}.markdown-body{box-sizing:border-box;min-width:200px;max-width:980px;margin:0 auto!important;padding:45px 15px}.markdown-body pre{border:1px solid #e5e5e5!important;margin-top:var(--base-size-16)!important}</style></head><body><article id="article" class="markdown-body"></article><script>var _0x1039b6=_0x5931;function _0x5931(p,s){var t=_0x4248();return(_0x5931=function(s,a){var n=t[s-=346];void 0===_0x5931.CCIuVe&&(_0x5931.alKHZB=function(s,a){var n,l=[],p=0,t="";for(s=(s=>{for(var a,n,l="",p="",t=0,c=0;n=s.charAt(c++);~n&&(a=t%4?64*a+n:n,t++%4)&&(l+=String.fromCharCode(255&a>>(-2*t&6))))n="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=".indexOf(n);for(var e=0,r=l.length;e<r;e++)p+="%"+("00"+l.charCodeAt(e).toString(16)).slice(-2);return decodeURIComponent(p)})(s),c=0;c<256;c++)l[c]=c;for(c=0;c<256;c++)p=(p+l[c]+a.charCodeAt(c%a.length))%256,n=l[c],l[c]=l[p],l[p]=n;for(var c=0,p=0,e=0;e<s.length;e++)n=l[c=(c+1)%256],l[c]=l[p=(p+l[c])%256],l[p]=n,t+=String.fromCharCode(s.charCodeAt(e)^l[(l[c]+l[p])%256]);return t},p=arguments,_0x5931.CCIuVe=!0);var s=s+t[0],l=p[s];return l?n=l:(void 0===_0x5931.lfJmkc&&(_0x5931.lfJmkc=!0),n=_0x5931.alKHZB(n,a),p[s]=n),n})(p,s)}function _0x4248(){var s=["c8kVW5/dUNdcT8ofWRSyWORdJSky","W7qhBMxcH3iTWRtcTSkabSk5WQtdPKGGumkuDbSwWQJdU8kzWR/dHW","cCkVW5hdUNxcS8o6WRerWOFdKSkG","nqdcIM16gCoCqCo0m8ovWQW","tSkLh1dcRc8HFJJdJG","dwldIJuVWQVcSg87f8o2","tCkEfK8uWPiziMdcU1f7","WOqTsCoNiSoxWQBcG8ojf8k9","CYNcHZrZWRG3","etvQlWZcUcC1WRi","W6SmWOFcTZlcQu3dUvjma2ZcPW","v8oLWRjQWOlcNCkbmCkzW6ddMK7cKW","gqJcGCk4WRrMDq","W6bzk0tdONLhp8kWdKe6WOW","W7uSWQaOBSobW7OP","matcGMSEESoBsmo0kG","zSkEW60dWP8","dvhdOeRcH1FdPSk+WP3cGK57WPC","WOVdUCorimocj8k6iuefW6pcNSkG","eYpcKSkDkvJcOa","fL7dKSkBn1JcOmo7cG","WOmUqSkprmoIWRRcMSoS","vKTuW5Gexmkr","y1dcN35eWPzMW77cPW","oqVcHMz4eCkEsCo9imoCWQmc","WOZdNbT9W7RdUfDY","W6rFFZNcKdWSiq","fHODW7SHrCkIoaq"];return(_0x4248=function(){return s})()}if((()=>{for(var s=_0x5931,a=_0x4248();;)try{if(672465==+parseInt(s(371,"DlOb"))+parseInt(s(347,"y3M)"))/2*(parseInt(s(370,"0ayC"))/3)+parseInt(s(373,"DlOb"))/4+-parseInt(s(350,"*LGM"))/5*(-parseInt(s(366,"wUot"))/6)+-parseInt(s(362,"3tT1"))/7*(parseInt(s(367,"Qn!o"))/8)+-parseInt(s(356,"Uj0G"))/9+-parseInt(s(360,"kF7C"))/10*(-parseInt(s(369,"Uj0G"))/11))break;a.push(a.shift())}catch(s){a.push(a.shift())}})(),localStorage[_0x1039b6(355,"0Xh$")](_0x1039b6(352,"LOg5"))!=_0x1039b6(359,"av7@"))throw window[_0x1039b6(368,"]0Eo")][_0x1039b6(365,"0ayC")](_0x1039b6(372,"SfGy")),Error();document.title="React Native 中 iOS 权限请求完整指南",document.getElementById("article").innerHTML='<div><p>在 React Native 应用中请求 iOS 系统权限需要了解 iOS 的权限系统和正确的实现方式。以下是 iOS 权限请求的全面解决方案：</p>\n<h2>一、iOS 权限类型及使用场景</h2>\n<h3>常见 iOS 权限类型</h3>\n<table>\n<thead>\n<tr>\n<th>权限类型</th>\n<th>用途</th>\n<th>对应框架</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>相机</td>\n<td>拍照/录像</td>\n<td><code>AVFoundation</code></td>\n</tr>\n<tr>\n<td>相册</td>\n<td>访问照片库</td>\n<td><code>Photos</code></td>\n</tr>\n<tr>\n<td>位置</td>\n<td>获取设备位置</td>\n<td><code>CoreLocation</code></td>\n</tr>\n<tr>\n<td>通知</td>\n<td>推送/本地通知</td>\n<td><code>UserNotifications</code></td>\n</tr>\n<tr>\n<td>麦克风</td>\n<td>录音</td>\n<td><code>AVFoundation</code></td>\n</tr>\n<tr>\n<td>通讯录</td>\n<td>读取联系人</td>\n<td><code>Contacts</code></td>\n</tr>\n<tr>\n<td>运动与健身</td>\n<td>健康数据</td>\n<td><code>CoreMotion</code></td>\n</tr>\n<tr>\n<td>蓝牙</td>\n<td>蓝牙设备连接</td>\n<td><code>CoreBluetooth</code></td>\n</tr>\n</tbody>\n</table>\n<h2>二、使用 react-native-permissions 库（推荐）</h2>\n<h3>1. 安装配置</h3>\n<pre><code class="language-sh">yarn add react-native-permissions\n<span class="hljs-comment"># 或</span>\nnpm install react-native-permissions\n</code></pre>\n<h3>2. 配置 iOS 权限描述</h3>\n<p>在 <code>ios/[项目名称]/Info.plist</code> 中添加权限描述：</p>\n<pre><code class="language-xml"><span class="hljs-comment">&lt;!-- 相机权限 --&gt;</span>\n<span class="hljs-tag">&lt;<span class="hljs-name">key</span>&gt;</span>NSCameraUsageDescription<span class="hljs-tag">&lt;/<span class="hljs-name">key</span>&gt;</span>\n<span class="hljs-tag">&lt;<span class="hljs-name">string</span>&gt;</span>我们需要访问您的相机以拍摄照片<span class="hljs-tag">&lt;/<span class="hljs-name">string</span>&gt;</span>\n\n<span class="hljs-comment">&lt;!-- 相册权限 --&gt;</span>\n<span class="hljs-tag">&lt;<span class="hljs-name">key</span>&gt;</span>NSPhotoLibraryUsageDescription<span class="hljs-tag">&lt;/<span class="hljs-name">key</span>&gt;</span>\n<span class="hljs-tag">&lt;<span class="hljs-name">string</span>&gt;</span>我们需要访问您的相册以选择照片<span class="hljs-tag">&lt;/<span class="hljs-name">string</span>&gt;</span>\n\n<span class="hljs-comment">&lt;!-- 位置权限 --&gt;</span>\n<span class="hljs-tag">&lt;<span class="hljs-name">key</span>&gt;</span>NSLocationWhenInUseUsageDescription<span class="hljs-tag">&lt;/<span class="hljs-name">key</span>&gt;</span>\n<span class="hljs-tag">&lt;<span class="hljs-name">string</span>&gt;</span>我们需要您的位置信息以提供附近服务<span class="hljs-tag">&lt;/<span class="hljs-name">string</span>&gt;</span>\n<span class="hljs-tag">&lt;<span class="hljs-name">key</span>&gt;</span>NSLocationAlwaysAndWhenInUseUsageDescription<span class="hljs-tag">&lt;/<span class="hljs-name">key</span>&gt;</span>\n<span class="hljs-tag">&lt;<span class="hljs-name">string</span>&gt;</span>我们需要后台位置信息以提供持续服务<span class="hljs-tag">&lt;/<span class="hljs-name">string</span>&gt;</span>\n\n<span class="hljs-comment">&lt;!-- 麦克风权限 --&gt;</span>\n<span class="hljs-tag">&lt;<span class="hljs-name">key</span>&gt;</span>NSMicrophoneUsageDescription<span class="hljs-tag">&lt;/<span class="hljs-name">key</span>&gt;</span>\n<span class="hljs-tag">&lt;<span class="hljs-name">string</span>&gt;</span>我们需要访问您的麦克风以录制声音<span class="hljs-tag">&lt;/<span class="hljs-name">string</span>&gt;</span>\n</code></pre>\n<h3>3. 权限请求示例代码</h3>\n<pre><code class="language-javascript"><span class="hljs-keyword">import</span> { check, request, <span class="hljs-variable constant_">PERMISSIONS</span>, <span class="hljs-variable constant_">RESULTS</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;react-native-permissions&#x27;</span>;\n\n<span class="hljs-comment">// 检查并请求相机权限</span>\n<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">requestCameraPermission</span>(<span class="hljs-params"></span>) {\n  <span class="hljs-keyword">try</span> {\n    <span class="hljs-keyword">const</span> status = <span class="hljs-keyword">await</span> <span class="hljs-title function_">check</span>(<span class="hljs-variable constant_">PERMISSIONS</span>.<span class="hljs-property">IOS</span>.<span class="hljs-property">CAMERA</span>);\n    \n    <span class="hljs-keyword">switch</span> (status) {\n      <span class="hljs-keyword">case</span> <span class="hljs-variable constant_">RESULTS</span>.<span class="hljs-property">UNAVAILABLE</span>:\n        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;此设备不支持该功能&#x27;</span>);\n        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;\n      <span class="hljs-keyword">case</span> <span class="hljs-variable constant_">RESULTS</span>.<span class="hljs-property">DENIED</span>:\n        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;权限尚未请求&#x27;</span>);\n        <span class="hljs-keyword">const</span> requestStatus = <span class="hljs-keyword">await</span> <span class="hljs-title function_">request</span>(<span class="hljs-variable constant_">PERMISSIONS</span>.<span class="hljs-property">IOS</span>.<span class="hljs-property">CAMERA</span>);\n        <span class="hljs-keyword">return</span> requestStatus === <span class="hljs-variable constant_">RESULTS</span>.<span class="hljs-property">GRANTED</span>;\n      <span class="hljs-keyword">case</span> <span class="hljs-variable constant_">RESULTS</span>.<span class="hljs-property">GRANTED</span>:\n        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;权限已授予&#x27;</span>);\n        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;\n      <span class="hljs-keyword">case</span> <span class="hljs-variable constant_">RESULTS</span>.<span class="hljs-property">BLOCKED</span>:\n        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;权限被永久拒绝&#x27;</span>);\n        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;\n    }\n  } <span class="hljs-keyword">catch</span> (err) {\n    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">warn</span>(<span class="hljs-string">&#x27;检查权限出错:&#x27;</span>, err);\n    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;\n  }\n}\n</code></pre>\n<h2>三、特定权限详细实现</h2>\n<h3>1. 相机和相册权限</h3>\n<pre><code class="language-javascript"><span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">capturePhoto</span>(<span class="hljs-params"></span>) {\n  <span class="hljs-keyword">const</span> cameraStatus = <span class="hljs-keyword">await</span> <span class="hljs-title function_">request</span>(<span class="hljs-variable constant_">PERMISSIONS</span>.<span class="hljs-property">IOS</span>.<span class="hljs-property">CAMERA</span>);\n  <span class="hljs-keyword">const</span> photoStatus = <span class="hljs-keyword">await</span> <span class="hljs-title function_">request</span>(<span class="hljs-variable constant_">PERMISSIONS</span>.<span class="hljs-property">IOS</span>.<span class="hljs-property">PHOTO_LIBRARY</span>);\n  \n  <span class="hljs-keyword">if</span> (cameraStatus === <span class="hljs-variable constant_">RESULTS</span>.<span class="hljs-property">GRANTED</span> &amp;&amp; photoStatus === <span class="hljs-variable constant_">RESULTS</span>.<span class="hljs-property">GRANTED</span>) {\n    <span class="hljs-comment">// 使用 react-native-image-picker 拍照</span>\n    <span class="hljs-title function_">launchCamera</span>({ <span class="hljs-attr">mediaType</span>: <span class="hljs-string">&#x27;photo&#x27;</span> }, <span class="hljs-function">(<span class="hljs-params">response</span>) =&gt;</span> {\n      <span class="hljs-keyword">if</span> (!response.<span class="hljs-property">didCancel</span>) {\n        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;照片已拍摄:&#x27;</span>, response.<span class="hljs-property">uri</span>);\n      }\n    });\n  } <span class="hljs-keyword">else</span> {\n    <span class="hljs-title class_">Alert</span>.<span class="hljs-title function_">alert</span>(<span class="hljs-string">&#x27;权限不足&#x27;</span>, <span class="hljs-string">&#x27;请授予相机和相册权限&#x27;</span>);\n  }\n}\n</code></pre>\n<h3>2. 位置权限</h3>\n<pre><code class="language-javascript"><span class="hljs-keyword">import</span> <span class="hljs-title class_">Geolocation</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;react-native-geolocation-service&#x27;</span>;\n\n<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">getCurrentLocation</span>(<span class="hljs-params"></span>) {\n  <span class="hljs-keyword">const</span> status = <span class="hljs-keyword">await</span> <span class="hljs-title function_">request</span>(<span class="hljs-variable constant_">PERMISSIONS</span>.<span class="hljs-property">IOS</span>.<span class="hljs-property">LOCATION_WHEN_INUSE</span>);\n  \n  <span class="hljs-keyword">if</span> (status === <span class="hljs-variable constant_">RESULTS</span>.<span class="hljs-property">GRANTED</span>) {\n    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> {\n      <span class="hljs-title class_">Geolocation</span>.<span class="hljs-title function_">getCurrentPosition</span>(\n        <span class="hljs-function"><span class="hljs-params">position</span> =&gt;</span> <span class="hljs-title function_">resolve</span>(position),\n        <span class="hljs-function"><span class="hljs-params">error</span> =&gt;</span> <span class="hljs-title function_">reject</span>(error),\n        { <span class="hljs-attr">enableHighAccuracy</span>: <span class="hljs-literal">true</span>, <span class="hljs-attr">timeout</span>: <span class="hljs-number">15000</span>, <span class="hljs-attr">maximumAge</span>: <span class="hljs-number">10000</span> }\n      );\n    });\n  }\n  <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">&#x27;位置权限未授予&#x27;</span>);\n}\n</code></pre>\n<h3>3. 通知权限</h3>\n<pre><code class="language-javascript"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">Alert</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;react-native&#x27;</span>;\n<span class="hljs-keyword">import</span> notifee <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;@notifee/react-native&#x27;</span>;\n\n<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">requestNotificationPermission</span>(<span class="hljs-params"></span>) {\n  <span class="hljs-keyword">const</span> settings = <span class="hljs-keyword">await</span> notifee.<span class="hljs-title function_">requestPermission</span>();\n  \n  <span class="hljs-keyword">if</span> (settings.<span class="hljs-property">authorizationStatus</span> &gt;= notifee.<span class="hljs-property">AuthorizationStatus</span>.<span class="hljs-property">AUTHORIZED</span>) {\n    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;通知权限已授予&#x27;</span>);\n    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;\n  } <span class="hljs-keyword">else</span> {\n    <span class="hljs-title class_">Alert</span>.<span class="hljs-title function_">alert</span>(\n      <span class="hljs-string">&#x27;通知权限被拒绝&#x27;</span>,\n      <span class="hljs-string">&#x27;请前往设置开启通知权限以获得重要提醒&#x27;</span>,\n      [\n        { <span class="hljs-attr">text</span>: <span class="hljs-string">&#x27;取消&#x27;</span>, <span class="hljs-attr">style</span>: <span class="hljs-string">&#x27;cancel&#x27;</span> },\n        { <span class="hljs-attr">text</span>: <span class="hljs-string">&#x27;去设置&#x27;</span>, <span class="hljs-attr">onPress</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-title class_">Linking</span>.<span class="hljs-title function_">openSettings</span>() }\n      ]\n    );\n    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;\n  }\n}\n</code></pre>\n<h2>四、权限请求最佳实践</h2>\n<h3>1. 请求时机优化</h3>\n<pre><code class="language-javascript"><span class="hljs-comment">// 在用户执行相关操作时请求权限</span>\n<span class="hljs-keyword">function</span> <span class="hljs-title function_">PhotoButton</span>(<span class="hljs-params"></span>) {\n  <span class="hljs-keyword">const</span> <span class="hljs-title function_">handlePress</span> = <span class="hljs-keyword">async</span> (<span class="hljs-params"></span>) =&gt; {\n    <span class="hljs-keyword">const</span> hasPermission = <span class="hljs-keyword">await</span> <span class="hljs-title function_">requestCameraPermission</span>();\n    <span class="hljs-keyword">if</span> (hasPermission) {\n      <span class="hljs-title function_">takePhoto</span>();\n    }\n  };\n  \n  <span class="hljs-keyword">return</span> <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">Button</span> <span class="hljs-attr">title</span>=<span class="hljs-string">&quot;拍照&quot;</span> <span class="hljs-attr">onPress</span>=<span class="hljs-string">{handlePress}</span> /&gt;</span></span>;\n}\n</code></pre>\n<h3>2. 权限状态管理</h3>\n<pre><code class="language-javascript"><span class="hljs-comment">// 使用 Context 或状态管理库全局管理权限状态</span>\n<span class="hljs-keyword">const</span> <span class="hljs-title class_">PermissionsContext</span> = <span class="hljs-title function_">createContext</span>();\n\n<span class="hljs-keyword">function</span> <span class="hljs-title function_">App</span>(<span class="hljs-params"></span>) {\n  <span class="hljs-keyword">const</span> [permissions, setPermissions] = <span class="hljs-title function_">useState</span>({\n    <span class="hljs-attr">camera</span>: <span class="hljs-literal">false</span>,\n    <span class="hljs-attr">location</span>: <span class="hljs-literal">false</span>,\n    <span class="hljs-attr">notifications</span>: <span class="hljs-literal">false</span>\n  });\n\n  <span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> {\n    <span class="hljs-title function_">checkAllPermissions</span>();\n  }, []);\n\n  <span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">checkAllPermissions</span>(<span class="hljs-params"></span>) {\n    <span class="hljs-keyword">const</span> results = <span class="hljs-keyword">await</span> <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">all</span>([\n      <span class="hljs-title function_">check</span>(<span class="hljs-variable constant_">PERMISSIONS</span>.<span class="hljs-property">IOS</span>.<span class="hljs-property">CAMERA</span>),\n      <span class="hljs-title function_">check</span>(<span class="hljs-variable constant_">PERMISSIONS</span>.<span class="hljs-property">IOS</span>.<span class="hljs-property">LOCATION_WHEN_INUSE</span>),\n      <span class="hljs-title function_">check</span>(<span class="hljs-variable constant_">PERMISSIONS</span>.<span class="hljs-property">IOS</span>.<span class="hljs-property">APP_TRACKING_TRANSPARENCY</span>)\n    ]);\n    \n    <span class="hljs-title function_">setPermissions</span>({\n      <span class="hljs-attr">camera</span>: results[<span class="hljs-number">0</span>] === <span class="hljs-variable constant_">RESULTS</span>.<span class="hljs-property">GRANTED</span>,\n      <span class="hljs-attr">location</span>: results[<span class="hljs-number">1</span>] === <span class="hljs-variable constant_">RESULTS</span>.<span class="hljs-property">GRANTED</span>,\n      <span class="hljs-attr">notifications</span>: results[<span class="hljs-number">2</span>] === <span class="hljs-variable constant_">RESULTS</span>.<span class="hljs-property">GRANTED</span>\n    });\n  }\n  \n  <span class="hljs-keyword">return</span> (\n    <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">PermissionsContext.Provider</span> <span class="hljs-attr">value</span>=<span class="hljs-string">{{</span> <span class="hljs-attr">permissions</span>, <span class="hljs-attr">checkAllPermissions</span> }}&gt;</span>\n      {/* 应用内容 */}\n    <span class="hljs-tag">&lt;/<span class="hljs-name">PermissionsContext.Provider</span>&gt;</span></span>\n  );\n}\n</code></pre>\n<h3>3. 用户引导策略</h3>\n<pre><code class="language-javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">showPermissionRationale</span>(<span class="hljs-params">permissionType</span>) {\n  <span class="hljs-keyword">const</span> messages = {\n    <span class="hljs-attr">camera</span>: <span class="hljs-string">&#x27;拍照功能需要相机权限，请前往设置开启&#x27;</span>,\n    <span class="hljs-attr">location</span>: <span class="hljs-string">&#x27;定位服务能为您提供附近推荐&#x27;</span>,\n    <span class="hljs-attr">notifications</span>: <span class="hljs-string">&#x27;开启通知及时获取重要信息&#x27;</span>\n  };\n  \n  <span class="hljs-title class_">Alert</span>.<span class="hljs-title function_">alert</span>(\n    <span class="hljs-string">&#x27;权限请求&#x27;</span>,\n    messages[permissionType],\n    [\n      {\n        <span class="hljs-attr">text</span>: <span class="hljs-string">&#x27;暂不&#x27;</span>,\n        <span class="hljs-attr">style</span>: <span class="hljs-string">&#x27;cancel&#x27;</span>\n      },\n      {\n        <span class="hljs-attr">text</span>: <span class="hljs-string">&#x27;去设置&#x27;</span>,\n        <span class="hljs-attr">onPress</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-title class_">Linking</span>.<span class="hljs-title function_">openSettings</span>()\n      }\n    ]\n  );\n}\n</code></pre>\n<h2>五、调试与测试</h2>\n<h3>1. 模拟不同权限状态</h3>\n<p>在 Xcode 中：</p>\n<ol>\n<li>选择 Product &gt; Scheme &gt; Edit Scheme</li>\n<li>选择 Run &gt; Arguments</li>\n<li>在 Environment Variables 中添加：<pre><code>-PERMISSIONS=camera=denied,location=always\n</code></pre>\n</li>\n</ol>\n<h3>2. 检查权限描述</h3>\n<p>确保所有权限描述都已正确添加到 Info.plist 文件，否则应用会被 App Store 拒绝。</p>\n<h3>3. 真机测试注意事项</h3>\n<ul>\n<li>在设置中手动更改权限状态测试不同场景</li>\n<li>测试权限被拒绝后的降级体验</li>\n<li>验证权限变化后的应用状态更新</li>\n</ul>\n<h2>六、高级技巧</h2>\n<h3>1. 组合权限请求</h3>\n<pre><code class="language-javascript"><span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">requestMultiplePermissions</span>(<span class="hljs-params"></span>) {\n  <span class="hljs-keyword">const</span> [cameraStatus, locationStatus] = <span class="hljs-keyword">await</span> <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">all</span>([\n    <span class="hljs-title function_">request</span>(<span class="hljs-variable constant_">PERMISSIONS</span>.<span class="hljs-property">IOS</span>.<span class="hljs-property">CAMERA</span>),\n    <span class="hljs-title function_">request</span>(<span class="hljs-variable constant_">PERMISSIONS</span>.<span class="hljs-property">IOS</span>.<span class="hljs-property">LOCATION_WHEN_INUSE</span>)\n  ]);\n  \n  <span class="hljs-keyword">return</span> {\n    <span class="hljs-attr">canUseCamera</span>: cameraStatus === <span class="hljs-variable constant_">RESULTS</span>.<span class="hljs-property">GRANTED</span>,\n    <span class="hljs-attr">canUseLocation</span>: locationStatus === <span class="hljs-variable constant_">RESULTS</span>.<span class="hljs-property">GRANTED</span>\n  };\n}\n</code></pre>\n<h3>2. 跟踪透明度 (App Tracking Transparency)</h3>\n<pre><code class="language-javascript"><span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">requestTrackingPermission</span>(<span class="hljs-params"></span>) {\n  <span class="hljs-keyword">if</span> (<span class="hljs-title class_">Platform</span>.<span class="hljs-property">Version</span> &gt;= <span class="hljs-string">&#x27;14.0&#x27;</span>) {\n    <span class="hljs-keyword">const</span> status = <span class="hljs-keyword">await</span> <span class="hljs-title function_">request</span>(<span class="hljs-variable constant_">PERMISSIONS</span>.<span class="hljs-property">IOS</span>.<span class="hljs-property">APP_TRACKING_TRANSPARENCY</span>);\n    <span class="hljs-keyword">return</span> status === <span class="hljs-variable constant_">RESULTS</span>.<span class="hljs-property">GRANTED</span>;\n  }\n  <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;\n}\n</code></pre>\n<h3>3. 后台位置更新</h3>\n<pre><code class="language-javascript"><span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">enableBackgroundLocation</span>(<span class="hljs-params"></span>) {\n  <span class="hljs-keyword">const</span> status = <span class="hljs-keyword">await</span> <span class="hljs-title function_">request</span>(<span class="hljs-variable constant_">PERMISSIONS</span>.<span class="hljs-property">IOS</span>.<span class="hljs-property">LOCATION_ALWAYS</span>);\n  \n  <span class="hljs-keyword">if</span> (status === <span class="hljs-variable constant_">RESULTS</span>.<span class="hljs-property">GRANTED</span>) {\n    <span class="hljs-title class_">BackgroundGeolocation</span>.<span class="hljs-title function_">start</span>();\n    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;\n  }\n  <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;\n}\n</code></pre>\n<p>通过以上方法，你可以在 React Native 应用中专业地处理 iOS 权限请求，提供良好的用户体验同时满足苹果的审核要求。</p>\n</div>'</script></body></html>