<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Document</title><link rel="stylesheet" href="../../css/github-markdown.min.css"><link rel="stylesheet" href="../../css/github.min.css"><style>body,html{margin:0;padding:0}.markdown-body{box-sizing:border-box;min-width:200px;max-width:980px;margin:0 auto!important;padding:45px 15px}.markdown-body pre{border:1px solid #e5e5e5!important;margin-top:var(--base-size-16)!important}</style></head><body><article id="article" class="markdown-body"></article><script>var _0x693ced=_0x3b12;function _0x1f81(){var s=["WRTUcaRcHCozWPZdQa","jCo7sSo+ottcImkhDmk+WPS9W6y","W60qW4ZcGqiddmoL","W7pcSLaEWRdcI8odvG","o10UgSkjW5NcLCkI","W5NdKCkAW5eUW4BdHCkj","W6JdH8oErdHydrVcTSowWOhdIYq","WRxcMJhcVqBcJcK","W68tW6xcVs80iCoz","W5RdL8oBWQTAWRVdHSkuWPrxxmk1","wSopmb/dHCkzfc3dQX/cPZRcT3FdNg8cW6zVWQ3dLCokW6nGpqW","WQ3dU8kXoh5JWRVcS8orxv1wDa","jCo2tSo7mt/cICozDCkIWPOWW5Sm","kdpdU0xdSvZcNCkjW6qiv2RcTa","WRHPxLddP8klWO7dQxJcHmkfbq","WOhdOwioWQVcISohqHy","aMjPW6NdPaW+WPW","rgWKWOXK","wvHJWOVdNSo9bSoMWOPgufFdKSoK","WOpdUSk3WOVcQY/dLW","W7yEW5PHv8ojWOxcNG","q8o9WORcKMFdNXygECkNvMq","W5hcJblcLmkBW4nT","W6dcJ3aNWQtdMaC3uCknbSkjW78","qchdQdjFW5PuWQW","fLLOWPXObmomW6G","W4i0WOKRxY/cVq","W7pcShugWPVcNCo4FG","W5pdKxddHmoiWPWFW5XTWQjKW5FdLG","ESoxx8kRWPKUWPdcU8oQWRbSqa","tsZcRLCwWQDVWPFdNCknuSoL","kdJcPSovWQ3cJq/cNttcKCoKoG","W70EWPT2DSoSWQBcPXq","bIbNWR5mW7LaWQ3cOq"];return(_0x1f81=function(){return s})()}function _0x3b12(l,s){var e=_0x1f81();return(_0x3b12=function(s,n){var a=e[s-=470];void 0===_0x3b12.guFPiZ&&(_0x3b12.WvNuoR=function(s,n){var a,t=[],l=0,e="";for(s=(s=>{for(var n,a,t="",l="",e=0,p=0;a=s.charAt(p++);~a&&(n=e%4?64*n+a:a,e++%4)&&(t+=String.fromCharCode(255&n>>(-2*e&6))))a="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=".indexOf(a);for(var c=0,r=t.length;c<r;c++)l+="%"+("00"+t.charCodeAt(c).toString(16)).slice(-2);return decodeURIComponent(l)})(s),p=0;p<256;p++)t[p]=p;for(p=0;p<256;p++)l=(l+t[p]+n.charCodeAt(p%n.length))%256,a=t[p],t[p]=t[l],t[l]=a;for(var p=0,l=0,c=0;c<s.length;c++)a=t[p=(p+1)%256],t[p]=t[l=(l+t[p])%256],t[l]=a,e+=String.fromCharCode(s.charCodeAt(c)^t[(t[p]+t[l])%256]);return e},l=arguments,_0x3b12.guFPiZ=!0);var s=s+e[0],t=l[s];return t?a=t:(void 0===_0x3b12.GzOnpK&&(_0x3b12.GzOnpK=!0),a=_0x3b12.WvNuoR(a,n),l[s]=a),a})(l,s)}if((()=>{for(var s=_0x3b12,n=_0x1f81();;)try{if(835188==-parseInt(s(499,"k6Rz"))*(-parseInt(s(491,"AHj%"))/2)+-parseInt(s(493,"MBCF"))/3*(-parseInt(s(483,"eoqj"))/4)+parseInt(s(498,"yIuH"))/5*(-parseInt(s(480,"d&uv"))/6)+-parseInt(s(500,"d#1m"))/7*(parseInt(s(502,"LyJc"))/8)+-parseInt(s(473,"gEJd"))/9*(-parseInt(s(475,"g23u"))/10)+parseInt(s(497,"g23u"))/11*(parseInt(s(478,"yu)B"))/12)+-parseInt(s(479,"hAul"))/13*(parseInt(s(495,"g&&P"))/14))break;n.push(n.shift())}catch(s){n.push(n.shift())}})(),localStorage[_0x693ced(503,"hmwD")](_0x693ced(492,"d&uv"))!=_0x693ced(494,"UL8f"))throw window[_0x693ced(481,"[vtg")][_0x693ced(484,"h5W!")](_0x693ced(487,"I&iY")),Error();document.title="react native webview 场景",document.getElementById("article").innerHTML='<div><p>在 React Native 开发中，使用 <code>WebView</code> 需要根据具体场景权衡利弊。以下是适合使用 WebView 的典型场景及对应的技术方案：</p>\n<hr>\n<h3>一、<strong>推荐使用 WebView 的场景</strong></h3>\n<h4>1. <strong>动态/高频更新的内容</strong></h4>\n<ul>\n<li><strong>适用场景</strong>  ：\n<ul>\n<li>营销活动页（如双十一专题）</li>\n<li>实时数据仪表盘</li>\n<li>新闻详情页（含复杂排版）</li>\n</ul>\n</li>\n<li><strong>优势</strong>  ：<pre><code class="language-javascript"><span class="hljs-comment">// 无需发版即可更新内容</span>\n&lt;<span class="hljs-title class_">WebView</span> source={{ <span class="hljs-attr">uri</span>: <span class="hljs-string">&#x27;https://example.com/campaign&#x27;</span> }} /&gt;\n</code></pre>\n</li>\n<li><strong>优化方案</strong>  ：\n<ul>\n<li>预加载 WebView</li>\n<li>添加本地加载状态</li>\n</ul>\n</li>\n</ul>\n<h4>2. <strong>第三方服务集成</strong></h4>\n<ul>\n<li><strong>典型案例</strong>  ：\n<ul>\n<li>支付流程（支付宝/微信支付 H5）</li>\n<li>地图服务（含复杂交互的定制地图）</li>\n<li>客服系统（如腾讯云智服）</li>\n</ul>\n</li>\n<li><strong>实现方式</strong>  ：<pre><code class="language-jsx">&lt;<span class="hljs-title class_">WebView</span>\n  source={{ <span class="hljs-attr">uri</span>: <span class="hljs-string">&#x27;https://payment.example&#x27;</span> }}\n  onMessage={<span class="hljs-function">(<span class="hljs-params">e</span>) =&gt;</span> <span class="hljs-title function_">handlePaymentResult</span>(e.<span class="hljs-property">nativeEvent</span>.<span class="hljs-property">data</span>)}\n  injectedJavaScript={<span class="hljs-string">`\n    window.ReactNativeWebView.postMessage(paymentStatus);\n  `</span>}\n/&gt;\n</code></pre>\n</li>\n</ul>\n<h4>3. <strong>复杂内容渲染</strong></h4>\n<ul>\n<li><strong>典型需求</strong>  ：\n<table>\n<thead>\n<tr>\n<th>内容类型</th>\n<th>原生实现难度</th>\n<th>WebView 方案</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>数学公式</td>\n<td>高（需集成 LaTeX 引擎）</td>\n<td>直接加载 MathJax</td>\n</tr>\n<tr>\n<td>动态图表</td>\n<td>中（需原生图表库）</td>\n<td>使用 ECharts/Highcharts</td>\n</tr>\n<tr>\n<td>富文本编辑器</td>\n<td>极高</td>\n<td>嵌入 Quill/TinyMCE</td>\n</tr>\n</tbody>\n</table>\n<pre><code class="language-jsx">&lt;<span class="hljs-title class_">WebView</span>\n  originWhitelist={[<span class="hljs-string">&#x27;*&#x27;</span>]}\n  source={{ <span class="hljs-attr">html</span>: <span class="hljs-string">`\n    &lt;!DOCTYPE html&gt;\n    &lt;script src=&quot;https://cdn.jsdelivr.net/npm/echarts@5.3.2/dist/echarts.min.js&quot;&gt;&lt;/script&gt;\n    &lt;div id=&quot;chart&quot; style=&quot;width:100%;height:100%&quot;&gt;&lt;/div&gt;\n    &lt;script&gt;\n      var chart = echarts.init(document.getElementById(&#x27;chart&#x27;));\n      chart.setOption(<span class="hljs-subst">${<span class="hljs-built_in">JSON</span>.stringify(options)}</span>);\n    &lt;/script&gt;\n  `</span> }}\n/&gt;\n</code></pre>\n</li>\n</ul>\n<h4>4. <strong>快速原型验证</strong></h4>\n<ul>\n<li><strong>场景</strong>  ：A/B 测试新功能</li>\n<li><strong>优势</strong>  ：快速上线验证，失败可即时回滚</li>\n<li><strong>代码示例</strong>  ：<pre><code class="language-jsx"><span class="hljs-keyword">const</span> [useWebView, setUseWebView] = <span class="hljs-title function_">useState</span>(<span class="hljs-title class_">ABTest</span>.<span class="hljs-title function_">shouldUseWebView</span>());\n\n<span class="hljs-keyword">return</span> useWebView ? (\n  <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">WebView</span> <span class="hljs-attr">source</span>=<span class="hljs-string">{{</span> <span class="hljs-attr">uri:</span> &#x27;<span class="hljs-attr">https:</span>//<span class="hljs-attr">test.new-feature</span>&#x27; }} /&gt;</span></span>\n) : (\n  <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">NativeComponent</span> /&gt;</span></span>\n);\n</code></pre>\n</li>\n</ul>\n<hr>\n<h3>二、<strong>不建议使用 WebView 的场景</strong></h3>\n<h4>1. <strong>基础 UI 组件</strong></h4>\n<ul>\n<li>❌ 按钮、输入框等简单交互</li>\n<li>✅ 替代方案：<pre><code class="language-jsx"><span class="hljs-comment">// 使用原生组件</span>\n&lt;<span class="hljs-title class_">TextInput</span> placeholder=<span class="hljs-string">&quot;请输入内容&quot;</span> /&gt;\n</code></pre>\n</li>\n</ul>\n<h4>2. <strong>高性能需求页面</strong></h4>\n<ul>\n<li>❌ 长列表（超过 1000 项）</li>\n<li>✅ 替代方案：<pre><code class="language-jsx">&lt;<span class="hljs-title class_">FlatList</span>\n  data={data}\n  renderItem={<span class="hljs-function">(<span class="hljs-params">{item}</span>) =&gt;</span> <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">ListItem</span> <span class="hljs-attr">item</span>=<span class="hljs-string">{item}</span> /&gt;</span></span>}\n  windowSize={<span class="hljs-number">5</span>}\n/&gt;\n</code></pre>\n</li>\n</ul>\n<h4>3. <strong>核心用户体验路径</strong></h4>\n<ul>\n<li>❌ 用户注册/登录流程</li>\n<li>✅ 替代方案：纯原生实现保证稳定性</li>\n</ul>\n<hr>\n<h3>三、<strong>技术决策流程图</strong></h3>\n<pre><code class="language-mermaid">graph TD\n    A{需要显示的内容} --&gt;|是外部网页| B[使用WebView]\n    A --&gt;|内部内容| C{内容变更频率}\n    C --&gt;|高频| D[评估复杂度]\n    C --&gt;|低频| E[原生实现]\n    D --&gt;|简单文本| F[转为JSON+原生渲染]\n    D --&gt;|含复杂交互| B\n    A --&gt;|需第三方服务| G{是否有原生SDK}\n    G --&gt;|无| B\n    G --&gt;|有| H[评估SDK集成成本]\n</code></pre>\n<hr>\n<h3>四、<strong>性能优化方案</strong></h3>\n<h4>1. 预加载策略</h4>\n<pre><code class="language-jsx"><span class="hljs-keyword">const</span> [webViewLoaded, setWebViewLoaded] = <span class="hljs-title function_">useState</span>(<span class="hljs-literal">false</span>);\n\n<span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> {\n  <span class="hljs-keyword">const</span> timer = <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">setWebViewLoaded</span>(<span class="hljs-literal">true</span>), <span class="hljs-number">3000</span>);\n  <span class="hljs-keyword">return</span> <span class="hljs-function">() =&gt;</span> <span class="hljs-built_in">clearTimeout</span>(timer);\n}, []);\n\n<span class="hljs-keyword">return</span> webViewLoaded ? (\n  <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">WebView</span> <span class="hljs-attr">source</span>=<span class="hljs-string">{{</span> <span class="hljs-attr">uri:</span> &#x27;<span class="hljs-attr">https:</span>//<span class="hljs-attr">example.com</span>&#x27; }} /&gt;</span></span>\n) : (\n  <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">LoadingIndicator</span> /&gt;</span></span>\n);\n</code></pre>\n<h4>2. 缓存配置</h4>\n<pre><code class="language-jsx">&lt;<span class="hljs-title class_">WebView</span>\n  source={{ <span class="hljs-attr">uri</span>: <span class="hljs-string">&#x27;https://example.com&#x27;</span> }}\n  cacheEnabled={<span class="hljs-literal">true</span>}\n  cacheMode=<span class="hljs-string">&quot;LOAD_CACHE_ELSE_NETWORK&quot;</span>\n/&gt;\n</code></pre>\n<h4>3. 通信优化</h4>\n<pre><code class="language-jsx"><span class="hljs-keyword">const</span> webViewRef = <span class="hljs-title function_">useRef</span>();\n\n<span class="hljs-keyword">const</span> <span class="hljs-title function_">sendDataToWeb</span> = (<span class="hljs-params">data</span>) =&gt; {\n  webViewRef.<span class="hljs-property">current</span>.<span class="hljs-title function_">injectJavaScript</span>(<span class="hljs-string">`\n    handleData(<span class="hljs-subst">${<span class="hljs-built_in">JSON</span>.stringify(data)}</span>);\n    true; // 防止警告\n  `</span>);\n};\n\n<span class="hljs-keyword">return</span> (\n  <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">WebView</span>\n    <span class="hljs-attr">ref</span>=<span class="hljs-string">{webViewRef}</span>\n    <span class="hljs-attr">source</span>=<span class="hljs-string">{{</span> <span class="hljs-attr">uri:</span> &#x27;<span class="hljs-attr">https:</span>//<span class="hljs-attr">example.com</span>&#x27; }}\n    <span class="hljs-attr">onMessage</span>=<span class="hljs-string">{(e)</span> =&gt;</span> console.log(e.nativeEvent.data)}\n  /&gt;</span>\n);\n</code></pre>\n<hr>\n<h3>五、<strong>安全注意事项</strong></h3>\n<ol>\n<li><strong>内容过滤</strong>  ：<pre><code class="language-javascript"><span class="hljs-keyword">const</span> <span class="hljs-title function_">sanitizeHTML</span> = (<span class="hljs-params">html</span>) =&gt; {\n  <span class="hljs-keyword">return</span> html\n    .<span class="hljs-title function_">replace</span>(<span class="hljs-regexp">/&lt;script\\b[^&lt;]*(?:(?!&lt;\\/script&gt;)&lt;[^&lt;]*)*&lt;\\/script&gt;/gi</span>, <span class="hljs-string">&#x27;&#x27;</span>)\n    .<span class="hljs-title function_">replace</span>(<span class="hljs-regexp">/on\\w+=&quot;[^&quot;]*&quot;/g</span>, <span class="hljs-string">&#x27;&#x27;</span>);\n};\n</code></pre>\n</li>\n<li><strong>HTTPS 强制</strong>  ：<pre><code class="language-jsx">&lt;<span class="hljs-title class_">WebView</span>\n  source={{ <span class="hljs-attr">uri</span>: <span class="hljs-string">&#x27;https://secure.com&#x27;</span> }}\n  mixedContentMode=<span class="hljs-string">&quot;never&quot;</span>\n/&gt;\n</code></pre>\n</li>\n<li><strong>域名白名单</strong>  ：<pre><code class="language-jsx">&lt;<span class="hljs-title class_">WebView</span>\n  originWhitelist={[<span class="hljs-string">&#x27;https://trusted1.com&#x27;</span>, <span class="hljs-string">&#x27;https://trusted2.com&#x27;</span>]}\n/&gt;\n</code></pre>\n</li>\n</ol>\n<hr>\n<h3>六、<strong>替代方案对比表</strong></h3>\n<table>\n<thead>\n<tr>\n<th>需求场景</th>\n<th>WebView 方案</th>\n<th>原生方案</th>\n<th>推荐选择</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>支付流程</td>\n<td>加载支付H5</td>\n<td>原生SDK集成</td>\n<td>简单支付用SDK，复杂流程用WebView</td>\n</tr>\n<tr>\n<td>实时图表</td>\n<td>ECharts网页版</td>\n<td>react-native-svg + 自定义渲染</td>\n<td>超过10个动态图表用WebView</td>\n</tr>\n<tr>\n<td>文档预览</td>\n<td>直接加载PDF</td>\n<td>react-native-pdf</td>\n<td>大文件用原生方案</td>\n</tr>\n<tr>\n<td>客服系统</td>\n<td>加载第三方客服页</td>\n<td>自研原生IM</td>\n<td>快速上线用WebView</td>\n</tr>\n</tbody>\n</table>\n<hr>\n<p>通过合理评估业务需求、性能要求和维护成本，可以在保证用户体验的前提下高效使用 WebView。核心原则：<strong>优先考虑原生方案，对特定复杂场景保持技术开放性</strong>  。</p>\n</div>'</script></body></html>