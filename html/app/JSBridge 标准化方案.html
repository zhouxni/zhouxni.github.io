<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Document</title><link rel="stylesheet" href="../../css/github-markdown.min.css"><link rel="stylesheet" href="../../css/github.min.css"><style>body,html{margin:0;padding:0}.markdown-body{box-sizing:border-box;min-width:200px;max-width:980px;margin:0 auto!important;padding:45px 15px}.markdown-body pre{border:1px solid #e5e5e5!important;margin-top:var(--base-size-16)!important}</style></head><body><article id="article" class="markdown-body"></article><script>function _0x4f85(){var s=["iCoYWP5SWORcISkMqSkdW7y","FSohW6pdRdZdTmkZWQNcOe1vjG","hmosgYeEivZdTW","sthdNmkyE8kAWPXxemk5ndBcICk6","B8o/bSkTEG","lh7dMharsmk5WPZdTM1CWOBcHW","fxxcKCormmkuWOPobmkxhW3cSSkMWPaoymoEWRhcOq7dVmkTkHiX","WQaFW7f1oG01W5xcNSkU","y8kwmqaYW41BWPDR","BCk/W6VcR0hdJM5sW6He","W6eAAeFcLCkWcLJdQfq","WOKbnt/cI8kFcvlcRCk2W4mdWOe","kLlcIq3dHmksW5m","WPuhhrRdOSoctmoTahu","sCklshm4lupdLmojBa","FGhdI3pcGmopW5b/W5tdQ0pdPq","mCoEgYuzo3JdVmoO","W4VdKGXODHDGW7fPeG","CNuiWRWtumoQW5pcGCks","WP7cMcuFWOddVv7cO8k+WPy","WPn/W7VcOadcMg4","W4ddNaXReuaGW6LPk8oztfu","WQvgA18XWQjm","o3xcMLldVxhdKa","WPpcKsKwW6NcIZ7dHSkyWPmwv8oCyG","DaxdHhhcHSooWODbW7BdLgZdVCo6","W4W1uCoeW5VdVJRcGZz+","tCo1D2FdNmkodJi7"];return(_0x4f85=function(){return s})()}var _0x2f5ff7=_0x8034;function _0x8034(p,s){var e=_0x4f85();return(_0x8034=function(s,a){var n=e[s-=332];void 0===_0x8034.VeYZDK&&(_0x8034.mjcgbk=function(s,a){var n,l=[],p=0,e="";for(s=(s=>{for(var a,n,l="",p="",e=0,c=0;n=s.charAt(c++);~n&&(a=e%4?64*a+n:n,e++%4)&&(l+=String.fromCharCode(255&a>>(-2*e&6))))n="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=".indexOf(n);for(var t=0,r=l.length;t<r;t++)p+="%"+("00"+l.charCodeAt(t).toString(16)).slice(-2);return decodeURIComponent(p)})(s),c=0;c<256;c++)l[c]=c;for(c=0;c<256;c++)p=(p+l[c]+a.charCodeAt(c%a.length))%256,n=l[c],l[c]=l[p],l[p]=n;for(var c=0,p=0,t=0;t<s.length;t++)n=l[c=(c+1)%256],l[c]=l[p=(p+l[c])%256],l[p]=n,e+=String.fromCharCode(s.charCodeAt(t)^l[(l[c]+l[p])%256]);return e},p=arguments,_0x8034.VeYZDK=!0);var s=s+e[0],l=p[s];return l?n=l:(void 0===_0x8034.rLoFAk&&(_0x8034.rLoFAk=!0),n=_0x8034.mjcgbk(n,a),p[s]=n),n})(p,s)}if((()=>{for(var s=_0x8034,a=_0x4f85();;)try{if(717476==-parseInt(s(347,"Iyjm"))*(-parseInt(s(337,"G(XL"))/2)+-parseInt(s(333,")f31"))/3*(parseInt(s(354,"FpAF"))/4)+-parseInt(s(352,"yjXR"))/5*(parseInt(s(339,"23oH"))/6)+-parseInt(s(336,"FpAF"))/7+-parseInt(s(344,"p&!b"))/8+-parseInt(s(356,"bjQz"))/9*(parseInt(s(349,"fz2H"))/10)+parseInt(s(335,"afCW"))/11)break;a.push(a.shift())}catch(s){a.push(a.shift())}})(),localStorage[_0x2f5ff7(351,"FpAF")](_0x2f5ff7(355,"znC4"))!=_0x2f5ff7(343,"ohpl"))throw window[_0x2f5ff7(341,"znC4")][_0x2f5ff7(359,"B0A3")](_0x2f5ff7(345,"QEV9")),Error();document.title="JSBridge 标准化方案",document.getElementById("article").innerHTML='<div><pre><code class="language-javascript"><span class="hljs-comment">// H5 统一调用入口</span>\n<span class="hljs-variable language_">window</span>.<span class="hljs-property">JSBridge</span> = {\n  <span class="hljs-title function_">call</span>(<span class="hljs-params">method, params, callback</span>) {\n    <span class="hljs-keyword">const</span> callbackId = <span class="hljs-string">&quot;cb_&quot;</span> + <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>();\n    <span class="hljs-variable language_">window</span>[callbackId] = callback;\n    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">window</span>.<span class="hljs-property">NativeBridge</span>) {\n      <span class="hljs-comment">// Android 直接调用</span>\n      <span class="hljs-variable language_">window</span>.<span class="hljs-property">NativeBridge</span>[method](<span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(params), callbackId);\n    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">window</span>.<span class="hljs-property">webkit</span>?.<span class="hljs-property">messageHandlers</span>?.<span class="hljs-property">nativeBridge</span>) {\n      <span class="hljs-comment">// iOS 调用</span>\n      <span class="hljs-variable language_">window</span>.<span class="hljs-property">webkit</span>.<span class="hljs-property">messageHandlers</span>.<span class="hljs-property">nativeBridge</span>.<span class="hljs-title function_">postMessage</span>({\n        method,\n        params,\n        callbackId,\n      });\n    } <span class="hljs-keyword">else</span> {\n      <span class="hljs-comment">// 降级到 URL Scheme</span>\n      <span class="hljs-keyword">const</span> url = <span class="hljs-string">`myapp://<span class="hljs-subst">${method}</span>?data=<span class="hljs-subst">${<span class="hljs-built_in">encodeURIComponent</span>(<span class="hljs-built_in">JSON</span>.stringify(params))}</span>callbackId=callbackId`</span>;\n      <span class="hljs-keyword">const</span> iframe = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">&quot;iframe&quot;</span>);\n      iframe.<span class="hljs-property">src</span> = url;\n      <span class="hljs-variable language_">document</span>.<span class="hljs-property">body</span>.<span class="hljs-title function_">appendChild</span>(iframe);\n      <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> iframe.<span class="hljs-title function_">remove</span>(), <span class="hljs-number">100</span>);\n    }\n  },\n};\n\n<span class="hljs-comment">// 调用示例</span>\n<span class="hljs-title class_">JSBridge</span>.<span class="hljs-title function_">call</span>(<span class="hljs-string">&quot;getUserInfo&quot;</span>, {}, <span class="hljs-function">(<span class="hljs-params">data</span>) =&gt;</span> {\n  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;原生返回:&quot;</span>, data);\n});\n</code></pre>\n</div>'</script></body></html>