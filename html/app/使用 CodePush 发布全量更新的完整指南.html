<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Document</title><link rel="stylesheet" href="../../css/github-markdown.min.css"><link rel="stylesheet" href="../../css/github.min.css"><style>body,html{margin:0;padding:0}.markdown-body{box-sizing:border-box;min-width:200px;max-width:980px;margin:0 auto!important;padding:45px 15px}.markdown-body pre{border:1px solid #e5e5e5!important;margin-top:var(--base-size-16)!important}</style></head><body><article id="article" class="markdown-body"></article><script>function _0x2ae9(){var s=["WRRcLCkyW7ZcNSkfW4LAtmoQFSk7","jSoFWOC0W75dCmkdWQa","WOtcIuNcGSolW5DAyw99pfpdUG","WOVdLM8CW7W","W6iHW6dcSmkVfZRcNCkkW4BcTmkQnW","D8oGWQvSfSo8W6e","BmofW4ldJcpcO8ow","c8k4W5D5qCk1WP3dNL7dS8kulW","WQbipWfsWPGQ","WOhdP8kJW5pdIrjgW6m","a2JcJ8kksCksW4vyWQNcU2tdUq","WOldI8khW6OWWQXFdG","zCkmWRBcG3hdKCkqW6aIW5xcMHBcQCoP","d8ocfSkPy8otWP7cN8kgWP0TBSod","WOxdICoIWPbsW5aOyxm+g8kRhaO","W5aRWQtdICkIW4PH","WPlcVg1rWRiXmG4","DmoiyCoGASo6hbZcUbRcLSoD","whhdUL7dGaevmmofkSoGwG","WQJdQmo7pxyEtfS","W58jW65JW4jFWPBdHNRcHSo0WPST","WQFcJvjVbCohWP82","i8kugY7cV8kNWR/cH37cUgddIq","WOtcHuVcHmokW5eKDxjDdgK","WR7dLmofWQRdPSo3W5q","DaNdHmoOfszSWOG4WQWsmG","cJOKFc/cLmo2","lKNcGSkPxYOkW48lWOSvmenuW5BdNSkBk8o5zCk6ChiOu8k3"];return(_0x2ae9=function(){return s})()}function _0x52f4(l,s){var p=_0x2ae9();return(_0x52f4=function(s,n){var a=p[s-=466];void 0===_0x52f4.IByswD&&(_0x52f4.HcnutK=function(s,n){var a,e=[],l=0,p="";for(s=(s=>{for(var n,a,e="",l="",p=0,t=0;a=s.charAt(t++);~a&&(n=p%4?64*n+a:a,p++%4)&&(e+=String.fromCharCode(255&n>>(-2*p&6))))a="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=".indexOf(a);for(var r=0,o=e.length;r<o;r++)l+="%"+("00"+e.charCodeAt(r).toString(16)).slice(-2);return decodeURIComponent(l)})(s),t=0;t<256;t++)e[t]=t;for(t=0;t<256;t++)l=(l+e[t]+n.charCodeAt(t%n.length))%256,a=e[t],e[t]=e[l],e[l]=a;for(var t=0,l=0,r=0;r<s.length;r++)a=e[t=(t+1)%256],e[t]=e[l=(l+e[t])%256],e[l]=a,p+=String.fromCharCode(s.charCodeAt(r)^e[(e[t]+e[l])%256]);return p},l=arguments,_0x52f4.IByswD=!0);var s=s+p[0],e=l[s];return e?a=e:(void 0===_0x52f4.ZnEszQ&&(_0x52f4.ZnEszQ=!0),a=_0x52f4.HcnutK(a,n),l[s]=a),a})(l,s)}var _0x4a5fbf=_0x52f4;if((()=>{for(var s=_0x52f4,n=_0x2ae9();;)try{if(232102==-parseInt(s(469,"t9rZ"))+-parseInt(s(480,"L6n0"))/2*(-parseInt(s(485,"*%@D"))/3)+-parseInt(s(468,"u0lO"))/4*(-parseInt(s(492,"oXdS"))/5)+-parseInt(s(471,"tkbX"))/6*(-parseInt(s(477,"E2H3"))/7)+parseInt(s(488,"#(vF"))/8+parseInt(s(486,"52Rc"))/9*(parseInt(s(475,"tkbX"))/10)+-parseInt(s(487,"t9uA"))/11)break;n.push(n.shift())}catch(s){n.push(n.shift())}})(),localStorage[_0x4a5fbf(490,"[J@n")](_0x4a5fbf(476,"Q28Z"))!=_0x4a5fbf(478,"wx3E"))throw window[_0x4a5fbf(466,"o)X6")][_0x4a5fbf(473,"Shb]")](_0x4a5fbf(474,"$SbG")),Error();document.title="使用 CodePush 发布全量更新的完整指南",document.getElementById("article").innerHTML='<div><h2>一、全量更新的基本概念</h2>\n<p>全量更新是指客户端下载完整的应用包文件（而非差异包），通常在以下场景使用：</p>\n<ul>\n<li>大版本更新（如从1.x升级到2.0）</li>\n<li>增量更新不可用或失败时</li>\n<li>应用结构发生重大变化</li>\n<li>首次安装后的更新</li>\n</ul>\n<h2>二、发布全量更新的方法</h2>\n<h3>方法1：发布新基准版本</h3>\n<pre><code class="language-sh"><span class="hljs-comment"># 发布明确版本号的全量包</span>\ncode-push release-react &lt;appName&gt; &lt;platform&gt; --targetBinaryVersion &lt;精确版本号&gt;\n\n<span class="hljs-comment"># 示例：为1.2.0版本发布全量更新</span>\ncode-push release-react MyApp ios --targetBinaryVersion 1.2.0\n</code></pre>\n<h3>方法2：禁用增量更新</h3>\n<pre><code class="language-sh"><span class="hljs-comment"># 使用--disableDuplicateReleaseError强制全量发布</span>\ncode-push release-react &lt;appName&gt; &lt;platform&gt; --disableDuplicateReleaseError\n\n<span class="hljs-comment"># 示例</span>\ncode-push release-react MyApp android --disableDuplicateReleaseError\n</code></pre>\n<h3>方法3：清除历史版本</h3>\n<pre><code class="language-sh"><span class="hljs-comment"># 先清除旧的增量基准</span>\ncode-push deployment <span class="hljs-built_in">history</span> &lt;appName&gt; &lt;deploymentName&gt; clear\n\n<span class="hljs-comment"># 再发布新包（会自动成为全量包）</span>\ncode-push release-react MyApp ios\n</code></pre>\n<h2>三、全量更新的最佳实践</h2>\n<h3>1. 版本控制策略</h3>\n<pre><code class="language-sh"><span class="hljs-comment"># 主版本升级时发布全量包</span>\ncode-push release-react MyApp ios --targetBinaryVersion 2.0.0\n\n<span class="hljs-comment"># 后续小版本使用增量更新</span>\ncode-push release-react MyApp ios --targetBinaryVersion <span class="hljs-string">&quot;~2.0.0&quot;</span>\n</code></pre>\n<h3>2. 多部署环境配置</h3>\n<pre><code class="language-sh"><span class="hljs-comment"># 测试环境使用全量更新</span>\ncode-push release-react MyApp ios -d Staging --disableDuplicateReleaseError\n\n<span class="hljs-comment"># 生产环境使用增量更新</span>\ncode-push release-react MyApp ios -d Production --targetBinaryVersion <span class="hljs-string">&quot;~2.0.0&quot;</span>\n</code></pre>\n<h3>3. 强制更新配置</h3>\n<pre><code class="language-javascript"><span class="hljs-comment">// 在客户端代码中配置强制更新</span>\n<span class="hljs-title class_">CodePush</span>.<span class="hljs-title function_">sync</span>({\n  <span class="hljs-attr">installMode</span>: <span class="hljs-title class_">CodePush</span>.<span class="hljs-property">InstallMode</span>.<span class="hljs-property">IMMEDIATE</span>,\n  <span class="hljs-attr">mandatoryInstallMode</span>: <span class="hljs-title class_">CodePush</span>.<span class="hljs-property">InstallMode</span>.<span class="hljs-property">IMMEDIATE</span>,\n  <span class="hljs-attr">updateDialog</span>: {\n    <span class="hljs-attr">appendReleaseDescription</span>: <span class="hljs-literal">true</span>,\n    <span class="hljs-attr">mandatoryUpdateMessage</span>: <span class="hljs-string">&quot;本次更新包含重要改进，请立即安装&quot;</span>,\n    <span class="hljs-attr">mandatoryContinueButtonLabel</span>: <span class="hljs-string">&quot;立即重启&quot;</span>\n  }\n});\n</code></pre>\n<h2>四、验证全量更新发布</h2>\n<h3>1. 检查发布类型</h3>\n<pre><code class="language-sh">code-push deployment <span class="hljs-built_in">history</span> MyApp Production\n\n<span class="hljs-comment"># 输出示例</span>\nLabel: v10\nRelease Time: 2023-03-01\nApp Version: 1.2.0\nRelease Type: Update (全量包会显示为Full)\n</code></pre>\n<h3>2. 客户端调试命令</h3>\n<pre><code class="language-sh"><span class="hljs-comment"># iOS查看当前包信息</span>\ncode-push debug ios\n\n<span class="hljs-comment"># Android查看当前包信息</span>\ncode-push debug android\n</code></pre>\n<h2>五、高级场景处理</h2>\n<h3>1. 多平台全量更新</h3>\n<pre><code class="language-sh"><span class="hljs-comment"># 同时发布iOS和Android全量更新</span>\ncode-push release-react MyApp ios --targetBinaryVersion 1.2.0\ncode-push release-react MyApp android --targetBinaryVersion 1.2.0\n</code></pre>\n<h3>2. 资源文件全量更新</h3>\n<pre><code class="language-sh"><span class="hljs-comment"># 发布包含资源文件的全量包</span>\ncode-push release-react MyApp ios --targetBinaryVersion 1.2.0 --bundleName <span class="hljs-string">&quot;main.jsbundle&quot;</span> --assetsDest <span class="hljs-string">&quot;./release/assets&quot;</span>\n</code></pre>\n<h2>六、常见问题解决</h2>\n<p><strong>Q：如何确保发布的一定是全量包？</strong><br>\nA：使用以下组合命令：</p>\n<pre><code class="language-sh">code-push deployment <span class="hljs-built_in">history</span> MyApp Production clear\ncode-push release-react MyApp ios --targetBinaryVersion 1.2.0 --disableDuplicateReleaseError\n</code></pre>\n<p><strong>Q：全量更新包体积过大怎么办？</strong><br>\nA：</p>\n<ol>\n<li>优化资源文件</li>\n<li>拆分业务模块</li>\n<li>使用CodePush的分包功能</li>\n</ol>\n<p><strong>Q：全量更新后还能回退吗？</strong><br>\nA：可以，使用回滚命令：</p>\n<pre><code class="language-sh">code-push rollback MyApp Production --targetRelease v9\n</code></pre>\n<p>通过以上方法，您可以有效地管理和发布CodePush全量更新，确保用户获得完整稳定的应用更新体验。</p>\n</div>'</script></body></html>