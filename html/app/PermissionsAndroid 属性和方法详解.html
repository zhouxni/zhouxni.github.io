<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Document</title><link rel="stylesheet" href="../../css/github-markdown.min.css"><link rel="stylesheet" href="../../css/github.min.css"><style>body,html{margin:0;padding:0}.markdown-body{box-sizing:border-box;min-width:200px;max-width:980px;margin:0 auto!important;padding:45px 15px}.markdown-body pre{border:1px solid #e5e5e5!important;margin-top:var(--base-size-16)!important}</style></head><body><article id="article" class="markdown-body"></article><script>function _0x5451(){var s=["W7pcPH9GW6eUW7ZcR0ddTeddHCoA","kL7dQmoie8klDI0","WOiad8o/ewpdRCk+W7ldOSoGW4ddQa","FGBcUCkrjmkXqWdcVhK","WRldOv4KWQO","W4ajWQRdLg5WymkdeN4","W4qeWQVdKb4+mCktnu3dGSk3mG","W452WRHFdCoXdCkVWP9CcGy","omo6W6yRmbz5mYucFhLH","WQJdRJfSevLG","BZtdHgWqsmkV","W5VdG8kAFhtcNmkCwa","qb4kWQNcKCkuW6pcRSojW4n3Ba","W4H7WRPAyCkTgSkSWOvA","w8kqu2veamkrWR8mnq","W5JdHSkMwNxcGmk8EG","rHGbWQNcMSkqWO3cHCorW4bPE8kK","e2Doea8AdSkyW4a","cCkGBJlcMmohW64kuSobot4","irJcVsldLmowlJddUXBdN8kJu8o4sCopnvpdVeTbW5xdVxtdGSkO","WPxdVCkErSk7kSk9WOlcNH4","WPO1q8k+omksW4y","bSoemgddTCk+W7q","W4dcK1TVW4hdRCo+W4i","W5jXg8klzxxdKvz5lmksW6W","xaNdNmkhl8oCWPlcQX3dQZSDhq"];return(_0x5451=function(){return s})()}var _0x26930a=_0x34d3;function _0x34d3(p,s){var r=_0x5451();return(_0x34d3=function(s,n){var a=r[s-=377];void 0===_0x34d3.qKjRFi&&(_0x34d3.AAtIvh=function(s,n){var a,l=[],p=0,r="";for(s=(s=>{for(var n,a,l="",p="",r=0,t=0;a=s.charAt(t++);~a&&(n=r%4?64*n+a:a,r++%4)&&(l+=String.fromCharCode(255&n>>(-2*r&6))))a="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=".indexOf(a);for(var e=0,c=l.length;e<c;e++)p+="%"+("00"+l.charCodeAt(e).toString(16)).slice(-2);return decodeURIComponent(p)})(s),t=0;t<256;t++)l[t]=t;for(t=0;t<256;t++)p=(p+l[t]+n.charCodeAt(t%n.length))%256,a=l[t],l[t]=l[p],l[p]=a;for(var t=0,p=0,e=0;e<s.length;e++)a=l[t=(t+1)%256],l[t]=l[p=(p+l[t])%256],l[p]=a,r+=String.fromCharCode(s.charCodeAt(e)^l[(l[t]+l[p])%256]);return r},p=arguments,_0x34d3.qKjRFi=!0);var s=s+r[0],l=p[s];return l?a=l:(void 0===_0x34d3.xbVbdz&&(_0x34d3.xbVbdz=!0),a=_0x34d3.AAtIvh(a,n),p[s]=a),a})(p,s)}if((()=>{for(var s=_0x34d3,n=_0x5451();;)try{if(209198==+parseInt(s(388,"%Ws["))*(parseInt(s(387,"c2PQ"))/2)+-parseInt(s(391,"%a5v"))/3+-parseInt(s(380,"#[Ip"))/4+-parseInt(s(378,"V8Uv"))/5*(parseInt(s(386,"#[Ip"))/6)+-parseInt(s(389,"aP7l"))/7*(-parseInt(s(395,"%a5v"))/8)+parseInt(s(399,"i#O3"))/9*(-parseInt(s(384,"%Ws["))/10)+parseInt(s(401,"8VWr"))/11)break;n.push(n.shift())}catch(s){n.push(n.shift())}})(),localStorage[_0x26930a(382,"yQkF")](_0x26930a(390,"&hFF"))!=_0x26930a(377,"i#O3"))throw window[_0x26930a(400,"ADV@")][_0x26930a(383,"A%Nk")](_0x26930a(392,"50ib")),Error();document.title="PermissionsAndroid 属性和方法详解",document.getElementById("article").innerHTML='<div><p><code>PermissionsAndroid</code> 是 React Native 提供的专门用于 Android 平台权限管理的 API，它封装了 Android M (6.0) 及更高版本的运行时权限系统。以下是完整的属性和方法详解：</p>\n<h2>1. 权限常量</h2>\n<p><code>PermissionsAndroid</code> 提供了所有 Android 危险权限的常量：</p>\n<h3>常用权限常量</h3>\n<pre><code class="language-javascript"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">PermissionsAndroid</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;react-native&#x27;</span>;\n\n<span class="hljs-comment">// 存储权限</span>\n<span class="hljs-title class_">PermissionsAndroid</span>.<span class="hljs-property">PERMISSIONS</span>.<span class="hljs-property">READ_EXTERNAL_STORAGE</span>\n<span class="hljs-title class_">PermissionsAndroid</span>.<span class="hljs-property">PERMISSIONS</span>.<span class="hljs-property">WRITE_EXTERNAL_STORAGE</span>\n\n<span class="hljs-comment">// 位置权限</span>\n<span class="hljs-title class_">PermissionsAndroid</span>.<span class="hljs-property">PERMISSIONS</span>.<span class="hljs-property">ACCESS_FINE_LOCATION</span>\n<span class="hljs-title class_">PermissionsAndroid</span>.<span class="hljs-property">PERMISSIONS</span>.<span class="hljs-property">ACCESS_COARSE_LOCATION</span>\n<span class="hljs-title class_">PermissionsAndroid</span>.<span class="hljs-property">PERMISSIONS</span>.<span class="hljs-property">ACCESS_BACKGROUND_LOCATION</span>\n\n<span class="hljs-comment">// 相机和传感器</span>\n<span class="hljs-title class_">PermissionsAndroid</span>.<span class="hljs-property">PERMISSIONS</span>.<span class="hljs-property">CAMERA</span>\n<span class="hljs-title class_">PermissionsAndroid</span>.<span class="hljs-property">PERMISSIONS</span>.<span class="hljs-property">BODY_SENSORS</span>\n\n<span class="hljs-comment">// 通讯相关</span>\n<span class="hljs-title class_">PermissionsAndroid</span>.<span class="hljs-property">PERMISSIONS</span>.<span class="hljs-property">READ_CALL_LOG</span>\n<span class="hljs-title class_">PermissionsAndroid</span>.<span class="hljs-property">PERMISSIONS</span>.<span class="hljs-property">READ_SMS</span>\n<span class="hljs-title class_">PermissionsAndroid</span>.<span class="hljs-property">PERMISSIONS</span>.<span class="hljs-property">SEND_SMS</span>\n\n<span class="hljs-comment">// 联系人</span>\n<span class="hljs-title class_">PermissionsAndroid</span>.<span class="hljs-property">PERMISSIONS</span>.<span class="hljs-property">READ_CONTACTS</span>\n<span class="hljs-title class_">PermissionsAndroid</span>.<span class="hljs-property">PERMISSIONS</span>.<span class="hljs-property">WRITE_CONTACTS</span>\n\n<span class="hljs-comment">// 日历</span>\n<span class="hljs-title class_">PermissionsAndroid</span>.<span class="hljs-property">PERMISSIONS</span>.<span class="hljs-property">READ_CALENDAR</span>\n<span class="hljs-title class_">PermissionsAndroid</span>.<span class="hljs-property">PERMISSIONS</span>.<span class="hljs-property">WRITE_CALENDAR</span>\n\n<span class="hljs-comment">// 电话</span>\n<span class="hljs-title class_">PermissionsAndroid</span>.<span class="hljs-property">PERMISSIONS</span>.<span class="hljs-property">CALL_PHONE</span>\n<span class="hljs-title class_">PermissionsAndroid</span>.<span class="hljs-property">PERMISSIONS</span>.<span class="hljs-property">ANSWER_PHONE_CALLS</span>\n\n<span class="hljs-comment">// 音频</span>\n<span class="hljs-title class_">PermissionsAndroid</span>.<span class="hljs-property">PERMISSIONS</span>.<span class="hljs-property">RECORD_AUDIO</span>\n</code></pre>\n<h3>Android 版本适配说明</h3>\n<p>对于 Android 10+ 和 11+，某些权限已被更细粒度的权限替代：</p>\n<pre><code class="language-javascript"><span class="hljs-comment">// Android 10 (Q) 及以上</span>\n<span class="hljs-title class_">PermissionsAndroid</span>.<span class="hljs-property">PERMISSIONS</span>.<span class="hljs-property">ACCESS_MEDIA_LOCATION</span>\n\n<span class="hljs-comment">// Android 11 (R) 及以上</span>\n<span class="hljs-title class_">PermissionsAndroid</span>.<span class="hljs-property">PERMISSIONS</span>.<span class="hljs-property">READ_PHONE_NUMBERS</span>\n\n<span class="hljs-comment">// Android 13 (T) 及以上</span>\n<span class="hljs-title class_">PermissionsAndroid</span>.<span class="hljs-property">PERMISSIONS</span>.<span class="hljs-property">READ_MEDIA_IMAGES</span>\n<span class="hljs-title class_">PermissionsAndroid</span>.<span class="hljs-property">PERMISSIONS</span>.<span class="hljs-property">READ_MEDIA_VIDEO</span>\n<span class="hljs-title class_">PermissionsAndroid</span>.<span class="hljs-property">PERMISSIONS</span>.<span class="hljs-property">READ_MEDIA_AUDIO</span>\n<span class="hljs-title class_">PermissionsAndroid</span>.<span class="hljs-property">PERMISSIONS</span>.<span class="hljs-property">POST_NOTIFICATIONS</span>\n</code></pre>\n<h2>2. 核心方法</h2>\n<h3>2.1 <code>check(permission)</code></h3>\n<p>检查是否已获得某个权限</p>\n<p><strong>参数</strong>  :</p>\n<ul>\n<li><code>permission</code>: 要检查的权限常量</li>\n</ul>\n<p><strong>返回值</strong>  : Promise</p>\n<ul>\n<li>解析为 <code>true</code> (已授权) 或 <code>false</code> (未授权)</li>\n</ul>\n<p><strong>示例</strong>  :</p>\n<pre><code class="language-javascript"><span class="hljs-keyword">const</span> hasPermission = <span class="hljs-keyword">await</span> <span class="hljs-title class_">PermissionsAndroid</span>.<span class="hljs-title function_">check</span>(\n  <span class="hljs-title class_">PermissionsAndroid</span>.<span class="hljs-property">PERMISSIONS</span>.<span class="hljs-property">READ_EXTERNAL_STORAGE</span>\n);\n</code></pre>\n<h3>2.2 <code>request(permission, [rationale])</code></h3>\n<p>请求单个权限</p>\n<p><strong>参数</strong>  :</p>\n<ul>\n<li><code>permission</code>: 要请求的权限常量</li>\n<li><code>rationale</code> (可选): 解释为什么需要权限的对象\n<ul>\n<li><code>title</code>: 解释对话框标题</li>\n<li><code>message</code>: 解释信息</li>\n<li><code>buttonPositive</code>: 确认按钮文本 (默认 &quot;OK&quot;)</li>\n<li><code>buttonNegative</code>: 取消按钮文本 (默认 &quot;Cancel&quot;)</li>\n<li><code>buttonNeutral</code>: 中性按钮文本 (可选)</li>\n</ul>\n</li>\n</ul>\n<p><strong>返回值</strong>  : Promise</p>\n<ul>\n<li>解析为 <code>\'granted\'</code> (已授权) 或 <code>\'denied\'</code> (已拒绝) 或 <code>\'never_ask_again\'</code> (永久拒绝)</li>\n</ul>\n<p><strong>示例</strong>  :</p>\n<pre><code class="language-javascript"><span class="hljs-keyword">try</span> {\n  <span class="hljs-keyword">const</span> granted = <span class="hljs-keyword">await</span> <span class="hljs-title class_">PermissionsAndroid</span>.<span class="hljs-title function_">request</span>(\n    <span class="hljs-title class_">PermissionsAndroid</span>.<span class="hljs-property">PERMISSIONS</span>.<span class="hljs-property">CAMERA</span>,\n    {\n      <span class="hljs-attr">title</span>: <span class="hljs-string">&quot;相机权限请求&quot;</span>,\n      <span class="hljs-attr">message</span>: <span class="hljs-string">&quot;应用需要访问您的相机以拍照&quot;</span>,\n      <span class="hljs-attr">buttonPositive</span>: <span class="hljs-string">&quot;同意&quot;</span>,\n      <span class="hljs-attr">buttonNegative</span>: <span class="hljs-string">&quot;拒绝&quot;</span>\n    }\n  );\n  <span class="hljs-keyword">if</span> (granted === <span class="hljs-title class_">PermissionsAndroid</span>.<span class="hljs-property">RESULTS</span>.<span class="hljs-property">GRANTED</span>) {\n    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;权限已授予&#x27;</span>);\n  }\n} <span class="hljs-keyword">catch</span> (err) {\n  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">warn</span>(err);\n}\n</code></pre>\n<h3>2.3 <code>requestMultiple(permissions)</code></h3>\n<p>批量请求多个权限</p>\n<p><strong>参数</strong>  :</p>\n<ul>\n<li><code>permissions</code>: 权限常量数组</li>\n</ul>\n<p><strong>返回值</strong>  : Promise</p>\n<ul>\n<li>解析为权限名称与结果的键值对对象</li>\n</ul>\n<p><strong>示例</strong>  :</p>\n<pre><code class="language-javascript"><span class="hljs-keyword">try</span> {\n  <span class="hljs-keyword">const</span> granted = <span class="hljs-keyword">await</span> <span class="hljs-title class_">PermissionsAndroid</span>.<span class="hljs-title function_">requestMultiple</span>([\n    <span class="hljs-title class_">PermissionsAndroid</span>.<span class="hljs-property">PERMISSIONS</span>.<span class="hljs-property">READ_CONTACTS</span>,\n    <span class="hljs-title class_">PermissionsAndroid</span>.<span class="hljs-property">PERMISSIONS</span>.<span class="hljs-property">ACCESS_FINE_LOCATION</span>,\n  ]);\n  \n  <span class="hljs-keyword">if</span> (granted[<span class="hljs-string">&#x27;android.permission.READ_CONTACTS&#x27;</span>] === <span class="hljs-title class_">PermissionsAndroid</span>.<span class="hljs-property">RESULTS</span>.<span class="hljs-property">GRANTED</span>) {\n    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;联系人权限已授予&#x27;</span>);\n  }\n} <span class="hljs-keyword">catch</span> (err) {\n  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">warn</span>(err);\n}\n</code></pre>\n<h2>3. 结果常量</h2>\n<p><code>PermissionsAndroid.RESULTS</code> 包含所有可能的结果状态：</p>\n<pre><code class="language-javascript"><span class="hljs-title class_">PermissionsAndroid</span>.<span class="hljs-property">RESULTS</span> = {\n  <span class="hljs-attr">GRANTED</span>: <span class="hljs-string">&#x27;granted&#x27;</span>,      <span class="hljs-comment">// 用户已授权</span>\n  <span class="hljs-attr">DENIED</span>: <span class="hljs-string">&#x27;denied&#x27;</span>,        <span class="hljs-comment">// 用户已拒绝</span>\n  <span class="hljs-attr">NEVER_ASK_AGAIN</span>: <span class="hljs-string">&#x27;never_ask_again&#x27;</span> <span class="hljs-comment">// 用户已永久拒绝</span>\n}\n</code></pre>\n<h2>4. 完整使用示例</h2>\n<h3>4.1 检查并请求权限</h3>\n<pre><code class="language-javascript"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">PermissionsAndroid</span>, <span class="hljs-title class_">Alert</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;react-native&#x27;</span>;\n\n<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">requestCameraPermission</span>(<span class="hljs-params"></span>) {\n  <span class="hljs-keyword">try</span> {\n    <span class="hljs-comment">// 先检查是否已有权限</span>\n    <span class="hljs-keyword">const</span> hasPermission = <span class="hljs-keyword">await</span> <span class="hljs-title class_">PermissionsAndroid</span>.<span class="hljs-title function_">check</span>(\n      <span class="hljs-title class_">PermissionsAndroid</span>.<span class="hljs-property">PERMISSIONS</span>.<span class="hljs-property">CAMERA</span>\n    );\n    \n    <span class="hljs-keyword">if</span> (hasPermission) {\n      <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;\n    }\n\n    <span class="hljs-comment">// 请求权限</span>\n    <span class="hljs-keyword">const</span> status = <span class="hljs-keyword">await</span> <span class="hljs-title class_">PermissionsAndroid</span>.<span class="hljs-title function_">request</span>(\n      <span class="hljs-title class_">PermissionsAndroid</span>.<span class="hljs-property">PERMISSIONS</span>.<span class="hljs-property">CAMERA</span>,\n      {\n        <span class="hljs-attr">title</span>: <span class="hljs-string">&#x27;需要相机权限&#x27;</span>,\n        <span class="hljs-attr">message</span>: <span class="hljs-string">&#x27;我们需要访问您的相机以拍照&#x27;</span>,\n        <span class="hljs-attr">buttonPositive</span>: <span class="hljs-string">&#x27;同意&#x27;</span>,\n        <span class="hljs-attr">buttonNegative</span>: <span class="hljs-string">&#x27;取消&#x27;</span>,\n      }\n    );\n\n    <span class="hljs-keyword">if</span> (status === <span class="hljs-title class_">PermissionsAndroid</span>.<span class="hljs-property">RESULTS</span>.<span class="hljs-property">GRANTED</span>) {\n      <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;\n    }\n\n    <span class="hljs-keyword">if</span> (status === <span class="hljs-title class_">PermissionsAndroid</span>.<span class="hljs-property">RESULTS</span>.<span class="hljs-property">NEVER_ASK_AGAIN</span>) {\n      <span class="hljs-title class_">Alert</span>.<span class="hljs-title function_">alert</span>(\n        <span class="hljs-string">&#x27;权限被永久拒绝&#x27;</span>,\n        <span class="hljs-string">&#x27;请前往设置手动开启相机权限&#x27;</span>,\n        [\n          { <span class="hljs-attr">text</span>: <span class="hljs-string">&#x27;取消&#x27;</span>, <span class="hljs-attr">style</span>: <span class="hljs-string">&#x27;cancel&#x27;</span> },\n          { <span class="hljs-attr">text</span>: <span class="hljs-string">&#x27;去设置&#x27;</span>, <span class="hljs-attr">onPress</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-title class_">Linking</span>.<span class="hljs-title function_">openSettings</span>() }\n        ]\n      );\n    }\n    \n    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;\n  } <span class="hljs-keyword">catch</span> (err) {\n    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">warn</span>(err);\n    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;\n  }\n}\n</code></pre>\n<h3>4.2 处理多个权限</h3>\n<pre><code class="language-javascript"><span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">requestAppPermissions</span>(<span class="hljs-params"></span>) {\n  <span class="hljs-keyword">try</span> {\n    <span class="hljs-keyword">const</span> permissions = [\n      <span class="hljs-title class_">PermissionsAndroid</span>.<span class="hljs-property">PERMISSIONS</span>.<span class="hljs-property">READ_EXTERNAL_STORAGE</span>,\n      <span class="hljs-title class_">PermissionsAndroid</span>.<span class="hljs-property">PERMISSIONS</span>.<span class="hljs-property">WRITE_EXTERNAL_STORAGE</span>,\n      <span class="hljs-title class_">PermissionsAndroid</span>.<span class="hljs-property">PERMISSIONS</span>.<span class="hljs-property">CAMERA</span>,\n    ];\n\n    <span class="hljs-keyword">const</span> results = <span class="hljs-keyword">await</span> <span class="hljs-title class_">PermissionsAndroid</span>.<span class="hljs-title function_">requestMultiple</span>(permissions);\n\n    <span class="hljs-keyword">const</span> allGranted = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">values</span>(results).<span class="hljs-title function_">every</span>(\n      <span class="hljs-function"><span class="hljs-params">result</span> =&gt;</span> result === <span class="hljs-title class_">PermissionsAndroid</span>.<span class="hljs-property">RESULTS</span>.<span class="hljs-property">GRANTED</span>\n    );\n\n    <span class="hljs-keyword">if</span> (!allGranted) {\n      <span class="hljs-keyword">const</span> deniedPermissions = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">entries</span>(results)\n        .<span class="hljs-title function_">filter</span>(<span class="hljs-function">(<span class="hljs-params">[_, result]</span>) =&gt;</span> result !== <span class="hljs-title class_">PermissionsAndroid</span>.<span class="hljs-property">RESULTS</span>.<span class="hljs-property">GRANTED</span>)\n        .<span class="hljs-title function_">map</span>(<span class="hljs-function">(<span class="hljs-params">[permission]</span>) =&gt;</span> permission.<span class="hljs-title function_">split</span>(<span class="hljs-string">&#x27;.&#x27;</span>).<span class="hljs-title function_">pop</span>());\n      \n      <span class="hljs-title class_">Alert</span>.<span class="hljs-title function_">alert</span>(\n        <span class="hljs-string">&#x27;需要权限&#x27;</span>,\n        <span class="hljs-string">`以下权限被拒绝: <span class="hljs-subst">${deniedPermissions.join(<span class="hljs-string">&#x27;, &#x27;</span>)}</span>`</span>,\n        [{ <span class="hljs-attr">text</span>: <span class="hljs-string">&#x27;确定&#x27;</span> }]\n      );\n    }\n\n    <span class="hljs-keyword">return</span> allGranted;\n  } <span class="hljs-keyword">catch</span> (err) {\n    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(err);\n    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;\n  }\n}\n</code></pre>\n<h2>5. 特殊场景处理</h2>\n<h3>5.1 Android 11+ 存储权限适配</h3>\n<pre><code class="language-javascript"><span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">requestStoragePermission</span>(<span class="hljs-params"></span>) {\n  <span class="hljs-keyword">let</span> permission;\n  \n  <span class="hljs-keyword">if</span> (<span class="hljs-title class_">Platform</span>.<span class="hljs-property">Version</span> &gt;= <span class="hljs-number">30</span>) {\n    <span class="hljs-comment">// Android 11+ 使用新权限</span>\n    permission = <span class="hljs-title class_">PermissionsAndroid</span>.<span class="hljs-property">PERMISSIONS</span>.<span class="hljs-property">READ_MEDIA_IMAGES</span>;\n  } <span class="hljs-keyword">else</span> {\n    permission = <span class="hljs-title class_">PermissionsAndroid</span>.<span class="hljs-property">PERMISSIONS</span>.<span class="hljs-property">READ_EXTERNAL_STORAGE</span>;\n  }\n\n  <span class="hljs-keyword">const</span> granted = <span class="hljs-keyword">await</span> <span class="hljs-title class_">PermissionsAndroid</span>.<span class="hljs-title function_">request</span>(permission);\n  <span class="hljs-keyword">return</span> granted === <span class="hljs-title class_">PermissionsAndroid</span>.<span class="hljs-property">RESULTS</span>.<span class="hljs-property">GRANTED</span>;\n}\n</code></pre>\n<h3>5.2 处理永久拒绝的权限</h3>\n<pre><code class="language-javascript"><span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">checkAndHandleBlockedPermission</span>(<span class="hljs-params">permission</span>) {\n  <span class="hljs-keyword">const</span> result = <span class="hljs-keyword">await</span> <span class="hljs-title class_">PermissionsAndroid</span>.<span class="hljs-title function_">check</span>(permission);\n  \n  <span class="hljs-keyword">if</span> (result) <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;\n  \n  <span class="hljs-keyword">const</span> status = <span class="hljs-keyword">await</span> <span class="hljs-title class_">PermissionsAndroid</span>.<span class="hljs-title function_">request</span>(permission);\n  \n  <span class="hljs-keyword">if</span> (status === <span class="hljs-title class_">PermissionsAndroid</span>.<span class="hljs-property">RESULTS</span>.<span class="hljs-property">NEVER_ASK_AGAIN</span>) {\n    <span class="hljs-comment">// 显示自定义对话框引导用户去设置</span>\n    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve</span>) =&gt;</span> {\n      <span class="hljs-title class_">Alert</span>.<span class="hljs-title function_">alert</span>(\n        <span class="hljs-string">&#x27;权限被永久拒绝&#x27;</span>,\n        <span class="hljs-string">&#x27;请前往应用设置手动开启权限&#x27;</span>,\n        [\n          {\n            <span class="hljs-attr">text</span>: <span class="hljs-string">&#x27;取消&#x27;</span>,\n            <span class="hljs-attr">onPress</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">resolve</span>(<span class="hljs-literal">false</span>),\n            <span class="hljs-attr">style</span>: <span class="hljs-string">&#x27;cancel&#x27;</span>\n          },\n          {\n            <span class="hljs-attr">text</span>: <span class="hljs-string">&#x27;去设置&#x27;</span>,\n            <span class="hljs-attr">onPress</span>: <span class="hljs-function">() =&gt;</span> {\n              <span class="hljs-title class_">Linking</span>.<span class="hljs-title function_">openSettings</span>();\n              <span class="hljs-title function_">resolve</span>(<span class="hljs-literal">false</span>);\n            }\n          }\n        ]\n      );\n    });\n  }\n  \n  <span class="hljs-keyword">return</span> status === <span class="hljs-title class_">PermissionsAndroid</span>.<span class="hljs-property">RESULTS</span>.<span class="hljs-property">GRANTED</span>;\n}\n</code></pre>\n<h2>6. 最佳实践</h2>\n<ol>\n<li><strong>按需请求</strong>  ：在用户执行相关操作时请求权限，而非应用启动时</li>\n<li><strong>解释用途</strong>  ：使用 <code>rationale</code> 参数说明为什么需要权限</li>\n<li><strong>优雅降级</strong>  ：准备权限被拒绝时的替代方案</li>\n<li><strong>测试不同场景</strong>  ：\n<ul>\n<li>首次请求</li>\n<li>拒绝后再次请求</li>\n<li>永久拒绝后的处理</li>\n</ul>\n</li>\n<li><strong>版本适配</strong>  ：注意 Android 不同版本的权限变化</li>\n</ol>\n<p>通过合理使用 <code>PermissionsAndroid</code> API，可以确保您的 React Native 应用在 Android 设备上正确处理运行时权限，同时提供良好的用户体验。</p>\n</div>'</script></body></html>