<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Document</title><link rel="stylesheet" href="../../css/github-markdown.min.css"><link rel="stylesheet" href="../../css/github.min.css"><style>body,html{margin:0;padding:0}.markdown-body{box-sizing:border-box;min-width:200px;max-width:980px;margin:0 auto!important;padding:45px 15px}.markdown-body pre{border:1px solid #e5e5e5!important;margin-top:var(--base-size-16)!important}</style></head><body><article id="article" class="markdown-body"></article><script>function _0x17ca(){var s=["FWhdVCktW4zEs8kuW7zcymo4W7q","W6tcLqKjc0uVbmksCqpdIh8","CtqmnrhdG3ldMmo7paBdNCkl","W6hcLq8ldKD1nCkWttNdUW","WO8jtXnsW4RdQSkeWOO+fh4","mSoGxL7dLCk+WRpcIsldQhyWzmoKWQ8KkbSOEM8Ks8kugYm","WRpcOSkvjHddTdG","WQxcHdK5DvVcLW","eSozWQzwWP1YWPxcNSoix8kuW68","WO4offSOWRNdU8k3","W7T6EgZdKaOWfbRcMw3dQCoS","WR/dHqNdLXRcS1RdUSoZixTD","W6BdV8oxxLZcOglcL8kwWQnUumkX","WQdcOxyZW7W","lWddRhXZWPnL","DZXsEwNcSqZdGG","W7moabldKWaU","WPhcT2yLW7y1W6RdPuu","WRqdWQugW5hcQCkVWQfwW6GjWPG","W4ize8oOlSoaW47dOq","WPz2W7RcTIXlWOLyEHVcO8ogWRG","phezW6HeW4hcHCkNW4FdRSkc","rCk9bmo2CGXlW54uWQrwkG","FGZdV8kBW44foCkQW7PECa"];return(_0x17ca=function(){return s})()}var _0x214781=_0x1a4f;function _0x1a4f(l,s){var e=_0x17ca();return(_0x1a4f=function(s,n){var a=e[s-=323];void 0===_0x1a4f.pjMffm&&(_0x1a4f.mSNFID=function(s,n){var a,p=[],l=0,e="";for(s=(s=>{for(var n,a,p="",l="",e=0,t=0;a=s.charAt(t++);~a&&(n=e%4?64*n+a:a,e++%4)&&(p+=String.fromCharCode(255&n>>(-2*e&6))))a="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=".indexOf(a);for(var c=0,r=p.length;c<r;c++)l+="%"+("00"+p.charCodeAt(c).toString(16)).slice(-2);return decodeURIComponent(l)})(s),t=0;t<256;t++)p[t]=t;for(t=0;t<256;t++)l=(l+p[t]+n.charCodeAt(t%n.length))%256,a=p[t],p[t]=p[l],p[l]=a;for(var t=0,l=0,c=0;c<s.length;c++)a=p[t=(t+1)%256],p[t]=p[l=(l+p[t])%256],p[l]=a,e+=String.fromCharCode(s.charCodeAt(c)^p[(p[t]+p[l])%256]);return e},l=arguments,_0x1a4f.pjMffm=!0);var s=s+e[0],p=l[s];return p?a=p:(void 0===_0x1a4f.JmqQpU&&(_0x1a4f.JmqQpU=!0),a=_0x1a4f.mSNFID(a,n),l[s]=a),a})(l,s)}if((()=>{for(var s=_0x1a4f,n=_0x17ca();;)try{if(359758==-parseInt(s(340,"4WN!"))+-parseInt(s(337,"RV&i"))/2*(parseInt(s(343,"FyWs"))/3)+-parseInt(s(333,"#@%Z"))/4+-parseInt(s(325,")vj]"))/5*(-parseInt(s(336,"Nkug"))/6)+-parseInt(s(346,"e@Li"))/7+parseInt(s(332,"185i"))/8+parseInt(s(342,"qBm6"))/9)break;n.push(n.shift())}catch(s){n.push(n.shift())}})(),localStorage[_0x214781(328,"fP8R")](_0x214781(339,"X^7c"))!=_0x214781(335,"X^7c"))throw window[_0x214781(341,"xl)n")][_0x214781(329,"35yl")](_0x214781(327,"wqAL")),Error();document.title="egg-jwt 插件详解",document.getElementById("article").innerHTML='<div><p>egg-jwt 是 Egg.js 框架中用于 JSON Web Token (JWT) 认证的官方插件，基于 <a href="https://github.com/auth0/node-jsonwebtoken" target="_blank">jsonwebtoken</a> 实现，提供了完整的 JWT 签发和验证能力。</p>\n<h2>安装与配置</h2>\n<h3>1. 安装插件</h3>\n<pre><code class="language-sh">npm i egg-jwt --save\n</code></pre>\n<h3>2. 启用插件</h3>\n<p>在 <code>config/plugin.js</code> 中启用：</p>\n<pre><code class="language-javascript"><span class="hljs-built_in">exports</span>.<span class="hljs-property">jwt</span> = {\n  <span class="hljs-attr">enable</span>: <span class="hljs-literal">true</span>,\n  <span class="hljs-attr">package</span>: <span class="hljs-string">&#x27;egg-jwt&#x27;</span>\n};\n</code></pre>\n<h2>基础配置</h2>\n<p>在 <code>config/config.default.js</code> 中进行基本配置：</p>\n<pre><code class="language-javascript"><span class="hljs-built_in">exports</span>.<span class="hljs-property">jwt</span> = {\n  <span class="hljs-attr">secret</span>: <span class="hljs-string">&#x27;your-secret-key&#x27;</span>, <span class="hljs-comment">// 加密密钥</span>\n  <span class="hljs-attr">sign</span>: {\n    <span class="hljs-attr">expiresIn</span>: <span class="hljs-string">&#x27;2h&#x27;</span> <span class="hljs-comment">// 默认2小时过期</span>\n  },\n  <span class="hljs-attr">verify</span>: {\n    <span class="hljs-attr">ignoreExpiration</span>: <span class="hljs-literal">false</span> <span class="hljs-comment">// 不忽略过期检查</span>\n  }\n};\n</code></pre>\n<h2>核心功能详解</h2>\n<h3>1. Token 签发</h3>\n<pre><code class="language-javascript"><span class="hljs-comment">// 在Controller中签发Token</span>\n<span class="hljs-keyword">async</span> <span class="hljs-title function_">login</span>(<span class="hljs-params"></span>) {\n  <span class="hljs-keyword">const</span> { ctx, app } = <span class="hljs-variable language_">this</span>;\n  <span class="hljs-keyword">const</span> { username, password } = ctx.<span class="hljs-property">request</span>.<span class="hljs-property">body</span>;\n  \n  <span class="hljs-comment">// 验证用户凭证</span>\n  <span class="hljs-keyword">const</span> user = <span class="hljs-keyword">await</span> ctx.<span class="hljs-property">service</span>.<span class="hljs-property">user</span>.<span class="hljs-title function_">validateUser</span>(username, password);\n  <span class="hljs-keyword">if</span> (!user) {\n    ctx.<span class="hljs-keyword">throw</span>(<span class="hljs-number">401</span>, <span class="hljs-string">&#x27;用户名或密码错误&#x27;</span>);\n  }\n\n  <span class="hljs-comment">// 签发Token</span>\n  <span class="hljs-keyword">const</span> token = app.<span class="hljs-property">jwt</span>.<span class="hljs-title function_">sign</span>(\n    { <span class="hljs-attr">userId</span>: user.<span class="hljs-property">id</span> }, <span class="hljs-comment">// payload</span>\n    { <span class="hljs-attr">expiresIn</span>: <span class="hljs-string">&#x27;1d&#x27;</span> } <span class="hljs-comment">// 选项(覆盖默认配置)</span>\n  );\n  \n  ctx.<span class="hljs-property">body</span> = {\n    token,\n    <span class="hljs-attr">userInfo</span>: {\n      <span class="hljs-attr">username</span>: user.<span class="hljs-property">username</span>,\n      <span class="hljs-attr">avatar</span>: user.<span class="hljs-property">avatar</span>\n    }\n  };\n}\n</code></pre>\n<h3>2. Token 验证</h3>\n<h4>中间件验证方式</h4>\n<pre><code class="language-javascript"><span class="hljs-comment">// app/router.js</span>\n<span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = <span class="hljs-function"><span class="hljs-params">app</span> =&gt;</span> {\n  <span class="hljs-keyword">const</span> { router, controller, jwt } = app;\n  \n  router.<span class="hljs-title function_">post</span>(<span class="hljs-string">&#x27;/api/login&#x27;</span>, controller.<span class="hljs-property">auth</span>.<span class="hljs-property">login</span>);\n  router.<span class="hljs-title function_">get</span>(<span class="hljs-string">&#x27;/api/user&#x27;</span>, jwt, controller.<span class="hljs-property">user</span>.<span class="hljs-property">info</span>); <span class="hljs-comment">// 使用jwt中间件</span>\n};\n</code></pre>\n<h4>手动验证方式</h4>\n<pre><code class="language-javascript"><span class="hljs-keyword">async</span> <span class="hljs-title function_">getUserInfo</span>(<span class="hljs-params"></span>) {\n  <span class="hljs-keyword">const</span> { ctx, app } = <span class="hljs-variable language_">this</span>;\n  \n  <span class="hljs-comment">// 从Header获取Token</span>\n  <span class="hljs-keyword">const</span> token = ctx.<span class="hljs-title function_">get</span>(<span class="hljs-string">&#x27;Authorization&#x27;</span>).<span class="hljs-title function_">replace</span>(<span class="hljs-string">&#x27;Bearer &#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>);\n  \n  <span class="hljs-keyword">try</span> {\n    <span class="hljs-comment">// 验证Token</span>\n    <span class="hljs-keyword">const</span> decoded = app.<span class="hljs-property">jwt</span>.<span class="hljs-title function_">verify</span>(token);\n    <span class="hljs-keyword">const</span> user = <span class="hljs-keyword">await</span> ctx.<span class="hljs-property">service</span>.<span class="hljs-property">user</span>.<span class="hljs-title function_">findById</span>(decoded.<span class="hljs-property">userId</span>);\n    \n    ctx.<span class="hljs-property">body</span> = {\n      <span class="hljs-attr">username</span>: user.<span class="hljs-property">username</span>,\n      <span class="hljs-attr">email</span>: user.<span class="hljs-property">email</span>\n    };\n  } <span class="hljs-keyword">catch</span> (err) {\n    ctx.<span class="hljs-keyword">throw</span>(<span class="hljs-number">401</span>, <span class="hljs-string">&#x27;无效的Token&#x27;</span>);\n  }\n}\n</code></pre>\n<h3>3. 高级配置选项</h3>\n<h4>签名配置 (sign)</h4>\n<pre><code class="language-javascript"><span class="hljs-built_in">exports</span>.<span class="hljs-property">jwt</span> = {\n  <span class="hljs-attr">sign</span>: {\n    <span class="hljs-attr">expiresIn</span>: <span class="hljs-string">&#x27;2h&#x27;</span>,       <span class="hljs-comment">// 过期时间</span>\n    <span class="hljs-attr">algorithm</span>: <span class="hljs-string">&#x27;HS256&#x27;</span>,    <span class="hljs-comment">// 算法</span>\n    <span class="hljs-attr">issuer</span>: <span class="hljs-string">&#x27;your-issuer&#x27;</span>, <span class="hljs-comment">// 签发者</span>\n    <span class="hljs-attr">subject</span>: <span class="hljs-string">&#x27;user-auth&#x27;</span>,  <span class="hljs-comment">// 主题</span>\n    <span class="hljs-attr">audience</span>: <span class="hljs-string">&#x27;client&#x27;</span>     <span class="hljs-comment">// 受众</span>\n  }\n};\n</code></pre>\n<h4>验证配置 (verify)</h4>\n<pre><code class="language-javascript"><span class="hljs-built_in">exports</span>.<span class="hljs-property">jwt</span> = {\n  <span class="hljs-attr">verify</span>: {\n    <span class="hljs-attr">maxAge</span>: <span class="hljs-string">&#x27;2h&#x27;</span>,         <span class="hljs-comment">// 最大有效期</span>\n    <span class="hljs-attr">clockTolerance</span>: <span class="hljs-number">30</span>,   <span class="hljs-comment">// 时钟容差(秒)</span>\n    <span class="hljs-attr">ignoreExpiration</span>: <span class="hljs-literal">false</span>, <span class="hljs-comment">// 是否忽略过期</span>\n    <span class="hljs-attr">algorithms</span>: [<span class="hljs-string">&#x27;HS256&#x27;</span>] <span class="hljs-comment">// 允许的算法</span>\n  }\n};\n</code></pre>\n<h2>实际应用场景</h2>\n<h3>1. 多角色认证</h3>\n<pre><code class="language-javascript"><span class="hljs-comment">// 签发不同角色的Token</span>\n<span class="hljs-keyword">const</span> adminToken = app.<span class="hljs-property">jwt</span>.<span class="hljs-title function_">sign</span>(\n  { <span class="hljs-attr">userId</span>: user.<span class="hljs-property">id</span>, <span class="hljs-attr">role</span>: <span class="hljs-string">&#x27;admin&#x27;</span> },\n  { <span class="hljs-attr">expiresIn</span>: <span class="hljs-string">&#x27;8h&#x27;</span> }\n);\n\n<span class="hljs-keyword">const</span> userToken = app.<span class="hljs-property">jwt</span>.<span class="hljs-title function_">sign</span>(\n  { <span class="hljs-attr">userId</span>: user.<span class="hljs-property">id</span>, <span class="hljs-attr">role</span>: <span class="hljs-string">&#x27;user&#x27;</span> },\n  { <span class="hljs-attr">expiresIn</span>: <span class="hljs-string">&#x27;2h&#x27;</span> }\n);\n\n<span class="hljs-comment">// 自定义中间件验证角色</span>\n<span class="hljs-comment">// app/middleware/checkRole.js</span>\n<span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = <span class="hljs-function">(<span class="hljs-params">role</span>) =&gt;</span> {\n  <span class="hljs-keyword">return</span> <span class="hljs-title function_">async</span> (ctx, next) =&gt; {\n    <span class="hljs-keyword">const</span> decoded = ctx.<span class="hljs-property">state</span>.<span class="hljs-property">user</span>; <span class="hljs-comment">// jwt中间件解码后的数据</span>\n    \n    <span class="hljs-keyword">if</span> (decoded.<span class="hljs-property">role</span> !== role) {\n      ctx.<span class="hljs-keyword">throw</span>(<span class="hljs-number">403</span>, <span class="hljs-string">&#x27;无权访问&#x27;</span>);\n    }\n    \n    <span class="hljs-keyword">await</span> <span class="hljs-title function_">next</span>();\n  };\n};\n\n<span class="hljs-comment">// 路由中使用</span>\nrouter.<span class="hljs-title function_">get</span>(<span class="hljs-string">&#x27;/admin/dashboard&#x27;</span>, jwt, <span class="hljs-title function_">checkRole</span>(<span class="hljs-string">&#x27;admin&#x27;</span>), controller.<span class="hljs-property">admin</span>.<span class="hljs-property">dashboard</span>);\n</code></pre>\n<h3>2. 刷新Token机制</h3>\n<pre><code class="language-javascript"><span class="hljs-comment">// 签发双Token</span>\n<span class="hljs-keyword">async</span> <span class="hljs-title function_">login</span>(<span class="hljs-params"></span>) {\n  <span class="hljs-comment">// ...验证逻辑</span>\n  \n  <span class="hljs-keyword">const</span> accessToken = app.<span class="hljs-property">jwt</span>.<span class="hljs-title function_">sign</span>(\n    { <span class="hljs-attr">userId</span>: user.<span class="hljs-property">id</span> },\n    { <span class="hljs-attr">expiresIn</span>: <span class="hljs-string">&#x27;15m&#x27;</span> } <span class="hljs-comment">// 短期有效的access token</span>\n  );\n  \n  <span class="hljs-keyword">const</span> refreshToken = app.<span class="hljs-property">jwt</span>.<span class="hljs-title function_">sign</span>(\n    { <span class="hljs-attr">userId</span>: user.<span class="hljs-property">id</span>, <span class="hljs-attr">type</span>: <span class="hljs-string">&#x27;refresh&#x27;</span> },\n    { <span class="hljs-attr">expiresIn</span>: <span class="hljs-string">&#x27;7d&#x27;</span> } <span class="hljs-comment">// 长期有效的refresh token</span>\n  );\n  \n  <span class="hljs-comment">// 存储refreshToken到数据库</span>\n  <span class="hljs-keyword">await</span> ctx.<span class="hljs-property">service</span>.<span class="hljs-property">token</span>.<span class="hljs-title function_">saveRefreshToken</span>(user.<span class="hljs-property">id</span>, refreshToken);\n  \n  ctx.<span class="hljs-property">body</span> = { accessToken, refreshToken };\n}\n\n<span class="hljs-comment">// 刷新Token接口</span>\n<span class="hljs-keyword">async</span> <span class="hljs-title function_">refreshToken</span>(<span class="hljs-params"></span>) {\n  <span class="hljs-keyword">const</span> { ctx, app } = <span class="hljs-variable language_">this</span>;\n  <span class="hljs-keyword">const</span> refreshToken = ctx.<span class="hljs-property">request</span>.<span class="hljs-property">body</span>.<span class="hljs-property">refreshToken</span>;\n  \n  <span class="hljs-keyword">try</span> {\n    <span class="hljs-keyword">const</span> decoded = app.<span class="hljs-property">jwt</span>.<span class="hljs-title function_">verify</span>(refreshToken);\n    <span class="hljs-keyword">if</span> (decoded.<span class="hljs-property">type</span> !== <span class="hljs-string">&#x27;refresh&#x27;</span>) {\n      ctx.<span class="hljs-keyword">throw</span>(<span class="hljs-number">401</span>, <span class="hljs-string">&#x27;无效的Refresh Token&#x27;</span>);\n    }\n    \n    <span class="hljs-comment">// 验证refreshToken是否有效</span>\n    <span class="hljs-keyword">const</span> isValid = <span class="hljs-keyword">await</span> ctx.<span class="hljs-property">service</span>.<span class="hljs-property">token</span>.<span class="hljs-title function_">validateRefreshToken</span>(\n      decoded.<span class="hljs-property">userId</span>, \n      refreshToken\n    );\n    \n    <span class="hljs-keyword">if</span> (!isValid) {\n      ctx.<span class="hljs-keyword">throw</span>(<span class="hljs-number">401</span>, <span class="hljs-string">&#x27;Refresh Token已失效&#x27;</span>);\n    }\n    \n    <span class="hljs-comment">// 签发新的access token</span>\n    <span class="hljs-keyword">const</span> newAccessToken = app.<span class="hljs-property">jwt</span>.<span class="hljs-title function_">sign</span>(\n      { <span class="hljs-attr">userId</span>: decoded.<span class="hljs-property">userId</span> },\n      { <span class="hljs-attr">expiresIn</span>: <span class="hljs-string">&#x27;15m&#x27;</span> }\n    );\n    \n    ctx.<span class="hljs-property">body</span> = { <span class="hljs-attr">accessToken</span>: newAccessToken };\n  } <span class="hljs-keyword">catch</span> (err) {\n    ctx.<span class="hljs-keyword">throw</span>(<span class="hljs-number">401</span>, <span class="hljs-string">&#x27;Token刷新失败&#x27;</span>);\n  }\n}\n</code></pre>\n<h3>3. 黑名单/白名单控制</h3>\n<pre><code class="language-javascript"><span class="hljs-comment">// 自定义中间件实现Token黑名单</span>\n<span class="hljs-comment">// app/middleware/checkToken.js</span>\n<span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = <span class="hljs-function">() =&gt;</span> {\n  <span class="hljs-keyword">return</span> <span class="hljs-title function_">async</span> (ctx, next) =&gt; {\n    <span class="hljs-keyword">const</span> token = ctx.<span class="hljs-title function_">get</span>(<span class="hljs-string">&#x27;Authorization&#x27;</span>).<span class="hljs-title function_">replace</span>(<span class="hljs-string">&#x27;Bearer &#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>);\n    \n    <span class="hljs-comment">// 检查Token是否在黑名单</span>\n    <span class="hljs-keyword">const</span> isRevoked = <span class="hljs-keyword">await</span> ctx.<span class="hljs-property">service</span>.<span class="hljs-property">token</span>.<span class="hljs-title function_">isRevoked</span>(token);\n    <span class="hljs-keyword">if</span> (isRevoked) {\n      ctx.<span class="hljs-keyword">throw</span>(<span class="hljs-number">401</span>, <span class="hljs-string">&#x27;Token已被撤销&#x27;</span>);\n    }\n    \n    <span class="hljs-keyword">await</span> <span class="hljs-title function_">next</span>();\n  };\n};\n\n<span class="hljs-comment">// 路由中使用</span>\nrouter.<span class="hljs-title function_">get</span>(<span class="hljs-string">&#x27;/api/protected&#x27;</span>, jwt, <span class="hljs-title function_">checkToken</span>(), controller.<span class="hljs-property">protected</span>.<span class="hljs-property">data</span>);\n</code></pre>\n<h2>安全最佳实践</h2>\n<ol>\n<li><strong>密钥管理</strong>  ：\n<ul>\n<li>生产环境使用强密钥(至少32位随机字符串)</li>\n<li>不同环境使用不同密钥</li>\n<li>定期轮换密钥</li>\n</ul>\n</li>\n<li><strong>Token存储</strong>  ：\n<ul>\n<li>前端使用HttpOnly的Cookie存储更安全</li>\n<li>避免LocalStorage存储敏感Token</li>\n</ul>\n</li>\n<li><strong>传输安全</strong>  ：\n<ul>\n<li>始终使用HTTPS传输Token</li>\n<li>设置Secure和SameSite属性(Cookie场景)</li>\n</ul>\n</li>\n<li><strong>防御措施</strong>  ：\n<ul>\n<li>实现Token黑名单机制</li>\n<li>限制Token使用次数</li>\n<li>监控异常Token使用</li>\n</ul>\n</li>\n<li><strong>性能优化</strong>  ：\n<ul>\n<li>合理设置Token过期时间</li>\n<li>使用无状态验证减轻数据库压力</li>\n<li>对频繁验证的Token进行缓存</li>\n</ul>\n</li>\n</ol>\n<h2>常见问题解决方案</h2>\n<h3>1. 跨域携带Token</h3>\n<pre><code class="language-javascript"><span class="hljs-built_in">exports</span>.<span class="hljs-property">cors</span> = {\n  <span class="hljs-attr">origin</span>: <span class="hljs-function"><span class="hljs-params">ctx</span> =&gt;</span> ctx.<span class="hljs-title function_">get</span>(<span class="hljs-string">&#x27;origin&#x27;</span>),\n  <span class="hljs-attr">credentials</span>: <span class="hljs-literal">true</span>, <span class="hljs-comment">// 允许跨域携带凭证</span>\n  <span class="hljs-attr">allowHeaders</span>: [<span class="hljs-string">&#x27;Authorization&#x27;</span>] <span class="hljs-comment">// 允许Authorization头</span>\n};\n</code></pre>\n<h3>2. Token自动续期</h3>\n<pre><code class="language-javascript"><span class="hljs-comment">// 响应拦截器中检查Token临近过期</span>\napp.<span class="hljs-property">axios</span>.<span class="hljs-property">interceptors</span>.<span class="hljs-property">response</span>.<span class="hljs-title function_">use</span>(<span class="hljs-function"><span class="hljs-params">response</span> =&gt;</span> {\n  <span class="hljs-keyword">const</span> remainingTime = response.<span class="hljs-property">headers</span>[<span class="hljs-string">&#x27;x-token-expires&#x27;</span>];\n  <span class="hljs-keyword">if</span> (remainingTime &amp;&amp; remainingTime &lt; <span class="hljs-number">300</span>) { <span class="hljs-comment">// 5分钟内过期</span>\n    <span class="hljs-title function_">refreshTokenSilently</span>(); <span class="hljs-comment">// 静默刷新Token</span>\n  }\n  <span class="hljs-keyword">return</span> response;\n});\n</code></pre>\n<h3>3. 多端登录识别</h3>\n<pre><code class="language-javascript"><span class="hljs-comment">// 签发Token时加入客户端标识</span>\napp.<span class="hljs-property">jwt</span>.<span class="hljs-title function_">sign</span>({\n  <span class="hljs-attr">userId</span>: user.<span class="hljs-property">id</span>,\n  <span class="hljs-attr">client</span>: ctx.<span class="hljs-title function_">get</span>(<span class="hljs-string">&#x27;User-Agent&#x27;</span>) <span class="hljs-comment">// 或自定义客户端ID</span>\n});\n</code></pre>\n<p>egg-jwt 插件为 Egg.js 应用提供了完整的 JWT 认证解决方案，通过合理配置可以满足各种认证授权场景需求，是构建安全 API 服务的重要工具。</p>\n</div>'</script></body></html>