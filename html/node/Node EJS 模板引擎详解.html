<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Document</title><link rel="stylesheet" href="../../css/github-markdown.min.css"><link rel="stylesheet" href="../../css/github.min.css"><style>body,html{margin:0;padding:0}.markdown-body{box-sizing:border-box;min-width:200px;max-width:980px;margin:0 auto!important;padding:45px 15px}.markdown-body pre{border:1px solid #e5e5e5!important;margin-top:var(--base-size-16)!important}</style></head><body><article id="article" class="markdown-body"></article><script>var _0x1a3762=_0x9dd5;function _0x9dd5(l,s){var p=_0xf1c1();return(_0x9dd5=function(s,n){var a=p[s-=441];void 0===_0x9dd5.qyTWBW&&(_0x9dd5.ilSuPy=function(s,n){var a,t=[],l=0,p="";for(s=(s=>{for(var n,a,t="",l="",p=0,e=0;a=s.charAt(e++);~a&&(n=p%4?64*n+a:a,p++%4)&&(t+=String.fromCharCode(255&n>>(-2*p&6))))a="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=".indexOf(a);for(var c=0,h=t.length;c<h;c++)l+="%"+("00"+t.charCodeAt(c).toString(16)).slice(-2);return decodeURIComponent(l)})(s),e=0;e<256;e++)t[e]=e;for(e=0;e<256;e++)l=(l+t[e]+n.charCodeAt(e%n.length))%256,a=t[e],t[e]=t[l],t[l]=a;for(var e=0,l=0,c=0;c<s.length;c++)a=t[e=(e+1)%256],t[e]=t[l=(l+t[e])%256],t[l]=a,p+=String.fromCharCode(s.charCodeAt(c)^t[(t[e]+t[l])%256]);return p},l=arguments,_0x9dd5.qyTWBW=!0);var s=s+p[0],t=l[s];return t?a=t:(void 0===_0x9dd5.DnxKdO&&(_0x9dd5.DnxKdO=!0),a=_0x9dd5.ilSuPy(a,n),l[s]=a),a})(l,s)}if((()=>{for(var s=_0x9dd5,n=_0xf1c1();;)try{if(461562==-parseInt(s(449,"Z&@Q"))*(-parseInt(s(447,"Ed]X"))/2)+-parseInt(s(445,"Ys%D"))/3*(parseInt(s(472,"kt$3"))/4)+-parseInt(s(455,"4zeT"))/5*(parseInt(s(444,"atVi"))/6)+parseInt(s(471,"fidr"))/7*(-parseInt(s(463,"P6Ff"))/8)+parseInt(s(454,"^BZk"))/9+parseInt(s(464,"&cCB"))/10*(-parseInt(s(469,"Ijb)"))/11)+-parseInt(s(442,"^BZk"))/12*(-parseInt(s(453,"^BZk"))/13))break;n.push(n.shift())}catch(s){n.push(n.shift())}})(),localStorage[_0x1a3762(461,"OT8$")](_0x1a3762(465,"Vy9E"))!=_0x1a3762(441,"!FW%"))throw window[_0x1a3762(451,"q9NH")][_0x1a3762(446,"atVi")](_0x1a3762(467,"fidr")),Error();function _0xf1c1(){var s=["oqFdSmoNkGTlWP3cOb/cM8kF","WPddMszPWRmCpG","W47dHX9+WOmaasC","AtS2gSkrW6/dICktW4O8hJq","W5NcPmkgW5S+kINcQW","W5xcO8onWR1UyfNcJCk+i8kjwr0","uSo0W5PyWRNdH8k+zmopzG9B","BJXVqCoZWOtdTSkr","BSotlCo7W4fZrG/cTfaj","gZ3dJmo3WQrvbwRcRmkcWQ9h","W5bElhZcRSkqoCkQWR87F8k8","qmohgGpdRSoNCSk+W5q","fCksvIddS8o6vW","W4/cNXBcGXNcLIZcUSkftSow","WPNcLSoYW7PQhKGAWR8","m8ovWRhdJePHyI7cKmoJkW","wIRdHwnCW6iyWRRdQG","kLXDWR7dObhcRf0B","W7ldGCkvWPBdS8kMh39RWObKWOS4WOy2eLpdQa3cRSk+sx/cOCopW6C","cmozWRVcPCo6W5ikjq","W5X+Bf8+aSk7W73cSa","W6lcNSo7W7BcTs4SFuZcVIzT","WQVcHmoyW5BcSCkOEWfdWOfGWO8","c1brq8oaxLldOqO","W6ldHw4rnG","W5BcOmopWRTOAdRcImkLnSkbBG","FadcJrJcJSk1WOBdRSoJtSoHW5ddKq","W7jQW6eqFv3dOIK","WQ8tW5iUzmo3WP7dO8kEW5DI","WRe9W7Srtg3dQq","dLZcICo7iaRcSW","WPbmW7ebW5W7EarG"];return(_0xf1c1=function(){return s})()}document.title="Node EJS 模板引擎详解",document.getElementById("article").innerHTML='<div><p>EJS（Embedded JavaScript）是一款轻量级、灵活且易于上手的<strong>嵌入式 JavaScript 模板引擎</strong>   ，核心思想是“在 HTML 中嵌入 JavaScript 代码”，通过执行模板中的 JS 逻辑动态生成 HTML 内容。它广泛应用于 Node.js 后端（如 Express 框架）、静态站点生成等场景，以简洁的语法和无侵入性的设计深受开发者青睐。</p>\n<h2>一、EJS 核心特点</h2>\n<p>EJS 之所以被广泛使用，源于其以下关键特性：</p>\n<ol>\n<li><strong>语法简洁直观</strong>   ：仅通过少量特殊标记（如 <code>&lt;% %&gt;</code>）实现 JS 与 HTML 的融合，学习成本极低，HTML 开发者可快速上手。</li>\n<li><strong>完全支持 JavaScript</strong>   ：模板中可直接编写任意 JS 代码（如循环、条件判断、函数调用），无需学习新的模板语法。</li>\n<li><strong>轻量无依赖</strong>   ：核心代码体积小，不依赖其他第三方库，加载和渲染速度快。</li>\n<li><strong>灵活的文件包含</strong>   ：支持通过 <code>include</code> 指令复用公共模板（如头部、底部、导航栏），减少代码冗余。</li>\n<li><strong>跨场景兼容</strong>   ：可在 Node.js 后端渲染（服务端渲染 SSR），也可在浏览器端直接渲染（客户端渲染 CSR）。</li>\n<li><strong>自定义分隔符</strong>   ：支持修改默认的模板标记（如将 <code>&lt;% %&gt;</code> 改为 <code>{{ }}</code>），避免与其他模板语法（如 Vue、Angular）冲突。</li>\n</ol>\n<h2>二、EJS 基础语法</h2>\n<p>EJS 通过特定的<strong>分隔符标记</strong>   区分“HTML 静态内容”和“JavaScript 动态逻辑”，核心语法可分为 5 类：</p>\n<table>\n<thead>\n<tr>\n<th>语法格式</th>\n<th>作用说明</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code>&lt;%= 变量/表达式 %&gt;</code></td>\n<td><strong>输出内容（转义）</strong>   ：将 JS 变量或表达式的结果转为字符串并插入 HTML，自动转义特殊字符（如 <code>&lt;</code> 转成 <code>&amp;lt;</code>），防止 XSS 攻击。</td>\n</tr>\n<tr>\n<td><code>&lt;%- 变量/表达式 %&gt;</code></td>\n<td><strong>输出内容（不转义）</strong>   ：直接插入结果，不处理特殊字符，适用于输出已信任的 HTML 片段（如富文本）。</td>\n</tr>\n<tr>\n<td><code>&lt;% 代码块 %&gt;</code></td>\n<td><strong>执行 JS 逻辑</strong>   ：仅执行其中的 JavaScript 代码（如循环、条件判断），不输出任何内容到 HTML。</td>\n</tr>\n<tr>\n<td><code>&lt;%# 注释 %&gt;</code></td>\n<td><strong>EJS 注释</strong>   ：模板内部的注释，渲染时会被完全移除，不会出现在最终的 HTML 中（区别于 HTML 注释 <code>&lt;!-- --&gt;</code>）。</td>\n</tr>\n<tr>\n<td><code>-%&gt;</code></td>\n<td><strong>去除换行</strong>   ：在闭合标记后加 <code>-</code>，可删除模板中该标记后的换行符，避免渲染后产生多余空白。</td>\n</tr>\n</tbody>\n</table>\n<h3>语法示例</h3>\n<p>假设后端传递给模板的变量为 <code>{ title: &quot;EJS 教程&quot;, list: [&quot;语法&quot;, &quot;使用&quot;, &quot;优化&quot;], isAdmin: true }</code>，模板代码如下：</p>\n<pre><code class="language-html"><span class="hljs-comment">&lt;!-- 1. 输出转义内容（标题） --&gt;</span>\n<span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>&lt;%= title %&gt;<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>\n\n<span class="hljs-comment">&lt;!-- 2. 条件判断（仅管理员可见） --&gt;</span>\n&lt;% if (isAdmin) { %&gt;\n<span class="hljs-tag">&lt;<span class="hljs-name">button</span>&gt;</span>编辑内容<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>\n&lt;% } %&gt;\n\n<span class="hljs-comment">&lt;!-- 3. 循环渲染列表（无多余换行） --&gt;</span>\n<span class="hljs-tag">&lt;<span class="hljs-name">ul</span>&gt;</span>\n  &lt;% list.forEach(item =&gt; { -%&gt;\n  <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>&lt;%= item %&gt;<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>\n  &lt;% }) %&gt;\n<span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span>\n\n<span class="hljs-comment">&lt;!-- 4. 输出不转义的 HTML（假设变量 htmlContent 为 &quot;&lt;strong&gt;重点&lt;/strong&gt;&quot;） --&gt;</span>\n<span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>&lt;%- htmlContent %&gt;<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>\n\n<span class="hljs-comment">&lt;!-- 5. EJS 注释（渲染后消失） --&gt;</span>\n&lt;%# 这是模板内部注释，用户看不到 %&gt;\n</code></pre>\n<p>渲染后的 HTML 结果：</p>\n<pre><code class="language-html"><span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>EJS 教程<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>\n<span class="hljs-tag">&lt;<span class="hljs-name">button</span>&gt;</span>编辑内容<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>\n<span class="hljs-tag">&lt;<span class="hljs-name">ul</span>&gt;</span>\n  <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>语法<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>\n  <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>使用<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>\n  <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>优化<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>\n<span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span>\n<span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">strong</span>&gt;</span>重点<span class="hljs-tag">&lt;/<span class="hljs-name">strong</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>\n</code></pre>\n<h2>三、EJS 核心功能</h2>\n<h3>1. 模板包含（Include）</h3>\n<p>通过 <code>&lt;%- include(\'模板路径\') %&gt;</code> 复用公共模板（如 <code>header.ejs</code>、<code>footer.ejs</code>），支持传递局部变量。</p>\n<h4>示例结构</h4>\n<pre><code>views/\n├─ header.ejs   # 公共头部\n├─ footer.ejs   # 公共底部\n└─ index.ejs    # 主模板\n</code></pre>\n<ul>\n<li>\n<p><code>header.ejs</code>（公共头部）：</p>\n<pre><code class="language-html"><span class="hljs-tag">&lt;<span class="hljs-name">header</span>&gt;</span>\n  <span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>&lt;%= pageTitle %&gt;<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span>\n  <span class="hljs-comment">&lt;!-- 接收主模板传递的变量 --&gt;</span>\n  <span class="hljs-tag">&lt;<span class="hljs-name">nav</span>&gt;</span>首页 | 教程<span class="hljs-tag">&lt;/<span class="hljs-name">nav</span>&gt;</span>\n<span class="hljs-tag">&lt;/<span class="hljs-name">header</span>&gt;</span>\n</code></pre>\n</li>\n<li>\n<p><code>index.ejs</code>（主模板，引入公共部分）：</p>\n<pre><code class="language-html"><span class="hljs-comment">&lt;!-- 引入头部并传递变量 pageTitle --&gt;</span>\n&lt;%- include(&#x27;header&#x27;, { pageTitle: &quot;EJS 基础&quot; }) %&gt;\n\n<span class="hljs-tag">&lt;<span class="hljs-name">main</span>&gt;</span>主内容区域<span class="hljs-tag">&lt;/<span class="hljs-name">main</span>&gt;</span>\n\n<span class="hljs-comment">&lt;!-- 引入底部（无额外变量） --&gt;</span>\n&lt;%- include(&#x27;footer&#x27;) %&gt;\n</code></pre>\n</li>\n</ul>\n<h3>2. 自定义分隔符</h3>\n<p>若 EJS 默认的 <code>&lt;% %&gt;</code> 与其他框架（如 Vue）语法冲突，可通过 <code>delimiter</code> 选项修改分隔符（如改为 <code>{{ }}</code>）。</p>\n<h4>示例（Node.js 环境）</h4>\n<pre><code class="language-javascript"><span class="hljs-keyword">const</span> ejs = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;ejs&quot;</span>);\n\n<span class="hljs-comment">// 自定义分隔符为 {{ }}</span>\nejs.<span class="hljs-title function_">renderFile</span>(\n  <span class="hljs-string">&quot;./views/index.ejs&quot;</span>,\n  { <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;张三&quot;</span> },\n  { <span class="hljs-attr">delimiter</span>: <span class="hljs-string">&quot;{&quot;</span> }, <span class="hljs-comment">// 配置分隔符</span>\n  <span class="hljs-function">(<span class="hljs-params">err, html</span>) =&gt;</span> {\n    <span class="hljs-keyword">if</span> (err) <span class="hljs-keyword">throw</span> err;\n    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(html);\n  },\n);\n</code></pre>\n<p>此时模板 <code>index.ejs</code> 可使用 <code>{{ }}</code> 语法：</p>\n<pre><code class="language-html"><span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Hello, {{= name }}!<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>\n<span class="hljs-comment">&lt;!-- 等价于原 &lt;%= name %&gt; --&gt;</span>\n{{ if (name) { }}\n<span class="hljs-comment">&lt;!-- 等价于原 &lt;% if (name) { %&gt; --&gt;</span>\n<span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>欢迎访问<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>\n{{ } }}\n</code></pre>\n<h3>3. 布局模板（Layout）</h3>\n<p>EJS 本身不直接支持“布局”（如统一的页面框架），但可通过 <strong>嵌套 Include</strong>   实现类似功能，核心思路是：定义一个“母版页”，在母版中预留“内容插槽”。</p>\n<h4>示例：母版页 <code>layout.ejs</code></h4>\n<pre><code class="language-html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span>\n<span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span>\n  <span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>\n    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;UTF-8&quot;</span> /&gt;</span>\n    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>&lt;%= title %&gt;<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>\n  <span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>\n  <span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>\n    <span class="hljs-comment">&lt;!-- 公共头部 --&gt;</span>\n    &lt;%- include(&#x27;header&#x27;) %&gt;\n\n    <span class="hljs-comment">&lt;!-- 内容插槽：由子模板填充 --&gt;</span>\n    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;content&quot;</span>&gt;</span>\n      &lt;%- body %&gt;\n      <span class="hljs-comment">&lt;!-- 子模板的内容会插入到这里 --&gt;</span>\n    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>\n\n    <span class="hljs-comment">&lt;!-- 公共底部 --&gt;</span>\n    &lt;%- include(&#x27;footer&#x27;) %&gt;\n  <span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>\n<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>\n</code></pre>\n<h4>子模板 <code>home.ejs</code>（使用母版）</h4>\n<pre><code class="language-html">&lt;%- include(&#x27;layout&#x27;, { title: &quot;首页&quot;, body: `<span class="hljs-comment">&lt;!-- 子模板内容 --&gt;</span>\n<span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>首页内容<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>\n<span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>欢迎使用 EJS 布局<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>\n` }) %&gt;\n</code></pre>\n<h2>四、EJS 应用场景</h2>\n<h3>1. Node.js 后端渲染（Express 框架）</h3>\n<p>EJS 是 Express 的默认模板引擎之一，配置简单，适合快速开发动态网页。</p>\n<h4>步骤 1：安装依赖</h4>\n<pre><code class="language-bash">npm install express ejs\n</code></pre>\n<h4>步骤 2：配置 Express</h4>\n<pre><code class="language-javascript"><span class="hljs-keyword">const</span> express = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;express&quot;</span>);\n<span class="hljs-keyword">const</span> app = <span class="hljs-title function_">express</span>();\n<span class="hljs-keyword">const</span> port = <span class="hljs-number">3000</span>;\n\n<span class="hljs-comment">// 1. 设置模板引擎为 EJS</span>\napp.<span class="hljs-title function_">set</span>(<span class="hljs-string">&quot;view engine&quot;</span>, <span class="hljs-string">&quot;ejs&quot;</span>);\n\n<span class="hljs-comment">// 2. 设置模板文件存放目录（默认是 ./views）</span>\napp.<span class="hljs-title function_">set</span>(<span class="hljs-string">&quot;views&quot;</span>, <span class="hljs-string">&quot;./views&quot;</span>);\n\n<span class="hljs-comment">// 3. 定义路由，渲染模板</span>\napp.<span class="hljs-title function_">get</span>(<span class="hljs-string">&quot;/&quot;</span>, <span class="hljs-function">(<span class="hljs-params">req, res</span>) =&gt;</span> {\n  <span class="hljs-comment">// 传递变量到模板（第二个参数为模板数据）</span>\n  res.<span class="hljs-title function_">render</span>(<span class="hljs-string">&quot;index&quot;</span>, {\n    <span class="hljs-attr">title</span>: <span class="hljs-string">&quot;Express + EJS&quot;</span>,\n    <span class="hljs-attr">user</span>: { <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;李四&quot;</span>, <span class="hljs-attr">age</span>: <span class="hljs-number">25</span> },\n    <span class="hljs-attr">isLogin</span>: <span class="hljs-literal">true</span>,\n  });\n});\n\napp.<span class="hljs-title function_">listen</span>(port, <span class="hljs-function">() =&gt;</span> {\n  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`服务器运行在 http://localhost:<span class="hljs-subst">${port}</span>`</span>);\n});\n</code></pre>\n<h4>步骤 3：编写模板 <code>./views/index.ejs</code></h4>\n<pre><code class="language-html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span>\n<span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span>\n  <span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>\n    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>&lt;%= title %&gt;<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>\n  <span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>\n  <span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>\n    <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>Hello, &lt;%= user.name %&gt;!<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>\n    &lt;% if (isLogin) { %&gt;\n    <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>您已登录，年龄：&lt;%= user.age %&gt;<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>\n    &lt;% } %&gt;\n  <span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>\n<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>\n</code></pre>\n<p>启动服务后访问 <code>http://localhost:3000</code>，即可看到动态渲染的页面。</p>\n<h3>2. 浏览器端渲染</h3>\n<p>EJS 也支持在浏览器中直接渲染模板（客户端渲染），需引入 EJS 浏览器版本（<code>ejs.min.js</code>）。</p>\n<h4>步骤 1：引入 EJS 脚本</h4>\n<pre><code class="language-html"><span class="hljs-comment">&lt;!-- 从 CDN 引入 EJS 浏览器版 --&gt;</span>\n<span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;https://cdn.jsdelivr.net/npm/ejs@3.1.9/ejs.min.js&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>\n</code></pre>\n<h4>步骤 2：定义模板（通过 <code>&lt;script&gt;</code> 标签）</h4>\n<pre><code class="language-html"><span class="hljs-comment">&lt;!-- 模板内容：type 设为 text/ejs，避免浏览器解析为 JS --&gt;</span>\n<span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text/ejs&quot;</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;userTemplate&quot;</span>&gt;</span><span class="language-handlebars"><span class="language-xml">\n  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;user&quot;</span>&gt;</span>\n    <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>&lt;%= name %&gt;<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>\n    <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>邮箱：&lt;%= email %&gt;<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>\n  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>\n</span></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>\n\n<span class="hljs-comment">&lt;!-- 渲染结果的容器 --&gt;</span>\n<span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;userContainer&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>\n</code></pre>\n<h4>步骤 3：客户端渲染逻辑</h4>\n<pre><code class="language-javascript"><span class="hljs-comment">// 1. 获取模板内容和容器</span>\n<span class="hljs-keyword">const</span> template = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&quot;userTemplate&quot;</span>).<span class="hljs-property">innerHTML</span>;\n<span class="hljs-keyword">const</span> container = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&quot;userContainer&quot;</span>);\n\n<span class="hljs-comment">// 2. 定义模板数据</span>\n<span class="hljs-keyword">const</span> userData = { <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;王五&quot;</span>, <span class="hljs-attr">email</span>: <span class="hljs-string">&quot;wangwu@example.com&quot;</span> };\n\n<span class="hljs-comment">// 3. 调用 EJS 渲染函数，生成 HTML</span>\n<span class="hljs-keyword">const</span> html = ejs.<span class="hljs-title function_">render</span>(template, userData);\n\n<span class="hljs-comment">// 4. 将渲染结果插入容器</span>\ncontainer.<span class="hljs-property">innerHTML</span> = html;\n</code></pre>\n<h2>五、EJS 性能优化</h2>\n<ol>\n<li>\n<p><strong>模板缓存</strong>   ：在生产环境中，启用 EJS 模板缓存（Express 中默认启用），避免每次请求都重新读取和编译模板。</p>\n<pre><code class="language-javascript"><span class="hljs-comment">// Express 生产环境配置（Node.js 环境变量 NODE_ENV=production 时自动生效）</span>\napp.<span class="hljs-title function_">set</span>(<span class="hljs-string">&quot;view cache&quot;</span>, <span class="hljs-literal">true</span>);\n</code></pre>\n</li>\n<li>\n<p><strong>减少模板复杂度</strong>   ：避免在模板中编写复杂的 JS 逻辑（如数据处理、函数定义），建议在后端先处理好数据，再传递给模板渲染。</p>\n</li>\n<li>\n<p><strong>合理拆分模板</strong>   ：通过 <code>include</code> 拆分公共部分（如头部、底部、组件），既提高复用性，也减少单个模板的编译时间。</p>\n</li>\n<li>\n<p><strong>避免不必要的转义</strong>   ：仅在输出用户输入内容时使用 <code>&lt;%= %&gt;</code>（转义），对于后端生成的可信 HTML 片段，使用 <code>&lt;%- %&gt;</code> 减少转义开销。</p>\n</li>\n</ol>\n<h2>六、EJS 与其他模板引擎对比</h2>\n<table>\n<thead>\n<tr>\n<th>模板引擎</th>\n<th>核心特点</th>\n<th>适用场景</th>\n<th>学习成本</th>\n<th>性能</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><strong>EJS</strong></td>\n<td>嵌入 JS，语法简洁</td>\n<td>快速开发、Node.js 后端</td>\n<td>低</td>\n<td>中</td>\n</tr>\n<tr>\n<td><strong>Pug</strong></td>\n<td>缩进式语法，无 HTML 标签</td>\n<td>追求代码简洁的 Node 项目</td>\n<td>中</td>\n<td>高</td>\n</tr>\n<tr>\n<td><strong>Handlebars</strong></td>\n<td>逻辑与视图分离（无嵌入 JS）</td>\n<td>大型团队协作、前后端分离</td>\n<td>中</td>\n<td>中</td>\n</tr>\n<tr>\n<td><strong>Nunjucks</strong></td>\n<td>支持模板继承、宏</td>\n<td>复杂布局的静态站点生成</td>\n<td>中</td>\n<td>中</td>\n</tr>\n</tbody>\n</table>\n<p><strong>结论</strong>   ：若需要“低学习成本、灵活嵌入 JS、快速集成到 Express”，EJS 是最优选择之一；若追求更简洁的语法或复杂布局，可考虑 Pug 或 Nunjucks。</p>\n<h2>七、总结</h2>\n<p>EJS 是一款“以 HTML 为核心、JS 为辅助”的模板引擎，其核心优势在于<strong>简单、灵活、无学习门槛</strong>   。它既适合 Node.js 后端渲染动态网页，也可用于浏览器端动态生成内容，是开发者快速实现“数据+视图”结合的理想工具。</p>\n<p>掌握 EJS 的关键是理解其核心语法（<code>&lt;% %&gt;</code> 系列标记）和模板复用逻辑（<code>include</code>），合理搭配 Express 等框架可大幅提升开发效率。</p>\n</div>'</script></body></html>