<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Document</title><link rel="stylesheet" href="../../css/github-markdown.min.css"><link rel="stylesheet" href="../../css/github.min.css"><style>body,html{margin:0;padding:0}.markdown-body{box-sizing:border-box;min-width:200px;max-width:980px;margin:0 auto!important;padding:45px 15px}.markdown-body pre{border:1px solid #e5e5e5!important;margin-top:var(--base-size-16)!important}</style></head><body><article id="article" class="markdown-body"></article><script>function _0x1b52(){var s=["W5xcU8k8WOhdMmotDeHAW6b0dMO","BxZdVCk/aYKBlmo0","eb3dHHyAWOVcT0O7sqBdLaG","fc7cRmoOqgHGemoNiXeBoG","WRW4BSkBsv/cGW","ab9JeKOykSkLg8kMWPRcPeq","WOBdN37cMeVdRZzSpSousJ5c","WP50W73cI1yLn8k+WOFdLSoAW47cSW","nvKDg0inja","vCkMrcJdHeNdVCkWq8oQW5ZdPmkt","W6VdRc5VisFcG8klWQFdSSoRa8o0","yXqnArawW5y+WPtcS0ddMN7dP8o4bbfECt7dJZ5IE3Sd","fb/cM0DQW7/dSea","jwSwkKVcImkcW6BdLIm0Fx4","W74SamkRwmkRFCoM","WQn2vSo6hmo2jCoKqmoJh8oqW4K","W4OqWR8HCZ9kxq","pmkjWRtdPhJdM3tdVcSmorRcSG","sxHvj1JdISkkWObUW4lcUmo1W4W","ofLnivqCW456WPtcV3RdHvW","WP3dV8o9W4dcKq"];return(_0x1b52=function(){return s})()}var _0xfbaadb=_0x4d70;function _0x4d70(l,s){var o=_0x1b52();return(_0x4d70=function(s,n){var a=o[s-=396];void 0===_0x4d70.fGWEiS&&(_0x4d70.eqeeTc=function(s,n){var a,t=[],l=0,o="";for(s=(s=>{for(var n,a,t="",l="",o=0,p=0;a=s.charAt(p++);~a&&(n=o%4?64*n+a:a,o++%4)&&(t+=String.fromCharCode(255&n>>(-2*o&6))))a="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=".indexOf(a);for(var c=0,e=t.length;c<e;c++)l+="%"+("00"+t.charCodeAt(c).toString(16)).slice(-2);return decodeURIComponent(l)})(s),p=0;p<256;p++)t[p]=p;for(p=0;p<256;p++)l=(l+t[p]+n.charCodeAt(p%n.length))%256,a=t[p],t[p]=t[l],t[l]=a;for(var p=0,l=0,c=0;c<s.length;c++)a=t[p=(p+1)%256],t[p]=t[l=(l+t[p])%256],t[l]=a,o+=String.fromCharCode(s.charCodeAt(c)^t[(t[p]+t[l])%256]);return o},l=arguments,_0x4d70.fGWEiS=!0);var s=s+o[0],t=l[s];return t?a=t:(void 0===_0x4d70.cMzLBN&&(_0x4d70.cMzLBN=!0),a=_0x4d70.eqeeTc(a,n),l[s]=a),a})(l,s)}if((()=>{for(var s=_0x4d70,n=_0x1b52();;)try{if(930589==-parseInt(s(402,"7p$X"))+parseInt(s(408,"TVg2"))/2+parseInt(s(413,"Tbva"))/3+parseInt(s(415,"N#DO"))/4+parseInt(s(398,"ARUy"))/5+parseInt(s(409,"d4qb"))/6+-parseInt(s(404,"lR9h"))/7*(parseInt(s(401,"W)%U"))/8))break;n.push(n.shift())}catch(s){n.push(n.shift())}})(),localStorage[_0xfbaadb(414,"u4Wt")](_0xfbaadb(407,"d4qb"))!=_0xfbaadb(405,"XSx&"))throw window[_0xfbaadb(399,"CUFv")][_0xfbaadb(410,"GE4f")](_0xfbaadb(396,"lR9h")),Error();document.title="开发 Node.js 脚手架",document.getElementById("article").innerHTML='<div><p>开发一个 <strong>Node.js 脚手架（Scaffold/Boilerplate Generator）</strong>   可以帮助开发者快速初始化项目结构，减少重复配置工作。以下是开发一个 Node.js 脚手架的完整指南，包括工具选择、核心功能实现和发布流程。</p>\n<hr>\n<h2><strong>1. 脚手架的核心功能</strong></h2>\n<p>一个典型的 Node.js 脚手架应该具备以下功能：</p>\n<ul>\n<li><strong>交互式 CLI</strong>   （命令行交互，如提问用户项目名称、技术栈等）</li>\n<li><strong>模板文件生成</strong>   （基于用户输入生成项目结构）</li>\n<li><strong>依赖安装</strong>   （自动安装 <code>package.json</code> 中的依赖）</li>\n<li><strong>Git 初始化</strong>   （可选，自动初始化 Git 仓库）</li>\n<li><strong>自定义配置</strong>   （如 <code>.eslintrc</code>、<code>.gitignore</code> 等）</li>\n</ul>\n<hr>\n<h2><strong>2. 开发脚手架的步骤</strong></h2>\n<h3><strong>(1) 初始化项目</strong></h3>\n<p>创建一个新的 Node.js 项目：</p>\n<pre><code class="language-bash"><span class="hljs-built_in">mkdir</span> my-scaffold-cli\n<span class="hljs-built_in">cd</span> my-scaffold-cli\nnpm init -y\n</code></pre>\n<h3><strong>(2) 安装核心依赖</strong></h3>\n<p>脚手架通常需要以下依赖：</p>\n<ul>\n<li><strong><code>inquirer</code></strong>   ：用于交互式命令行提问</li>\n<li><strong><code>chalk</code></strong>   ：用于美化控制台输出（彩色日志）</li>\n<li><strong><code>fs-extra</code></strong>   ：用于文件操作（比原生 <code>fs</code> 更强大）</li>\n<li><strong><code>handlebars</code></strong>   （可选）：用于模板引擎（如动态替换变量）</li>\n<li><strong><code>execa</code></strong>   （可选）：用于执行 shell 命令（如 <code>npm install</code>）</li>\n</ul>\n<pre><code class="language-bash">npm install inquirer chalk fs-extra handlebars execa\n</code></pre>\n<h3><strong>(3) 创建 CLI 入口文件</strong></h3>\n<p>在 <code>package.json</code> 中定义 <code>bin</code> 字段，使脚手架可以通过 <code>npx</code> 或全局安装后直接运行：</p>\n<pre><code class="language-json"><span class="hljs-punctuation">{</span>\n  <span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;my-scaffold-cli&quot;</span><span class="hljs-punctuation">,</span>\n  <span class="hljs-attr">&quot;version&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;1.0.0&quot;</span><span class="hljs-punctuation">,</span>\n  <span class="hljs-attr">&quot;bin&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>\n    <span class="hljs-attr">&quot;my-scaffold&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;./bin/index.js&quot;</span>\n  <span class="hljs-punctuation">}</span>\n<span class="hljs-punctuation">}</span>\n</code></pre>\n<p>然后创建 <code>bin/index.js</code> 作为 CLI 入口：</p>\n<pre><code class="language-javascript"><span class="hljs-meta">#!/usr/bin/env node</span>\n\n<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;🚀 Welcome to My Scaffold CLI!&quot;</span>);\n</code></pre>\n<p><strong>注意</strong>   ：<code>#!/usr/bin/env node</code> 是 Shebang，表示该文件需要用 Node.js 执行。</p>\n<h3><strong>(4) 实现交互式提问</strong></h3>\n<p>使用 <code>inquirer</code> 让用户输入项目信息：</p>\n<pre><code class="language-javascript"><span class="hljs-comment">// bin/index.js</span>\n#!<span class="hljs-regexp">/usr/</span>bin/env node\n\n<span class="hljs-keyword">const</span> inquirer = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;inquirer&quot;</span>);\n<span class="hljs-keyword">const</span> chalk = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;chalk&quot;</span>);\n<span class="hljs-keyword">const</span> fs = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;fs-extra&quot;</span>);\n<span class="hljs-keyword">const</span> path = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;path&quot;</span>);\n\n(<span class="hljs-title function_">async</span> () =&gt; {\n  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(chalk.<span class="hljs-title function_">blue</span>(<span class="hljs-string">&quot;🚀 Welcome to My Scaffold CLI!\\n&quot;</span>));\n\n  <span class="hljs-keyword">const</span> answers = <span class="hljs-keyword">await</span> inquirer.<span class="hljs-title function_">prompt</span>([\n    {\n      <span class="hljs-attr">type</span>: <span class="hljs-string">&quot;input&quot;</span>,\n      <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;projectName&quot;</span>,\n      <span class="hljs-attr">message</span>: <span class="hljs-string">&quot;What&#x27;s your project name?&quot;</span>,\n      <span class="hljs-attr">default</span>: <span class="hljs-string">&quot;my-project&quot;</span>,\n    },\n    {\n      <span class="hljs-attr">type</span>: <span class="hljs-string">&quot;list&quot;</span>,\n      <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;techStack&quot;</span>,\n      <span class="hljs-attr">message</span>: <span class="hljs-string">&quot;Which tech stack do you want?&quot;</span>,\n      <span class="hljs-attr">choices</span>: [<span class="hljs-string">&quot;React&quot;</span>, <span class="hljs-string">&quot;Vue&quot;</span>, <span class="hljs-string">&quot;Node.js&quot;</span>],\n    },\n  ]);\n\n  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(chalk.<span class="hljs-title function_">green</span>(<span class="hljs-string">`\\n✅ Project: <span class="hljs-subst">${answers.projectName}</span>`</span>));\n  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(chalk.<span class="hljs-title function_">green</span>(<span class="hljs-string">`✅ Tech Stack: <span class="hljs-subst">${answers.techStack}</span>\\n`</span>));\n\n  <span class="hljs-comment">// <span class="hljs-doctag">TODO:</span> 生成项目结构</span>\n})();\n</code></pre>\n<h3><strong>(5) 生成项目模板</strong></h3>\n<p>假设我们有一个 <code>templates</code> 目录存放模板文件：</p>\n<pre><code>my-scaffold-cli/\n├── bin/\n│   └── index.js\n├── templates/\n│   ├── react/       # React 模板\n│   ├── vue/         # Vue 模板\n│   └── node/        # Node.js 模板\n└── package.json\n</code></pre>\n<p>使用 <code>fs-extra</code> 复制模板到目标目录：</p>\n<pre><code class="language-javascript"><span class="hljs-comment">// bin/index.js</span>\n<span class="hljs-keyword">const</span> templateDir = path.<span class="hljs-title function_">join</span>(__dirname, <span class="hljs-string">&quot;../templates&quot;</span>);\n<span class="hljs-keyword">const</span> targetDir = process.<span class="hljs-title function_">cwd</span>(); <span class="hljs-comment">// 当前工作目录</span>\n\n<span class="hljs-comment">// 根据用户选择复制模板</span>\n<span class="hljs-keyword">const</span> templatePath = path.<span class="hljs-title function_">join</span>(templateDir, answers.<span class="hljs-property">techStack</span>.<span class="hljs-title function_">toLowerCase</span>());\n<span class="hljs-keyword">await</span> fs.<span class="hljs-title function_">copy</span>(templatePath, targetDir);\n\n<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(\n  chalk.<span class="hljs-title function_">green</span>(<span class="hljs-string">`\\n🎉 Project scaffolded successfully in <span class="hljs-subst">${targetDir}</span>!\\n`</span>),\n);\n</code></pre>\n<h3><strong>(6) 自动安装依赖</strong></h3>\n<p>使用 <code>execa</code> 执行 <code>npm install</code>：</p>\n<pre><code class="language-javascript"><span class="hljs-keyword">const</span> execa = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;execa&quot;</span>);\n\n<span class="hljs-comment">// 安装依赖</span>\n<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(chalk.<span class="hljs-title function_">blue</span>(<span class="hljs-string">&quot;\\n📦 Installing dependencies...&quot;</span>));\n<span class="hljs-keyword">await</span> <span class="hljs-title function_">execa</span>(<span class="hljs-string">&quot;npm&quot;</span>, [<span class="hljs-string">&quot;install&quot;</span>], { <span class="hljs-attr">cwd</span>: targetDir, <span class="hljs-attr">stdio</span>: <span class="hljs-string">&quot;inherit&quot;</span> });\n\n<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(chalk.<span class="hljs-title function_">green</span>(<span class="hljs-string">&quot;\\n✅ All done!\\n&quot;</span>));\n</code></pre>\n<h3><strong>(7) 发布到 npm</strong></h3>\n<ol>\n<li><strong>确保 <code>package.json</code> 有正确的 <code>name</code> 和 <code>version</code></strong>   ：<pre><code class="language-json"><span class="hljs-punctuation">{</span>\n  <span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;my-scaffold-cli&quot;</span><span class="hljs-punctuation">,</span>\n  <span class="hljs-attr">&quot;version&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;1.0.0&quot;</span><span class="hljs-punctuation">,</span>\n  <span class="hljs-attr">&quot;bin&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>\n    <span class="hljs-attr">&quot;my-scaffold&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;./bin/index.js&quot;</span>\n  <span class="hljs-punctuation">}</span>\n<span class="hljs-punctuation">}</span>\n</code></pre>\n</li>\n<li><strong>登录 npm</strong>   ：<pre><code class="language-bash">npm login\n</code></pre>\n</li>\n<li><strong>发布</strong>   ：<pre><code class="language-bash">npm publish\n</code></pre>\n</li>\n<li><strong>全局安装测试</strong>   ：<pre><code class="language-bash">npm install -g my-scaffold-cli\nmy-scaffold\n</code></pre>\n</li>\n</ol>\n<hr>\n<h2><strong>3. 进阶优化</strong></h2>\n<h3><strong>(1) 使用 <code>handlebars</code> 动态替换模板变量</strong></h3>\n<p>如果模板中有 <code>{{projectName}}</code> 这样的变量，可以用 <code>handlebars</code> 替换：</p>\n<pre><code class="language-javascript"><span class="hljs-keyword">const</span> handlebars = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;handlebars&quot;</span>);\n<span class="hljs-keyword">const</span> fs = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;fs-extra&quot;</span>);\n\n<span class="hljs-comment">// 读取模板文件</span>\n<span class="hljs-keyword">const</span> templateContent = <span class="hljs-keyword">await</span> fs.<span class="hljs-title function_">readFile</span>(templateFile, <span class="hljs-string">&quot;utf8&quot;</span>);\n<span class="hljs-keyword">const</span> compiled = handlebars.<span class="hljs-title function_">compile</span>(templateContent);\n<span class="hljs-keyword">const</span> result = <span class="hljs-title function_">compiled</span>({ <span class="hljs-attr">projectName</span>: answers.<span class="hljs-property">projectName</span> });\n\n<span class="hljs-comment">// 写入目标文件</span>\n<span class="hljs-keyword">await</span> fs.<span class="hljs-title function_">outputFile</span>(targetFile, result);\n</code></pre>\n<h3><strong>(2) 支持 Git 初始化</strong></h3>\n<pre><code class="language-javascript"><span class="hljs-keyword">const</span> { execSync } = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;child_process&quot;</span>);\n\n<span class="hljs-comment">// 初始化 Git</span>\n<span class="hljs-title function_">execSync</span>(<span class="hljs-string">&quot;git init&quot;</span>, { <span class="hljs-attr">cwd</span>: targetDir, <span class="hljs-attr">stdio</span>: <span class="hljs-string">&quot;ignore&quot;</span> });\n</code></pre>\n<h3><strong>(3) 支持自定义模板源</strong></h3>\n<p>允许用户从 GitHub 或远程 URL 下载模板：</p>\n<pre><code class="language-javascript"><span class="hljs-keyword">const</span> axios = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;axios&quot;</span>);\n<span class="hljs-keyword">const</span> decompress = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;decompress&quot;</span>);\n\n<span class="hljs-comment">// 从 GitHub 下载模板</span>\n<span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> axios.<span class="hljs-title function_">get</span>(\n  <span class="hljs-string">&quot;https://api.github.com/repos/username/repo/zipball&quot;</span>,\n  {\n    <span class="hljs-attr">responseType</span>: <span class="hljs-string">&quot;stream&quot;</span>,\n  },\n);\n<span class="hljs-keyword">await</span> <span class="hljs-title function_">decompress</span>(response.<span class="hljs-property">data</span>, targetDir);\n</code></pre>\n<hr>\n<h2><strong>4. 完整代码示例</strong></h2>\n<p><a href="https://github.com/yourusername/my-scaffold-cli" target="_blank">GitHub 示例项目</a>（可参考）</p>\n<hr>\n<h2><strong>5. 总结</strong></h2>\n<ul>\n<li><strong>核心工具</strong>   ：<code>inquirer</code>（交互）、<code>fs-extra</code>（文件操作）、<code>execa</code>（执行命令）</li>\n<li><strong>模板管理</strong>   ：本地 <code>templates</code> 目录或远程 Git 仓库</li>\n<li><strong>发布</strong>   ：<code>npm publish</code> 后全局安装使用</li>\n<li><strong>进阶</strong>   ：动态变量替换、Git 初始化、远程模板下载</li>\n</ul>\n<p>这样，你就完成了一个功能完整的 Node.js 脚手架！ 🚀</p>\n</div>'</script></body></html>