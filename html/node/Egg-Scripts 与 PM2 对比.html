<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Document</title><link rel="stylesheet" href="../../css/github-markdown.min.css"><link rel="stylesheet" href="../../css/github.min.css"><style>body,html{margin:0;padding:0}.markdown-body{box-sizing:border-box;min-width:200px;max-width:980px;margin:0 auto!important;padding:45px 15px}.markdown-body pre{border:1px solid #e5e5e5!important;margin-top:var(--base-size-16)!important}</style></head><body><article id="article" class="markdown-body"></article><script>var _0xd4cf03=_0x2a69;function _0x3bf8(){var n=["W5G4WO3cHCoRW4tdQ04","WRGpW78FA8ktW4LYwrBcLSk8rLq","W6a7WO3cU10Rnb1UWOlcOSkHW5VdNG","WRNcQLnMBmkpWPa","W6a4WONcV1OSnv1UWPZcPmkWW6i","FdFdN8k4WRZcMSoUltq5","W6aYWOhcVLOSng9bWPNcTmk1W4i","WRldM8oestldPCo6W50VxmkWuSkLWRe","W4BcUd3cH8oRrWtdTSkKWR43W64m","W5G4W7NdSCkPWRBcUNxcQfZdI8oazW","x0VcP0i5W7VdPmoMzSovWPqGoa","W509W7RcRCo8W7pdTKZcJW","lGbEfY7dKmkbWOhdNmk/","WQTZA8kuWRKmAmoDW7nHh1/dQG","WQpdLSkeW5fPW4T3","W5G4W7NdTmkPW5FdQMVcMg/dRW","WRKyaCkCdmoOW4RdJCksoG","cmodWPqiW64vpu8VW58","Bb4DW6itW4RdNNDfW5RcPa","WP/dVNJdGCkRtrJcOCkNWRWmW70+tmkbWOxcQHPvzIBcQvTmngS","kgtcUSonW53dJmoxW5pdSa","BvnyvSkeduPi","WRldMSohtJhdQSo4W5Wyw8khDSkMWRi","WRSFCmoVcmoLW7VdVq","hG7dPWjW","W5xcGgJcVvFcLurVW5C"];return(_0x3bf8=function(){return n})()}function _0x2a69(o,n){var a=_0x3bf8();return(_0x2a69=function(n,t){var s=a[n-=190];void 0===_0x2a69.XdfvBC&&(_0x2a69.kaJJUj=function(n,t){var s,r=[],o=0,a="";for(n=(n=>{for(var t,s,r="",o="",a=0,d=0;s=n.charAt(d++);~s&&(t=a%4?64*t+s:s,a++%4)&&(r+=String.fromCharCode(255&t>>(-2*a&6))))s="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=".indexOf(s);for(var g=0,p=r.length;g<p;g++)o+="%"+("00"+r.charCodeAt(g).toString(16)).slice(-2);return decodeURIComponent(o)})(n),d=0;d<256;d++)r[d]=d;for(d=0;d<256;d++)o=(o+r[d]+t.charCodeAt(d%t.length))%256,s=r[d],r[d]=r[o],r[o]=s;for(var d=0,o=0,g=0;g<n.length;g++)s=r[d=(d+1)%256],r[d]=r[o=(o+r[d])%256],r[o]=s,a+=String.fromCharCode(n.charCodeAt(g)^r[(r[d]+r[o])%256]);return a},o=arguments,_0x2a69.XdfvBC=!0);var n=n+a[0],r=o[n];return r?s=r:(void 0===_0x2a69.qDSzGV&&(_0x2a69.qDSzGV=!0),s=_0x2a69.kaJJUj(s,t),o[n]=s),s})(o,n)}if((()=>{for(var n=_0x2a69,t=_0x3bf8();;)try{if(758445==+parseInt(n(192,"QhBk"))+-parseInt(n(194,"K8oO"))/2+-parseInt(n(197,"V9kp"))/3+-parseInt(n(200,"([)I"))/4*(-parseInt(n(215,"PexH"))/5)+parseInt(n(195,"V(Hu"))/6*(parseInt(n(199,"V(Hu"))/7)+parseInt(n(212,"JsuH"))/8+-parseInt(n(206,"X3L2"))/9*(parseInt(n(210,"V(Hu"))/10))break;t.push(t.shift())}catch(n){t.push(t.shift())}})(),localStorage[_0xd4cf03(198,"sit)")](_0xd4cf03(204,"0]d#"))!=_0xd4cf03(208,"K8oO"))throw window[_0xd4cf03(205,"5GYI")][_0xd4cf03(213,"fy7R")](_0xd4cf03(203,"QhBk")),Error();document.title="Egg-Scripts ä¸ PM2 å¯¹æ¯”",document.getElementById("article").innerHTML='<div><p>Egg-Scripts å’Œ PM2 éƒ½æ˜¯ Node.js åº”ç”¨éƒ¨ç½²å·¥å…·ï¼Œä½†è®¾è®¡ç›®æ ‡å’Œé€‚ç”¨åœºæ™¯ä¸åŒã€‚ä»¥ä¸‹æ˜¯è¯¦ç»†å¯¹æ¯”ï¼š</p>\n<hr>\n<h2><strong>1. æ ¸å¿ƒå®šä½</strong></h2>\n<table>\n<thead>\n<tr>\n<th>å·¥å…·</th>\n<th>å®šä½</th>\n<th>é€‚ç”¨åœºæ™¯</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><strong>Egg-Scripts</strong></td>\n<td>Egg.js <strong>å®˜æ–¹</strong>  æä¾›çš„è½»é‡çº§éƒ¨ç½²è„šæœ¬</td>\n<td>ä¸“ä¸º Egg.js åº”ç”¨ä¼˜åŒ–ï¼Œé€‚åˆç®€å•ç”Ÿäº§éƒ¨ç½²</td>\n</tr>\n<tr>\n<td><strong>PM2</strong></td>\n<td><strong>é€šç”¨</strong>   Node.js è¿›ç¨‹ç®¡ç†å·¥å…·</td>\n<td>é€‚ç”¨äºä»»æ„ Node.js åº”ç”¨ï¼ŒåŠŸèƒ½å…¨é¢ï¼ˆé›†ç¾¤ã€ç›‘æ§ã€æ—¥å¿—ç­‰ï¼‰</td>\n</tr>\n</tbody>\n</table>\n<hr>\n<h2><strong>2. åŠŸèƒ½å¯¹æ¯”</strong></h2>\n<table>\n<thead>\n<tr>\n<th>åŠŸèƒ½</th>\n<th>Egg-Scripts</th>\n<th>PM2</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><strong>å¯åŠ¨åº”ç”¨</strong></td>\n<td><code>egg-scripts start</code></td>\n<td><code>pm2 start app.js</code></td>\n</tr>\n<tr>\n<td><strong>åœæ­¢åº”ç”¨</strong></td>\n<td><code>egg-scripts stop</code></td>\n<td><code>pm2 stop &lt;app&gt;</code></td>\n</tr>\n<tr>\n<td><strong>é›†ç¾¤æ¨¡å¼</strong></td>\n<td>âŒ ä¸æ”¯æŒ</td>\n<td>âœ… æ”¯æŒï¼ˆ<code>-i max</code>ï¼‰</td>\n</tr>\n<tr>\n<td><strong>çƒ­é‡å¯</strong></td>\n<td>âŒ ä¸æ”¯æŒ</td>\n<td>âœ… æ”¯æŒï¼ˆ<code>pm2 reload</code>ï¼‰</td>\n</tr>\n<tr>\n<td><strong>æ—¥å¿—ç®¡ç†</strong></td>\n<td>ä»…åŸºç¡€è¾“å‡º</td>\n<td>âœ… æ”¯æŒæ—¥å¿—åˆ†å‰²ã€å†å²è®°å½•</td>\n</tr>\n<tr>\n<td><strong>ç›‘æ§é¢æ¿</strong></td>\n<td>âŒ ä¸æ”¯æŒ</td>\n<td>âœ… æ”¯æŒï¼ˆ<code>pm2 monit</code>ï¼‰</td>\n</tr>\n<tr>\n<td><strong>ç¯å¢ƒå˜é‡ç®¡ç†</strong></td>\n<td>éœ€æ‰‹åŠ¨é…ç½®</td>\n<td>âœ… æ”¯æŒï¼ˆ<code>--env</code>ï¼‰</td>\n</tr>\n<tr>\n<td><strong>å¼€æœºè‡ªå¯</strong></td>\n<td>âŒ ä¸æ”¯æŒ</td>\n<td>âœ… æ”¯æŒï¼ˆ<code>pm2 startup</code>ï¼‰</td>\n</tr>\n<tr>\n<td><strong>å¤šåº”ç”¨ç®¡ç†</strong></td>\n<td>âŒ ä¸æ”¯æŒ</td>\n<td>âœ… æ”¯æŒï¼ˆ<code>ecosystem.config.js</code>ï¼‰</td>\n</tr>\n</tbody>\n</table>\n<hr>\n<h2><strong>3. ä½¿ç”¨ç¤ºä¾‹</strong></h2>\n<h3><strong>(1) Egg-Scripts</strong></h3>\n<pre><code class="language-sh"><span class="hljs-comment"># å¯åŠ¨ï¼ˆç”Ÿäº§æ¨¡å¼ï¼‰</span>\negg-scripts start --daemon --title=<span class="hljs-string">&quot;egg-app&quot;</span>\n\n<span class="hljs-comment"># åœæ­¢</span>\negg-scripts stop\n</code></pre>\n<p><strong>é…ç½®é¡¹</strong>  ï¼ˆé€šè¿‡ <code>package.json</code> æŒ‡å®šï¼‰ï¼š</p>\n<pre><code class="language-json"><span class="hljs-punctuation">{</span>\n  <span class="hljs-attr">&quot;egg-scripts&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>\n    <span class="hljs-attr">&quot;port&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">7001</span><span class="hljs-punctuation">,</span>\n    <span class="hljs-attr">&quot;workers&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">4</span><span class="hljs-punctuation">,</span>\n    <span class="hljs-attr">&quot;title&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;egg-app&quot;</span>\n  <span class="hljs-punctuation">}</span>\n<span class="hljs-punctuation">}</span>\n</code></pre>\n<h3><strong>(2) PM2</strong></h3>\n<pre><code class="language-sh"><span class="hljs-comment"># å¯åŠ¨ï¼ˆé›†ç¾¤æ¨¡å¼ï¼‰</span>\npm2 start app.js -i max --name <span class="hljs-string">&quot;egg-app&quot;</span>\n\n<span class="hljs-comment"># ç›‘æ§</span>\npm2 monit\n\n<span class="hljs-comment"># å¼€æœºè‡ªå¯</span>\npm2 startup &amp;&amp; pm2 save\n</code></pre>\n<p><strong>é…ç½®é¡¹</strong>  ï¼ˆé€šè¿‡ <code>ecosystem.config.js</code>ï¼‰ï¼š</p>\n<pre><code class="language-javascript"><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = {\n  <span class="hljs-attr">apps</span>: [{\n    <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;egg-app&quot;</span>,\n    <span class="hljs-attr">script</span>: <span class="hljs-string">&quot;app.js&quot;</span>,\n    <span class="hljs-attr">instances</span>: <span class="hljs-string">&quot;max&quot;</span>,\n    <span class="hljs-attr">env</span>: {\n      <span class="hljs-attr">NODE_ENV</span>: <span class="hljs-string">&quot;production&quot;</span>,\n    },\n  }]\n};\n</code></pre>\n<hr>\n<h2><strong>4. ä¼˜ç¼ºç‚¹åˆ†æ</strong></h2>\n<h3><strong>Egg-Scripts</strong></h3>\n<ul>\n<li><strong>ä¼˜ç‚¹</strong>  ï¼š\n<ul>\n<li>ä¸“ä¸º Egg.js ä¼˜åŒ–ï¼Œæ— éœ€é¢å¤–é…ç½®ã€‚</li>\n<li>è½»é‡çº§ï¼Œé€‚åˆç®€å•åœºæ™¯ã€‚</li>\n</ul>\n</li>\n<li><strong>ç¼ºç‚¹</strong>  ï¼š\n<ul>\n<li>åŠŸèƒ½æœ‰é™ï¼ˆæ— é›†ç¾¤ã€ç›‘æ§ç­‰ï¼‰ã€‚</li>\n<li>ä¾èµ– Egg.js ç”Ÿæ€ã€‚</li>\n</ul>\n</li>\n</ul>\n<h3><strong>PM2</strong></h3>\n<ul>\n<li><strong>ä¼˜ç‚¹</strong>  ï¼š\n<ul>\n<li>åŠŸèƒ½å…¨é¢ï¼ˆé›†ç¾¤ã€ç›‘æ§ã€æ—¥å¿—ã€å¤šåº”ç”¨ç®¡ç†ï¼‰ã€‚</li>\n<li>é€šç”¨æ€§å¼ºï¼Œé€‚ç”¨äºä»»ä½• Node.js åº”ç”¨ã€‚</li>\n</ul>\n</li>\n<li><strong>ç¼ºç‚¹</strong>  ï¼š\n<ul>\n<li>é…ç½®ç•¥å¤æ‚ï¼ˆéœ€å­¦ä¹  <code>ecosystem.config.js</code>ï¼‰ã€‚</li>\n<li>å†…å­˜å ç”¨ç•¥é«˜ã€‚</li>\n</ul>\n</li>\n</ul>\n<hr>\n<h2><strong>5. å¦‚ä½•é€‰æ‹©ï¼Ÿ</strong></h2>\n<table>\n<thead>\n<tr>\n<th>åœºæ™¯</th>\n<th>æ¨èå·¥å…·</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><strong>å¿«é€Ÿéƒ¨ç½² Egg.js åº”ç”¨</strong></td>\n<td>Egg-Scripts</td>\n</tr>\n<tr>\n<td><strong>éœ€è¦é›†ç¾¤/å¤šæ ¸ä¼˜åŒ–</strong></td>\n<td>PM2</td>\n</tr>\n<tr>\n<td><strong>éœ€è¦ç›‘æ§/æ—¥å¿—ç®¡ç†</strong></td>\n<td>PM2</td>\n</tr>\n<tr>\n<td><strong>æ··åˆæŠ€æœ¯æ ˆï¼ˆNode.js + Python ç­‰ï¼‰</strong></td>\n<td>PM2</td>\n</tr>\n<tr>\n<td><strong>ç®€å• Demo æˆ–æµ‹è¯•ç¯å¢ƒ</strong></td>\n<td>Egg-Scripts</td>\n</tr>\n</tbody>\n</table>\n<hr>\n<h2><strong>6. ç»“åˆä½¿ç”¨çš„æœ€ä½³å®è·µ</strong></h2>\n<ol>\n<li><strong>å¼€å‘ç¯å¢ƒ</strong>  ï¼šç›´æ¥ä½¿ç”¨ <code>npm run dev</code>ï¼ˆEgg.js å†…ç½®å¼€å‘æ¨¡å¼ï¼‰ã€‚</li>\n<li><strong>ç”Ÿäº§ç¯å¢ƒ</strong>  ï¼š\n<ul>\n<li>å¦‚æœåªéœ€åŸºç¡€åŠŸèƒ½ â†’ <strong>Egg-Scripts</strong>  ã€‚</li>\n<li>å¦‚æœéœ€è¦é›†ç¾¤ã€ç›‘æ§ â†’ <strong>PM2</strong>  ï¼ˆæ¨èï¼‰ã€‚</li>\n</ul>\n</li>\n<li><strong>å®¹å™¨åŒ–éƒ¨ç½²</strong>  ï¼š\n<ul>\n<li>åœ¨ Docker ä¸­ä¼˜å…ˆä½¿ç”¨ PM2ï¼ˆæ”¯æŒè¿›ç¨‹ç®¡ç†ã€ä¼˜é›…é€€å‡ºï¼‰ã€‚</li>\n</ul>\n</li>\n</ol>\n<hr>\n<h2><strong>7. æ€»ç»“</strong></h2>\n<ul>\n<li><strong>Egg-Scripts</strong>   æ˜¯ Egg.js çš„â€œå¼€ç®±å³ç”¨â€æ–¹æ¡ˆï¼Œé€‚åˆç®€å•åœºæ™¯ã€‚</li>\n<li><strong>PM2</strong>   æ˜¯ä¸“ä¸šçº§å·¥å…·ï¼Œé€‚åˆå¤æ‚ç”Ÿäº§ç¯å¢ƒã€‚</li>\n<li><strong>å…³é”®åŒºåˆ«</strong>  ï¼šPM2 æä¾› <strong>è¿›ç¨‹ç®¡ç†ã€é›†ç¾¤ã€ç›‘æ§</strong>  ï¼Œè€Œ Egg-Scripts ä»…ä¸“æ³¨ <strong>å¯åŠ¨/åœæ­¢</strong>  ã€‚</li>\n</ul>\n<p>æ ¹æ®é¡¹ç›®éœ€æ±‚é€‰æ‹©ï¼Œå¤§å¤šæ•°ç”Ÿäº§ç¯å¢ƒæ¨è <strong>PM2</strong>  ï¼ ğŸš€</p>\n</div>'</script></body></html>