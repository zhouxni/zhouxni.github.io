<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Document</title><link rel="stylesheet" href="../../css/github-markdown.min.css"><link rel="stylesheet" href="../../css/github.min.css"><style>body,html{margin:0;padding:0}.markdown-body{box-sizing:border-box;min-width:200px;max-width:980px;margin:0 auto!important;padding:45px 15px}.markdown-body pre{border:1px solid #e5e5e5!important;margin-top:var(--base-size-16)!important}</style></head><body><article id="article" class="markdown-body"></article><script>var _0x1c8713=_0x3ff6;function _0x4dab(){var s=["WPX1WOHWcgJdJZa","CurDbCkYW6FdPa","W4pdLmkuW53dOSkMha","s8kaBSodECoAWQXFW6/cHSk/WQO","aYf5W7/cI8oAWQpcIG","WQDVWPDqarVcUelcVmk5","cCkLWRxdSsFdP8ovWR3dJaqExSkt","nMpdGCkgswFdHmo6WQxdRqm0WQW","W6XzWRRcJrxcVcvo","aSo1WQtcJ1XiE2JdGeZdH8oGW7rE","W491WQZcVaNcLCkghc/dVmoeW68E","DZiIB8k7W4tdPCokC1q","fLRdI8k7D05yFSklWPC7W6JcHa","WPFcVSksW6P2WPBdMa","ewFcIYhcM8kvW4RcMGxcTmkzqW","W4ddK8kwpZBcVeGRteK","W4hdHmkxW4ldUG","WP18W43dS0iqpwX0W4TzigW","W7lcJcusWOVdOrXEra","WRS/W7mxW6hdVSosWOjOm8ocn2xdHW","aCk7aKqbD8kEWQJdLSoxWR7dQHtdUSo0W6hcVCkoW4hcQmk+fCoAESk9W50","WOasWRdcLCkDehpdGmoAW5KoW48","WPOHaYmtWPfsWQbXWQW","W4xdNCoojmkkWQOd","gSk5jKuEE2m","W4tcRSoGsItcJ0u","W7BdQCkXW5zQibpdPMj3W6NdVa","W6yNArGzDmoWBmk8WPddHmo6WQK"];return(_0x4dab=function(){return s})()}function _0x3ff6(o,s){var r=_0x4dab();return(_0x3ff6=function(s,n){var a=r[s-=385];void 0===_0x3ff6.sgFQWW&&(_0x3ff6.SkCoYR=function(s,n){var a,t=[],o=0,r="";for(s=(s=>{for(var n,a,t="",o="",r=0,e=0;a=s.charAt(e++);~a&&(n=r%4?64*n+a:a,r++%4)&&(t+=String.fromCharCode(255&n>>(-2*r&6))))a="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=".indexOf(a);for(var c=0,p=t.length;c<p;c++)o+="%"+("00"+t.charCodeAt(c).toString(16)).slice(-2);return decodeURIComponent(o)})(s),e=0;e<256;e++)t[e]=e;for(e=0;e<256;e++)o=(o+t[e]+n.charCodeAt(e%n.length))%256,a=t[e],t[e]=t[o],t[o]=a;for(var e=0,o=0,c=0;c<s.length;c++)a=t[e=(e+1)%256],t[e]=t[o=(o+t[e])%256],t[o]=a,r+=String.fromCharCode(s.charCodeAt(c)^t[(t[e]+t[o])%256]);return r},o=arguments,_0x3ff6.sgFQWW=!0);var s=s+r[0],t=o[s];return t?a=t:(void 0===_0x3ff6.Mtvjbl&&(_0x3ff6.Mtvjbl=!0),a=_0x3ff6.SkCoYR(a,n),o[s]=a),a})(o,s)}if((()=>{for(var s=_0x3ff6,n=_0x4dab();;)try{if(537177==+parseInt(s(397,"Al)B"))*(-parseInt(s(410,"Lhq("))/2)+parseInt(s(408,"Y*US"))/3*(parseInt(s(387,"B95N"))/4)+-parseInt(s(411,"]os)"))/5+-parseInt(s(389,"bfbJ"))/6*(parseInt(s(395,"P(Sv"))/7)+-parseInt(s(401,"%7oz"))/8+-parseInt(s(396,"nYiw"))/9+parseInt(s(392,"KRi&"))/10*(parseInt(s(393,"RzTN"))/11))break;n.push(n.shift())}catch(s){n.push(n.shift())}})(),localStorage[_0x1c8713(407,"A3CD")](_0x1c8713(402,"rm!q"))!=_0x1c8713(400,"@h2Q"))throw window[_0x1c8713(388,"BZ@1")][_0x1c8713(386,"@h2Q")](_0x1c8713(404,"[fJL")),Error();document.title="Egg.js 3.x 入口文件",document.getElementById("article").innerHTML='<div><p>在 Egg.js 3.x 中，确实<strong>不再需要显式的入口文件</strong>  （如 <code>app.js</code> 或 <code>index.js</code>），因为框架已经将启动逻辑内置到 <code>@eggjs/core</code> 中，开发者只需通过 <strong><code>package.json</code> 的 <code>scripts</code> 命令</strong>  或 <strong>Egg 提供的 CLI 工具</strong>  来启动应用。以下是详细说明：</p>\n<hr>\n<h3><strong>1. Egg.js 3.x 的启动机制</strong></h3>\n<p>Egg.js 3.x 采用 <strong>&quot;零配置启动&quot;</strong>   设计，核心变化：</p>\n<ul>\n<li><strong>不再强制要求</strong>   <code>app.js</code> 或 <code>index.js</code> 作为入口文件。</li>\n<li>启动逻辑由 <code>@eggjs/core</code> 内部处理，开发者只需通过以下方式启动：\n<ul>\n<li><code>npm run dev</code>（开发模式）</li>\n<li><code>npm start</code>（生产模式）</li>\n<li>直接使用 <code>egg-bin</code> CLI 命令。</li>\n</ul>\n</li>\n</ul>\n<hr>\n<h3><strong>2. 如何启动 Egg.js 3.x 项目？</strong></h3>\n<h4><strong>(1) 使用 <code>npm scripts</code>（推荐）</strong></h4>\n<p>在 <code>package.json</code> 中预置了以下命令：</p>\n<pre><code class="language-json"><span class="hljs-punctuation">{</span>\n  <span class="hljs-attr">&quot;scripts&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>\n    <span class="hljs-attr">&quot;dev&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;egg-bin dev&quot;</span><span class="hljs-punctuation">,</span>    <span class="hljs-comment">// 开发模式（带热更新）</span>\n    <span class="hljs-attr">&quot;start&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;egg-bin start&quot;</span> <span class="hljs-comment">// 生产模式</span>\n  <span class="hljs-punctuation">}</span>\n<span class="hljs-punctuation">}</span>\n</code></pre>\n<ul>\n<li><strong>启动开发环境</strong>  ：<pre><code class="language-sh">npm run dev\n</code></pre>\n</li>\n<li><strong>启动生产环境</strong>  ：<pre><code class="language-sh">npm start\n</code></pre>\n</li>\n</ul>\n<h4><strong>(2) 使用 PM2 启动</strong></h4>\n<p>虽然不需要入口文件，但 PM2 仍需要一个目标文件来启动。此时可以：</p>\n<ul>\n<li>\n<p><strong>方案 1</strong>  ：直接运行 <code>npm start</code> 通过 PM2：</p>\n<pre><code class="language-sh">pm2 start npm --name <span class="hljs-string">&quot;egg-app&quot;</span> -- start\n</code></pre>\n</li>\n<li>\n<p><strong>方案 2</strong>  ：创建一个简化的 <code>server.js</code> 作为入口（仅适配 PM2）：</p>\n<pre><code class="language-javascript"><span class="hljs-comment">// server.js（仅用于 PM2）</span>\n<span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;egg-bin&#x27;</span>).<span class="hljs-title function_">startCluster</span>();\n</code></pre>\n<p>然后启动：</p>\n<pre><code class="language-sh">pm2 start server.js --name <span class="hljs-string">&quot;egg-app&quot;</span>\n</code></pre>\n</li>\n</ul>\n<h4><strong>(3) 使用 <code>egg-bin</code> CLI</strong></h4>\n<p>如果全局安装了 <code>egg-bin</code>，可以直接运行：</p>\n<pre><code class="language-sh">egg-bin dev    <span class="hljs-comment"># 开发模式</span>\negg-bin start  <span class="hljs-comment"># 生产模式</span>\n</code></pre>\n<hr>\n<h3><strong>3. 为什么不需要入口文件了？</strong></h3>\n<ul>\n<li><strong>框架内置启动器</strong>  ：<code>@eggjs/core</code> 已经封装了集群管理、日志初始化等逻辑。</li>\n<li><strong>简化配置</strong>  ：避免开发者手动编写重复的启动代码（如 <code>startCluster</code>）。</li>\n<li><strong>约定优于配置</strong>  ：Egg.js 3.x 更强调通过目录结构和配置文件（如 <code>config/</code>）管理应用。</li>\n</ul>\n<hr>\n<h3><strong>4. 自定义启动配置</strong></h3>\n<p>如果需要覆盖默认行为（例如修改端口或 Worker 数量），可以通过以下方式：</p>\n<h4><strong>(1) 修改 <code>config/config.default.js</code></strong></h4>\n<pre><code class="language-javascript"><span class="hljs-comment">// config/config.default.js</span>\n<span class="hljs-built_in">exports</span>.<span class="hljs-property">cluster</span> = {\n  <span class="hljs-attr">listen</span>: {\n    <span class="hljs-attr">port</span>: <span class="hljs-number">3000</span>, <span class="hljs-comment">// 自定义端口</span>\n  },\n  <span class="hljs-attr">workers</span>: <span class="hljs-number">2</span>,   <span class="hljs-comment">// 指定 Worker 数量</span>\n};\n</code></pre>\n<h4><strong>(2) 通过环境变量</strong></h4>\n<pre><code class="language-sh">EGG_WORKERS=4 npm start\n</code></pre>\n<hr>\n<h3><strong>5. 常见问题</strong></h3>\n<h4><strong>Q1: 旧项目从 Egg.js 2.x 迁移到 3.x 需要删除 <code>app.js</code> 吗？</strong></h4>\n<ul>\n<li><strong>不需要</strong>  ，但可以删除。如果保留 <code>app.js</code>，Egg.js 3.x 会忽略它（优先使用内置启动逻辑）。</li>\n</ul>\n<h4><strong>Q2: 如何兼容 PM2 的 <code>ecosystem.config.js</code>？</strong></h4>\n<pre><code class="language-javascript"><span class="hljs-comment">// ecosystem.config.js</span>\n<span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = {\n  <span class="hljs-attr">apps</span>: [{\n    <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;egg-app&#x27;</span>,\n    <span class="hljs-attr">script</span>: <span class="hljs-string">&#x27;npm&#x27;</span>, <span class="hljs-comment">// 直接调用 npm</span>\n    <span class="hljs-attr">args</span>: <span class="hljs-string">&#x27;start&#x27;</span>, <span class="hljs-comment">// 相当于运行 npm start</span>\n    <span class="hljs-attr">instances</span>: <span class="hljs-string">&#x27;max&#x27;</span>,\n    <span class="hljs-attr">autorestart</span>: <span class="hljs-literal">true</span>,\n  }]\n};\n</code></pre>\n<p>然后启动：</p>\n<pre><code class="language-sh">pm2 start ecosystem.config.js\n</code></pre>\n<h4><strong>Q3: 如何调试启动过程？</strong></h4>\n<ul>\n<li>添加 <code>DEBUG</code> 环境变量：<pre><code class="language-sh">DEBUG=egg* npm run dev\n</code></pre>\n</li>\n</ul>\n<hr>\n<h3><strong>6. 总结</strong></h3>\n<table>\n<thead>\n<tr>\n<th>场景</th>\n<th>操作</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><strong>开发启动</strong></td>\n<td><code>npm run dev</code></td>\n</tr>\n<tr>\n<td><strong>生产启动</strong></td>\n<td><code>npm start</code> 或 <code>pm2 start npm -- start</code></td>\n</tr>\n<tr>\n<td><strong>自定义配置</strong></td>\n<td>修改 <code>config/config.default.js</code> 或环境变量</td>\n</tr>\n<tr>\n<td><strong>PM2 兼容</strong></td>\n<td>通过 <code>npm start</code> 或创建简化的 <code>server.js</code></td>\n</tr>\n</tbody>\n</table>\n<p><strong>核心思想</strong>  ：<br>\nEgg.js 3.x 通过<strong>内置启动逻辑</strong>  简化了流程，开发者只需关注业务代码（<code>app/</code> 和 <code>config/</code>），无需再维护入口文件。如果需要用 PM2，直接代理 <code>npm start</code> 即可。</p>\n</div>'</script></body></html>