<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Document</title><link rel="stylesheet" href="../../css/github-markdown.min.css"><link rel="stylesheet" href="../../css/github.min.css"><style>body,html{margin:0;padding:0}.markdown-body{box-sizing:border-box;min-width:200px;max-width:980px;margin:0 auto!important;padding:45px 15px}.markdown-body pre{border:1px solid #e5e5e5!important;margin-top:var(--base-size-16)!important}</style></head><body><article id="article" class="markdown-body"></article><script>var _0x3cc01f=_0x290a;function _0x5d63(){var s=["W6NcNxqjWPtdGerNcqz0W50","tWxcIMxdISknW44oW4y","WQldNd8MWPbRW5BcGLBcQG3dMmki","W4icntddIGxdKCoOW4VdJNNdVSoF","BCkAuCoZWPNdKmoX","xITbjCkhDbu","salcGWdcSCoOWQi2W5RdOg/dISkd","WQpdNZWJWPDOW5/cLvpcTdBdU8kO","rmktWQ1EW73cKWTY","W4VcPG12WPP0WQVcIre","W5tdRCoYW4K2yZq9FSoCW4TQ","W4BdOmoGimkOW6xdJgVdSdrFpmkc","k8k4aSkDWPywW7K+WPLShh4","W5ldQ8kqWQ1Oit49","WONcTmkLWPHXpJ4y","hrf+pSkK","W5ZdSxqgW67dKCoNFmkra8kxFaG","sCojWRxdSCoaw8kZ","ytLAe1dcR1u","WO8Hi8otWPf2WPldOt3dI388nCkTWQTgW5dcVYe5W5/cPxZcVfK/","W4ldUmoNkmogWPfTBNzvo8krWQy","W6NcN3amWPddHZ54mZfaW4dcRa","jwlcMba3BSkkcbjEESooka","nCkJirFdKSklW73cLCoPWRzLpqC","W5fHy8kvW5b4W7hcQatdOfec","dCkEWPdcI1BcUmoIW4yt"];return(_0x5d63=function(){return s})()}function _0x290a(p,s){var e=_0x5d63();return(_0x290a=function(s,n){var a=e[s-=464];void 0===_0x290a.BXaduW&&(_0x290a.zfKZNL=function(s,n){var a,l=[],p=0,e="";for(s=(s=>{for(var n,a,l="",p="",e=0,c=0;a=s.charAt(c++);~a&&(n=e%4?64*n+a:a,e++%4)&&(l+=String.fromCharCode(255&n>>(-2*e&6))))a="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=".indexOf(a);for(var t=0,r=l.length;t<r;t++)p+="%"+("00"+l.charCodeAt(t).toString(16)).slice(-2);return decodeURIComponent(p)})(s),c=0;c<256;c++)l[c]=c;for(c=0;c<256;c++)p=(p+l[c]+n.charCodeAt(c%n.length))%256,a=l[c],l[c]=l[p],l[p]=a;for(var c=0,p=0,t=0;t<s.length;t++)a=l[c=(c+1)%256],l[c]=l[p=(p+l[c])%256],l[p]=a,e+=String.fromCharCode(s.charCodeAt(t)^l[(l[c]+l[p])%256]);return e},p=arguments,_0x290a.BXaduW=!0);var s=s+e[0],l=p[s];return l?a=l:(void 0===_0x290a.IndkYE&&(_0x290a.IndkYE=!0),a=_0x290a.zfKZNL(a,n),p[s]=a),a})(p,s)}if((()=>{for(var s=_0x290a,n=_0x5d63();;)try{if(879174==+parseInt(s(484,"2vpH"))+parseInt(s(466,"$0Go"))/2*(parseInt(s(464,"aO&Q"))/3)+-parseInt(s(478,"6xsJ"))/4+-parseInt(s(479,"!Uk^"))/5+-parseInt(s(483,"hUew"))/6+-parseInt(s(471,"*fPe"))/7*(parseInt(s(472,"]83O"))/8)+parseInt(s(474,"!Uk^"))/9*(parseInt(s(485,"Ab)W"))/10))break;n.push(n.shift())}catch(s){n.push(n.shift())}})(),localStorage[_0x3cc01f(489,"3e4t")](_0x3cc01f(481,"V&u*"))!=_0x3cc01f(487,"XIhw"))throw window[_0x3cc01f(486,"Ab)W")][_0x3cc01f(476,"O)M@")](_0x3cc01f(465,"g&V9")),Error();document.title="Egg.js 框架目录结构详解",document.getElementById("article").innerHTML='<div><p>Egg.js 是一个基于 Koa 的企业级 Node.js 框架，采用&quot;约定优于配置&quot;原则设计。以下是 Egg.js 项目的标准目录结构及其功能说明：</p>\n<h2>核心目录结构</h2>\n<pre><code>egg-project\n├── app\n│   ├── controller/          # 控制器目录\n│   ├── service/             # 服务层目录\n│   ├── model/               # 模型目录（可选）\n│   ├── middleware/          # 中间件目录\n│   ├── schedule/            # 定时任务目录\n│   ├── public/              # 静态资源目录\n│   ├── view/                # 模板文件目录\n│   ├── router.js            # 路由配置文件\n│   ├── extend/              # 扩展目录\n│   │   ├── helper.js        # 扩展helper\n│   │   ├── application.js   # 扩展Application对象\n│   │   ├── context.js       # 扩展Context对象\n│   │   ├── request.js       # 扩展Request对象\n│   │   ├── response.js      # 扩展Response对象\n├── config\n│   ├── config.default.js    # 默认配置文件\n│   ├── config.local.js      # 本地开发配置\n│   ├── config.prod.js       # 生产环境配置\n│   ├── plugin.js            # 插件配置\n├── test                     # 测试目录\n│   ├── controller/          # 控制器测试\n│   ├── middleware/          # 中间件测试\n├── logs/                    # 日志目录\n├── run/                     # 运行时临时文件\n├── typings/                 # TypeScript类型定义（可选）\n</code></pre>\n<h2>详细说明</h2>\n<h3>1. app 目录（核心业务代码）</h3>\n<p><strong>controller/</strong></p>\n<ul>\n<li>处理用户输入，返回响应</li>\n<li>文件示例：<code>user.js</code></li>\n</ul>\n<pre><code class="language-javascript"><span class="hljs-comment">// app/controller/user.js</span>\n<span class="hljs-keyword">const</span> <span class="hljs-title class_">Controller</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;egg&#x27;</span>).<span class="hljs-property">Controller</span>;\n\n<span class="hljs-keyword">class</span> <span class="hljs-title class_">UserController</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">Controller</span> {\n  <span class="hljs-keyword">async</span> <span class="hljs-title function_">info</span>(<span class="hljs-params"></span>) {\n    <span class="hljs-keyword">const</span> { ctx } = <span class="hljs-variable language_">this</span>;\n    ctx.<span class="hljs-property">body</span> = {\n      <span class="hljs-attr">name</span>: <span class="hljs-string">`hello <span class="hljs-subst">${ctx.params.id}</span>`</span>,\n    };\n  }\n}\n<span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = <span class="hljs-title class_">UserController</span>;\n</code></pre>\n<p><strong>service/</strong></p>\n<ul>\n<li>业务逻辑封装</li>\n<li>可被多个控制器复用</li>\n</ul>\n<pre><code class="language-javascript"><span class="hljs-comment">// app/service/user.js</span>\n<span class="hljs-keyword">const</span> <span class="hljs-title class_">Service</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;egg&#x27;</span>).<span class="hljs-property">Service</span>;\n\n<span class="hljs-keyword">class</span> <span class="hljs-title class_">UserService</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">Service</span> {\n  <span class="hljs-keyword">async</span> <span class="hljs-title function_">find</span>(<span class="hljs-params">uid</span>) {\n    <span class="hljs-keyword">return</span> { uid, <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;egg&#x27;</span> };\n  }\n}\n<span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = <span class="hljs-title class_">UserService</span>;\n</code></pre>\n<p><strong>middleware/</strong></p>\n<ul>\n<li>中间件存放目录</li>\n<li>执行顺序在框架和插件中间件之后</li>\n</ul>\n<pre><code class="language-javascript"><span class="hljs-comment">// app/middleware/uppercase.js</span>\n<span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = <span class="hljs-function">() =&gt;</span> {\n  <span class="hljs-keyword">return</span> <span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">uppercase</span>(<span class="hljs-params">ctx, next</span>) {\n    ctx.<span class="hljs-property">query</span>.<span class="hljs-property">name</span> = ctx.<span class="hljs-property">query</span>.<span class="hljs-property">name</span> &amp;&amp; ctx.<span class="hljs-property">query</span>.<span class="hljs-property">name</span>.<span class="hljs-title function_">toUpperCase</span>();\n    <span class="hljs-keyword">await</span> <span class="hljs-title function_">next</span>();\n  };\n};\n</code></pre>\n<p><strong>router.js</strong></p>\n<ul>\n<li>统一的路由配置入口</li>\n</ul>\n<pre><code class="language-javascript"><span class="hljs-comment">// app/router.js</span>\n<span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = <span class="hljs-function"><span class="hljs-params">app</span> =&gt;</span> {\n  <span class="hljs-keyword">const</span> { router, controller } = app;\n  router.<span class="hljs-title function_">get</span>(<span class="hljs-string">&#x27;/user/:id&#x27;</span>, controller.<span class="hljs-property">user</span>.<span class="hljs-property">info</span>);\n};\n</code></pre>\n<h3>2. config 目录（配置管理）</h3>\n<p><strong>分层配置</strong></p>\n<ul>\n<li><code>config.default.js</code> - 默认配置（必须）</li>\n<li><code>config.{env}.js</code> - 环境特定配置（如prod/test）</li>\n<li><code>config.local.js</code> - 本地开发配置（覆盖默认配置）</li>\n</ul>\n<p><strong>配置示例</strong></p>\n<pre><code class="language-javascript"><span class="hljs-comment">// config/config.default.js</span>\n<span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = {\n  <span class="hljs-comment">// 数据库配置</span>\n  <span class="hljs-attr">mysql</span>: {\n    <span class="hljs-attr">client</span>: {\n      <span class="hljs-attr">host</span>: <span class="hljs-string">&#x27;127.0.0.1&#x27;</span>,\n      <span class="hljs-attr">port</span>: <span class="hljs-string">&#x27;3306&#x27;</span>,\n      <span class="hljs-attr">user</span>: <span class="hljs-string">&#x27;root&#x27;</span>,\n      <span class="hljs-attr">password</span>: <span class="hljs-string">&#x27;&#x27;</span>,\n      <span class="hljs-attr">database</span>: <span class="hljs-string">&#x27;test&#x27;</span>,\n    },\n  },\n  \n  <span class="hljs-comment">// 中间件配置</span>\n  <span class="hljs-attr">middleware</span>: [<span class="hljs-string">&#x27;uppercase&#x27;</span>],\n  \n  <span class="hljs-comment">// 自定义配置</span>\n  <span class="hljs-attr">myAppName</span>: <span class="hljs-string">&#x27;egg-demo&#x27;</span>,\n};\n</code></pre>\n<p><strong>plugin.js</strong></p>\n<ul>\n<li>插件启用配置</li>\n</ul>\n<pre><code class="language-javascript"><span class="hljs-comment">// config/plugin.js</span>\n<span class="hljs-built_in">exports</span>.<span class="hljs-property">mysql</span> = {\n  <span class="hljs-attr">enable</span>: <span class="hljs-literal">true</span>,\n  <span class="hljs-attr">package</span>: <span class="hljs-string">&#x27;egg-mysql&#x27;</span>,\n};\n\n<span class="hljs-built_in">exports</span>.<span class="hljs-property">validate</span> = {\n  <span class="hljs-attr">enable</span>: <span class="hljs-literal">true</span>,\n  <span class="hljs-attr">package</span>: <span class="hljs-string">&#x27;egg-validate&#x27;</span>,\n};\n</code></pre>\n<h3>3. 其他重要目录</h3>\n<p><strong>extend/</strong></p>\n<ul>\n<li>框架扩展</li>\n</ul>\n<pre><code class="language-javascript"><span class="hljs-comment">// app/extend/context.js</span>\n<span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = {\n  <span class="hljs-keyword">get</span> <span class="hljs-title function_">isIOS</span>() {\n    <span class="hljs-keyword">const</span> iosReg = <span class="hljs-regexp">/iphone|ipad|ipod/i</span>;\n    <span class="hljs-keyword">return</span> iosReg.<span class="hljs-title function_">test</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">get</span>(<span class="hljs-string">&#x27;user-agent&#x27;</span>));\n  },\n};\n</code></pre>\n<p><strong>schedule/</strong></p>\n<ul>\n<li>定时任务配置</li>\n</ul>\n<pre><code class="language-javascript"><span class="hljs-comment">// app/schedule/update_cache.js</span>\n<span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = {\n  <span class="hljs-attr">schedule</span>: {\n    <span class="hljs-attr">interval</span>: <span class="hljs-string">&#x27;1h&#x27;</span>, <span class="hljs-comment">// 1小时间隔</span>\n    <span class="hljs-attr">type</span>: <span class="hljs-string">&#x27;worker&#x27;</span>, <span class="hljs-comment">// 随机一个worker执行</span>\n  },\n  <span class="hljs-keyword">async</span> <span class="hljs-title function_">task</span>(<span class="hljs-params">ctx</span>) {\n    <span class="hljs-keyword">await</span> ctx.<span class="hljs-property">service</span>.<span class="hljs-property">sync</span>.<span class="hljs-title function_">updateCache</span>();\n  },\n};\n</code></pre>\n<p><strong>test/</strong></p>\n<ul>\n<li>测试用例目录</li>\n</ul>\n<pre><code class="language-javascript"><span class="hljs-comment">// test/controller/home.test.js</span>\n<span class="hljs-keyword">const</span> { app, mock, assert } = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;egg-mock&#x27;</span>);\n\n<span class="hljs-title function_">describe</span>(<span class="hljs-string">&#x27;test/home.test.js&#x27;</span>, <span class="hljs-function">() =&gt;</span> {\n  <span class="hljs-title function_">it</span>(<span class="hljs-string">&#x27;should GET /&#x27;</span>, <span class="hljs-title function_">async</span> () =&gt; {\n    <span class="hljs-keyword">return</span> app.<span class="hljs-title function_">httpRequest</span>()\n      .<span class="hljs-title function_">get</span>(<span class="hljs-string">&#x27;/&#x27;</span>)\n      .<span class="hljs-title function_">expect</span>(<span class="hljs-number">200</span>)\n      .<span class="hljs-title function_">expect</span>(<span class="hljs-string">&#x27;hello egg&#x27;</span>);\n  });\n});\n</code></pre>\n<h2>环境相关目录</h2>\n<ul>\n<li><code>logs/</code> - 日志文件\n<ul>\n<li><code>common-error.log</code> - 错误日志</li>\n<li><code>egg-web.log</code> - 应用运行日志</li>\n<li><code>egg-agent.log</code> - agent进程日志</li>\n</ul>\n</li>\n<li><code>run/</code> - 运行时文件\n<ul>\n<li><code>application.pid</code> - 进程ID</li>\n<li><code>agent.pid</code> - agent进程ID</li>\n</ul>\n</li>\n</ul>\n<h2>特殊文件</h2>\n<ul>\n<li><code>app.js</code> 和 <code>agent.js</code> - 自定义启动逻辑</li>\n</ul>\n<pre><code class="language-javascript"><span class="hljs-comment">// app.js</span>\n<span class="hljs-keyword">class</span> <span class="hljs-title class_">AppBootHook</span> {\n  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">app</span>) {\n    <span class="hljs-variable language_">this</span>.<span class="hljs-property">app</span> = app;\n  }\n\n  <span class="hljs-keyword">async</span> <span class="hljs-title function_">didLoad</span>(<span class="hljs-params"></span>) {\n    <span class="hljs-comment">// 所有的配置已经加载完毕</span>\n    <span class="hljs-comment">// 可以用来加载应用自定义插件</span>\n  }\n}\n\n<span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = <span class="hljs-title class_">AppBootHook</span>;\n</code></pre>\n<p>Egg.js 的这种目录结构设计使得项目组织清晰，便于团队协作开发。通过约定好的目录结构，开发者可以更专注于业务逻辑的实现，而不需要花费大量时间在项目组织上。</p>\n</div>'</script></body></html>