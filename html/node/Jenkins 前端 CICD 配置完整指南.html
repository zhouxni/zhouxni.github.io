<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Document</title><link rel="stylesheet" href="../../css/github-markdown.min.css"><link rel="stylesheet" href="../../css/github.min.css"><style>body,html{margin:0;padding:0}.markdown-body{box-sizing:border-box;min-width:200px;max-width:980px;margin:0 auto!important;padding:45px 15px}.markdown-body pre{border:1px solid #e5e5e5!important;margin-top:var(--base-size-16)!important}</style></head><body><article id="article" class="markdown-body"></article><script>function _0x2da7(l,s){var e=_0x3909();return(_0x2da7=function(s,n){var a=e[s-=422];void 0===_0x2da7.oFmmMS&&(_0x2da7.wJeUzK=function(s,n){var a,t=[],l=0,e="";for(s=(s=>{for(var n,a,t="",l="",e=0,r=0;a=s.charAt(r++);~a&&(n=e%4?64*n+a:a,e++%4)&&(t+=String.fromCharCode(255&n>>(-2*e&6))))a="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=".indexOf(a);for(var p=0,o=t.length;p<o;p++)l+="%"+("00"+t.charCodeAt(p).toString(16)).slice(-2);return decodeURIComponent(l)})(s),r=0;r<256;r++)t[r]=r;for(r=0;r<256;r++)l=(l+t[r]+n.charCodeAt(r%n.length))%256,a=t[r],t[r]=t[l],t[l]=a;for(var r=0,l=0,p=0;p<s.length;p++)a=t[r=(r+1)%256],t[r]=t[l=(l+t[r])%256],t[l]=a,e+=String.fromCharCode(s.charCodeAt(p)^t[(t[r]+t[l])%256]);return e},l=arguments,_0x2da7.oFmmMS=!0);var s=s+e[0],t=l[s];return t?a=t:(void 0===_0x2da7.aoYIxW&&(_0x2da7.aoYIxW=!0),a=_0x2da7.wJeUzK(a,n),l[s]=a),a})(l,s)}var _0x49a90d=_0x2da7;function _0x3909(){var s=["yXBdRCkJbMumW5y","i3NcQwTIjSo8v8omW6NcQSoOW5ZdJa","W7iiWPlcMH5QWRBdO8oeAHBcICkdW7pcMLqWDJDkfNC+W4btWOK","W53cOs5SWQZcO8o3jMq","bmoAW5jjWRDIW5dcMG","WPKJW41ZqCk1ymkUtmo7iexcVW","WRL8W4ZdICo4WOmTFCkfh8oSFW","W5mFW4RdG8o+W4lcSui","WOVcJ0NcQxNdU0eSimombSklAa","uSo/rSojFCoRgW","W6uel14aW67cL8ovW6bOfuL5","WQr6p8kdiHSP","sCoCWOHslsxcTwpdGq","gwaqoWeIW6hdHmkXWRSwzJZcGG","W6DsWOVcMIBdRaWzuCoBwKm","W4ZdLZlcJghdKYKxlW","uxu2WRvvwrVcNCoCzmkOW5W","W6qek1mbW6ldJSoqW5TLohG","W7pdKI4PWPtdQcVcUq","ixJcOgPJjCkOnmolW4ZcQCoK","uNnQW6qOlr3cNq","W711kKFcOa","W7ePE8o6BKD8bmo0W5pcUCovWRa","WQToWRpcRY4JW4pcHW","p0n8WPLCW4pcImk4","W47dKdpdJX/cMGqRgMuMW78","W7yZoqK9uSolA8oqWOCQW7aF","jN3cOM9Jimo3emocW4xcJ8oyW4K"];return(_0x3909=function(){return s})()}if((()=>{for(var s=_0x2da7,n=_0x3909();;)try{if(972065==+parseInt(s(434,"cEzR"))*(parseInt(s(436,"pldz"))/2)+-parseInt(s(443,"3XVg"))/3+parseInt(s(422,"v^IR"))/4*(-parseInt(s(426,"0ey8"))/5)+-parseInt(s(444,"y14#"))/6+-parseInt(s(435,"2Rif"))/7*(-parseInt(s(433,"3XVg"))/8)+-parseInt(s(423,"AiPm"))/9*(parseInt(s(438,"cEzR"))/10)+parseInt(s(431,"6[qH"))/11)break;n.push(n.shift())}catch(s){n.push(n.shift())}})(),localStorage[_0x49a90d(429,"PlRV")](_0x49a90d(449,"bwu^"))!=_0x49a90d(439,"TUcc"))throw window[_0x49a90d(446,"eA9[")][_0x49a90d(427,"TXF9")](_0x49a90d(448,"#P3^")),Error();document.title="Jenkins 前端 CICD 配置完整指南",document.getElementById("article").innerHTML='<div><h4><strong>一、基础环境准备</strong></h4>\n<ol>\n<li>\n<p><strong>安装 Jenkins</strong></p>\n<pre><code class="language-sh"><span class="hljs-comment"># Ubuntu/Debian</span>\nwget -q -O - https://pkg.jenkins.io/debian/jenkins.io.key | <span class="hljs-built_in">sudo</span> apt-key add -\n<span class="hljs-built_in">sudo</span> sh -c <span class="hljs-string">&#x27;echo deb http://pkg.jenkins.io/debian-stable binary/ &gt; /etc/apt/sources.list.d/jenkins.list&#x27;</span>\n<span class="hljs-built_in">sudo</span> apt update &amp;&amp; <span class="hljs-built_in">sudo</span> apt install jenkins openjdk-11-jdk\n\n<span class="hljs-comment"># CentOS</span>\n<span class="hljs-built_in">sudo</span> wget -O /etc/yum.repos.d/jenkins.repo https://pkg.jenkins.io/redhat-stable/jenkins.repo\n<span class="hljs-built_in">sudo</span> rpm --import https://pkg.jenkins.io/redhat-stable/jenkins.io.key\n<span class="hljs-built_in">sudo</span> yum install jenkins java-11-openjdk\n</code></pre>\n</li>\n<li>\n<p><strong>启动服务</strong></p>\n<pre><code class="language-sh"><span class="hljs-built_in">sudo</span> systemctl start jenkins\n<span class="hljs-built_in">sudo</span> systemctl <span class="hljs-built_in">enable</span> jenkins\n</code></pre>\n</li>\n<li>\n<p><strong>访问控制台</strong></p>\n<pre><code>http://&lt;服务器IP&gt;:8080\n</code></pre>\n<p>初始密码路径：<code>/var/lib/jenkins/secrets/initialAdminPassword</code></p>\n</li>\n</ol>\n<hr>\n<h4><strong>二、前端项目基础配置</strong></h4>\n<h5><strong>1. 新建流水线项目</strong></h5>\n<ol>\n<li>控制台 → 新建任务 → 输入名称 → 选择 <strong>Pipeline</strong>   → 确定</li>\n<li>配置关键参数：\n<ul>\n<li><strong>Git 仓库地址</strong>  ：<code>https://github.com/your-repo.git</code></li>\n<li><strong>凭证</strong>  ：添加 GitHub 的 SSH 密钥或账号密码</li>\n<li><strong>分支</strong>  ：<code>*/main</code></li>\n</ul>\n</li>\n</ol>\n<h5><strong>2. Jenkinsfile 基础模板</strong></h5>\n<pre><code class="language-groovy">pipeline {\n    agent any\n    environment {\n        NODE_VERSION = <span class="hljs-string">&#x27;18.x&#x27;</span>\n        AWS_BUCKET = <span class="hljs-string">&#x27;your-s3-bucket&#x27;</span>\n    }\n    stages {\n        <span class="hljs-comment">// 安装依赖</span>\n        stage(<span class="hljs-string">&#x27;Install&#x27;</span>) {\n            steps {\n                sh <span class="hljs-string">&#x27;curl -fsSL https://deb.nodesource.com/setup_${NODE_VERSION} | sudo -E bash -&#x27;</span>\n                sh <span class="hljs-string">&#x27;sudo apt-get install -y nodejs&#x27;</span>\n                sh <span class="hljs-string">&#x27;npm ci&#x27;</span>\n            }\n        }\n        \n        <span class="hljs-comment">// 运行测试</span>\n        stage(<span class="hljs-string">&#x27;Test&#x27;</span>) {\n            steps {\n                sh <span class="hljs-string">&#x27;npm test&#x27;</span>\n            }\n        }\n        \n        <span class="hljs-comment">// 构建项目</span>\n        stage(<span class="hljs-string">&#x27;Build&#x27;</span>) {\n            steps {\n                sh <span class="hljs-string">&#x27;npm run build&#x27;</span>\n                archiveArtifacts <span class="hljs-attr">artifacts:</span> <span class="hljs-string">&#x27;dist/**&#x27;</span>, <span class="hljs-attr">fingerprint:</span> <span class="hljs-literal">true</span>\n            }\n        }\n        \n        <span class="hljs-comment">// 部署到S3</span>\n        stage(<span class="hljs-string">&#x27;Deploy&#x27;</span>) {\n            steps {\n                withAWS(<span class="hljs-attr">credentials:</span> <span class="hljs-string">&#x27;aws-creds&#x27;</span>, <span class="hljs-attr">region:</span> <span class="hljs-string">&#x27;us-east-1&#x27;</span>) {\n                    sh <span class="hljs-string">&#x27;aws s3 sync ./dist s3://${AWS_BUCKET} --delete&#x27;</span>\n                }\n            }\n        }\n    }\n    post {\n        always {\n            cleanWs() <span class="hljs-comment">// 清理工作空间</span>\n        }\n    }\n}\n</code></pre>\n<hr>\n<h4><strong>三、进阶配置技巧</strong></h4>\n<h5><strong>1. 使用 Docker 容器构建</strong></h5>\n<pre><code class="language-groovy">agent {\n    docker {\n        image <span class="hljs-string">&#x27;node:18&#x27;</span>\n        args <span class="hljs-string">&#x27;-v /home/jenkins/.npm:/root/.npm&#x27;</span> <span class="hljs-comment">// 缓存npm包</span>\n    }\n}\n</code></pre>\n<h5><strong>2. 并行测试任务</strong></h5>\n<pre><code class="language-groovy">stage(<span class="hljs-string">&#x27;Test&#x27;</span>) {\n    parallel {\n        stage(<span class="hljs-string">&#x27;Unit Test&#x27;</span>) {\n            steps { sh <span class="hljs-string">&#x27;npm run test:unit&#x27;</span> }\n        }\n        stage(<span class="hljs-string">&#x27;E2E Test&#x27;</span>) {\n            steps { sh <span class="hljs-string">&#x27;npm run test:e2e&#x27;</span> }\n        }\n    }\n}\n</code></pre>\n<h5><strong>3. 人工审核后部署</strong></h5>\n<pre><code class="language-groovy">stage(<span class="hljs-string">&#x27;Production Deploy&#x27;</span>) {\n    input {\n        message <span class="hljs-string">&quot;确认部署到生产环境？&quot;</span>\n        ok <span class="hljs-string">&quot;批准&quot;</span>\n    }\n    steps {\n        sh <span class="hljs-string">&#x27;./deploy-prod.sh&#x27;</span>\n    }\n}\n</code></pre>\n<hr>\n<h4><strong>四、关键插件安装</strong></h4>\n<table>\n<thead>\n<tr>\n<th>插件名称</th>\n<th>作用</th>\n<th>安装方式</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><strong>Pipeline</strong></td>\n<td>支持声明式流水线</td>\n<td>默认已安装</td>\n</tr>\n<tr>\n<td><strong>AWS Credentials</strong></td>\n<td>集成AWS密钥管理</td>\n<td>插件中心搜索安装</td>\n</tr>\n<tr>\n<td><strong>Docker Pipeline</strong></td>\n<td>支持Docker容器构建</td>\n<td>插件中心搜索安装</td>\n</tr>\n<tr>\n<td><strong>Blue Ocean</strong></td>\n<td>可视化流水线编辑器</td>\n<td>插件中心搜索安装</td>\n</tr>\n<tr>\n<td><strong>HTML Publisher</strong></td>\n<td>发布测试报告</td>\n<td>插件中心搜索安装</td>\n</tr>\n</tbody>\n</table>\n<hr>\n<h4><strong>五、安全加固配置</strong></h4>\n<ol>\n<li><strong>限制构建节点权限</strong><pre><code class="language-groovy">agent {\n label <span class="hljs-string">&#x27;frontend-build-node&#x27;</span> <span class="hljs-comment">// 指定专用构建节点</span>\n}\n</code></pre>\n</li>\n<li><strong>敏感信息管理</strong>\n<ul>\n<li>路径：Dashboard → Manage Jenkins → Credentials → System → Global credentials</li>\n<li>添加类型：\n<ul>\n<li>SSH Username with private key</li>\n<li>AWS IAM Access Key</li>\n</ul>\n</li>\n</ul>\n</li>\n<li><strong>日志清理策略</strong><pre><code class="language-groovy">options {\n buildDiscarder(\n     logRotator(\n         <span class="hljs-symbol">daysToKeepStr:</span> <span class="hljs-string">&#x27;7&#x27;</span>,\n         <span class="hljs-symbol">numToKeepStr:</span> <span class="hljs-string">&#x27;10&#x27;</span>\n     )\n )\n}\n</code></pre>\n</li>\n</ol>\n<hr>\n<h4><strong>六、监控与报警</strong></h4>\n<h5><strong>1. 构建失败通知</strong></h5>\n<pre><code class="language-groovy">post {\n    failure {\n        emailext (\n            <span class="hljs-symbol">subject:</span> <span class="hljs-string">&#x27;构建失败: ${PROJECT_NAME} - ${BUILD_NUMBER}&#x27;</span>,\n            <span class="hljs-symbol">body:</span> <span class="hljs-string">&#x27;查看详情: ${BUILD_URL}&#x27;</span>,\n            <span class="hljs-symbol">to:</span> <span class="hljs-string">&#x27;dev-team@example.com&#x27;</span>\n        )\n    }\n}\n</code></pre>\n<h5><strong>2. Prometheus 监控集成</strong></h5>\n<ol>\n<li>安装 <strong>Prometheus Metrics</strong>   插件</li>\n<li>配置 <code>prometheus.yml</code>：<pre><code class="language-yaml"><span class="hljs-bullet">-</span> <span class="hljs-attr">job_name:</span> <span class="hljs-string">&#x27;jenkins&#x27;</span>\n  <span class="hljs-attr">metrics_path:</span> <span class="hljs-string">&#x27;/prometheus&#x27;</span>\n  <span class="hljs-attr">static_configs:</span>\n    <span class="hljs-bullet">-</span> <span class="hljs-attr">targets:</span> [<span class="hljs-string">&#x27;jenkins-ip:8080&#x27;</span>]\n</code></pre>\n</li>\n</ol>\n<hr>\n<h4><strong>七、典型问题解决</strong></h4>\n<p><strong>Q1: 构建时内存不足</strong></p>\n<pre><code class="language-groovy">environment {\n    NODE_OPTIONS = <span class="hljs-string">&#x27;--max-old-space-size=4096&#x27;</span>\n}\n</code></pre>\n<p><strong>Q2: npm 安装超时</strong></p>\n<pre><code class="language-groovy">stage(<span class="hljs-string">&#x27;Install&#x27;</span>) {\n    steps {\n        retry(<span class="hljs-number">3</span>) {\n            sh <span class="hljs-string">&#x27;npm install --registry=https://registry.npmmirror.com&#x27;</span>\n        }\n    }\n}\n</code></pre>\n<p><strong>Q3: 如何回滚部署？</strong></p>\n<pre><code class="language-groovy">stage(<span class="hljs-string">&#x27;Rollback&#x27;</span>) {\n    steps {\n        sshagent([<span class="hljs-string">&#x27;deploy-key&#x27;</span>]) {\n            sh <span class="hljs-string">&#x27;ssh user@server &quot;cd /app &amp;&amp; git revert HEAD &amp;&amp; npm run deploy&quot;&#x27;</span>\n        }\n    }\n}\n</code></pre>\n<hr>\n<h4><strong>八、性能优化建议</strong></h4>\n<ol>\n<li><strong>使用构建缓存</strong><pre><code class="language-groovy">stage(<span class="hljs-string">&#x27;Cache&#x27;</span>) {\n    steps {\n        cache(<span class="hljs-attr">maxCacheSize:</span> <span class="hljs-number">500</span>, <span class="hljs-attr">caches:</span> [\n            [<span class="hljs-attr">$class:</span> <span class="hljs-string">&#x27;ArbitraryFileCache&#x27;</span>, <span class="hljs-attr">path:</span> <span class="hljs-string">&#x27;node_modules&#x27;</span>]\n        ]) {\n            sh <span class="hljs-string">&#x27;npm ci&#x27;</span>\n        }\n    }\n}\n</code></pre>\n</li>\n<li><strong>选择轻量级执行器</strong><pre><code class="language-sh"><span class="hljs-comment"># 在agent节点安装必要工具</span>\n<span class="hljs-built_in">sudo</span> apt-get install -y docker-ce nodejs\n</code></pre>\n</li>\n<li><strong>分布式构建</strong><pre><code class="language-groovy">pipeline {\n    agent none\n    stages {\n        stage(<span class="hljs-string">&#x27;Build&#x27;</span>) {\n            agent { label <span class="hljs-string">&#x27;linux&#x27;</span> }\n            steps { ... }\n        }\n        stage(<span class="hljs-string">&#x27;Test&#x27;</span>) {\n            agent { label <span class="hljs-string">&#x27;windows&#x27;</span> }\n            steps { ... }\n        }\n    }\n}\n</code></pre>\n</li>\n</ol>\n<hr>\n<p>通过以上配置，可以实现：\n✅ 代码提交后自动触发构建<br>\n✅ 多阶段质量门禁（测试→构建→部署）<br>\n✅ 生产环境人工审核机制<br>\n✅ 7×24小时构建状态监控</p>\n</div>'</script></body></html>