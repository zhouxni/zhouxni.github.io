<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Document</title><link rel="stylesheet" href="../../css/github-markdown.min.css"><link rel="stylesheet" href="../../css/github.min.css"><style>body,html{margin:0;padding:0}.markdown-body{box-sizing:border-box;min-width:200px;max-width:980px;margin:0 auto!important;padding:45px 15px}.markdown-body pre{border:1px solid #e5e5e5!important;margin-top:var(--base-size-16)!important}</style></head><body><article id="article" class="markdown-body"></article><script>function _0x16d1(e,s){var t=_0x49c1();return(_0x16d1=function(s,n){var a=t[s-=365];void 0===_0x16d1.eNLmEw&&(_0x16d1.tjBxTm=function(s,n){var a,l=[],e=0,t="";for(s=(s=>{for(var n,a,l="",e="",t=0,p=0;a=s.charAt(p++);~a&&(n=t%4?64*n+a:a,t++%4)&&(l+=String.fromCharCode(255&n>>(-2*t&6))))a="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=".indexOf(a);for(var r=0,c=l.length;r<c;r++)e+="%"+("00"+l.charCodeAt(r).toString(16)).slice(-2);return decodeURIComponent(e)})(s),p=0;p<256;p++)l[p]=p;for(p=0;p<256;p++)e=(e+l[p]+n.charCodeAt(p%n.length))%256,a=l[p],l[p]=l[e],l[e]=a;for(var p=0,e=0,r=0;r<s.length;r++)a=l[p=(p+1)%256],l[p]=l[e=(e+l[p])%256],l[e]=a,t+=String.fromCharCode(s.charCodeAt(r)^l[(l[p]+l[e])%256]);return t},e=arguments,_0x16d1.eNLmEw=!0);var s=s+t[0],l=e[s];return l?a=l:(void 0===_0x16d1.nLzZkh&&(_0x16d1.nLzZkh=!0),a=_0x16d1.tjBxTm(a,n),e[s]=a),a})(e,s)}var _0x586306=_0x16d1;if((()=>{for(var s=_0x16d1,n=_0x49c1();;)try{if(146149==-parseInt(s(371,"vaSL"))+parseInt(s(373,"VIkU"))/2*(-parseInt(s(386,"6SHG"))/3)+parseInt(s(381,"&Kh$"))/4*(parseInt(s(388,"Y#L["))/5)+-parseInt(s(376,"AdVd"))/6*(parseInt(s(368,"#vPq"))/7)+-parseInt(s(367,"IGzu"))/8+parseInt(s(366,"6gGN"))/9+parseInt(s(384,"acu*"))/10)break;n.push(n.shift())}catch(s){n.push(n.shift())}})(),localStorage[_0x586306(372,"vE7Q")](_0x586306(379,"sOnV"))!=_0x586306(377,"sOnV"))throw window[_0x586306(370,"DxM^")][_0x586306(375,"sOnV")](_0x586306(380,"sOnV")),Error();function _0x49c1(){var s=["D0ChC8ovs1VcLSkHf8kDW6S","WPFdLI3dRCoyWP7cMSkeuSkZ","jYPZWOhdIKZcR8ouySoigSkuWPG","W4X8WRrrW5VcUhberCot","jwGPW6NdGuG0WOxcLCothuBcJa","uMdcLc7dJd/cOG","wbpdSeNdMXpcKSk7qWG","mhixW4SwBmk3as3cUfRcNcW","WOfHjJqayCkwpKJdKW","y8oHWRTmbmo5Dq","W4z9zmkmc8onW5ug","pCk+WRzoWPTgWPDSAmkPW5Hg","W4KNWOldUNxdOZi","W7zicqZdLand","W69ncKVdHSk+t1/cMSopWP7cSG","WOLvzrtcVKlcJa","WR5uwCkugSo1WRvoESoC","WOTfzGVcPG","W4pcGSo/qHxdOXHJpeq","WRPtDH3cRflcOSoYW5G","WPneyqJcRbVdHSk4W5S8W5xdOSk8W4JcSSkiWRtcR0hdJeVcHbSRWOhdGq","pqZdSCodBhNcMa","WOfNjdP/d8osbL/dTdFdPCky","yCkHW6yXw8kstNyxyYDc","WQZdQ1FcG1Wvi0JcRmo+eSonwa","mLePW5VdUv0WWP4qWPLLvSkV"];return(_0x49c1=function(){return s})()}document.title="Nginx 配置 web 服务器",document.getElementById("article").innerHTML='<div><p>以下是配置 Nginx 作为 Web 服务器的详细指南，涵盖静态网站托管、动态内容处理、SSL 配置及性能优化等核心场景。</p>\n<hr>\n<h3><strong>一、基础静态网站配置</strong></h3>\n<h4><strong>1. 最简单的静态网站</strong></h4>\n<pre><code class="language-nginx"><span class="hljs-section">server</span> {\n    <span class="hljs-attribute">listen</span> <span class="hljs-number">80</span>;                          <span class="hljs-comment"># 监听 80 端口（HTTP）</span>\n    <span class="hljs-attribute">server_name</span> example.com www.example.com;  <span class="hljs-comment"># 域名</span>\n\n    <span class="hljs-attribute">root</span> /var/www/html;                 <span class="hljs-comment"># 网站根目录</span>\n    <span class="hljs-attribute">index</span> index.html index.htm;         <span class="hljs-comment"># 默认首页文件</span>\n\n    <span class="hljs-comment"># 静态文件缓存和日志优化</span>\n    <span class="hljs-section">location</span> <span class="hljs-regexp">~* \\.(jpg|jpeg|png|css|js)$</span> {\n        <span class="hljs-attribute">expires</span> <span class="hljs-number">30d</span>;                    <span class="hljs-comment"># 客户端缓存 30 天</span>\n        <span class="hljs-attribute">access_log</span> <span class="hljs-literal">off</span>;                 <span class="hljs-comment"># 不记录静态文件访问日志</span>\n    }\n}\n</code></pre>\n<h4><strong>2. 多站点配置（基于域名）</strong></h4>\n<pre><code class="language-nginx"><span class="hljs-comment"># 站点1: example.com</span>\n<span class="hljs-section">server</span> {\n    <span class="hljs-attribute">listen</span> <span class="hljs-number">80</span>;\n    <span class="hljs-attribute">server_name</span> example.com;\n    <span class="hljs-attribute">root</span> /var/www/example;\n    <span class="hljs-attribute">index</span> index.html;\n}\n\n<span class="hljs-comment"># 站点2: test.com</span>\n<span class="hljs-section">server</span> {\n    <span class="hljs-attribute">listen</span> <span class="hljs-number">80</span>;\n    <span class="hljs-attribute">server_name</span> test.com;\n    <span class="hljs-attribute">root</span> /var/www/test;\n    <span class="hljs-attribute">index</span> index.html;\n}\n</code></pre>\n<hr>\n<h3><strong>二、动态内容处理</strong></h3>\n<h4><strong>1. 代理 PHP（FastCGI）</strong></h4>\n<pre><code class="language-nginx"><span class="hljs-section">server</span> {\n    <span class="hljs-attribute">listen</span> <span class="hljs-number">80</span>;\n    <span class="hljs-attribute">server_name</span> example.com;\n    <span class="hljs-attribute">root</span> /var/www/html;\n\n    <span class="hljs-attribute">index</span> index.php index.html;\n\n    <span class="hljs-comment"># 处理 PHP 请求</span>\n    <span class="hljs-section">location</span> <span class="hljs-regexp">~ \\.php$</span> {\n        <span class="hljs-attribute">include</span> fastcgi_params;\n        <span class="hljs-attribute">fastcgi_pass</span> unix:/run/php/php8.2-fpm.sock;  <span class="hljs-comment"># PHP-FPM 套接字路径</span>\n        <span class="hljs-attribute">fastcgi_index</span> index.php;\n        <span class="hljs-attribute">fastcgi_param</span> SCRIPT_FILENAME <span class="hljs-variable">$document_root</span><span class="hljs-variable">$fastcgi_script_name</span>;\n    }\n}\n</code></pre>\n<h4><strong>2. 代理 Python（uWSGI）</strong></h4>\n<pre><code class="language-nginx"><span class="hljs-section">location</span> / {\n    <span class="hljs-attribute">include</span> uwsgi_params;\n    <span class="hljs-attribute">uwsgi_pass</span> <span class="hljs-number">127.0.0.1:8000</span>;          <span class="hljs-comment"># uWSGI 服务地址</span>\n}\n</code></pre>\n<hr>\n<h3><strong>三、HTTPS 配置（SSL/TLS）</strong></h3>\n<h4><strong>1. 使用 Let\'s Encrypt 免费证书</strong></h4>\n<pre><code class="language-nginx"><span class="hljs-section">server</span> {\n    <span class="hljs-attribute">listen</span> <span class="hljs-number">443</span> ssl http2;               <span class="hljs-comment"># 启用 HTTP/2</span>\n    <span class="hljs-attribute">server_name</span> example.com;\n\n    <span class="hljs-comment"># SSL 证书路径</span>\n    <span class="hljs-attribute">ssl_certificate</span> /etc/letsencrypt/live/example.com/fullchain.pem;\n    <span class="hljs-attribute">ssl_certificate_key</span> /etc/letsencrypt/live/example.com/privkey.pem;\n\n    <span class="hljs-comment"># SSL 优化配置</span>\n    <span class="hljs-attribute">ssl_protocols</span> TLSv1.<span class="hljs-number">2</span> TLSv1.<span class="hljs-number">3</span>;\n    <span class="hljs-attribute">ssl_ciphers</span> <span class="hljs-string">&#x27;ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384&#x27;</span>;\n    <span class="hljs-attribute">ssl_prefer_server_ciphers</span> <span class="hljs-literal">on</span>;\n    <span class="hljs-attribute">ssl_session_cache</span> shared:SSL:<span class="hljs-number">10m</span>;\n    <span class="hljs-attribute">ssl_session_timeout</span> <span class="hljs-number">10m</span>;\n\n    <span class="hljs-attribute">root</span> /var/www/html;\n    <span class="hljs-attribute">index</span> index.html;\n}\n\n<span class="hljs-comment"># HTTP 强制跳转 HTTPS</span>\n<span class="hljs-section">server</span> {\n    <span class="hljs-attribute">listen</span> <span class="hljs-number">80</span>;\n    <span class="hljs-attribute">server_name</span> example.com;\n    <span class="hljs-attribute">return</span> <span class="hljs-number">301</span> https://<span class="hljs-variable">$host</span><span class="hljs-variable">$request_uri</span>;\n}\n</code></pre>\n<hr>\n<h3><strong>四、高级功能配置</strong></h3>\n<h4><strong>1. URL 重写（Rewrite）</strong></h4>\n<pre><code class="language-nginx"><span class="hljs-section">location</span> /blog {\n    <span class="hljs-attribute">rewrite</span><span class="hljs-regexp"> ^/blog/(.*)$</span> /news/<span class="hljs-variable">$1</span> <span class="hljs-literal">permanent</span>;  <span class="hljs-comment"># /blog/old → /news/old</span>\n}\n\n<span class="hljs-comment"># 隐藏 .php 扩展</span>\n<span class="hljs-section">location</span> / {\n    <span class="hljs-attribute">try_files</span> <span class="hljs-variable">$uri</span> <span class="hljs-variable">$uri</span>/ <span class="hljs-variable">$uri</span>.php?<span class="hljs-variable">$args</span>;\n}\n</code></pre>\n<h4><strong>2. 防盗链</strong></h4>\n<pre><code class="language-nginx"><span class="hljs-section">location</span> <span class="hljs-regexp">~* \\.(jpg|png)$</span> {\n    <span class="hljs-attribute">valid_referers</span> <span class="hljs-literal">none</span> <span class="hljs-literal">blocked</span> example.com <span class="hljs-regexp">*.example.com</span>;\n    <span class="hljs-attribute">if</span> (<span class="hljs-variable">$invalid_referer</span>) {\n        <span class="hljs-attribute">return</span> <span class="hljs-number">403</span>;\n    }\n}\n</code></pre>\n<h4><strong>3. 禁止访问敏感文件</strong></h4>\n<pre><code class="language-nginx"><span class="hljs-section">location</span> <span class="hljs-regexp">~ /\\.(ht|env|git)</span> {\n    <span class="hljs-attribute">deny</span> all;\n    <span class="hljs-attribute">return</span> <span class="hljs-number">404</span>;\n}\n</code></pre>\n<hr>\n<h3><strong>五、性能优化</strong></h3>\n<h4><strong>1. 启用 Gzip 压缩</strong></h4>\n<pre><code class="language-nginx"><span class="hljs-attribute">gzip</span> <span class="hljs-literal">on</span>;\n<span class="hljs-attribute">gzip_types</span> text/plain text/css application/json application/javascript;\n<span class="hljs-attribute">gzip_min_length</span> <span class="hljs-number">1024</span>;\n<span class="hljs-attribute">gzip_comp_level</span> <span class="hljs-number">6</span>;\n</code></pre>\n<h4><strong>2. 静态文件缓存控制</strong></h4>\n<pre><code class="language-nginx"><span class="hljs-section">location</span> <span class="hljs-regexp">~* \\.(woff2|jpg|avif)$</span> {\n    <span class="hljs-attribute">expires</span> <span class="hljs-number">365d</span>;\n    <span class="hljs-attribute">add_header</span> Cache-Control <span class="hljs-string">&quot;public&quot;</span>;\n}\n</code></pre>\n<h4><strong>3. 限制客户端并发</strong></h4>\n<pre><code class="language-nginx"><span class="hljs-attribute">limit_conn_zone</span> <span class="hljs-variable">$binary_remote_addr</span> zone=conn_limit:<span class="hljs-number">10m</span>;\n<span class="hljs-attribute">limit_conn</span> conn_limit <span class="hljs-number">10</span>;  <span class="hljs-comment"># 每个 IP 最多 10 个连接</span>\n</code></pre>\n<hr>\n<h3><strong>六、日志配置</strong></h3>\n<h4><strong>1. 自定义访问日志格式</strong></h4>\n<pre><code class="language-nginx"><span class="hljs-section">http</span> {\n    <span class="hljs-attribute">log_format</span> main <span class="hljs-string">&#x27;<span class="hljs-variable">$remote_addr</span> - <span class="hljs-variable">$remote_user</span> [<span class="hljs-variable">$time_local</span>] &#x27;</span>\n                   <span class="hljs-string">&#x27;&quot;<span class="hljs-variable">$request</span>&quot; <span class="hljs-variable">$status</span> <span class="hljs-variable">$body_bytes_sent</span> &#x27;</span>\n                   <span class="hljs-string">&#x27;&quot;<span class="hljs-variable">$http_referer</span>&quot; &quot;<span class="hljs-variable">$http_user_agent</span>&quot;&#x27;</span>;\n\n    <span class="hljs-attribute">access_log</span> /var/log/nginx/access.log main;\n}\n</code></pre>\n<h4><strong>2. 错误日志分级</strong></h4>\n<pre><code class="language-nginx"><span class="hljs-attribute">error_log</span> /var/log/nginx/<span class="hljs-literal">error</span>.log <span class="hljs-literal">warn</span>;  <span class="hljs-comment"># 仅记录警告及以上级别</span>\n</code></pre>\n<hr>\n<h3><strong>七、调试与维护</strong></h3>\n<h4><strong>1. 检查配置语法</strong></h4>\n<pre><code class="language-sh">nginx -t  <span class="hljs-comment"># 测试配置是否正确</span>\n</code></pre>\n<h4><strong>2. 重载配置</strong></h4>\n<pre><code class="language-sh">nginx -s reload  <span class="hljs-comment"># 不重启服务，应用新配置</span>\n</code></pre>\n<h4><strong>3. 查看运行状态</strong></h4>\n<pre><code class="language-sh">systemctl status nginx  <span class="hljs-comment"># 检查服务状态</span>\n</code></pre>\n<hr>\n<h3><strong>常见问题解决</strong></h3>\n<ol>\n<li><strong>403 Forbidden</strong>\n<ul>\n<li>检查 <code>root</code> 目录权限：<code>chown -R nginx:nginx /var/www/html</code></li>\n<li>确保 <code>index</code> 文件存在。</li>\n</ul>\n</li>\n<li><strong>502 Bad Gateway</strong>\n<ul>\n<li>后端服务（如 PHP-FPM）是否运行：<code>systemctl status php8.2-fpm</code></li>\n<li>检查 <code>fastcgi_pass</code> 地址是否正确。</li>\n</ul>\n</li>\n<li><strong>SSL 证书不生效</strong>\n<ul>\n<li>确认证书路径无误，并重启 Nginx。</li>\n<li>使用工具检测：<code>openssl s_client -connect example.com:443</code></li>\n</ul>\n</li>\n</ol>\n<hr>\n<p>通过以上配置，你可以快速搭建一个高性能、安全的 Nginx Web 服务器。根据实际需求调整参数，并参考 <a href="https://nginx.org/en/docs/" target="_blank">Nginx 官方文档</a> 深入了解更多功能。</p>\n</div>'</script></body></html>