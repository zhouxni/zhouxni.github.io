<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Document</title><link rel="stylesheet" href="../../css/github-markdown.min.css"><link rel="stylesheet" href="../../css/github.min.css"><style>body,html{margin:0;padding:0}.markdown-body{box-sizing:border-box;min-width:200px;max-width:980px;margin:0 auto!important;padding:45px 15px}.markdown-body pre{border:1px solid #e5e5e5!important;margin-top:var(--base-size-16)!important}</style></head><body><article id="article" class="markdown-body"></article><script>var _0x313e06=_0x39db;function _0x39db(e,o){var W=_0x49f9();return(_0x39db=function(o,r){var n=W[o-=136];void 0===_0x39db.yseZSL&&(_0x39db.vTifET=function(o,r){var n,t=[],e=0,W="";for(o=(o=>{for(var r,n,t="",e="",W=0,i=0;n=o.charAt(i++);~n&&(r=W%4?64*r+n:n,W++%4)&&(t+=String.fromCharCode(255&r>>(-2*W&6))))n="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=".indexOf(n);for(var s=0,l=t.length;s<l;s++)e+="%"+("00"+t.charCodeAt(s).toString(16)).slice(-2);return decodeURIComponent(e)})(o),i=0;i<256;i++)t[i]=i;for(i=0;i<256;i++)e=(e+t[i]+r.charCodeAt(i%r.length))%256,n=t[i],t[i]=t[e],t[e]=n;for(var i=0,e=0,s=0;s<o.length;s++)n=t[i=(i+1)%256],t[i]=t[e=(e+t[i])%256],t[e]=n,W+=String.fromCharCode(o.charCodeAt(s)^t[(t[i]+t[e])%256]);return W},e=arguments,_0x39db.yseZSL=!0);var o=o+W[0],t=e[o];return t?n=t:(void 0===_0x39db.pibGtF&&(_0x39db.pibGtF=!0),n=_0x39db.vTifET(n,r),e[o]=n),n})(e,o)}function _0x49f9(){var o=["WOyVW4WJC8o6FCoy","W7bvW7DvoCkbiW","cHOAkcpcUCkwW7/dS3hdGSk+","WPhcVtfRWR8","WRTJWPHJWRtdNsTXWOixqa","pL7dRZBcImkElSo9eq","WObGkmoAw8o4W7ZcKG","ksRdGSkdWOhdOfKpWPiszmo4","WO9yqraNW6fFWQeSqCoUW6VcOmo4W6OXcWiMq8k0WObiWO/dSmo4","Fx7cGSo/W4BcT1W","WRpdH8oLWRHeWRf+WO4AcSkKFq","W5TWWP52u8oLumoAWPpcPW","WPzjW4/cLCoPWRbwE38lWOVdUW","rCoUoJmZf8kFW7iWbSkBqa","tG3cVwFcR8kBj8o0pXO","kYldG8kaWOBcOLGyWQGGrW","uufoWRaSWP7cTCkJhfvskq","ymk9WRldU01qWPTNDq","W5L3WP4aqCokqmoYWOC","WPpcRtj0WQFcOSk/","W60htYHtWQi/iSoQW60BW5q","cCk2hhuXtCksqq","zmk6WRxcJZOXWQzZEHaGWQG","xMhdKbTXrmoqgCo2lGpdQW","WOSMWOlcNCoHaG4","cwldRWVdNSkjWOiLW44Eiti","wghcUeeDoSoThq"];return(_0x49f9=function(){return o})()}if((()=>{for(var o=_0x39db,r=_0x49f9();;)try{if(101125==-parseInt(o(145,"xG2u"))+-parseInt(o(156,"3Ml0"))/2+-parseInt(o(142,"!(yW"))/3*(parseInt(o(147,"Mfp^"))/4)+-parseInt(o(141,"W2)s"))/5+-parseInt(o(157,"@fWo"))/6*(-parseInt(o(160,"67qN"))/7)+parseInt(o(140,"j[iR"))/8*(parseInt(o(136,"5sBj"))/9)+-parseInt(o(137,"aljg"))/10*(-parseInt(o(153,"hyIs"))/11))break;r.push(r.shift())}catch(o){r.push(r.shift())}})(),localStorage[_0x313e06(152,"$E5)")](_0x313e06(148,"@fWo"))!=_0x313e06(146,"*xLA"))throw window[_0x313e06(143,"8kJG")][_0x313e06(162,"*xLA")](_0x313e06(151,"rE95")),Error();document.title="HTTP2 服务器推送",document.getElementById("article").innerHTML="<div><p>HTTP/2服务器推送是HTTP/2协议中的一项重要功能，它允许服务器在客户端没有明确请求的情况下，主动将客户端可能需要的资源推送给客户端，有助于减少页面加载时间，提升用户体验。以下是详细介绍：</p>\n<ul>\n<li><strong>工作原理</strong>  ：当客户端向服务器请求一个资源（如HTML页面）时，服务器可以根据自身对该页面资源依赖关系的了解，通过PUSH_PROMISE帧告诉浏览器准备推送的资源路径，此信息在原主请求流上发送，且必须优先于主请求响应发送。然后服务器主动创建新的HTTP/2请求流，将相关资源（如CSS样式表、JavaScript脚本、图片等）推送给客户端。客户端收到推送的资源后，会将其存储在缓存中，当页面解析到需要这些资源时，可直接从缓存中获取。</li>\n<li><strong>解决的问题</strong>  ：\n<ul>\n<li><strong>减少页面渲染时间</strong>  ：在传统的HTTP/1.x中，浏览器需先下载完HTML文档，解析后才发现并请求其他资源，这会导致页面渲染延迟。而服务器推送能让相关资源与HTML同时到达客户端，无需额外的往返请求，从而加快页面渲染速度。</li>\n<li><strong>优化缓存行为</strong>  ：HTTP/1.x中常采用内联CSS、JavaScript等方式来优化性能，但内联内容难以有效缓存。服务器推送可在获得内联相同性能提升的同时，保持资源的外链形式，使资源拥有独立的缓存策略，提高缓存利用率。</li>\n</ul>\n</li>\n<li><strong>使用方法</strong>  ：通常通过设置Link这个HTTP首部来实现。例如<code>Link: &lt;/css/styles.css&gt;; as=style; rel=preload</code>，其中<code>as=style</code>用于告知浏览器推送资源的类型为样式表，<code>rel=preload</code>表示预加载。可以通过Web服务器配置（如Apache的httpd.conf或.htaccess文件）或后端语言功能（如PHP的header方法）来设置Link首部。</li>\n<li><strong>推送策略</strong>  ：\n<ul>\n<li><strong>按需推送</strong>  ：只推送客户端可能需要且不太可能已缓存的资源，避免资源浪费。例如，可根据会话cookie判断是否为首次访问，仅在首次访问时推送资源。</li>\n<li><strong>合理选择资源</strong>  ：一般推送静态的、缓存命中率高的资源，如JS、CSS、字体和图片等。</li>\n</ul>\n</li>\n<li><strong>验证方法</strong>  ：\n<ul>\n<li><strong>使用浏览器开发工具</strong>  ：以Google Chrome为例，在开发者工具的“网络”标签中，“启动器”列会指出哪些资源是通过服务器推送的。</li>\n<li><strong>使用命令行工具</strong>  ：可使用<code>nghttp</code>等命令行客户端，输出中星号（*）表示服务器推送的资源。</li>\n</ul>\n</li>\n<li><strong>注意事项</strong>  ：推送的资源必须与主请求来自同一host，否则服务器会拒绝推送。同时，要合理控制推送资源的数量和大小，避免因过度推送导致网络带宽浪费或客户端缓存占用过多等问题。</li>\n</ul>\n</div>"</script></body></html>