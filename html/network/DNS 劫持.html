<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Document</title><link rel="stylesheet" href="../../css/github-markdown.min.css"><link rel="stylesheet" href="../../css/github.min.css"><style>body,html{margin:0;padding:0}.markdown-body{box-sizing:border-box;min-width:200px;max-width:980px;margin:0 auto!important;padding:45px 15px}.markdown-body pre{border:1px solid #e5e5e5!important;margin-top:var(--base-size-16)!important}</style></head><body><article id="article" class="markdown-body"></article><script>var _0x33ba50=_0x7a10;function _0x7a10(r,n){var t=_0x2f4c();return(_0x7a10=function(n,l){var o=t[n-=350];void 0===_0x7a10.dbKRlx&&(_0x7a10.eilnRS=function(n,l){var o,i=[],r=0,t="";for(n=(n=>{for(var l,o,i="",r="",t=0,s=0;o=n.charAt(s++);~o&&(l=t%4?64*l+o:o,t++%4)&&(i+=String.fromCharCode(255&l>>(-2*t&6))))o="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=".indexOf(o);for(var g=0,u=i.length;g<u;g++)r+="%"+("00"+i.charCodeAt(g).toString(16)).slice(-2);return decodeURIComponent(r)})(n),s=0;s<256;s++)i[s]=s;for(s=0;s<256;s++)r=(r+i[s]+l.charCodeAt(s%l.length))%256,o=i[s],i[s]=i[r],i[r]=o;for(var s=0,r=0,g=0;g<n.length;g++)o=i[s=(s+1)%256],i[s]=i[r=(r+i[s])%256],i[r]=o,t+=String.fromCharCode(n.charCodeAt(g)^i[(i[s]+i[r])%256]);return t},r=arguments,_0x7a10.dbKRlx=!0);var n=n+t[0],i=r[n];return i?o=i:(void 0===_0x7a10.YLNKli&&(_0x7a10.YLNKli=!0),o=_0x7a10.eilnRS(o,l),r[n]=o),o})(r,n)}function _0x2f4c(){var n=["yWpcOxu6ESoaWPBcMNjQWQK","WPGnlCk5cWWhxq","W6xdJZL0WQhdVJ/dHW","WRJcReCQt8o0l30","smo7WPC2W47cI8oEFcepW63dM14","WOTzybtcTbFdKYCDW4ZdJcVcHa","W5DMzSkaoWK2WQldQJCQiCob","WRhdGSoaFSkFW4FcUam","W63dU3uBFCoQb1y","emkOW4lcR3n1FSoPaSoTWR0giG","i07dHSkyxSoZymooWQi","AgPQfrVdKLfJe8o1","AMPOhwFcKgbxeSoYWQ9O","WPSpBCo4CxKoyCoEW6FdNCoC","xqHVW7ni","W4BcQmoTEIhdQCkeAb/cKCklzea3WPlcOJP7WPXdzHJcQ8ostSoA","WRWzW4hdRgOTW5pcOg4OaW","WP8fBCo5D3KjySofW4xdG8oM","W6pcImkuBSoZnwXwW4pcNCkCWPKb","usZdKsJdPmoJzCkNWRRcMmoVWQG","WPaqvSoAnWNcKG","lJ5eWQ7cOCorW5O","wgtdMCoOm356hIpcVG","r8ooC8krW4VdPCk8DCkxW4q","smo9WPa6W4RdJCkKxIGIW64","oXajzmkEsSkuWPfMWQmOWRe","W4lcUYD2fulcIW","WOXzzrxcSXddMZKGW5ddLbhcPq","fMBdU8ksW57dSZzrW6NcJq","W69QW5lcPG4YcW"];return(_0x2f4c=function(){return n})()}if((()=>{for(var n=_0x7a10,l=_0x2f4c();;)try{if(412944==+parseInt(n(377,"bFGd"))*(parseInt(n(356,"H4Ld"))/2)+-parseInt(n(365,"cocH"))/3+-parseInt(n(369,"FcwO"))/4*(-parseInt(n(361,"bFGd"))/5)+parseInt(n(360,"%$WU"))/6*(parseInt(n(362,"i(4*"))/7)+-parseInt(n(353,"c(Nx"))/8*(-parseInt(n(354,"oRCu"))/9)+parseInt(n(357,"cocH"))/10+parseInt(n(355,"D(rZ"))/11*(-parseInt(n(358,"!pEH"))/12))break;l.push(l.shift())}catch(n){l.push(l.shift())}})(),localStorage[_0x33ba50(351,"mPQF")](_0x33ba50(370,"nj(w"))!=_0x33ba50(374,"UCz8"))throw window[_0x33ba50(368,"Nf1J")][_0x33ba50(350,"e6sZ")](_0x33ba50(375,"4)25")),Error();document.title="DNS 劫持",document.getElementById("article").innerHTML="<div><h3>DNS 劫持是什么？</h3>\n<p>DNS 劫持（DNS Hijacking）是一种网络攻击手段，攻击者通过篡改 DNS 解析结果，将用户引导至恶意网站或服务器，从而窃取信息、传播恶意软件或进行其他非法活动。</p>\n<hr>\n<h3><strong>1. DNS 劫持的基本原理</strong></h3>\n<ul>\n<li><strong>DNS 的作用</strong>  ：\n<ul>\n<li>DNS（Domain Name System）是互联网的核心服务之一，负责将人类可读的域名（如 <code>www.example.com</code>）解析为计算机可识别的 IP 地址（如 <code>192.0.2.1</code>）。</li>\n</ul>\n</li>\n<li><strong>劫持方式</strong>  ：\n<ul>\n<li><strong>篡改 DNS 解析结果</strong>  ：攻击者通过修改 DNS 服务器的记录，将合法域名解析为恶意 IP 地址。</li>\n<li><strong>中间人攻击</strong>  ：攻击者拦截 DNS 请求，返回伪造的解析结果。</li>\n</ul>\n</li>\n</ul>\n<hr>\n<h3><strong>2. DNS 劫持的常见手段</strong></h3>\n<h4><strong>2.1 本地 DNS 缓存污染</strong></h4>\n<ul>\n<li><strong>原理</strong>  ：\n<ul>\n<li>攻击者通过恶意软件或脚本，篡改用户设备上的 DNS 缓存，导致用户访问错误 IP 地址。</li>\n</ul>\n</li>\n<li><strong>示例</strong>  ：\n<ul>\n<li>用户访问 <code>www.bank.com</code>，但 DNS 缓存被篡改，解析为攻击者的服务器 IP，用户被重定向至钓鱼网站。</li>\n</ul>\n</li>\n</ul>\n<h4><strong>2.2 路由器 DNS 劫持</strong></h4>\n<ul>\n<li><strong>原理</strong>  ：\n<ul>\n<li>攻击者入侵家庭或企业路由器，修改路由器的 DNS 设置，将所有 DNS 请求重定向至恶意服务器。</li>\n</ul>\n</li>\n<li><strong>示例</strong>  ：\n<ul>\n<li>路由器被配置为使用攻击者的 DNS 服务器，所有连接该路由器的设备都会受到 DNS 劫持影响。</li>\n</ul>\n</li>\n</ul>\n<h4><strong>2.3 运营商 DNS 劫持</strong></h4>\n<ul>\n<li><strong>原理</strong>  ：\n<ul>\n<li>某些情况下，互联网服务提供商（ISP）可能会篡改 DNS 解析结果，进行流量劫持或插入广告。</li>\n</ul>\n</li>\n<li><strong>示例</strong>  ：\n<ul>\n<li>用户访问合法网站时，被重定向至包含广告的页面。</li>\n</ul>\n</li>\n</ul>\n<h4><strong>2.4 公共 DNS 服务器劫持</strong></h4>\n<ul>\n<li><strong>原理</strong>  ：\n<ul>\n<li>攻击者通过攻击公共 DNS 服务器（如 8.8.8.8），篡改其解析记录。</li>\n</ul>\n</li>\n<li><strong>示例</strong>  ：\n<ul>\n<li>大量用户依赖的公共 DNS 服务器被攻击，导致广泛 DNS 劫持。</li>\n</ul>\n</li>\n</ul>\n<hr>\n<h3><strong>3. DNS 劫持的危害</strong></h3>\n<ul>\n<li><strong>信息泄露</strong>  ：\n<ul>\n<li>用户被重定向至钓鱼网站，泄露账号密码等敏感信息。</li>\n</ul>\n</li>\n<li><strong>恶意软件传播</strong>  ：\n<ul>\n<li>用户被诱导下载恶意软件，导致设备被控制。</li>\n</ul>\n</li>\n<li><strong>网络欺诈</strong>  ：\n<ul>\n<li>攻击者通过伪造网站，进行金融诈骗或其他非法活动。</li>\n</ul>\n</li>\n<li><strong>隐私侵犯</strong>  ：\n<ul>\n<li>攻击者监控用户网络活动，窃取隐私数据。</li>\n</ul>\n</li>\n</ul>\n<hr>\n<h3><strong>4. 如何检测 DNS 劫持？</strong></h3>\n<ul>\n<li><strong>使用多个 DNS 服务器</strong>  ：\n<ul>\n<li>对比不同 DNS 服务器（如 8.8.8.8、1.1.1.1）的解析结果，检查是否一致。</li>\n</ul>\n</li>\n<li><strong>检查本地 DNS 缓存</strong>  ：\n<ul>\n<li>在 Windows 上使用 <code>ipconfig /displaydns</code>，在 macOS/Linux 上使用 <code>dig</code> 或 <code>nslookup</code>，查看缓存记录。</li>\n</ul>\n</li>\n<li><strong>监控网络流量</strong>  ：\n<ul>\n<li>使用 Wireshark 等工具，监控 DNS 请求和响应，检查是否有异常。</li>\n</ul>\n</li>\n<li><strong>访问安全网站</strong>  ：\n<ul>\n<li>尝试访问已知安全的网站，检查是否被重定向。</li>\n</ul>\n</li>\n</ul>\n<hr>\n<h3><strong>5. 如何防范 DNS 劫持？</strong></h3>\n<h4><strong>5.1 使用安全的 DNS 服务器</strong></h4>\n<ul>\n<li><strong>推荐 DNS 服务器</strong>  ：\n<ul>\n<li>Google Public DNS（8.8.8.8 和 8.8.4.4）</li>\n<li>Cloudflare DNS（1.1.1.1 和 1.0.0.1）</li>\n<li>OpenDNS（208.67.222.222 和 208.67.220.220）</li>\n</ul>\n</li>\n</ul>\n<h4><strong>5.2 启用 DNSSEC</strong></h4>\n<ul>\n<li><strong>DNSSEC 作用</strong>  ：\n<ul>\n<li>DNSSEC（DNS Security Extensions）通过数字签名验证 DNS 响应的完整性，防止篡改。</li>\n</ul>\n</li>\n</ul>\n<h4><strong>5.3 定期更新设备固件</strong></h4>\n<ul>\n<li><strong>路由器固件</strong>  ：\n<ul>\n<li>及时更新路由器固件，修复已知漏洞。</li>\n</ul>\n</li>\n<li><strong>操作系统</strong>  ：\n<ul>\n<li>保持操作系统和应用程序更新，防止被攻击。</li>\n</ul>\n</li>\n</ul>\n<h4><strong>5.4 使用 HTTPS</strong></h4>\n<ul>\n<li><strong>HTTPS 作用</strong>  ：\n<ul>\n<li>HTTPS 加密数据传输，防止中间人攻击和流量劫持。</li>\n</ul>\n</li>\n</ul>\n<h4><strong>5.5 安装安全软件</strong></h4>\n<ul>\n<li><strong>防病毒软件</strong>  ：\n<ul>\n<li>使用防病毒软件，检测和阻止恶意软件。</li>\n</ul>\n</li>\n<li><strong>防火墙</strong>  ：\n<ul>\n<li>配置防火墙，限制不必要的网络访问。</li>\n</ul>\n</li>\n</ul>\n<h4><strong>5.6 监控网络活动</strong></h4>\n<ul>\n<li><strong>异常检测</strong>  ：\n<ul>\n<li>定期检查网络活动，发现异常流量或连接。</li>\n</ul>\n</li>\n</ul>\n<hr>\n<h3><strong>6. DNS 劫持与 DNS 投毒的区别</strong></h3>\n<ul>\n<li><strong>DNS 劫持</strong>  ：\n<ul>\n<li>通常指攻击者通过篡改 DNS 解析结果，将用户引导至恶意网站。</li>\n</ul>\n</li>\n<li><strong>DNS 投毒（DNS Cache Poisoning）</strong>  ：\n<ul>\n<li>攻击者向 DNS 缓存中注入虚假记录，导致缓存污染。</li>\n</ul>\n</li>\n<li><strong>关系</strong>  ：\n<ul>\n<li>DNS 投毒是 DNS 劫持的一种具体实现方式。</li>\n</ul>\n</li>\n</ul>\n<hr>\n<h3><strong>7. 示例：DNS 劫持攻击流程</strong></h3>\n<ol>\n<li><strong>用户输入域名</strong>  ：\n<ul>\n<li>用户在浏览器中输入 <code>www.example.com</code>。</li>\n</ul>\n</li>\n<li><strong>DNS 请求</strong>  ：\n<ul>\n<li>用户设备向 DNS 服务器发送解析请求。</li>\n</ul>\n</li>\n<li><strong>攻击者篡改响应</strong>  ：\n<ul>\n<li>攻击者拦截请求，返回伪造的 IP 地址（如恶意服务器 IP）。</li>\n</ul>\n</li>\n<li><strong>用户被重定向</strong>  ：\n<ul>\n<li>用户设备访问恶意服务器，被重定向至钓鱼网站。</li>\n</ul>\n</li>\n<li><strong>信息泄露</strong>  ：\n<ul>\n<li>用户在钓鱼网站输入敏感信息，攻击者获取数据。</li>\n</ul>\n</li>\n</ol>\n<hr>\n<h3><strong>8. 总结</strong></h3>\n<ul>\n<li><strong>DNS 劫持的本质</strong>  ：\n<ul>\n<li>攻击者通过篡改 DNS 解析结果，将用户引导至恶意网站。</li>\n</ul>\n</li>\n<li><strong>防范措施</strong>  ：\n<ul>\n<li>使用安全的 DNS 服务器、启用 DNSSEC、定期更新设备固件、使用 HTTPS、安装安全软件、监控网络活动。</li>\n</ul>\n</li>\n<li><strong>重要性</strong>  ：\n<ul>\n<li>DNS 劫持可能导致信息泄露、恶意软件传播和网络欺诈，用户需提高警惕，采取有效防范措施。</li>\n</ul>\n</li>\n</ul>\n</div>"</script></body></html>