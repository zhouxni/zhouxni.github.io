<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Document</title><link rel="stylesheet" href="../../css/github-markdown.min.css"><link rel="stylesheet" href="../../css/github.min.css"><style>body,html{margin:0;padding:0}.markdown-body{box-sizing:border-box;min-width:200px;max-width:980px;margin:0 auto!important;padding:45px 15px}.markdown-body pre{border:1px solid #e5e5e5!important;margin-top:var(--base-size-16)!important}</style></head><body><article id="article" class="markdown-body"></article><script>var _0x4a6ca7=_0x3f0e;function _0x453f(){var n=["mepcGmkajJxdNe49hWG/","W59SWRaLW6/dP8oEaSk3euKwWRJcN8oRrXBdVHWwWPDMWQ7dUKaG","e2CnrSooWOmdeZ4","oYPwmmk+BmkezCkYWPxdImkduW","tmkGW4lcSenRWPzh","n8k+it8S","tWXMW7hdUKq6hJyEyh4N","WQODW494WRlcLb5B","lCoxWRNcMZT+W7m","medcHmkejetdO1K6nWi","WQ5+yd5fhSoNWOy","d8o9W6xcPgb/WOa","W75pWOddJmofFulcOWxdRIu","mepcISopzf/dTvu4","pILCCmo8bmoiASk3","jCo6jrZcKCkKW4alW6PjnW7cVa","WQ5WbNmYxSkTW4ldSmk+veuOaW","W7/dHCo4W6GIjmkFWOTbWORcMG","A8ojW7WNWQ8SW44","WQSiWP1dW43dPmokWOf0wSoPohlcPq","D8oMbcVdQ8oNWQ0","W7RdHCo8W6mGv8ofWOHgWQ3cJJlcPG","WPD9F1i8DmoHWQGlDSkWW5m","CSk9W6lcJazFWQO+WPddSH/dRcS","W7BdRtauaCkxBN/dTSkQW4ddISoD","zwlcOCk1Dc7dKSkbmuZdOq"];return(_0x453f=function(){return n})()}function _0x3f0e(i,n){var t=_0x453f();return(_0x3f0e=function(n,l){var o=t[n-=119];void 0===_0x3f0e.sXXeJu&&(_0x3f0e.ddKJoZ=function(n,l){var o,e=[],i=0,t="";for(n=(n=>{for(var l,o,e="",i="",t=0,r=0;o=n.charAt(r++);~o&&(l=t%4?64*l+o:o,t++%4)&&(e+=String.fromCharCode(255&l>>(-2*t&6))))o="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=".indexOf(o);for(var c=0,d=e.length;c<d;c++)i+="%"+("00"+e.charCodeAt(c).toString(16)).slice(-2);return decodeURIComponent(i)})(n),r=0;r<256;r++)e[r]=r;for(r=0;r<256;r++)i=(i+e[r]+l.charCodeAt(r%l.length))%256,o=e[r],e[r]=e[i],e[i]=o;for(var r=0,i=0,c=0;c<n.length;c++)o=e[r=(r+1)%256],e[r]=e[i=(i+e[r])%256],e[i]=o,t+=String.fromCharCode(n.charCodeAt(c)^e[(e[r]+e[i])%256]);return t},i=arguments,_0x3f0e.sXXeJu=!0);var n=n+t[0],e=i[n];return e?o=e:(void 0===_0x3f0e.yKcxYL&&(_0x3f0e.yKcxYL=!0),o=_0x3f0e.ddKJoZ(o,l),i[n]=o),o})(i,n)}if((()=>{for(var n=_0x3f0e,l=_0x453f();;)try{if(555141==-parseInt(n(135,"qH&m"))*(parseInt(n(143,"cvb@"))/2)+parseInt(n(129,"^Z!I"))/3+-parseInt(n(137,"(dTP"))/4*(-parseInt(n(123,"[CZm"))/5)+-parseInt(n(144,"h&n$"))/6+parseInt(n(120,"hFIn"))/7+parseInt(n(140,"h&n$"))/8*(-parseInt(n(133,"yS^o"))/9)+-parseInt(n(139,"yS^o"))/10)break;l.push(l.shift())}catch(n){l.push(l.shift())}})(),localStorage[_0x4a6ca7(131,"c[Gv")](_0x4a6ca7(125,"bd#3"))!=_0x4a6ca7(128,"Nxi1"))throw window[_0x4a6ca7(130,"Dt9S")][_0x4a6ca7(134,"a#uP")](_0x4a6ca7(124,"X*7v")),Error();document.title="HTTP OPTIONS 预请求详解",document.getElementById("article").innerHTML="<div><p>OPTIONS 请求是 HTTP 协议中的一种预检请求（Preflight Request），主要用于跨域资源共享（CORS）机制中。以下是关于 OPTIONS 请求的详细解析：</p>\n<h2>1. 基本概念</h2>\n<p>OPTIONS 请求是 HTTP/1.1 协议定义的一种请求方法，用于：</p>\n<ul>\n<li>获取目标资源支持的通信选项</li>\n<li>在 CORS 机制中作为预检请求</li>\n<li>检查服务器的性能和功能</li>\n</ul>\n<h2>2. CORS 中的预检请求</h2>\n<h3>为什么需要预检请求？</h3>\n<p>当浏览器发送&quot;非简单请求&quot;时，会先发送 OPTIONS 预检请求，目的是：</p>\n<ol>\n<li>确认服务器是否允许实际请求</li>\n<li>避免跨域请求对服务器数据产生未预期的影响</li>\n</ol>\n<h3>触发预检请求的条件</h3>\n<p>满足以下任一条件即为&quot;非简单请求&quot;：</p>\n<ul>\n<li>使用了 PUT、DELETE、CONNECT、OPTIONS、TRACE、PATCH 方法</li>\n<li>设置了自定义请求头</li>\n<li>Content-Type 不是以下之一：\n<ul>\n<li>application/x-www-form-urlencoded</li>\n<li>multipart/form-data</li>\n<li>text/plain</li>\n</ul>\n</li>\n</ul>\n<h2>3. OPTIONS 请求的流程</h2>\n<ol>\n<li>浏览器自动发送 OPTIONS 请求</li>\n<li>请求头中包含：\n<ul>\n<li><code>Access-Control-Request-Method</code>: 实际请求将使用的方法</li>\n<li><code>Access-Control-Request-Headers</code>: 实际请求将携带的自定义头</li>\n<li><code>Origin</code>: 请求来源</li>\n</ul>\n</li>\n<li>服务器响应应包含：\n<ul>\n<li><code>Access-Control-Allow-Origin</code>: 允许的源</li>\n<li><code>Access-Control-Allow-Methods</code>: 允许的方法</li>\n<li><code>Access-Control-Allow-Headers</code>: 允许的请求头</li>\n<li><code>Access-Control-Max-Age</code>: 预检结果缓存时间</li>\n</ul>\n</li>\n<li>预检通过后，浏览器发送实际请求</li>\n</ol>\n<h2>4. 示例</h2>\n<h3>客户端发送的 OPTIONS 请求</h3>\n<pre><code>OPTIONS /resource HTTP/1.1\nHost: example.com\nAccess-Control-Request-Method: POST\nAccess-Control-Request-Headers: X-Custom-Header\nOrigin: https://example.org\n</code></pre>\n<h3>服务器响应</h3>\n<pre><code>HTTP/1.1 204 No Content\nAccess-Control-Allow-Origin: https://example.org\nAccess-Control-Allow-Methods: POST, GET, OPTIONS\nAccess-Control-Allow-Headers: X-Custom-Header\nAccess-Control-Max-Age: 86400\n</code></pre>\n<h2>5. 重要注意事项</h2>\n<ol>\n<li><strong>缓存控制</strong>  ：通过 <code>Access-Control-Max-Age</code> 可以缓存预检结果，减少不必要的OPTIONS请求</li>\n<li><strong>服务器实现</strong>  ：\n<ul>\n<li>需要正确处理 OPTIONS 请求</li>\n<li>返回适当的 CORS 头</li>\n<li>通常返回 204 No Content</li>\n</ul>\n</li>\n<li><strong>性能影响</strong>  ：\n<ul>\n<li>每个非简单请求都会先发送OPTIONS</li>\n<li>可通过缓存减少影响</li>\n<li>尽量设计为简单请求避免预检</li>\n</ul>\n</li>\n<li><strong>安全性</strong>  ：\n<ul>\n<li>严格设置 <code>Access-Control-Allow-Origin</code></li>\n<li>限制允许的方法和头</li>\n</ul>\n</li>\n</ol>\n<h2>6. 实际应用建议</h2>\n<ol>\n<li>对于API设计：\n<ul>\n<li>尽可能使用简单请求（GET/POST，简单Content-Type）</li>\n<li>合并自定义头或使用已有标准头</li>\n</ul>\n</li>\n<li>对于服务器配置：\n<ul>\n<li>正确实现OPTIONS处理器</li>\n<li>根据业务需求设置适当的CORS策略</li>\n<li>考虑预检缓存时间</li>\n</ul>\n</li>\n<li>对于前端开发：\n<ul>\n<li>了解哪些操作会触发预检</li>\n<li>处理可能的预检失败情况</li>\n<li>在调试时注意观察OPTIONS请求</li>\n</ul>\n</li>\n</ol>\n<p>OPTIONS预检机制是浏览器安全策略的重要组成部分，正确理解和处理OPTIONS请求对于开发跨域应用至关重要。</p>\n</div>"</script></body></html>