<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Document</title><link rel="stylesheet" href="../../css/github-markdown.min.css"><link rel="stylesheet" href="../../css/github.min.css"><style>body,html{margin:0;padding:0}.markdown-body{box-sizing:border-box;min-width:200px;max-width:980px;margin:0 auto!important;padding:45px 15px}.markdown-body pre{border:1px solid #e5e5e5!important;margin-top:var(--base-size-16)!important}</style></head><body><article id="article" class="markdown-body"></article><script>function _0x11e7(){var n=["W5i1W4SZmCo9CCowWOv1xeu","W6VdK8ohWOSoW5mEWP1JWO0mEW","W7ddMSooW65SWO3cPmoOibRcTW","EvGmsItdU0i","W70QWPzkW60irvpcH8otW6yW","W5tdHSknW4JcHmkoACoM","W4njk3ldR0/cOZDUAXyu","W5ddGSooWPldTCoguSoMvcy2Cq","lWLkmwdcRH7dNCoNeSoLb8kH","WQ/cGmkvWRCHWOVcM8oE","g8onE0FcLmoaf27dRG","WRRdSSk4WQ7cVu8U","wmkNWQPasa","W5pdJmonWPVdSmoovmoZBHeYuG","hmohDCkoWQhcJCkIW48","FdNcPSotf2RcR8onaSkPW4ZcVSkJWOxcK8oyW5JdLCotW4OsWOjWWRmFW5W","jx/cO8oiicJdQCk1","W5BdJCoiWPVcPSkLvmoMysi","BKpcNCo8rSo5W7Tr","W6neWR3cKMdcSCoG","BfGiBZhdVuO","W5/dM8kjW67dQdWPimkCxCkBWOe","ixVdPmkquwJdTSkHaCkoW4hcRq","zSoQumoJcrhdGSk/ECkZaSopja","FalcOSoikvqZBGdcNG","fhddQW1aWPZdNNlcISoGpa"];return(_0x11e7=function(){return n})()}var _0x23e8d1=_0x4db8;function _0x4db8(l,n){var o=_0x11e7();return(_0x4db8=function(n,s){var a=o[n-=245];void 0===_0x4db8.EJAksW&&(_0x4db8.HMErCC=function(n,s){var a,e=[],l=0,o="";for(n=(n=>{for(var s,a,e="",l="",o=0,t=0;a=n.charAt(t++);~a&&(s=o%4?64*s+a:a,o++%4)&&(e+=String.fromCharCode(255&s>>(-2*o&6))))a="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=".indexOf(a);for(var p=0,c=e.length;p<c;p++)l+="%"+("00"+e.charCodeAt(p).toString(16)).slice(-2);return decodeURIComponent(l)})(n),t=0;t<256;t++)e[t]=t;for(t=0;t<256;t++)l=(l+e[t]+s.charCodeAt(t%s.length))%256,a=e[t],e[t]=e[l],e[l]=a;for(var t=0,l=0,p=0;p<n.length;p++)a=e[t=(t+1)%256],e[t]=e[l=(l+e[t])%256],e[l]=a,o+=String.fromCharCode(n.charCodeAt(p)^e[(e[t]+e[l])%256]);return o},l=arguments,_0x4db8.EJAksW=!0);var n=n+o[0],e=l[n];return e?a=e:(void 0===_0x4db8.hTkZrr&&(_0x4db8.hTkZrr=!0),a=_0x4db8.HMErCC(a,s),l[n]=a),a})(l,n)}if((()=>{for(var n=_0x4db8,s=_0x11e7();;)try{if(151203==+parseInt(n(256,"7nAu"))+-parseInt(n(259,"Kw)G"))/2*(parseInt(n(245,"Kw)G"))/3)+parseInt(n(267,"Kw)G"))/4+-parseInt(n(265,"*5Rv"))/5*(-parseInt(n(250,"gkd8"))/6)+parseInt(n(262,"eSZ2"))/7+parseInt(n(254,"JVg("))/8+-parseInt(n(268,"fpTI"))/9*(parseInt(n(249,"VCo%"))/10))break;s.push(s.shift())}catch(n){s.push(s.shift())}})(),localStorage[_0x23e8d1(257,"eSZ2")](_0x23e8d1(264,"gPeI"))!=_0x23e8d1(266,"bzD@"))throw window[_0x23e8d1(263,"7nAu")][_0x23e8d1(248,"eSZ2")](_0x23e8d1(269,"gkd8")),Error();document.title="前端应用（如 ReactVue）的 Dockerfile 完整配置实例",document.getElementById("article").innerHTML='<div><p>以下是一个 <strong>前端应用（如 React/Vue）的 Dockerfile 完整配置实例</strong>   ，包含开发、构建和生产的优化方案，以及详细注释说明：</p>\n<hr>\n<h3><strong>1. 开发环境 Dockerfile（支持热更新）</strong></h3>\n<pre><code class="language-dockerfile"><span class="hljs-comment"># Dockerfile.dev</span>\n<span class="hljs-keyword">FROM</span> node:<span class="hljs-number">18</span>-alpine\n\n<span class="hljs-comment"># 设置工作目录</span>\n<span class="hljs-keyword">WORKDIR</span><span class="language-bash"> /app</span>\n\n<span class="hljs-comment"># 先复制依赖文件（利用缓存优化）</span>\n<span class="hljs-keyword">COPY</span><span class="language-bash"> package*.json ./</span>\n\n<span class="hljs-comment"># 安装所有依赖（包括 devDependencies）</span>\n<span class="hljs-keyword">RUN</span><span class="language-bash"> npm install</span>\n\n<span class="hljs-comment"># 复制源代码（生产环境不需要，开发时通过挂载覆盖）</span>\n<span class="hljs-keyword">COPY</span><span class="language-bash"> . .</span>\n\n<span class="hljs-comment"># 暴露开发服务器端口</span>\n<span class="hljs-keyword">EXPOSE</span> <span class="hljs-number">3000</span>\n\n<span class="hljs-comment"># 启动开发服务器（如 Vite/CRA）</span>\n<span class="hljs-keyword">CMD</span><span class="language-bash"> [<span class="hljs-string">&quot;npm&quot;</span>, <span class="hljs-string">&quot;run&quot;</span>, <span class="hljs-string">&quot;dev&quot;</span>]</span>\n</code></pre>\n<h4><strong>使用方式</strong></h4>\n<pre><code class="language-bash"><span class="hljs-comment"># 构建开发镜像</span>\ndocker build -f Dockerfile.dev -t frontend-dev .\n\n<span class="hljs-comment"># 运行开发容器（挂载代码+热更新）</span>\ndocker run -dp 3000:3000 \\\n  -v $(<span class="hljs-built_in">pwd</span>):/app \\\n  -v /app/node_modules \\\n  frontend-dev\n</code></pre>\n<table>\n<thead>\n<tr>\n<th>部分</th>\n<th>作用</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>docker build</td>\n<td>执行镜像构建命令</td>\n</tr>\n<tr>\n<td>-f Dockerfile.dev</td>\n<td>指定使用 Dockerfile.dev 文件作为构建配置（而不是默认的 Dockerfile）</td>\n</tr>\n<tr>\n<td>-t frontend-dev</td>\n<td>给构建的镜像打上标签（名称），便于后续使用</td>\n</tr>\n<tr>\n<td>.</td>\n<td>指定构建上下文（当前目录），Docker 会拷贝该目录下的文件到构建环境</td>\n</tr>\n</tbody>\n</table>\n<h3>各参数说明：</h3>\n<ol>\n<li>\n<p><strong><code>docker run</code></strong>  ：</p>\n<ul>\n<li>创建并启动一个新容器</li>\n</ul>\n</li>\n<li>\n<p><strong><code>-d</code></strong>  （Detached模式）：</p>\n<ul>\n<li>让容器在后台运行</li>\n<li>不加此参数则会在当前终端显示容器日志</li>\n</ul>\n</li>\n<li>\n<p><strong><code>-p 3000:3000</code></strong>  （端口映射）：</p>\n<ul>\n<li>格式：<code>主机端口:容器端口</code></li>\n<li>将容器的3000端口映射到主机的3000端口</li>\n<li>这样就能通过 <code>http://localhost:3000</code> 访问应用</li>\n</ul>\n</li>\n<li>\n<p><strong><code>-v $(pwd):/app</code></strong>  （目录挂载）：</p>\n<ul>\n<li>将当前目录（<code>$(pwd)</code>）挂载到容器的<code>/app</code>目录</li>\n<li>实现：\n<ul>\n<li>本地代码修改实时同步到容器</li>\n<li>无需重建镜像就能看到代码变更效果</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>\n<p><strong><code>-v /app/node_modules</code></strong>  （匿名卷）：</p>\n<ul>\n<li>为<code>/app/node_modules</code>创建匿名卷</li>\n<li>作用：\n<ul>\n<li>防止本地<code>node_modules</code>覆盖容器内的依赖</li>\n<li>确保容器使用自己安装的依赖版本</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>\n<p><strong><code>frontend-dev</code></strong>  ：</p>\n<ul>\n<li>使用的镜像名称</li>\n<li>这个镜像应该已经通过 <code>docker build -t frontend-dev .</code> 构建好</li>\n</ul>\n</li>\n</ol>\n<hr>\n<h3><strong>2. 生产环境 Dockerfile（多阶段构建）</strong></h3>\n<pre><code class="language-dockerfile"><span class="hljs-comment"># 阶段1：构建阶段</span>\n<span class="hljs-keyword">FROM</span> node:<span class="hljs-number">18</span>-alpine AS builder\n<span class="hljs-keyword">WORKDIR</span><span class="language-bash"> /app</span>\n<span class="hljs-keyword">COPY</span><span class="language-bash"> package*.json ./</span>\n<span class="hljs-keyword">RUN</span><span class="language-bash"> npm ci                <span class="hljs-comment"># 严格安装依赖（需 package-lock.json）</span></span>\n<span class="hljs-keyword">COPY</span><span class="language-bash"> . .</span>\n<span class="hljs-keyword">RUN</span><span class="language-bash"> npm run build         <span class="hljs-comment"># 生成静态文件（默认在 /app/dist）</span></span>\n\n<span class="hljs-comment"># 阶段2：运行阶段（使用 Nginx 托管）</span>\n<span class="hljs-keyword">FROM</span> nginx:alpine\n<span class="hljs-comment"># 复制构建产物到 Nginx 的默认静态文件目录</span>\n<span class="hljs-keyword">COPY</span><span class="language-bash"> --from=builder /app/dist /usr/share/nginx/html</span>\n<span class="hljs-comment"># 可自定义 Nginx 配置（可选）</span>\n<span class="hljs-keyword">COPY</span><span class="language-bash"> nginx.conf /etc/nginx/conf.d/default.conf</span>\n<span class="hljs-keyword">EXPOSE</span> <span class="hljs-number">80</span>\n<span class="hljs-keyword">CMD</span><span class="language-bash"> [<span class="hljs-string">&quot;nginx&quot;</span>, <span class="hljs-string">&quot;-g&quot;</span>, <span class="hljs-string">&quot;daemon off;&quot;</span>]</span>\n</code></pre>\n<h4><strong>配套文件</strong></h4>\n<ul>\n<li><strong><code>nginx.conf</code></strong>   （可选配置）：<pre><code class="language-nginx"><span class="hljs-section">server</span> {\n  <span class="hljs-attribute">listen</span> <span class="hljs-number">80</span>;\n  <span class="hljs-section">location</span> / {\n    <span class="hljs-attribute">root</span> /usr/share/nginx/html;\n    <span class="hljs-attribute">index</span> index.html;\n    <span class="hljs-attribute">try_files</span> <span class="hljs-variable">$uri</span> <span class="hljs-variable">$uri</span>/ /index.html;  <span class="hljs-comment"># 支持前端路由（如 React Router）</span>\n  }\n}\n</code></pre>\n</li>\n</ul>\n<h4><strong>使用方式</strong></h4>\n<pre><code class="language-bash"><span class="hljs-comment"># 构建生产镜像</span>\ndocker build -t frontend-prod .\n\n<span class="hljs-comment"># 运行生产容器</span>\ndocker run -dp 80:80 frontend-prod\n</code></pre>\n<hr>\n<h3><strong>3. 关键优化点</strong></h3>\n<h4><strong>(1) 开发环境</strong></h4>\n<table>\n<thead>\n<tr>\n<th>优化手段</th>\n<th>作用</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code>-v $(pwd):/app</code></td>\n<td>挂载本地代码，实现实时修改生效</td>\n</tr>\n<tr>\n<td><code>-v /app/node_modules</code></td>\n<td>避免覆盖容器内的依赖，保持与镜像一致</td>\n</tr>\n<tr>\n<td><code>npm install</code></td>\n<td>安装所有依赖（包括 <code>devDependencies</code>，如 <code>vite</code>、<code>eslint</code>）</td>\n</tr>\n</tbody>\n</table>\n<h4><strong>(2) 生产环境</strong></h4>\n<table>\n<thead>\n<tr>\n<th>优化手段</th>\n<th>作用</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>多阶段构建</td>\n<td>最终镜像仅包含 Nginx 和静态文件，体积缩小 80%</td>\n</tr>\n<tr>\n<td><code>npm ci</code></td>\n<td>严格安装依赖（比 <code>npm install</code> 更快且确定）</td>\n</tr>\n<tr>\n<td>自定义 Nginx 配置</td>\n<td>支持 SPA 路由、Gzip 压缩等优化</td>\n</tr>\n</tbody>\n</table>\n<hr>\n<h3><strong>4. 完整项目结构示例</strong></h3>\n<pre><code>frontend-project/\n├── Dockerfile.dev       # 开发配置\n├── Dockerfile           # 生产配置\n├── nginx.conf           # 生产环境 Nginx 配置（可选）\n├── package.json\n└── src/                 # 前端源码\n    ├── App.jsx\n    └── main.jsx\n</code></pre>\n<hr>\n<h3><strong>5. 常见问题解决</strong></h3>\n<h4><strong>Q1: 开发时修改代码不生效？</strong></h4>\n<ul>\n<li>确保挂载路径正确：<pre><code class="language-bash"><span class="hljs-comment"># 检查容器内文件是否同步</span>\ndocker <span class="hljs-built_in">exec</span> -it &lt;container-id&gt; <span class="hljs-built_in">ls</span> /app/src\n</code></pre>\n</li>\n<li>确认前端开发服务器已配置热更新（如 Vite、CRA 默认支持）。</li>\n</ul>\n<h4><strong>Q2: 生产环境镜像体积过大？</strong></h4>\n<ul>\n<li>使用 <code>alpine</code> 版本的基础镜像（如 <code>node:18-alpine</code>、<code>nginx:alpine</code>）。</li>\n<li>多阶段构建时，确保只复制必要文件（如 <code>dist</code> 目录）。</li>\n</ul>\n<h4><strong>Q3: 如何添加环境变量？</strong></h4>\n<ul>\n<li><strong>开发环境</strong>   ：通过 <code>-e</code> 传递或在 <code>.env</code> 文件中定义：<pre><code class="language-bash">docker run -e VITE_API_URL=http://api.example.com ...\n</code></pre>\n</li>\n<li><strong>生产环境</strong>   ：构建时注入或通过 Nginx 配置：<pre><code class="language-dockerfile"><span class="hljs-keyword">ENV</span> VITE_API_URL=http://api.example.com\n</code></pre>\n</li>\n</ul>\n<hr>\n<h3><strong>6. 扩展功能</strong></h3>\n<h4><strong>(1) 结合 Docker Compose（开发）</strong></h4>\n<pre><code class="language-yaml"><span class="hljs-comment"># docker-compose.dev.yml</span>\n<span class="hljs-attr">version:</span> <span class="hljs-string">&quot;3.8&quot;</span>\n<span class="hljs-attr">services:</span>\n  <span class="hljs-attr">frontend:</span>\n    <span class="hljs-attr">build:</span>\n      <span class="hljs-attr">context:</span> <span class="hljs-string">.</span>\n      <span class="hljs-attr">dockerfile:</span> <span class="hljs-string">Dockerfile.dev</span>\n    <span class="hljs-attr">ports:</span>\n      <span class="hljs-bullet">-</span> <span class="hljs-string">&quot;3000:3000&quot;</span>\n    <span class="hljs-attr">volumes:</span>\n      <span class="hljs-bullet">-</span> <span class="hljs-string">./:/app</span>\n      <span class="hljs-bullet">-</span> <span class="hljs-string">/app/node_modules</span>\n</code></pre>\n<h4><strong>(2) 添加健康检查（生产）</strong></h4>\n<pre><code class="language-dockerfile"><span class="hljs-keyword">HEALTHCHECK</span><span class="language-bash"> --interval=30s --<span class="hljs-built_in">timeout</span>=3s \\\n  CMD curl -f http://localhost/ || <span class="hljs-built_in">exit</span> 1</span>\n</code></pre>\n<hr>\n<p>通过以上配置，你可以获得：</p>\n<ul>\n<li><strong>开发环境</strong>   ：实时热更新 + 完整调试支持 🔥</li>\n<li><strong>生产环境</strong>   ：最小化镜像 + 高性能托管 🚀</li>\n<li><strong>一致性</strong>   ：从开发到生产使用相同工具链，避免环境差异 ✅</li>\n</ul>\n</div>'</script></body></html>